webpackJsonp([29],{1108:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwCwmpSdk=void 0;var a=n(132),i=r(a),o=n(4),s=r(o),c=n(1109);t.HwCwmpSdk=function e(){(0,s.default)(this,e),this.getCwmpApi=c.getCwmpApi,(0,i.default)(this,(0,c.getCwmpApi)().getApiList())}},1109:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CwmpImpl=t.getCwmpApi=void 0;var i=n(1),o=a(i),s=n(2),c=a(s),u=n(128),f=a(u),d=n(4),l=a(d),p=n(129),w=a(p),g=n(130),h=a(g),C=n(670),v=r(C),m=n(865),S=r(m),E=n(671),_=r(E),I=coreLogger.getLogger("cwmp")("CwmpImpl"),T=void 0,P=(t.getCwmpApi=function(){return isNullOrEmpty(T)&&(T=new P),T},t.CwmpImpl=function(e){function t(){var e=this;(0,l.default)(this,t);var n=(0,w.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return n.stopCwmpServerAndUnInit=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("stopCwmpServerAndUnInit"),e.abrupt("return",S.stopCwmpServerAndUnInit());case 2:case"end":return e.stop()}},t,e)})),n.dealWithUICfgParam=function(){var t=(0,c.default)(o.default.mark(function t(n){var r=n.paramName,a=n.paramValue;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("dealWithUICfgParam"),v.dealWithUICfgParam(r,a);case 2:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),n.cwmpConfigToken=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("cwmpConfigToken"),e.abrupt("return",S.cwmpConfigToken());case 2:case"end":return e.stop()}},t,e)})),n.checkUpdateConfig=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("checkUpdateConfig"),v.checkUpdateConfig();case 2:case"end":return e.stop()}},t,e)})),n.restartUpgrade=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("restartUpgrade"),_.restartUpgrade();case 2:case"end":return e.stop()}},t,e)})),n.setUploadSuccessFunc=function(){var t=(0,c.default)(o.default.mark(function t(n){var r=n.func;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("setUploadSuccessFunc"),v.setUploadSuccessFunc(r);case 2:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),n.setUploadFailedFunc=function(){var t=(0,c.default)(o.default.mark(function t(n){var r=n.func;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("setUploadFailedFunc"),v.setUploadFailedFunc(r);case 2:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),n.dealZipLogSuccess=function(){var t=(0,c.default)(o.default.mark(function t(n){var r=n.logPath;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("dealZipLogSuccess"),v.dealZipLogSuccess(r);case 2:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),n.hideProgressBarModal=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("hideProgressBarModal"),_.hideProgressBarModal();case 2:case"end":return e.stop()}},t,e)})),n.clickRequestVersionCheck=function(){var t=(0,c.default)(o.default.mark(function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{version:""},r=n.version;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("clickRequestVersionCheck version=",r),_.clickRequestVersionCheck(r);case 2:case"end":return e.stop()}},t,e)}));return function(){return t.apply(this,arguments)}}(),n.sendMobileLogZipFiles=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("sendMobileLogZipFiles"),v.sendMobileLogZipFiles();case 2:case"end":return e.stop()}},t,e)})),n.dealUpdateVersionClick=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("dealUpdateVersionClick"),_.dealUpdateVersionClick();case 2:case"end":return e.stop()}},t,e)})),n.clearBarPageSet=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("clearBarPageSet"),_.clearBarPageSet();case 2:case"end":return e.stop()}},t,e)})),n.requestVersionUpdateCheck=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("requestVersionUpdateCheck"),_.requestVersionUpdateCheck();case 2:case"end":return e.stop()}},t,e)})),n.getInCallingState=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("getInCallingState"),e.abrupt("return",_.getInCallingState());case 2:case"end":return e.stop()}},t,e)})),n.clearBarPageSet=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("clearBarPageSet"),_.clearBarPageSet();case 2:case"end":return e.stop()}},t,e)})),n.getComPressFileSize=function(){var t=(0,c.default)(o.default.mark(function t(n){var r=n.filePath;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("getComPressFileSize"),e.abrupt("return",v.getComPressFileSize(r));case 2:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),n.initESightService=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("initESightService"),e.abrupt("return",S.initESightService());case 2:case"end":return e.stop()}},t,e)})),n.getAllConfig=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v.getAllConfig());case 1:case"end":return e.stop()}},t,e)})),n}return(0,h.default)(t,e),t}(coreLazyLoad.CwmpApi))},1110:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isServerCollecting=function(e){return $dispatch(coreUi.isServerCollecting(e))}},127:function(e,t,n){e.exports=n(0)(0)},132:function(e,t,n){e.exports=n(0)(562)},140:function(e,t,n){"use strict";(function(e){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=i.prototype):(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return o(this,e,t,n)}function o(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?l(e,t,n,r):"string"==typeof t?f(e,t,n):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,n,r){return s(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}function u(e,t){if(s(t),e=a(e,t<0?0:0|w(t)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n);e=a(e,r);var o=e.write(t,n);return o!==r&&(e=e.slice(0,o)),e}function d(e,t){var n=t.length<0?0:0|w(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function l(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),i.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=i.prototype):e=d(e,t),e}function p(e,t){if(i.isBuffer(t)){var n=0|w(t.length);return e=a(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?a(e,0):d(e,t);if("Buffer"===t.type&&Z(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),i.alloc(+e)}function h(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(r)return W(e).length;t=(""+t).toLowerCase(),r=!0}}function C(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return b(this,t,n);case"utf8":case"utf-8":return y(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return O(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,a){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=i.from(t,r)),i.isBuffer(t))return 0===t.length?-1:S(e,t,n,r,a);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):S(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function S(e,t,n,r,a){function i(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,n/=2}var u;if(a){var f=-1;for(u=n;u<s;u++)if(i(e,u)===i(t,-1===f?0:u-f)){if(-1===f&&(f=u),u-f+1===c)return f*o}else-1!==f&&(u-=u-f),f=-1}else for(n+c>s&&(n=s-c),u=n;u>=0;u--){for(var d=!0,l=0;l<c;l++)if(i(e,u+l)!==i(t,l)){d=!1;break}if(d)return u}return-1}function E(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function _(e,t,n,r){return z(W(t,e.length-n),e,n,r)}function I(e,t,n,r){return z(K(t),e,n,r)}function T(e,t,n,r){return I(e,t,n,r)}function P(e,t,n,r){return z(q(t),e,n,r)}function N(e,t,n,r){return z(Y(t,e.length-n),e,n,r)}function x(e,t,n){return 0===t&&n===e.length?j.fromByteArray(e):j.fromByteArray(e.slice(t,n))}function y(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i=e[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s<=n){var c,u,f,d;switch(s){case 1:i<128&&(o=i);break;case 2:c=e[a+1],128==(192&c)&&(d=(31&i)<<6|63&c)>127&&(o=d);break;case 3:c=e[a+1],u=e[a+2],128==(192&c)&&128==(192&u)&&(d=(15&i)<<12|(63&c)<<6|63&u)>2047&&(d<55296||d>57343)&&(o=d);break;case 4:c=e[a+1],u=e[a+2],f=e[a+3],128==(192&c)&&128==(192&u)&&128==(192&f)&&(d=(15&i)<<18|(63&c)<<12|(63&u)<<6|63&f)>65535&&d<1114112&&(o=d)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=s}return k(r)}function k(e){var t=e.length;if(t<=J)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=J));return n}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function O(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function b(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=$(e[i]);return a}function U(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,a,o){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function M(e,t,n,r){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-n,2);a<i;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function R(e,t,n,r){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-n,4);a<i;++a)e[n+a]=t>>>8*(r?a:3-a)&255}function F(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function V(e,t,n,r,a){return a||F(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,a){return a||F(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,n,r,52,8),n+8}function G(e){if(e=H(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function $(e){return e<16?"0"+e.toString(16):e.toString(16)}function W(e,t){t=t||1/0;for(var n,r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function K(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Y(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,a=n%256,i.push(a),i.push(r);return i}function q(e){return j.toByteArray(G(e))}function z(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function X(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var j=n(231),Q=n(232),Z=n(214);t.Buffer=i,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,n){return o(null,e,t,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,n){return c(null,e,t,n)},i.allocUnsafe=function(e){return u(null,e)},i.allocUnsafeSlow=function(e){return u(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,o=Math.min(n,r);a<o;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=i.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var o=e[n];if(!i.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,a),a+=o.length}return r},i.byteLength=h,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?y(this,0,e):C.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,n,r,a){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,a>>>=0,this===e)return 0;for(var o=a-r,s=n-t,c=Math.min(o,s),u=this.slice(r,a),f=e.slice(t,n),d=0;d<c;++d)if(u[d]!==f[d]){o=u[d],s=f[d];break}return o<s?-1:s<o?1:0},i.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},i.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},i.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return I(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return P(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var J=4096;i.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(i.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=i.prototype;else{var a=t-e;r=new i(a,void 0);for(var o=0;o<a;++o)r[o]=this[o+e]}return r},i.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},i.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},i.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*t)),r},i.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),Q.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),Q.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),Q.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),Q.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},i.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},i.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);L(this,e,t,n,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},i.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);L(this,e,t,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,n){return V(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return V(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,o=r-n;if(this===e&&n<t&&t<r)for(a=o-1;a>=0;--a)e[a+t]=this[a+n];else if(o<1e3||!i.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},i.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=i.isBuffer(e)?e:W(new i(e,r).toString()),c=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%c]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(148))},145:function(e,t,n){e.exports={default:n(165),__esModule:!0}},148:function(e,t,n){e.exports=n(0)(86)},165:function(e,t,n){n(23),n(22),e.exports=n(166)},166:function(e,t,n){var r=n(9),a=n(26);e.exports=n(8).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},214:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},231:function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function a(e){var t=r(e),n=t[0],a=t[1];return 3*(n+a)/4-a}function i(e,t,n){return 3*(t+n)/4-n}function o(e){for(var t,n=r(e),a=n[0],o=n[1],s=new l(i(e,a,o)),c=0,u=o>0?a-4:a,f=0;f<u;f+=4)t=d[e.charCodeAt(f)]<<18|d[e.charCodeAt(f+1)]<<12|d[e.charCodeAt(f+2)]<<6|d[e.charCodeAt(f+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;return 2===o&&(t=d[e.charCodeAt(f)]<<2|d[e.charCodeAt(f+1)]>>4,s[c++]=255&t),1===o&&(t=d[e.charCodeAt(f)]<<10|d[e.charCodeAt(f+1)]<<4|d[e.charCodeAt(f+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t),s}function s(e){return f[e>>18&63]+f[e>>12&63]+f[e>>6&63]+f[63&e]}function c(e,t,n){for(var r,a=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),a.push(s(r));return a.join("")}function u(e){for(var t,n=e.length,r=n%3,a=[],i=0,o=n-r;i<o;i+=16383)a.push(c(e,i,i+16383>o?o:i+16383));return 1===r?(t=e[n-1],a.push(f[t>>2]+f[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],a.push(f[t>>10]+f[t>>4&63]+f[t<<2&63]+"=")),a.join("")}t.byteLength=a,t.toByteArray=o,t.fromByteArray=u;for(var f=[],d=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=0,g=p.length;w<g;++w)f[w]=p[w],d[p.charCodeAt(w)]=w;d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},232:function(e,t){t.read=function(e,t,n,r,a){var i,o,s=8*a-r-1,c=(1<<s)-1,u=c>>1,f=-7,d=n?a-1:0,l=n?-1:1,p=e[t+d];for(d+=l,i=p&(1<<-f)-1,p>>=-f,f+=s;f>0;i=256*i+e[t+d],d+=l,f-=8);for(o=i&(1<<-f)-1,i>>=-f,f+=r;f>0;o=256*o+e[t+d],d+=l,f-=8);if(0===i)i=1-u;else{if(i===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),i-=u}return(p?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,a,i){var o,s,c,u=8*i-a-1,f=(1<<u)-1,d=f>>1,l=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,w=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=f):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),t+=o+d>=1?l/c:l*Math.pow(2,1-d),t*c>=2&&(o++,c/=2),o+d>=f?(s=0,o=f):o+d>=1?(s=(t*c-1)*Math.pow(2,a),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),o=0));a>=8;e[n+p]=255&s,p+=w,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;e[n+p]=255&o,p+=w,o/=256,u-=8);e[n+p-w]|=128*g}},374:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.syncCertificate=void 0;var a=n(145),i=r(a),o=n(3),s=r(o),c=n(1),u=r(c),f=n(2),d=r(f),l=coreLogger.getLogger("logic")("syncCertificate"),p="",w="",g="",h="",C="",v="",m="",S="",E=function(){var e=(0,d.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p=window.EXEC_PATH,w=window.EXEC_PATH+"/BfcpTLS",g=window.EXEC_PATH+"/BfcpTLS/server.pem",h=window.EXEC_PATH+"/BfcpTLS/server_key.pem",C=window.EXEC_PATH+"/kmc/p4bfcp.txt",window.fs&&(p=window.path.join(window.EXEC_PATH),w=window.path.join(window.EXEC_PATH,"BfcpTLS"),g=window.path.join(window.EXEC_PATH,"BfcpTLS","server.pem"),h=window.path.join(window.EXEC_PATH,"BfcpTLS","server_key.pem"),C=window.path.join(window.APP_DATA_PATH,"p4bfcp.txt")),"mac"===window.CLIENTCONFIG.PLATFORM&&(p=window.path.join(window.EXEC_PATH)),"win"===window.CLIENTCONFIG.PLATFORM&&(C=window.path.join(window.EXEC_PATH,"BfcpTLS","p4bfcp.txt")),v=window.APP_DATA_PATH+"/deviceCertificate_cacert.pem",m=window.APP_DATA_PATH+"/deviceCertificate.tar.gz",S=window.APP_DATA_PATH+"/deviceCertificate",window.fs&&(v=window.path.join(window.APP_DATA_PATH,"deviceCertificate_cacert.pem"),m=window.path.join(window.APP_DATA_PATH,"deviceCertificate.tar.gz"),S=window.path.join(window.APP_DATA_PATH,"deviceCertificate"));case 12:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.fs){e.next=7;break}if(fs.existsSync(t)){e.next=4;break}return l.info("failed to Read file: "+t),e.abrupt("return","");case 4:return e.abrupt("return",fs.readFileSync(t).toString());case 7:if("android"!==window.CLIENTCONFIG.PLATFORM){e.next=14;break}if(window.webView.isFileExist(t)){e.next=11;break}return l.info("failed to Read file: "+t),e.abrupt("return","");case 11:return e.abrupt("return",window.webView.readP4BFCP(t));case 14:if("ios"!==window.CLIENTCONFIG.PLATFORM){e.next=22;break}return n=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default(function(e){var n=function(t){e(t)},r=function(){e("")};window.cordova.exec(n,r,"OCJSBridge","readFile",[t])}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),e.next=18,n(t);case 18:return r=e.sent,e.abrupt("return",r);case 22:l.info("Unown Platform.");case 23:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),I=function(){var t=(0,d.default)(u.default.mark(function t(n){var r,a;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.fs){t.next=6;break}if(!fs.existsSync(n)){t.next=4;break}return r=fs.readFileSync(n),t.abrupt("return",new e(r).toString("base64"));case 4:t.next=19;break;case 6:if("android"!==window.CLIENTCONFIG.PLATFORM){t.next=10;break}return t.abrupt("return",window.webView.readBytesToBase64(n));case 10:if("ios"!==window.CLIENTCONFIG.PLATFORM){t.next=17;break}return a=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default(function(e){var n=function(t){e(t)},r=function(){e("")};window.cordova.exec(n,r,"OCJSBridge","readBytesToBase64",[t])}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.next=14,a(n);case 14:return t.abrupt("return",t.sent);case 17:return l.info("Unown PlatForm."),t.abrupt("return","");case 19:case"end":return t.stop()}},t,void 0)}));return function(e){return t.apply(this,arguments)}}(),T=function(){var e=(0,d.default)(u.default.mark(function e(t,n){var r,a,i,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.fs){e.next=4;break}try{fs.writeFileSync(t,n)}catch(e){l.error("failed to write file: "+t)}e.next=20;break;case 4:if("android"!==window.CLIENTCONFIG.PLATFORM){e.next=8;break}return e.abrupt("return",window.webView.writeStringToFile(t,n));case 8:if("ios"!==window.CLIENTCONFIG.PLATFORM){e.next=18;break}return r=t.lastIndexOf("/"),a=t.slice(0,r),i=t.slice(r+1),o=function(){var e=(0,d.default)(u.default.mark(function e(t,n,r){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default(function(e){var a=function(t){e(t)},i=function(){e("")};window.cordova.exec(a,i,"OCJSBridge","writeFile",[t,n,r])}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t,n,r){return e.apply(this,arguments)}}(),e.next=15,o(a,i,n);case 15:return e.abrupt("return",e.sent);case 18:return l.info("Unown Platform."),e.abrupt("return",null);case 20:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),P=function(){var e=(0,d.default)(u.default.mark(function e(t,n){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=T,e.t1=n,e.next=4,_(t);case 4:return e.t2=e.sent,e.next=7,(0,e.t0)(e.t1,e.t2);case 7:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=(0,d.default)(u.default.mark(function e(t,n){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=T,e.t1=n,e.next=4,_(t);case 4:return e.t2=e.sent,e.next=7,(0,e.t0)(e.t1,e.t2);case 7:return e.next=9,y(t);case 9:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,o,c,f,p,w,g,h;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.fs){e.next=28;break}if(!fs.existsSync(t)){e.next=27;break}if(!fs.lstatSync(t).isDirectory()){e.next=26;break}for(n=fs.readdirSync(t),r=!0,a=!1,o=void 0,e.prev=7,c=(0,i.default)(n);!(r=(f=c.next()).done);r=!0)p=f.value,w=window.path.join(t,p),fs.unlinkSync(w);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),a=!0,o=e.t0;case 15:e.prev=15,e.prev=16,!r&&c.return&&c.return();case 18:if(e.prev=18,!a){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:fs.rmdirSync(t),e.next=27;break;case 26:fs.unlinkSync(t);case 27:fs.mkdirSync(S);case 28:if("android"!==window.CLIENTCONFIG.PLATFORM){e.next=32;break}window.webView.makeNewDir(S),e.next=40;break;case 32:if("ios"!==window.CLIENTCONFIG.PLATFORM){e.next=40;break}return g=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default(function(e){var n=function(t){e(t)},r=function(){e([])};window.cordova.exec(n,r,"OCJSBridge","makeNewDir",[t])}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),e.next=36,g(S);case 36:if(h=e.sent){e.next=40;break}return l.info("failed to create directory."),e.abrupt("return");case 40:case"end":return e.stop()}},e,void 0,[[7,11,15,23],[16,,18,22]])}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.fs){e.next=4;break}fs.existsSync(t)&&(fs.lstatSync(t).isDirectory()?fs.rmdirSync(t):fs.unlinkSync(t)),e.next=17;break;case 4:if("android"!==window.CLIENTCONFIG.PLATFORM){e.next=8;break}return e.abrupt("return",window.webView.deleteFile(t));case 8:if("ios"!==window.CLIENTCONFIG.PLATFORM){e.next=16;break}return n=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default(function(e){var n=function(t){e(t)},r=function(){e("")};window.cordova.exec(n,r,"OCJSBridge","deleteFile",[t])}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),e.next=12,n(t);case 12:return r=e.sent,e.abrupt("return",r);case 16:l.info("Unown Platform.");case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,d.default)(u.default.mark(function e(t){var n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.fs){e.next=9;break}if(!fs.existsSync(t)){e.next=7;break}if(!fs.lstatSync(t).isDirectory()){e.next=6;break}return e.next=5,fs.readdirSync(t);case 5:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",null);case 7:e.next=18;break;case 9:if("android"!==window.CLIENTCONFIG.PLATFORM){e.next=13;break}return e.abrupt("return",JSON.parse(window.webView.getFileList(t)));case 13:if("ios"!==window.CLIENTCONFIG.PLATFORM){e.next=18;break}return n=function(){var e=(0,d.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default(function(e){var n=function(t){e(t)},r=function(){e([])};window.cordova.exec(n,r,"OCJSBridge","getFileList",[t])}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),e.next=17,n(t);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,i,o,s,c,f,d,l,p,w,g,h,C,v,m;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},r=t.length,a=0,i=512,o=i,s=100,c=8,f=8,d=8,l=12,p=4;case 11:if(!(a+p<r)){e.next=25;break}if(t.substr(a,p).replaceAll("\0","")){e.next=14;break}return e.abrupt("break",25);case 14:w=a,g=a+s+c+f+d,h=t.substr(w,s).replaceAll("\0",""),C=parseInt(t.substr(g,l),8),v=a+o,m=t.substr(v,+C),a=v+C,C%i&&(a+=i-C%i),n[h]=m,e.next=11;break;case 25:return e.abrupt("return",n);case 26:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,d.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l.info("Begin refreshBFCPP"),"ios"===window.CLIENTCONFIG.PLATFORM?window.readBfcpp(window.KMC_PATH+"/p4bfcp.txt"):"android"===window.CLIENTCONFIG.PLATFORM?window.bfcpp=window.webView.readP4BFCP(window.KMC_PATH+"/p4bfcp.txt"):(t=window.path.join(window.KMC_PATH,"p4bfcp.txt"),"win"===window.CLIENTCONFIG.PLATFORM&&(t=window.path.join(window.EXEC_PATH,"BfcpTLS","p4bfcp.txt")),fs.existsSync(t)?window.bfcpp=fs.readFileSync(t).toString():window.bfcpp=fs.readFileSync(window.path.join(window.EXEC_PATH,"p4bfcp.txt")).toString()),l.info("refreshBFCPP: succeed.");case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("Begin refreshBFCPForTLS"),t=parseInt(window.CLIENTCONFIG["Device.ComCfg.Media.BFCPMode"]),n=!1,t!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_TLS&&t!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_UDP||(n=!0),l.info("refreshBFCPForTLS: "+n),e.next=7,O();case 7:return e.next=9,coreAccount.configBFCPForTLS({bForceTLSMode:n});case 9:return r=e.sent,e.next=12,coreTup.getCallInstance().configBFCPTLSParam(r);case 12:l.info("refreshBFCPForTLS succeed.");case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),U=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a,o,s,c,f,d,E,_,I,T,x,A,O,U;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.info("Begin refreshDeviceCertificate"),t="password.txt",n="private"+$getState().login.account.toUpperCase()+".pem",r=$getState().login.account.toUpperCase()+".pem",a=S+"/"+r,o=S+"/"+n,s=S+"/"+t,window.fs&&(a=window.path.join(S,r),o=window.path.join(S,n),s=window.path.join(S,t)),"mac"!==window.CLIENTCONFIG.PLATFORM){e.next=17;break}return e.next=11,N(a,window.path.join(S,"server.pem"));case 11:return e.next=13,N(o,window.path.join(S,"server_key.pem"));case 13:return e.next=15,N(s,window.path.join(S,"p4bfcp.txt"));case 15:e.next=23;break;case 17:return e.next=19,N(a,g);case 19:return e.next=21,N(o,h);case 21:return e.next=23,N(s,C);case 23:return c=[],c="mac"===window.CLIENTCONFIG.PLATFORM?["server.pem","server_key.pem","p4bfcp.txt"]:[t,n,r],e.next=27,k(S);case 27:f=e.sent,d=!0,E=!1,_=void 0,e.prev=31,I=(0,i.default)(f);case 33:if(d=(T=I.next()).done){e.next=47;break}if(x=T.value,-1!==c.indexOf(x)){e.next=44;break}return A=window.fs?window.path.join(S,x):S+"/"+x,O=window.fs?window.path.join(p,x):p+"/"+x,U=window.fs?window.path.join(w,x):w+"/"+x,e.next=41,P(A,O);case 41:if("mac"===window.CLIENTCONFIG.PLATFORM){e.next=44;break}return e.next=44,N(A,U);case 44:d=!0,e.next=33;break;case 47:e.next=53;break;case 49:e.prev=49,e.t0=e.catch(31),E=!0,_=e.t0;case 53:e.prev=53,e.prev=54,!d&&I.return&&I.return();case 56:if(e.prev=56,!E){e.next=59;break}throw _;case 59:return e.finish(56);case 60:return e.finish(53);case 61:if("mac"===window.CLIENTCONFIG.PLATFORM){e.next=64;break}return e.next=64,y(S);case 64:return e.next=66,y(v);case 66:return e.next=68,y(m);case 68:return e.next=70,b();case 70:l.info("refreshDeviceCertificate: Refresh Device Certificate Succeed.");case 71:case"end":return e.stop()}},e,void 0,[[31,49,53,61],[54,,56,60]])}));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=S+"/private"+$getState().login.account.toUpperCase()+".pem",window.fs&&(t=window.path.join(S,"private"+$getState().login.account.toUpperCase()+".pem")),e.next=4,coreSecurity.getHWTupSupport();case 4:return n=e.sent,e.next=7,n.isPlainPrivatePem({privatePemPath:t});case 7:return r=e.sent,e.abrupt("return",r.param.isplaintext);case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a,i;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("begin isValidPrivateKey"),t=S+"/private"+$getState().login.account.toUpperCase()+".pem",n=S+"password.txt",window.fs&&(t=window.path.join(S,"private"+$getState().login.account.toUpperCase()+".pem"),n=window.path.join(S,"password.txt")),e.next=6,_(n);case 6:return r=e.sent,e.next=9,coreSecurity.getHWTupSupport();case 9:return a=e.sent,e.next=12,a.getinstance().isCipherValid({privatePemPath:t,password:r});case 12:return i=e.sent,e.abrupt("return",i.param.passwordvalid);case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a,i,o,s,c,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("begin encryptPrivatePemFile"),t="private"+$getState().login.account.toUpperCase()+".pem",n=S+"/"+t,r=S+"/password.txt",window.fs&&(n=window.path.join(S,t),r=window.path.join(S,"password.txt")),e.next=7,_(r);case 7:if(a=e.sent){e.next=13;break}return i=16,e.next=12,coreSecurity.getRealRandom(i);case 12:a=e.sent;case 13:return e.next=15,coreSecurity.getHWTupSupport();case 15:return o=e.sent,e.next=18,o.getinstance().encryptPrivateKey({privatePemPath:n,password:a,privateEncryptPemPath:n});case 18:if(s=e.sent,0===s.result){e.next=22;break}return l.info("failed to encrypt pem file."),e.abrupt("return");case 22:return e.next=24,coreSecurity.encryptKMC(a);case 24:return c=e.sent,f=c.param.CiperText,e.next=28,T(r,f);case 28:return e.next=30,U();case 30:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a,i,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("before encryptPrivatePem"),e.next=3,D();case 3:if(!(t=e.sent)){e.next=9;break}l.info("isPlainPem: true"),M(),e.next=31;break;case 9:return l.info("isPlainPem: false"),e.next=12,L();case 12:if(!(n=e.sent)){e.next=29;break}return l.info("isValid: true"),r=S+"/password.txt",window.fs&&(r=window.path.join(S,"password.txt")),e.next=19,_(r);case 19:return a=e.sent,e.next=22,coreSecurity.encryptKMC(a);case 22:return i=e.sent,o=i.param.CiperText,e.next=26,T(r,o);case 26:U(),e.next=31;break;case 29:return l.info("isValid: false"),e.abrupt("return");case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("begin unArchiveDeviceCertificate"),e.next=3,I(m);case 3:return t=e.sent,n=coreCommon.unZip(t),e.next=7,A(n);case 7:if(r=e.sent){e.next=11;break}return l.info("failed to resolve certificate package."),e.abrupt("return");case 11:return e.next=13,x(S);case 13:e.t0=u.default.keys(r);case 14:if((e.t1=e.t0()).done){e.next=20;break}return a=e.t1.value,e.next=18,T(S+"/"+a,r[a]);case 18:e.next=14;break;case 20:l.info("unArchiveDeviceCertificate: Done!"),R();case 22:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,d.default)(u.default.mark(function e(t,n,r,a){var i,o,s,c,f,d;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("begin syncDeviceCertificate"),i="https://"+t+":"+n+"/capf/equcertificate/"+$getState().login.account+".tar.gz",o=m,e.next=5,_(v);case 5:if(s=e.sent){e.next=9;break}return l.info("failed to read ca certificate file information."),e.abrupt("return");case 9:return s=s.replace(/\n/g,"").replace(/^.*-----BEGIN CERTIFICATE-----/,"").replace(/-----END CERTIFICATE-----$/,""),c="<root><sn>"+$getState().login.account+"</sn><factorycertificate>"+s+"</factorycertificate></root>",f={"Content-Type":"text/xml;"},d=function(e){0===e.param.ret&&200===e.param.rsp_body.rsp_code?(l.info("syncDeviceCertificate: succeed."),F()):0!==e.param.ret?l.info("syncDeviceCertificate failed(tup): "+e.param.ret):l.info("syncDeviceCertificate failed(http): "+e.param.rsp_body.rsp_code)},e.next=15,coreHttp.downloadFile({params:{url:i,filePath:o,body:c,header:f,userName:r,password:a},resultCallback:d});case 15:case"end":return e.stop()}},e,void 0)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),B=function(){var e=(0,d.default)(u.default.mark(function e(t,n,r,a){var i,o,s,c,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.info("begin syncCACertificate"),e.next=3,E();case 3:return i="https://"+t+":"+n+"/capf/rootcertificate/root.pem",o=v,s=null,c={},f=function(e){0===e.param.ret&&200===e.param.rsp_body.rsp_code?(l.info("syncCACertificate: succeed."),V(t,n,r,a)):0!==e.param.ret?l.info("syncCACertificate failed(tup): "+e.param.ret):l.info("syncCACertificate failed(http): "+e.param.rsp_body.rsp_code)},e.next=10,coreHttp.downloadFile({params:{url:i,filePath:o,body:s,header:c,userName:r,password:a},resultCallback:f});case 10:case"end":return e.stop()}},e,void 0)}));return function(t,n,r,a){return e.apply(this,arguments)}}();t.syncCertificate=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,i,o,s,c,f,d;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.some(function(e){return"Device.UICfg.cert.autoSyncCert"===e["ParameterValueStruct.Name"]&&("1"===e["ParameterValueStruct.Value"]?(l.info("begin syncCertificate"),!0):(l.info("No Need To Sync Certificate!"),!1))})){e.next=3;break}return e.abrupt("return");case 3:if(r=t.filter(function(e){return"Device.UICfg.cert.syncAddress"===e["ParameterValueStruct.Name"]}),a=r.length>0?r[0]["ParameterValueStruct.Value"]:"",i=t.filter(function(e){return"Device.UICfg.cert.syncPort"===e["ParameterValueStruct.Name"]}),o=i.length>0?i[0]["ParameterValueStruct.Value"]:0,s=t.filter(function(e){return"Device.UICfg.cert.syncName"===e["ParameterValueStruct.Name"]}),c=s.length>0?s[0]["ParameterValueStruct.Value"]:"",f=t.filter(function(e){return"Device.UICfg.cert.syncCode"===e["ParameterValueStruct.Name"]}),d=f.length>0?f[0]["ParameterValueStruct.Value"]:"",!(a&&o&&c&&d)){e.next=16;break}return e.next=14,B(a,o,c,d);case 14:e.next=17;break;case 16:l.info("syncCertificate: Invalid Sync Information!");case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()}).call(t,n(140).Buffer)},670:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getAllConfig=t.dealWithConfigNotify=t.compareVersion=t.clearCwmpParam=t.beginUploadLog=t.RequestSetEventInform=t.checkUpdateConfig=t.dealWithUICfgParam=t.dealUploadLogFailed=t.dealUploadLogSuccess=t.dealZipLogSuccess=t.sendMobileLogZipFiles=t.getComPressFileSize=t.initCwmpNotify=t.getHttpConnRandNum=t.send4ValueChange=t.getStunParam=t.getCPEParam=t.getStunEnable=t.getCPEEnable=t.clearUploadResultFunc=t.setUploadSuccessFunc=t.setUploadFailedFunc=void 0;var a=n(132),i=r(a),o=n(69),s=r(o),c=n(1),u=r(c),f=n(2),d=r(f),l=n(3),p=r(l),w=n(1110),g=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(w),n(865)),h=n(671),C=n(374),v=n(672),m=r(v),S=null,E=null,_=(t.setUploadFailedFunc=function(e){I.info("log upload: setUploadFailedFunc"),S=e},t.setUploadSuccessFunc=function(e){I.info("log upload: setUploadSuccessFunc"),E=e},t.clearUploadResultFunc=function(){I.info("log upload: clearUploadResultFunc"),S=null,E=null}),I=coreLogger.getLogger("logic")("cwmp/index"),T=window.CLIENTCONFIG,P=0,N=!1,x=new Array,y="",k="",A="",O="",b="",U="",D="",L="",M="",R=null,F=null,V="",B=function(e){return new p.default(function(t,n){t(e)})},G=function(){return new p.default(function(e,t){t()})},H=(t.getCPEEnable=function(){return""!==k&&0!==P?B():G()},t.getStunEnable=function(){return N?B():G()},t.getCPEParam=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreSecurity.getPasswordManager();case 2:return t=e.sent,e.next=5,t.getPassword("CPEPassword");case 5:return n=e.sent,r={CPEAuthType:0,CPEUsername:k,CPEPassword:n,LocalIp:window.cwmpLocalIp?window.cwmpLocalIp:"",ListenPort:T.ACS_HTTP_CONN_LISTEN_PORT,ReqConnPath:P+""},I.info("get CPE param success"),e.abrupt("return",r);case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getStunParam=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a,i,o,s,c,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreSecurity.getPasswordManager();case 2:return t=e.sent,e.next=5,t.getPassword("StunPassword");case 5:return n=e.sent,e.next=8,t.getPassword("CPEPassword");case 8:return r=e.sent,a=$getState().login.fireWallMode,I.info("the fireWallMode is: "+a),i=parseInt(O),o=parseInt(U),s=A,c=0,constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===a&&(c=1,""!==L&&""!==M&&(I.info("use stun over stg, port:",M),s=L,i=parseInt(M))),f={STUNDomain:s,STUNServerPort:i,STUNUserName:b,STUNPassWord:n,STUNListenPort:34758,STUNInterval:o,STUNSocketType:c,NatDetectedNodeName:"Device.ManagementServer.NATDetected",UdpConnAddrNodeName:"Device.ManagementServer.UDPConnectionRequestAddress",CPEUsername:k,CPEPassword:r,LocalIp:window.cwmpLocalIp?window.cwmpLocalIp:""},I.info("get STUN param success"),e.abrupt("return",f);case 19:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.send4ValueChange=function(e){var t=window.cwmpLocalIp?window.cwmpLocalIp:"";return y="http://"+t+":"+window.CLIENTCONFIG.ACS_HTTP_CONN_LISTEN_PORT+"/"+P,e.push({ParaName:window.CLIENTCONFIG.ACS_CONNECTIONREQUESTURL_NAME,ParaValue:y}),I.info("send 4 VALUE CHANGE"),we("4 VALUE CHANGE",1,1,e,e.length)},function(e,t){return Math.floor(e+Math.random()*(t-e))}),$=(t.getHttpConnRandNum=function(){var e=0;do{e=H(1e5,999999)}while(e===P);P=e},function(e){if($getState().login.isPortalUpgrade)return void I.info("notifyNewVersionResult : now is in portal upgrade");var t=e.param,n=t.SoftwareVersion;if(I.info("notify set SoftwareVersion & what's new,version=",n),window.isHubEnv&&"WeLink"===window.CLIENTCONFIG.NEW_APP_NAME||window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ENABLE_IT_MEETING||window.isPluginEnv)return void I.info("maxhub, bigwin ,conf_plugin or plugin   environment, return");if(n){var r=he(n);I.info("get higher version, should update software"),r&&setTimeout(function(){(0,h.getWhatsNewNotify)(t)},3e3)}}),W=function(e){var t=e.param;return $getState().login.isPortalUpgrade?(I.info("notifyUpgrade : now is in portal upgrade"),void(0,h.cancelDownload)(t.Magic)):(I.info("soft update：The software version is updated, start notify upgrade, result = ",(0,s.default)(t)),window.isHubEnv&&"WeLink"===window.CLIENTCONFIG.NEW_APP_NAME||window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ENABLE_IT_MEETING||window.isPluginEnv?void(0,h.cancelDownload)(t.Magic):void(0,h.updateFileDownloadNotify)(t.Magic,t.FileType))},K=function(e){if($getState().login.isPortalUpgrade)return void I.info("notifyDownloadProcessResult : now is in portal upgrade");(0,h.downloadProcessNotify)(e.param)},Y=function(e){if($getState().login.isPortalUpgrade)return void I.info("notifyFinishDownload : now is in portal upgrade");I.info("soft update：notify finish download, release version check, data = "+(0,s.default)(e.param)),(0,h.downloadResultNotify)(e.param)},q=function(e){I.info("notify set param value"),Ce(e.param)},z=function(e){I.info("notify save cmd[key], entry = "+(0,s.default)(e.entry)),se(e.entry)},X=function(e){I.info("notify get param value, params = "+(0,s.default)(e.param)+", magic = "+e.magic)},j=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,i,o,s;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.param.Magic,I.info("log upload: start notify upload log, magic = "+n),R&&clearTimeout(R),!$getState().cwmpInfo.isUserClickUpload){e.next=17;break}if(I.info("log upload: userClick upload flag is true"),""===V){e.next=9;break}ae(V,n),e.next=15;break;case 9:return I.info("log upload: No zip files exist, can not upload"),e.next=12,m.default.getinstance();case 12:return r=e.sent,e.next=15,r.tupSetUploadFileName("",n,0);case 15:e.next=29;break;case 17:if(!1!==(a=$getState().myInfo.isAutoCollectLogs)){e.next=28;break}return i=0,I.info("log upload: not allow the server to collect logs"),e.next=23,m.default.getinstance();case 23:return o=e.sent,e.next=26,o.tupSetUploadFileName("",n,i);case 26:e.next=29;break;case 28:window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv?(I.info("log upload: bigwin or maxhub auto allow the server to collect logs"),ne(n)):(s=$getState().myInfo.hasAllowCollectLogs,s?(I.info("log upload: user has allowed the server to collect logs"),ne(n)):coreCommon.confirmWindowWitTime("",""+language.ALLOW_SERVER_COLLECT_LOG,function(){ne(n),coreSetting.setHasAllowCollectLogsState(!0)},(0,d.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.default.getinstance();case 2:return t=e.sent,e.next=5,t.tupSetUploadFileName("",n,0);case 5:case"end":return e.stop()}},e,void 0)})),15e3));case 29:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,i;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.param,r=n.totalsize,a=n.uploadsize,i=parseInt(a/r*100),$dispatch(coreUi.changeFeedbackProcess(i));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Z=function(e){var t=e.param.result;I.info("log upload: log upload result param=",(0,s.default)(e.param)),$dispatch(coreUi.isServerCollecting(!1)),$getState().cwmpInfo.isUserClickUpload&&(I.info("log upload: userClick upload flag is true"),0===t?ie():oe(constant.LOG_UPLOAD_RESULT.FAILED)())},J=function(e){ee()},ee=(t.initCwmpNotify=function(){var e=(0,d.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.default.getinstance();case 2:return t=e.sent,t.setNotifyFunc(884737,q),t.setNotifyFunc(884738,z),t.setNotifyFunc(884739,Y),t.setNotifyFunc(884740,X),t.setNotifyFunc(884741,j),t.setNotifyFunc(884742,W),t.setNotifyFunc(884743,J),t.setNotifyFunc(884745,Z),t.setNotifyFunc(884746,K),t.setNotifyFunc(884747,$),t.setNotifyFunc(884748,Q),e.abrupt("return",B());case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(u.default.mark(function e(){var t,n,r,a,i,o,s;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=void 0,r=$getState(),a=r.login,i=a.account,o=a.real_user_account,n=isNullOrEmpty(o)?i:o,t.push({ParaName:"Device.LAN.IPAddress",ParaValue:window.cwmpLocalIp?window.cwmpLocalIp:""}),t.push({ParaName:"Device.DeviceInfo.SoftwareVersion",ParaValue:T.ACS_SOFTWAREVERSION_VALUE}),t.push({ParaName:"Device.DeviceInfo.UserAccountId",ParaValue:n}),t.push({ParaName:"Device.ManagementServer.ConnectionRequestURL",ParaValue:y}),e.next=10,m.default.getinstance();case 10:return s=e.sent,e.next=13,s.tupCwmpRequsetAddInformParam(t);case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),te=t.getComPressFileSize=function(e){return new p.default(function(t,n){var r="";window.fs?(r=window.fs.statSync(e).size,t({fileSize:r,filePath:e})):window.webView?(r=window.getFileSize(e),I.info("The is Android get comPress FileSize success, size="+r),t({fileSize:r,filePath:e})):window.getFileSize(e,function(n){I.info("The is IOS get comPress FileSize success, size="+n),t({fileSize:n,filePath:e})})})},ne=function(e){var t=this;I.info("log upload: Start to upload log to server, magic=",e),coreAccount.recordPrivacy({oprEvent:constant.OPR_EVENT_TYPE.LOG}),$dispatch(coreUi.isServerCollecting(!0)),coreLog.collectLogs({isOpen:!1}).then(function(t){ae(t,e)},(0,d.default)(u.default.mark(function n(){var r;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $dispatch(coreUi.isServerCollecting(!1)),t.next=3,m.default.getinstance();case 3:return r=t.sent,t.next=6,r.tupSetUploadFileName("",e,0);case 6:I.info("log upload: Compress logs failed.");case 7:case"end":return t.stop()}},n,t)})))},re=!1,ae=(t.sendMobileLogZipFiles=function(){if(I.info("userClick, Send logs: start to send log zip files."),window.Toast(language.LOG_COMPRESS_PROMPT),re)return void I.info("Send logs: last send log not end, not compress again.");re=!0,coreLog.collectLogCuts().then(function(e){if(window.webView){window.openAppListToSendFiles(language.LOG_REPORT_EMAIL_TITLE,e)?I.info("Send logs: Android open application list to send log files success."):(window.Toast(language.LOG_SEND_FAILED_PROMPT,2,!1),I.info("Send logs: Android open application list to send log files failed."))}else window.sendZipFiles(language.LOG_REPORT_EMAIL_TITLE,e,function(e){"0"!==e.toString()?"1"===e.toString()?coreCommon.showAlert(""+language.LOG_EMAIL_CONFIGURED_PROMPT):(window.Toast(language.LOG_SEND_FAILED_PROMPT,2,!1),I.info("Send logs: IOS send log files by email failed, result=",e)):I.info("Send logs: IOS send log files by email success")});re=!1},function(){window.Toast(language.LOG_SEND_FAILED_PROMPT,2,!1),re=!1,I.info("Send logs: compress log files failed.")})},function(e,t){var n=this;te(e).then(function(){var e=(0,d.default)(u.default.mark(function e(r){var a,i,o,s,c;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.default.getinstance();case 2:if(a=e.sent,i=r.fileSize,o=r.filePath,I.info("log upload: start upload, file size= "+i+"B"),!(1024*T.LOG_MAX_UPLOAD_SIZE*1024>i)){e.next=12;break}return s=1,I.info("log upload: start upload log request, magic="+t),e.next=10,a.tupSetUploadFileName(o,t,s);case 10:e.next=17;break;case 12:return I.info("log upload: file size beyond the limit, maximum file size= "+T.LOG_MAX_UPLOAD_SIZE+"M"),c=0,e.next=16,a.tupSetUploadFileName("",t,c);case 16:$getState().cwmpInfo.isUserClickUpload&&(I.info("log upload: userClick upload flag is true"),oe(constant.LOG_UPLOAD_RESULT.OVER_LIMIT)());case 17:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}())}),ie=(t.dealZipLogSuccess=function(e){I.info("log upload: compress log files success"),V=e,ge(),R&&clearTimeout(R),R=setTimeout(oe(constant.LOG_UPLOAD_RESULT.TIMEOUT),9e4)},t.dealUploadLogSuccess=function(){I.info("log upload: dealUploadLogSuccess start"),$dispatch(coreUi.IsUserClickUpload(!1)),E?(I.info("log upload: _uploadSuccessFunc start"),E(),_()):window.ToastNew(language.LOG_UPLOAD_SUCCESS_PROMPT,2)}),oe=t.dealUploadLogFailed=function(e){return function(){I.info("log upload: dealUploadLogFailed start, reason=",e),$dispatch(coreUi.IsUserClickUpload(!1)),S?(I.info("log upload: _uploadFailedFunc start"),S(e),_()):window.ToastNew(language.LOG_UPLOAD_FAILED_PROMPT,2)}},se=function(e){I.info("save cmdKey from server.");var t=(0,s.default)(e),n={key:"cmdkey",value:t};return coreDb.saveUserConfig(n)},ce=t.dealWithUICfgParam=function(e,t){if(e.indexOf("Device.UICfg.cert.sync")?I.info("set ui config, name="+e+", value=",t):I.info("set ui config, name="+e),"Device.UICfg.IM.mutiLanguage"===e)window.mutiLanguage=t;else if("Device.UICfg.IM.enableISH"===e)$dispatch(coreUi.changeSecurityHintsShow(t));else if("Device.UICfg.IM.chineseISH"===e)$dispatch(coreUi.changeSecurityHintsChinese(t));else if("Device.UICfg.IM.setFont"===e)$dispatch(coreUi.changeImSetFontEnable(t));else if("Device.UICfg.IM.stgDisableSendFile"===e)$dispatch(coreUi.changeStgDisableSendFile("1"===t));else if("Device.UICfg.IM.englishISH"===e)$dispatch(coreUi.changeSecurityHintsEnglish(t));else if("Device.UICfg.Conf.Coordination"===e)$dispatch(coreUi.changeShowPiar(parseInt(t)));else if(0===e.indexOf("Device.UICfg.Call.ConfRefreshTime"))window.confRefreshTime=t;else if(0===e.indexOf("Device.UICfg.Call.isMultiStream"))window.isMultiStream=t,I.info("dealWithUICfgParam isMultiStream: "+window.isMultiStream);else if("Device.UICfg.Conf.EnableDocShare"===e)window.enableDocShare=t;else if(0===e.indexOf("Device.UICfg.FunctionConfig.PersonalManagementPlatform")){if(!window.CLIENTCONFIG.ISMOBILE){var n=parseInt(t);$getState().displayInfo.showPersonalManagement!==n&&($dispatch(coreUi.changeShowPersonalManagement(n)),appService.initMainTray())}}else if(0===e.indexOf("Device.UICfg.FunctionConfig.ChineseHelpUrl")){var r=t;$getState().displayInfo.chineseHelpUrl!==r&&$dispatch(coreUi.changeChineseHelpUrl(r))}else if(0===e.indexOf("Device.UICfg.FunctionConfig.OtherLanguagesHelpUrl")){var a=t;$getState().displayInfo.otherLanguagesHelpUrl!==a&&$dispatch(coreUi.changeOtherLanguagesHelpUrl(a))}else if(0===e.indexOf("Device.UICfg.Conf.TransferChairman"))"1"===t?$dispatch(coreUi.toggleTransferChairman(!0)):$dispatch(coreUi.toggleTransferChairman(!1));else if(0===e.indexOf("Device.UICfg.Conf.CreateMeetingPassword"))I.info("esight config createMeetingPOption(0 NO 1 YES 2 DIS):"+t),"1"===t?($dispatch(coreUi.changeCreateMeetingPassword(!0)),$dispatch(coreUi.changeCreateMeetingPasswordDefault(!0))):"0"===t?($dispatch(coreUi.changeCreateMeetingPassword(!1)),$dispatch(coreUi.changeCreateMeetingPasswordDefault(!1))):($dispatch(coreUi.changeCreateMeetingPasswordOption(!1)),$dispatch(coreUi.changeCreateMeetingPassword(!0)),$dispatch(coreUi.changeCreateMeetingPasswordDefault(!0)));else if("Device.UICfg.PC.CTD.callback.flag"===e)(window.CLIENTCONFIG.ISWIN||"mac"===window.CLIENTCONFIG.PLATFORM)&&("1"===t?$dispatch(coreUi.changeCTDcallbackToPC(!0)):$dispatch(coreUi.changeCTDcallbackToPC(!1)));else if(0===e.indexOf("Device.UICfg.FunctionConfig.enableCHRColPro"))$dispatch(coreUi.changeShowChrCollectPrompt(parseInt(t)));else if(0===e.indexOf("Device.UICfg.Conf.BoardQRMode")){var i=parseInt(t);$getState().synergismInfo.QRMode!==i&&($dispatch(coreUi.changeQRMode(parseInt(t))),coreConf.requestPairCode())}else 0===e.indexOf("Device.UICfg.Conf.BoardQRScheme")?$dispatch(coreUi.changeQRScheme(t)):"Device.UICfg.IM.enableMDXSelfContact"===e?$dispatch(coreUi.changeImMDXSelfContactEnable(t)):"Device.ComCfg.IM.groupNumberLimit"===e?$dispatch(coreUi.setGroupNumberLimit(t)):"Device.ComCfg.Conf.meetingNumberLimit"===e&&$dispatch(coreUi.setMeetingNumberLimit(t))},ue=function(){var e=(0,d.default)(u.default.mark(function e(t,n,r){var a,i,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==T.ACS_PERIODICINFORMINTERVAL_NAME||n===T.ACS_PERIODICINFORMINTERVAL_VALUE.toString()){e.next=9;break}return e.next=3,m.default.getinstance();case 3:return a=e.sent,e.next=6,a.tupCwmpSetPeriodic(n);case 6:I.info("get tr069 heart interval config from esight, name="+t+", value="+n),e.next=61;break;case 9:if(t!==T.ACS_CONNECTIONREQUESTUSERNAME_NAME||n===T.ACS_CONNECTIONREQUESTUSERNAME_VALUE){e.next=16;break}r.isCPEParamChanged=!0,k=n,r.paraCPE.push({ParaName:t,ParaValue:n}),I.info("get cpe config from esight, name="+t+", value length="+n.length),e.next=61;break;case 16:if(t!==T.ACS_CONNECTIONREQUESTPASSWORD_NAME||n===T.ACS_CONNECTIONREQUESTPASSWORD_VALUE){e.next=27;break}return r.isCPEParamChanged=!0,e.next=20,coreSecurity.getPasswordManager();case 20:return i=e.sent,e.next=23,i.setPassword("CPEPassword",n);case 23:r.paraCPE.push({ParaName:t,ParaValue:n}),I.info("get cpe config from esight, name="+t+", value length="+n.length),e.next=61;break;case 27:if(t!==T.ACS_CONNECTIONSTUN_ENABLE){e.next=32;break}N="1"===n,I.info("get stun config from esight, name="+t+", value="+n),e.next=61;break;case 32:if(t!==T.ACS_CONNECTIONSTUNSERVER_ADDRESS_NAME||n===T.ACS_CONNECTIONSTUNSERVER_ADDRESS_VALUE){e.next=38;break}r.isSTUNParamChanged=!0,A=n,I.info("get stun config from esight, name="+t+", value length="+n.length),e.next=61;break;case 38:if(t!==T.ACS_CONNECTIONSTUNSERVER_PORT_NAME||n===T.ACS_CONNECTIONSTUNSERVER_PORT_VALUE){e.next=44;break}r.isSTUNParamChanged=!0,O=n,I.info("get stun config from esight, name="+t+", value length="+n.length),e.next=61;break;case 44:if(t!==T.ACS_CONNECTIONSTUNUSERNAME_NAME||n===T.ACS_CONNECTIONSTUNUSERNAME_VALUE){e.next=50;break}r.isSTUNParamChanged=!0,b=n,I.info("get stun config from esight, name="+t+", value length="+n.length),e.next=61;break;case 50:if(t!==T.ACS_CONNECTIONSTUNPASSWORD_NAME||n===T.ACS_CONNECTIONSTUNPASSWORD_VALUE){e.next=60;break}return r.isSTUNParamChanged=!0,e.next=54,coreSecurity.getPasswordManager();case 54:return o=e.sent,e.next=57,o.setPassword("StunPassword",n);case 57:I.info("get stun config from esight, name="+t+", value length="+n.length),e.next=61;break;case 60:t===T.ACS_CONNECTIONSTUN_MIN_ALIVEPERIOD_NAME&&n!==T.ACS_CONNECTIONSTUN_MIN_ALIVEPERIOD_VALUE?(r.isSTUNParamChanged=!0,U=n,I.info("get stun config from esight, name="+t+", value="+n)):t===T.ACS_CONNECTIONSTUN_MAX_ALIVEPERIOD_NAME&&n!==T.ACS_CONNECTIONSTUN_MAX_ALIVEPERIOD_VALUE?(r.isSTUNParamChanged=!0,D=n,I.info("get stun config from esight, name="+t+", value="+n)):t===T.ACS_CONNECTIONSTUN_STG_SERVER_ADDRESS_NAME&&n!==T.ACS_CONNECTIONSTUN_STG_SERVER_ADDRESS_VALUE?(r.isSTUNParamChanged=!0,L=n,I.info("get stun config from esight, name="+t+", value length="+n.length)):t===T.ACS_CONNECTIONSTUN_STG_SERVER_PORT_NAME&&n!==T.ACS_CONNECTIONSTUN_STG_SERVER_PORT_VALUE&&(r.isSTUNParamChanged=!0,M=n,I.info("get stun config from esight, name="+t+", value length="+n.length));case 61:return e.abrupt("return",r);case 62:case"end":return e.stop()}},e,void 0)}));return function(t,n,r){return e.apply(this,arguments)}}(),fe=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,i,o,c,f,d,l,p,w,g,h,v,m,S,E,_,P,N,y,k,A,O,b,U,D,L,M,R,F;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreAccount.getLoginModel();case 2:if(n=e.sent,r=n.isSupportAS,window.isHubEnv||!r||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=7;break}return I.info("not BIGWIN or HubEnv , not run cwmp config "),e.abrupt("return");case 7:return I.info("get esight setting params data length="+t.length),a=null,i={},e.next=12,coreTup.getCallInstance();case 12:o=e.sent,c={isSTUNParamChanged:!1,isCPEParamChanged:!1,paraCPE:[]},f=new Array,x.splice(0,x.length),$dispatch(coreUi.clearSvcConfEsightResolutionConfig()),d=0;case 18:if(!(d<t.length)){e.next=110;break}if(l=t[d]["ParameterValueStruct.Name"],p=t[d]["ParameterValueStruct.Value"],0!==l.indexOf("Device.ComCfg.Conf.Svc")){e.next=60;break}if(""!==p){e.next=24;break}return e.abrupt("continue",107);case 24:if(l!==T.SVC_Mobile_Conf_HdDecoder){e.next=32;break}if(window.isConfHardCode=p,I.info("get ui config from esight is hard code:"+window.isConfHardCode),!window.CLIENTCONFIG.ISMOBILE){e.next=32;break}return w=coreAccount.initVideoHardCodeParam(),e.next=31,o.configCallHardCodeParam(w);case 31:"android"===window.CLIENTCONFIG.PLATFORM&&(g=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,I.info("android hard decoder enter 0",g),window.isHardDecodeToNative(g));case 32:if(l===T.SVC_AUTOMATIC_ACCEPT_VIDEO_CONF&&I.info("bAutomaticAcceptVideoConf= ",p),l===T.SVC_START_SHARE_BFCP&&(I.info("SVC_START_SHARE_BFCP = ",p),$dispatch(coreUi.changeSwitchShareBfcp(!1))),"Device.ComCfg.Conf.Svc.IsEnableExperieceConf"===l&&(I.info("ENABLE_EXPERIENCE_CONF = "+p),"1"===p?$dispatch(coreUi.changeIsEnableExperienceVedioConf(!0)):$dispatch(coreUi.changeIsEnableExperienceVedioConf(!1))),"Device.ComCfg.Conf.Svc.Conf.ExperienceConfID"===l&&(I.info("EXPERIENCE CONF ID = "+p),$dispatch(coreUi.changeExperienceVedioConfId(p))),"Device.ComCfg.Conf.Svc.Conf.ExperienceConfTimes"===l&&(I.info("EXPERIENCE CONF TIMES = "+p),$dispatch(coreUi.changeExperienceShowTimes(parseInt(p)))),l===T.ENABLE_HISTORY_CONF_LIST&&(I.info("ENABLE_HISTORY_CONF_LIST = ",p),"1"===p?$dispatch(coreUi.changeIsEnableHistoryConfList(!0)):$dispatch(coreUi.changeIsEnableHistoryConfList(!1))),l!==T.SVC_CONF_HME_LOG_SIZE_MB){e.next=46;break}return window.hmeLogSizeMb=parseInt(p),e.next=42,coreAccount.configHMELog();case 42:return h=e.sent,I.info("eSight set configHmeInfo=",h),e.next=46,o.setHMELog(h);case 46:l===T.SVC_DESKTOP_MAX_ENCODE&&(v=parseInt(p),$dispatch(coreUi.changeSvcDesktopMaxEncode(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[v])),m=$getState().conf.svcDesktopMaxEncode,I.info("Svc_Esight_Config get SVC_DESKTOP_MAX_ENCODE esight setting params= ",m)),l===T.SVC_DESKTOP_SPEAKER_BIG_MAX_LOOK&&(S=parseInt(p),$dispatch(coreUi.changeSvcDesktopSpeakerBigMaxLook(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[S])),I.info("Svc_Esight_Config get SVC_DESKTOP_SPEAKER_BIG_MAX_LOOK esight setting params= ",$getState().conf.svcDesktopSpeakerBigMaxLook)),l===T.SVC_DESKTOP_SPEAKER_SMALL_MAX_LOOK&&(E=parseInt(p),$dispatch(coreUi.changeSvcDesktopSpeakerModeSmallMaxLook(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[E])),I.info("Svc_Esight_Config get SVC_DESKTOP_SPEAKER_SMALL_MAX_LOOK esight setting params= ",$getState().conf.svcDesktopSpeakerModeSmallMaxLook)),l===T.SVC_DESKTOP_DIVIDEMODE_MAX_LOOK_2_6&&(_=parseInt(p),$dispatch(coreUi.changeSvcDesktopDivideModeMaxLook2_6(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[_])),I.info("Svc_Esight_Config get SVC_DESKTOP_DIVIDEMODE_MAX_LOOK_2_6vesight setting params= ",$getState().conf.svcDesktopDivideModeMaxLook2_6)),l===T.SVC_DESKTOP_DIVIDEMODE_MAX_LOOK_7_16&&(P=parseInt(p),$dispatch(coreUi.changeSvcDesktopDivideModeMaxLook7_16(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[P])),I.info("Svc_Esight_Config get SVC_DESKTOP_DIVIDEMODE_MAX_LOOK_7_16 esight setting params= ",$getState().conf.svcDesktopDivideModeMaxLook7_16)),l===T.SVC_DESKTOP_DIVIDEMODE_MAX_LOOK_17_24&&(N=parseInt(p),$dispatch(coreUi.changeSvcDesktopDivideModeMaxLook17_24(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[N])),I.info("Svc_Esight_Config get SVC_DESKTOP_DIVIDEMODE_MAX_LOOK_17_24 esight setting params= ",$getState().conf.svcDesktopDivideModeMaxLook17_24)),l===T.SVC_MOBILE_SOFT_ENCODE&&(y=parseInt(p),$dispatch(coreUi.changeSvcMobileMaxSoftEncode(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[y])),I.info("Svc_Esight_Config get SVC_MOBILE_SOFT_ENCODE esight setting params= ",$getState().conf.svcMobileMaxSoftEncode)),l===T.SVC_MOBILE_HARD_ENCODE&&(k=parseInt(p),$dispatch(coreUi.changeSvcMobileMaxHardEncode(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[k])),I.info("Svc_Esight_Config get SVC_MOBILE_HARD_ENCODE esight setting params= ",$getState().conf.svcMobileMaxHardEncode)),l===T.SVC_MOBILE_SPEAKERMODE_MAX_LOOK&&(A=parseInt(p),$dispatch(coreUi.changeSvcMobileSpeakerModeMaxLook(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[A])),I.info("Svc_Esight_Config get SVC_MOBILE_SPEAKERMODE_MAX_LOOK esight setting params= ",$getState().conf.svcMobileSpeakerModeMaxLook)),l===T.SVC_MOBILE_DIVIDEMODE_MAX_LOOK&&(O=parseInt(p),$dispatch(coreUi.changeSvcMobileDivideModeMaxLook(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[O])),I.info("Svc_Esight_Config get SVC_MOBILE_DIVIDEMODE_MAX_LOOK esight setting params= ",$getState().conf.svcMobileDivideModeMaxLook)),l===T.SVC_HIGHPERFORMANCE_MOBILE_SPEAKERMODE_MAX_LOOK&&(b=parseInt(p),$dispatch(coreUi.changeSvcHighPerformanceMobileSpeakerModeMaxLook(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[b])),I.info("Svc_Esight_Config get SVC_HIGHPERFORMANCE_MOBILE_SPEAKERMODE_MAX_LOOK esight setting params= ",$getState().conf.svcHighPerformanceMobileSpeakerModeMaxLook)),l===T.SVC_HIGHPERFORMANCE_MOBILE_DIVIDEMODE_MAX_LOOK&&(U=parseInt(p),$dispatch(coreUi.changeSvcHighPerformanceMobileDivideModeMaxLook(constant.SVC_ENCODE_DECODE_RESOLUTION_ESIGHT_CONFIG[U])),I.info("Svc_Esight_Config get SVC_HIGHPERFORMANCE_MOBILE_DIVIDEMODE_MAX_LOOK esight setting params= ",$getState().conf.svcHighPerformanceMobileDivideModeMaxLook)),e.next=107;break;case 60:if(0!==l.indexOf("Device.ComCfg")){e.next=78;break}if(""!==p){e.next=63;break}return e.abrupt("continue",107);case 63:if(0===l.indexOf("Device.ComCfg.CHR.CHRPas")){e.next=69;break}a={key:l,value:p},i[l]=p,x.push(a),e.next=76;break;case 69:return e.next=71,coreSecurity.getPasswordManager();case 71:return D=e.sent,e.next=74,D.setPassword("CHRPassword",p);case 74:L=e.sent,L&&L.salt&&L.cipher&&(p={salt:L.salt,cipher:L.cipher},a={key:"CHRPassword",value:(0,s.default)(p)},coreDb.saveUserConfig(a));case 76:e.next=107;break;case 78:if(0!==l.indexOf("Device.UICfg")){e.next=104;break}if(0!==l.indexOf("Device.UICfg.Conf.ExperienceConferenceID")){e.next=98;break}if(M=coreConf.getExperienceConferenceInfo(p),I.info("ExperienceConferenceID confId: ",M.confId),isNullOrEmpty(M.confPwd)){e.next=92;break}return e.next=85,coreSecurity.getPasswordManager();case 85:return R=e.sent,e.next=88,R.setPassword("experienceConfPwd",M.confPwd);case 88:F=e.sent,F&&F.salt&&F.cipher&&(p={salt:F.salt,cipher:F.cipher,confid:M.confId},a={key:"experienceConfInfo",value:(0,s.default)(p)},coreDb.saveUserConfig(a)),e.next=95;break;case 92:p={salt:"",cipher:"",confid:M.confId},a={key:"experienceConfInfo",value:(0,s.default)(p)},coreDb.saveUserConfig(a);case 95:$dispatch(coreUi.changeExperienceConfId(M.confId)),e.next=102;break;case 98:a={key:l,value:p},f.push(a),ce(l,p),window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv||0===l.indexOf("Device.UICfg.FunctionConfig.enableCHRColPro")&&coreSetting.initChrUpload();case 102:e.next=107;break;case 104:return e.next=106,ue(l,p,c);case 106:c=e.sent;case 107:d++,e.next=18;break;case 110:return e.next=112,de(i);case 112:return e.next=114,le(c.isCPEParamChanged,c.isSTUNParamChanged,c.paraCPE);case 114:if(!(f.length>0)){e.next=118;break}return I.info("save ui config to database"),e.next=118,coreDb.saveUserConfigList(f);case 118:return e.next=120,(0,C.syncCertificate)(t);case 120:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("the configParam length is: "+x.length),!(x.length>0)){e.next=18;break}return e.next=4,coreAccount.getLoginModel();case 4:return n=e.sent,coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_ESIGHT_SERVER,resultParams:[1,n.isResume?1:0],isTrackTimeCosts:!0}),e.next=8,coreDb.saveUserConfigList(x);case 8:if(r=$getState().call.callStatus,!(a=!("VIDEO_CONNECTED"===r||"VIDEO_OUT"===r||"CALL_OUT"===r||"CALL_CONNECTED"===r))){e.next=15;break}return e.next=13,pe(x);case 13:e.next=17;break;case 15:I.info("start calling status."),$dispatch(coreUi.isWaitUpdateConfigTUP(!0));case 17:(0,i.default)(window.CLIENTCONFIG,t);case 18:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=(0,d.default)(u.default.mark(function e(t,n,r){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("isCPEParamChanged is: "+t+", isSTUNParamChanged is:"+n),!t){e.next=4;break}return(0,g.startStunAndCPEService)(r).then(function(){},function(){}),e.abrupt("return");case 4:n&&(0,g.startStunService)().then(function(){},function(){});case 5:case"end":return e.stop()}},e,void 0)}));return function(t,n,r){return e.apply(this,arguments)}}(),pe=(t.checkUpdateConfig=function(){var e=(0,d.default)(u.default.mark(function e(){var t,n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),!(n=t.cwmpInfo.isWaitUpdateConfigTUP)){e.next=7;break}return I.info("The call callEnded is start update config to tup"),$dispatch(coreUi.isWaitUpdateConfigTUP(!1)),e.next=7,pe(x);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(u.default.mark(function e(t){var n,r,a,o,c,f,d,l,p,w,g,h,C,v,m,S,E,_,T,P,N,x,y,k,A,O,b,U,D,L,M,R,F,V,B;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.isWaitUpdateConfigTUP(!1)),n=window.CLIENTCONFIG,r={media:{}},a={esightChrEnable:0,esightChrPer:300,esightChrColPer:60},o=!1,c=0,f=0,d=0,l=0,p=0,w="",g=-1,h=-1,C=-1,v=-1,m=-1,S=-1,E=-1,_=-1,T="",P="",e.next=11,coreTup.getCallInstance();case 11:N=e.sent,x=0;case 13:if(!(x<t.length)){e.next=154;break}if(0!==t[x].key.indexOf("Device.ComCfg.Media.")||""===t[x].value){e.next=150;break}if(n.hasOwnProperty(t[x].key)&&t[x].value===n[t[x].key]){e.next=148;break}if(w=t[x].value,"Device.ComCfg.Media.DataArq"!==t[x].key){e.next=21;break}N.config({media:{data_arq:parseInt(w)}}),e.next=148;break;case 21:if("Device.ComCfg.Media.DataHarq"!==t[x].key){e.next=25;break}N.config({media:{data_harq:parseInt(w)}}),e.next=148;break;case 25:if("Device.ComCfg.Media.VideoArq"!==t[x].key){e.next=29;break}N.config({media:{video_arq:parseInt(w)}}),e.next=148;break;case 29:if("Device.ComCfg.Media.VideoHarq"!==t[x].key){e.next=33;break}N.config({media:{video_harq:parseInt(w)}}),e.next=148;break;case 33:if("Device.ComCfg.Media.EcPktInRtp"!==t[x].key){e.next=37;break}N.config({media:{ec_pkt_in_rtp:parseInt(w)}}),e.next=148;break;case 37:if("Device.ComCfg.Media.VideoNetRat"!==t[x].key){e.next=41;break}N.config({media:{net_lossrate:parseInt(w)}}),e.next=148;break;case 41:if("Device.ComCfg.Media.VideoKeyFrameIntervalNetRat"!==t[x].key){e.next=45;break}N.config({media:{keyframe_interval:parseInt(w)}}),e.next=148;break;case 45:if("Device.ComCfg.Media.TmmbrControl"!==t[x].key){e.next=49;break}N.config({media:{fluid_control:parseInt(w)}}),e.next=148;break;case 49:if("Device.ComCfg.Media.VideoARS"!==t[x].key){e.next=53;break}N.config({media:{video_ars:{ars:parseInt(w)}}}),e.next=148;break;case 53:if("Device.ComCfg.Media.VideoARSFrameSize"!==t[x].key){e.next=57;break}N.config({media:{video_ars:{ars_ctrl_framesize:parseInt(w)}}}),e.next=148;break;case 57:if("Device.ComCfg.Media.VideoARSFrameRate"!==t[x].key){e.next=61;break}N.config({media:{video_ars:{ars_ctrl_framerate:parseInt(w)}}}),e.next=148;break;case 61:if("Device.ComCfg.Media.VideoARSBitRate"!==t[x].key){e.next=65;break}N.config({media:{video_ars:{ars_ctrl_bitrate:parseInt(w)}}}),e.next=148;break;case 65:if("Device.ComCfg.Media.VideoArsFec"!==t[x].key){e.next=69;break}N.config({media:{video_ars:{ars_ctrl_fec:parseInt(w)}}}),e.next=148;break;case 69:if("Device.ComCfg.Media.VideoShaping"!==t[x].key){e.next=73;break}N.config({media:{video_ars:{ars_data_shaping:parseInt(w)}}}),e.next=148;break;case 73:if("Device.ComCfg.Media.DataARS"!==t[x].key){e.next=77;break}N.config({media:{data_ars:{ars:parseInt(w)}}}),e.next=148;break;case 77:if("Device.ComCfg.Media.DataARSFrameSize"!==t[x].key){e.next=81;break}N.config({media:{data_ars:{ars_ctrl_framesize:parseInt(w)}}}),e.next=148;break;case 81:if("Device.ComCfg.Media.DataARSFrameRate"!==t[x].key){e.next=85;break}N.config({media:{data_ars:{ars_ctrl_framerate:parseInt(w)}}}),e.next=148;break;case 85:if("Device.ComCfg.Media.DataARSBitRate"!==t[x].key){e.next=89;break}N.config({media:{data_ars:{ars_ctrl_bitrate:parseInt(w)}}}),e.next=148;break;case 89:if("Device.ComCfg.Media.DataArsFec"!==t[x].key){e.next=93;break}N.config({media:{data_ars:{ars_ctrl_fec:parseInt(w)}}}),e.next=148;break;case 93:if("Device.ComCfg.Media.DataShaping"!==t[x].key){e.next=97;break}N.config({media:{data_ars:{ars_data_shaping:parseInt(w)}}}),e.next=148;break;case 97:if("Device.ComCfg.Media.BfcpKeepaliveTime"!==t[x].key){e.next=101;break}N.config({call:{bfcp_keepalive_time:parseInt(w)}}),e.next=148;break;case 101:if("Device.ComCfg.Media.TotalBandwidth"!==t[x].key){e.next=107;break}f=parseInt(w),n["Device.ComCfg.Media.TotalBandwidth"]=f+"",I.info("Device.ComCfg.Media.TotalBandwidth is",f),e.next=148;break;case 107:if("Device.ComCfg.Media.Mobile.WifiSoftCodedTotalBandwidth"!==t[x].key){e.next=113;break}p=parseInt(w),n["Device.ComCfg.Media.Mobile.WifiSoftCodedTotalBandwidth"]=p+"",I.info("Device.ComCfg.Media.Mobile.WifiSoftCodedTotalBandwidth is",p),e.next=148;break;case 113:if("Device.ComCfg.Media.Mobile.4GTotalBandwidth"!==t[x].key){e.next=119;break}l=parseInt(w),n["Device.ComCfg.Media.Mobile.4GTotalBandwidth"]=l+"",I.info("Device.ComCfg.Media.Mobile.4GTotalBandwidth is",l),e.next=148;break;case 119:if("Device.ComCfg.Media.Mobile.3GTotalBandwidth"!==t[x].key){e.next=125;break}d=parseInt(w),n["Device.ComCfg.Media.Mobile.3GTotalBandwidth"]=d+"",I.info("Device.ComCfg.Media.Mobile.3GTotalBandwidth is",d),e.next=148;break;case 125:if("Device.ComCfg.Media.BFCPMode"!==t[x].key){e.next=138;break}return I.info("esight bfcp trans_mode: "+parseInt(w)),n["Device.ComCfg.Media.BFCPMode"]=w,y={media:{bfcp_param:{floor_ctrl:3,setup:3,trans_type:2===parseInt(w)?1:parseInt(w)}}},N.config(y),k=!1,parseInt(w)!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_TLS&&parseInt(w)!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_UDP||(k=!0),e.next=134,coreAccount.configBFCPForTLS({bForceTLSMode:k});case 134:A=e.sent,N.configBFCPTLSParam(A),e.next=148;break;case 138:if("Device.ComCfg.Media.priorityRtp"!==t[x].key){e.next=147;break}return n["Device.ComCfg.Media.priorityRtp"]=w,e.next=142,coreAccount.configRTP();case 142:return O=e.sent,e.next=145,N.config(O);case 145:e.next=148;break;case 147:"Device.ComCfg.Media.EncryptCalloutUseMKI"===t[x].key&&N.config({media:{srtp_mki:parseInt(w)}});case 148:e.next=151;break;case 150:0===t[x].key.indexOf("Device.ComCfg.Sip")?"Device.ComCfg.Sip.LocalPort"===t[x].key?v=parseInt(t[x].value):"Device.ComCfg.Sip.enableSessionTimer"===t[x].key?m=parseInt(t[x].value):"Device.ComCfg.Sip.SessionTime"===t[x].key?S=parseInt(t[x].value):"Device.ComCfg.Sip.sipKeepaliveTime"===t[x].key?(I.info("esight Device.ComCfg.Sip.sipKeepaliveTime = "+parseInt(t[x].value)),N.config({call:{sip_keepalive_time:parseInt(t[x].value)}})):"Device.ComCfg.Sip.RegistExpires"===t[x].key&&(I.info("esight Device.ComCfg.Sip.RegistExpires = "+parseInt(t[x].value)),N.config({call:{regist_timeout:parseInt(t[x].value)}})):0===t[x].key.indexOf("Device.ComCfg.CHR.")?(o=!0,w=t[x].value,"Device.ComCfg.CHR.enableCHR"===t[x].key?a.esightChrEnable="TRUE"===w?1:0:"Device.ComCfg.CHR.CHRPer"===t[x].key?a.esightChrPer=parseInt(w):"Device.ComCfg.CHR.CHRColPer"===t[x].key&&(a.esightChrColPer=parseInt(w))):0===t[x].key.indexOf("Device.ComCfg.Service.")&&("Device.ComCfg.Service.pointPickupActive"===t[x].key?T=t[x].value:"Device.ComCfg.Service.groupPickupActive"===t[x].key&&(P=t[x].value));case 151:x++,e.next=13;break;case 154:if(!o){e.next=161;break}return I.info("get CHR server config, esightChrConfig=",(0,s.default)(a)),e.next=158,coreSetting.packageChrConfigValue(a.esightChrEnable,a.esightChrPer,a.esightChrColPer);case 158:return b=e.sent,e.next=161,N.config(b);case 161:if(0===f&&0===d&&0===l&&0===p){e.next=174;break}return U={},e.next=165,coreAccount.initVideoSettingParam();case 165:return U.media=e.sent,e.next=168,N.config(U);case 168:return e.next=170,coreAccount.configBFCP();case 170:return D=e.sent,e.next=173,N.config(D);case 173:"android"===window.CLIENTCONFIG.PLATFORM&&(L=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,I.info("android hard decoder enter 2",L),window.isHardDecodeToNative(L));case 174:if(M={},R=0,-1!==v&&v!==parseInt(n["Device.ComCfg.Sip.LocalPort"])&&(M.hasOwnProperty("network")||(M.network={}),F={network:{local_sip_port:v}},M.network=(0,i.default)(M.network,F.network),R++),-1!==m&&m!==parseInt(n["Device.ComCfg.Sip.enableSessionTimer"])&&(M.hasOwnProperty("sip")||(M.sip={}),V={sip:{sessiontimer_enable:m}},M.sip=(0,i.default)(M.sip,V.sip),R++),-1!==S&&S!==parseInt(n["Device.ComCfg.Sip.SessionTime"])&&1===m&&(M.hasOwnProperty("sip")||(M.sip={}),B={sip:{session_time:S}},M.sip=(0,i.default)(M.sip,B.sip),R++),""===T||T===n["Device.ComCfg.Service.pointPickupActive"]){e.next=183;break}return I.info("Device.ComCfg.Service.pointPickupActive : "+n["Device.ComCfg.Service.pointPickupActive"]),e.next=183,N.config({service:{server_right:{type:7,active_accesscode:T,deactive_accesscode:"",register:0,right:0}}});case 183:if(""===P||P===n["Device.ComCfg.Service.groupPickupActive"]){e.next=187;break}return I.info("Device.ComCfg.Service.groupPickupActive : "+n["Device.ComCfg.Service.groupPickupActive"]),e.next=187,N.config({service:{server_right:{type:6,active_accesscode:P,deactive_accesscode:"",register:0,right:0}}});case 187:if(!(R>0)){e.next=191;break}return I.info("the configSipInfo is "+(0,s.default)(M)),e.next=191,N.config(M);case 191:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),we=t.RequestSetEventInform=function(e,t,n,r,a){return I.info("request event inform tup, eventCode = ",e),new p.default(function(){var i=(0,d.default)(u.default.mark(function i(o,s){var c,f,d;return u.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,m.default.getinstance();case 2:return c=i.sent,i.next=5,c.tupCwmpRequestSetEventInform(e,t,n,r,a);case 5:f=i.sent,d=f.result,0===d?(I.info("request event inform tup success"),o()):(I.info("request event inform tup failed, result = "+d),s());case 8:case"end":return i.stop()}},i,void 0)}));return function(e,t){return i.apply(this,arguments)}}())},ge=t.beginUploadLog=function(){I.info("beginUploadLog enter.");we("X WeLink UploadLog",1,1,null,0)},he=(t.clearCwmpParam=function(){R&&clearTimeout(R),R=null,F&&clearTimeout(F),F=null},t.compareVersion=function(e){var t=window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE,n=t.split("."),r=e.split("."),a=Math.max(n.length,r.length);if(t===e)return!1;for(var i=0;i<a;i++){var o=i>=r.length?0:parseInt(r[i],10),s=i>=n.length?0:parseInt(n[i],10);if(o>s)return!0;if(o<s)return!1}return!1}),Ce=t.dealWithConfigNotify=function(e){I.info("add task, get esight config notify, params length=",e.length),coreCommon.TaskQueue.getInstance("cwmpQueue").addTask(fe,{},null,e)};t.getAllConfig=function(){return x}},671:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.downloadResultNotify=t.updateFileDownloadNotify=t.getWhatsNewNotify=t.clickRequestVersionCheck=t.requestVersionUpdateCheck=t.dealUpdateVersionClick=t.clearBarPageSet=t.downloadProcessNotify=t.hideProgressBarModal=t.restartUpgrade=t.dealInstallFailed=t.dealDownloadFailed=t.startInstallNewVer=t.getInCallingState=t.cancelDownload=t.clearDownloadClick=t.setDownloadClick=t.clearAllUpdataState=t.changeUpdataState=void 0;var a=n(1),i=r(a),o=n(2),s=r(o),c=n(132),u=r(c),f=n(69),d=r(f),l=n(127),p=r(l),w=n(670),g=n(672),h=r(g),C=coreLogger.getLogger("logic")("cwmp/upgrade"),v={clickDownload:!1,clickTimer:null,downloadResume:!1,hasFirstUpdateNotify:!1},m=t.changeUpdataState=function(e){C.info("change updata state, obj=",(0,d.default)(e)),(0,u.default)(v,e),C.info("updataState=",(0,d.default)(v))},S=(t.clearAllUpdataState=function(){v.clickTimer&&clearTimeout(v.clickTimer),v={clickDownload:!1,clickTimer:null,downloadResume:!1,hasFirstUpdateNotify:!1},C.info("clear updata state, updataState=",(0,d.default)(v))},t.setDownloadClick=function(){m({clickDownload:!0}),v.clickTimer&&clearTimeout(v.clickTimer),v.clickTimer=setTimeout(function(){C.info("wait download notify time out, show download failed"),m({clickDownload:!1}),L()},6e4)}),E=t.clearDownloadClick=function(){v.clickTimer&&clearTimeout(v.clickTimer),v.clickTimer=null,m({clickDownload:!1})},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=window.CLIENTCONFIG.ACS_SOFTWAREVERSION_NAME,n=window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE;""!==e&&(t="Device.DeviceInfo.RequestSoftwareVersion",n=e);var r=[];r.push({ParaName:t,ParaValue:n}),C.info("sendVersionUpdateCheck para: "+(0,d.default)(r)),(0,w.RequestSetEventInform)("X WeLink Firmware Upgrade",1,1,r,r.length)},I=t.cancelDownload=function(){var e=(0,s.default)(i.default.mark(function e(t){var n,r,a;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("cancelDownload, magic=",t),n={Magic:t,AgreeDownload:0,DownloadTimeOut:parseInt(window.CLIENTCONFIG["Device.ComCfg.Cwmp.UpgradeDownloadTimeout"]),UpgFileTempPath:"",TcpTimeOut:3,ReqTimeOut:32,KeepDownload:1,LocalFileSize:0},e.next=4,h.default.getinstance();case 4:return r=e.sent,e.next=7,r.tupCwmpRequsetDownload(n);case 7:a=e.sent,C.info("cancelDownload, result=",a.result);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("confirmDownload path=",t+", magic=",n+", old file size=",s),r={Magic:n,AgreeDownload:1,DownloadTimeOut:parseInt(window.CLIENTCONFIG["Device.ComCfg.Cwmp.UpgradeDownloadTimeout"]),UpgFileTempPath:t,TcpTimeOut:3,ReqTimeOut:32,KeepDownload:1,LocalFileSize:s},e.next=4,h.default.getinstance();case 4:return a=e.sent,e.next=7,a.tupCwmpRequsetDownload(r);case 7:o=e.sent,C.info("confirmDownload, result=",o.result);case 9:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),P=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().common.modalContent,isNullOrEmpty(t)||"progressbar"===t.key){e.next=7;break}if(C.info("model is not empty, [key]=",t.key),"addConf"!==t.key){e.next=7;break}return e.next=6,coreConf.toggleChangeConfAcsPas("");case 6:coreUi.changeConfAcsStateEntrance(constant.JOIN_CONF_PASSWORD_INPUT_STATE.UNKNOWN);case 7:n=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getProgressBar}),coreUi.showModal(p.default.createElement(n,{key:"progressbar"}),!0,"",!1);case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C.info("userClick confirm download update version"),!window.isOffline){e.next=5;break}return C.info("offline, can not download update file"),window.Toast(language.NETWORK_IS_NOT_WORKING,2,!1),e.abrupt("return");case 5:t=$getState().cwmpInfo.downloadVersion,z(t);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),x=function(){$getState().cwmpInfo.isForceUpdate?window.notifyUpdateConfirm("VERSION_UPDATE_TITLE",{leftButton:language.LOG_OUT,rightButton:language.UPDATE_NOW}).then(function(e){e.ret?N():(C.info("userClick exit download update version"),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT))}):window.notifyUpdateConfirm("VERSION_UPDATE_TITLE",{leftButton:language.UPDATE_LATER,rightButton:language.UPDATE_NOW}).then(function(e){e.ret?N():C.info("userClick cancel download update version")})},y=function(){window.CLIENTCONFIG.ISMOBILE?window.webView&&(constant.UPDATE_MODEL_CONTENT_TYPE.DOWNLOADING===$getState().cwmpInfo.showContentType?window.goRoute("mUpdateVersionInfo"):x()):P()},k=function(e){try{if(window.fs){window.fs.readdirSync(e).forEach(function(t){var n=e+"/"+t;window.fs.statSync(n).isDirectory()||window.fs.unlinkSync(n)})}}catch(e){C.error("delete file error",e)}},A=function(e){var t=[];if(window.fs){window.fs.readdirSync(e).forEach(function(n){t.push(e+"/"+n)})}return t},O=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="",n="";if(window.fs)if(t=window.path.join(window.APP_DATA_PATH,"update/").replace(/\\/g,"/"),window.fs.existsSync(t))if(e){var r=A(t);n=Array.isArray(r)&&1===r.length&&r[0]||"",C.info("this is resume download, find old update file=",n),""===n&&(C.info("not found valid file, delete all files"),k(t))}else C.info("not resume download, delete old update files"),k(t);else C.info("creat new update file"),window.fs.mkdir(t);else window.webView&&(t=window.UPGRADE_APK_PATH,e&&(n=window.getProcessFileName(t)));return{upgradeDir:t,fileNamePath:n}},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];C.info("start update download, magic=",e,"iskeep=",t);var n=O(t),r=n.upgradeDir,a=n.fileNamePath;C.info("confirm download, set update file path=",r),""!==r&&(""!==a?(C.info("get old file path=",a),(0,w.getComPressFileSize)(a).then(function(t){var n=t.fileSize;C.info("get old update file size=",n),T(r,e,n)})):T(r,e))},U=t.getInCallingState=function(){var e=$getState().call.callStatus;return"VIDEO_CONNECTED"===e||"VIDEO_OUT"===e||"CALL_OUT"===e||"CALL_CONNECTED"===e},D=t.startInstallNewVer=function(){U()?(C.info("User is in calling, save the state and wait for the call end"),$dispatch(coreUi.bAfterCallUpgrade(!0))):(C.info("User is not calling, start install soft version now"),setTimeout(function(){window.CLIENTCONFIG.ISMOBILE?window.webView&&window.upgradeSoftVersion():V()},3e3))},L=t.dealDownloadFailed=function(){$dispatch(coreUi.setIsUpdateProcessError(!0)),$dispatch(coreUi.changeShowContentType(constant.UPDATE_MODEL_CONTENT_TYPE.DOWNLOADING)),y()},M=t.dealInstallFailed=function(e){C.info("intsall update file error, show download again prompt"),window.exec("tskill ShowInstallTip"),B(),$dispatch(coreUi.changeShowContentType(constant.UPDATE_MODEL_CONTENT_TYPE.NEWHINTS)),window.confirm(""+e,!0).then(function(e){e.ret&&(C.info("userClick to download update file again"),z())})},R=function(e){var t="WeLink"===window.CLIENTCONFIG.NEW_APP_NAME?window.process.env.APPDATA+"\\WeLink\\log\\language.txt":window.process.env.APPDATA+"\\HuaweiMeeting\\log\\language.txt";window.fs.writeFile(t,window.langcode,"utf8",function(t){t&&window.log("writeFile quiteInstallFile error =",t),window.spawn(e,["/verysilent","/suppressmsgboxes","/norestart"]).on("error",function(e){C.info("execute update file error, err=",e),M(language.PC_FILE_DAMAGE_DOWN_AGAIN)})})},F=function(e){try{var t=window.APP_DATA_PATH;appService.writeFile(t,"configfile.ini","language = "+window.langcode.toString()+"\r\npackageversion = "+window.CLIENTCONFIG.NEW_APP_NAME).then(function(n){C.info("set update tip language success, file=",n);var r=t+"/ShowInstallTip.exe";appService.isFileExist(r).then(function(n){if(n){C.info("execute ShowInstallTip");var r=t.slice(0,2),a=r+" && cd "+t+" && ShowInstallTip.exe";"WeLink"===window.CLIENTCONFIG.NEW_APP_NAME?a+=" /WeLink":a+=" /HuaweiMeeting",window.exec(a),R(e)}else C.info("update tip file does not exit"),R(e)})},function(t){C.info("set update tip language failed, err:"+t),R(e)})}catch(e){C.error("install update file error:",e),M(language.PC_FILE_DAMAGE_DOWN_AGAIN)}},V=function(){if(window.fs){for(var e=window.path.join(window.APP_DATA_PATH,"update").replace(/\\/g,"/"),t=window.fs.readdirSync(e),n=0;n<t.length;n++){var r=t[n];if(-1!==(0,d.default)(r).indexOf(".exe")){C.info("start execute software upgrade file, upgrade file name=",r);return void F(e+"/"+r)}}C.info("software update file is not exist"),M(language.DID_NOT_FIND_THE_AVAILABLE_UPGRADE_FILE)}},B=(t.restartUpgrade=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=3;break}return C.info("[ENABLE_IT_MEETING] Plugin do not need to be updated！"),e.abrupt("return");case 3:t=$getState(),n=t.cwmpInfo.isWaitUpgrade,r=t.cwmpInfo.isAfterCallUpgrade,!0===n&&!0===r&&(C.info("Soft start to upgrade after call ended"),$dispatch(coreUi.bAfterCallUpgrade(!1)),window.CLIENTCONFIG.ISMOBILE?window.webView&&window.upgradeSoftVersion():D());case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.hideProgressBarModal=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().common.modalContent,isNullOrEmpty(t)||"progressbar"!==t.key?C.info("not update model, [key]=",t.key):(C.info("hide update model"),coreUi.hideModal());case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),G=function(){return"login"===window.getRoute()?(C.info("offline or logout, can not update"),!1):!window.webView||!window.IsGooglePlayPkg()||(C.info("Android pkg check, the app is from google play, can not update by esight"),!1)},H=function(e){var t=e.SoftwareVersion,n=e.WhatsNewCHN,r=e.WhatsNewENG;if(C.info("getWhatIsNew, version=",t),!1!==G()){if(window.isHubEnv)return C.info("maxhub, request check version"),void _();if($dispatch(coreUi.changeWhatsNewCHN(n)),$dispatch(coreUi.changeWhatsNewENG(r)),$dispatch(coreUi.changeDownloadVersion(t)),v.hasFirstUpdateNotify)return void C.info("has show first hints, return");m({hasFirstUpdateNotify:!0}),$dispatch(coreUi.changeShowContentType(constant.UPDATE_MODEL_CONTENT_TYPE.WHATSNEWHINTS)),$dispatch(coreUi.isWaitUpgrade(!0));U()?C.info("User is in calling, not show hints"):(C.info("User is not calling, start to show update hints"),y())}},$=function(e,t){return C.info("deal with update file download notify, magic=",e+", update mode=",t),!1===G()?void I(e):window.isHubEnv?(C.info("maxhub confirm download update file"),void b(e)):v.clickDownload?(C.info("it's userClick, confirm download"),v.downloadResume?(b(e,!0),m({downloadResume:!1})):b(e),void E()):(C.info("get server update notify, cancel first and show hints"),I(e),v.hasFirstUpdateNotify?void C.info("has show first hints, return"):(m({hasFirstUpdateNotify:!0}),void setTimeout(function(){if(C.info("start to show hints"),!1!==G()){var e=!1;"X Vender FileMain UpgradeCompelled"===t&&(e=!0),$dispatch(coreUi.changeIsForceUpdate(e)),$dispatch(coreUi.changeShowContentType(constant.UPDATE_MODEL_CONTENT_TYPE.NEWHINTS)),$dispatch(coreUi.isWaitUpgrade(!0));U()?C.info("user is in calling, not show hints"):y()}},3e3)))},W=(t.downloadProcessNotify=function(e){try{C.info("start set download process ",(0,d.default)(e));var t=e.totalsize,n=e.downloadsize;if(t=parseFloat(t),n=parseFloat(n),isNaN(t)||isNaN(n))return void C.error("size data error");var r=t<=0?0:parseInt(Math.round(n/t*1e4)/100);$dispatch(coreUi.setDownloadProcess(r))}catch(e){C.error("downloadProcessNotify, error:",e)}},function(){C.info("maxhub download soft upgrade file success");for(var e=window.path.join(window.APP_DATA_PATH,"update").replace(/\\/g,"/"),t=window.fs.readdirSync(e),n=0;n<t.length;n++){var r=t[n];if(-1!==(0,d.default)(r).indexOf(".exe")){C.info("maxhub find upgrade file, name=",r);var a=e+"/"+r;return void coreConf.NotifyGetUpdateFiles(0,a)}}}),K=function(e){if(C.info("get download result, params",(0,d.default)(e)),window.isHubEnv)return void(0===e.result?W():C.info("maxhub download soft upgrade file failed"));if(0===e.result)C.info("download update file success"),D();else{if(9001===e.result||9101===e.result)return void C.info("user cancel download update file, return");C.info("download update file failed, result=",e.result+", info=",e.FaultString),m(9010===e.result?{downloadResume:!0}:{downloadResume:!1}),L()}},Y=t.clearBarPageSet=function(){var e=(0,s.default)(i.default.mark(function e(){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.setIsUpdateProcessError(!1)),$dispatch(coreUi.setDownloadProcess(-1));case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),q=function(e){C.info("start request software version check"),S(),_(e),Y(),$dispatch(coreUi.changeShowContentType(constant.UPDATE_MODEL_CONTENT_TYPE.DOWNLOADING)),y()},z=(t.dealUpdateVersionClick=function(){if(C.info("userClick, show soft update state btn"),!1===$getState().cwmpInfo.isWaitUpgrade)if(C.info("this is the latest software version"),window.CLIENTCONFIG.ISMOBILE)window.ToastNew(language.SOFT_UPGRADE_LATEST,2);else{var e=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getSoftVersionHint});coreUi.showModal(p.default.createElement(e,null))}else y()},t.requestVersionUpdateCheck=function(){C.info("add task, not userClick request version check"),coreCommon.TaskQueue.getInstance("updateQueue").addTask(_,{},null)},t.clickRequestVersionCheck=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";C.info("add task, userClick request version check, version=",e),coreCommon.TaskQueue.getInstance("updateQueue").addTask(q,{},null,e)});t.getWhatsNewNotify=function(e){C.info("add task, deal what's new notify, version=",e.SoftwareVersion),coreCommon.TaskQueue.getInstance("updateQueue").addTask(H,{},null,e)},t.updateFileDownloadNotify=function(e,t){C.info("add task, deal update file downloading notify, magic=",e),coreCommon.TaskQueue.getInstance("updateQueue").addTask($,{},null,e,t)},t.downloadResultNotify=function(e){C.info("add task, deal download result notify, params=",e),coreCommon.TaskQueue.getInstance("updateQueue").addTask(K,{},null,e)}},672:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1),i=r(a),o=n(132),s=r(o),c=n(2),u=r(c),f=n(3),d=r(f),l=n(69),p=r(l),w=n(4),g=r(w),h=n(5),C=r(h),v=coreLogger.getLogger("tup")("cwmp"),m=coreCommon.getTupProtocolClass(),S=null,E=function(){function e(t){var n=this;return(0,g.default)(this,e),this.tupCwmpConfig=function(e){v.info("begin cwmp config");var t={cmd:851971,description:"tup_cwmp_config",param:e};return n.sendMessage(t)},this.tupCwmpConfigCPE=function(e){v.info("begin cwmp config CPE");var t={cmd:851981,description:"tup_cwmp_config_cpe",param:e};return n.sendMessage(t)},this.tupCwmpConfigStun=function(e){v.info("begin cwmp config Stun");var t={cmd:851982,description:"tup_cwmp_config_stun",param:e};return n.sendMessage(t)},this.tupCwmpStart=function(){v.info("cwmp start");var e={cmd:851973,description:"tup_cwmp_start"};return n.sendMessage(e)},this.tupCwmpStop=function(){v.info("cwmp stop");var e={cmd:851974,description:"tup_cwmp_stop"};return n.sendMessage(e)},this.tupCwmpGetParamterValues=function(e){v.info("reply param value by param name");var t={cmd:851978,description:"tup_cwmp_get_paramter_values",param:e};return n.sendMessage(t)},this.tupCwmpSetPeriodic=function(e){var t={cmd:851979,description:"tup_cwmp_set_periodic",param:{PeriodicInformEnable:1,PeriodicInformInterval:parseInt(e)}};return v.info("tupCwmpSetPeriodic data = "+(0,p.default)(t)),n.sendMessage(t)},this.tupSetUploadFileName=function(e,t,r){var a={cmd:851980,description:"tup_cwmp_set_upload_filename",param:{Magic:t,AgreeUpload:r,UploadFileName:e,TcpTimeOut:3,ReqTimeOut:80,UploadTimeOut:80}};return v.info("tupSetUploadFileName data = "+(0,p.default)(a)),n.sendMessage(a)},this.tupCwmpStartConnReqSever=function(){var e={cmd:851972,description:"tup_cwmp_start_conn_req_sever"};return n.sendMessage(e)},this.tupCwmpStopConnReqSever=function(){var e={cmd:851975,description:"tup_cwmp_stop_conn_req_sever"};return n.sendMessage(e)},this.tupCwmpStartStunSevice=function(){var e={cmd:851983,description:"tup_cwmp_start_stun_service"};return n.sendMessage(e)},this.tupCwmpStopStunSevice=function(){var e={cmd:851984,description:"tup_cwmp_stop_stun_service"};return n.sendMessage(e)},this.tupCwmpRequestSetEventInform=function(e,t,r,a,i){v.info("tupCwmpRequestSetEventInform enter, eventCode = ",e);var o={cmd:851986,description:"tup_cwmp_inform_event",param:{EventCode:e,IsNeedRetry:t,IsActiveInform:r,IsMultiple:1,ParaTotalNum:i,EventParas:a}};return n.sendMessage(o)},this.tupCwmpRequsetDownload=function(e){v.info("tupCwmpRequsetDownload enter.");var t={cmd:851985,description:"tup_cwmp_request_download",param:e};return n.sendMessage(t)},this.tupCwmpRequsetAddInformParam=function(e){var t=e.length,r={cmd:851987,description:"tup_cwmp_add_inform_paras",param:{ParaTotalNum:t,InformParas:e}};return n.sendMessage(r)},this.tupCwmpUpdateToken=function(e){v.info("tupCwmpUpdateToken enter.");var t={cmd:851989,description:"tup_cwmp_set_custom_header",param:{ACSCustomHeaderName:"X-auth-Token",ACSCustomHeaderValue:e}};return n.sendMessage(t)},new d.default(function(){var e=(0,u.default)(i.default.mark(function e(r,a){var o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={key:constant.TupModuleKey.cwmp,moduleName:"tup_cwmp_service_protocol",webSocketUri:""},(0,s.default)(o,t),e.next=4,new m(o);case 4:n.tupProtocol=e.sent,r(n);case 6:case"end":return e.stop()}},e,n)}));return function(t,n){return e.apply(this,arguments)}}())}return(0,C.default)(e,null,[{key:"getinstance",value:function(){return!coreCommon.isMac()&&S||(S=new e),S}}]),(0,C.default)(e,[{key:"sendMessage",value:function(e){var t=this;return new d.default(function(n,r){var a={resolve:n,data:e};t.tupProtocol.setRspFuncsAndSendMessage(a)})}},{key:"setNotifyFunc",value:function(e,t){this.tupProtocol.setNotifyFunc(e,t)}}]),e}();t.default=E},69:function(e,t,n){e.exports={default:n(70),__esModule:!0}},70:function(e,t,n){var r=n(8),a=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},865:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.initESightService=t.stopCwmpServerAndUnInit=t.initAndStartCwmpServer=t.startStunAndCPEService=t.startStunService=t.cwmpConfigToken=void 0;var a=n(1),i=r(a),o=n(2),s=r(o),c=n(3),u=r(c),f=n(670),d=n(671),l=n(672),p=r(l),w=coreLogger.getLogger("logic")("cwmp/init"),g=!1,h=!1,C=null,v=function(){return new u.default(function(e,t){t()})},m=function(e){return new u.default(function(){var t=(0,s.default)(i.default.mark(function t(n,r){var a,o,s;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.default.getinstance();case 2:return a=t.sent,t.next=5,a.tupCwmpConfig(e);case 5:o=t.sent,s=o.result,0===s?(w.info("cwmp config success"),n()):(w.error("cwmp config failed, result = "+s),r());case 8:case"end":return t.stop()}},t,void 0)}));return function(e,n){return t.apply(this,arguments)}}())},S=t.cwmpConfigToken=function(){return new u.default(function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=$getState().login.authToken,e.next=3,p.default.getinstance();case 3:a=e.sent,a.tupCwmpUpdateToken(r),w.info("cwmp config [token] success"),t();case 7:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},E=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.getCPEParam)();case 2:return t=e.sent,n=new u.default(function(){var e=(0,s.default)(i.default.mark(function e(n,r){var a,o,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.getinstance();case 2:return a=e.sent,e.next=5,a.tupCwmpConfigCPE(t);case 5:o=e.sent,s=o.result,0===s?(w.info("cwmp config CPE success"),n()):(w.error("cwmp config CPE failed, result = "+s),r());case 8:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.getStunParam)();case 2:return t=e.sent,n=new u.default(function(){var e=(0,s.default)(i.default.mark(function e(n,r){var a,o,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.getinstance();case 2:return a=e.sent,e.next=5,a.tupCwmpConfigStun(t);case 5:o=e.sent,s=o.result,0===s?(w.info("cwmp config Stun success"),n()):(w.error("cwmp config Stun failed, result = "+s),r());case 8:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),I=function(){return new u.default(function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.getinstance();case 2:return r=e.sent,e.next=5,r.tupCwmpStart();case 5:a=e.sent,o=a.result,0===o?(w.info("cwmp start success"),t()):(w.error("cwmp start failed, result = "+o),n());case 8:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},T=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.getinstance();case 2:t=e.sent,t.tupCwmpStop();case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),P=function(){return new u.default(function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.getinstance();case 2:return r=e.sent,e.next=5,r.tupCwmpStartStunSevice();case 5:a=e.sent,o=a.result,0===o?(w.info("cwmp Stun start success"),h=!0,t()):(w.error("cwmp Stun start failed, result = "+o),n());case 8:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},N=function(){return new u.default(function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=12;break}return w.info("start stop cwmp stun service"),e.next=4,p.default.getinstance();case 4:return r=e.sent,e.next=7,r.tupCwmpStopStunSevice();case 7:a=e.sent,o=a.result,0===o?(w.info("cwmp stun stop success"),h=!1,t()):(w.error("cwmp stun stop failed, result = "+o),n()),e.next=14;break;case 12:w.info("cwmp stun service not need to stop"),t();case 14:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},x=function(){return new u.default(function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.getinstance();case 2:return r=e.sent,e.next=5,r.tupCwmpStartConnReqSever();case 5:a=e.sent,o=a.result,0===o?(w.info("cwmp http start success"),g=!0,t()):(w.error("cwmp http start failed, result = "+o),n());case 8:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},y=function(){return new u.default(function(){var e=(0,s.default)(i.default.mark(function e(t,n){var r,a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=12;break}return w.info("start to stop cwmp http service"),e.next=4,p.default.getinstance();case 4:return r=e.sent,e.next=7,r.tupCwmpStopConnReqSever();case 7:a=e.sent,o=a.result,0===o?(w.info("cwmp http stop success"),g=!1,t()):(w.error("cwmp http stop failed, result = "+o),n()),e.next=14;break;case 12:w.info("cwmp http service not need to stop"),t();case 14:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}())},k=function(){return w.info("start initCwmpModule"),new u.default(function(e,t){(0,f.initCwmpNotify)().then(function(){$dispatch(coreUi.setCwmpInitStatus(!0)),w.info("initCwmpModule success, set init status to true"),e()},function(){w.info("initCwmpModule failed"),t()})})},A=function(){w.info("start unInitCwmpModule"),$dispatch(coreUi.setCwmpInitStatus(!1)),w.info("unInitCwmpModule success, set init status to false")},O=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n,r,a,o,s,c,d,l,p,g,h,C,v,m,S;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,f.getHttpConnRandNum)(),t="",n="",r="win",a=$getState(),o=a.login.show_account,"android"===r?(t="WeLink Android",window.CLIENTCONFIG.ENABLE_IT_MEETING&&(t="Workplace Android"),n="SoftClient_Android_"+o):"ios"===r?(t="WeLink Ios",window.CLIENTCONFIG.ENABLE_IT_MEETING&&(t="Workplace iOS"),n="SoftClient_Ios_"+o):"win"===r||"bigwin"===r?window.isHubEnv?(t="CloudLink IWB",n="SoftClient_IWB_"+o):(t="WeLink Win",n="SoftClient_Win_"+o):"mac"===r&&(t="WeLink Mac",n="SoftClient_Mac_"+o),"WeLink"===window.CLIENTCONFIG.NEW_APP_NAME&&("win"===r?(t="Workplace Win",window.isHubEnv&&(t="CloudLink IWB",n="SoftClient_IWB_"+o)):"mac"===r&&(t="Workplace Mac")),s=$getState().login,c=s.isSupportCACertCheck,d=s.tmsServer,l=s.isSupportProxy,p=s.proxyAddress,g=s.proxyPort,h=s.proxyAccount,w.info("tmsServer: "),C=null,!l){e.next=20;break}return e.next=14,coreSecurity.getPasswordManager();case 14:return v=e.sent,e.next=17,v.getPassword("proxyPassword");case 17:C=e.sent,e.next=23;break;case 20:p=null,g=null,h=null;case 23:return m=$getState().cwmpInfo.cmdKey,S=new u.default(function(e,r){e({ACSUrl:d,ProxyAddr:p,ProxyPort:parseInt(g),ProxyUserName:h,ProxyPassword:C,DeviceManufacture:window.CLIENTCONFIG.ACS_MANUFACTURER_VALUE,DeviceOUI:window.CLIENTCONFIG.ACS_MANUFACTUREROUI_VALUE,DeviceproductClass:t,DeviceSerialNumber:n,PeriodicInformEnable:parseInt(window.CLIENTCONFIG.ACS_PERIODICINFORMENABLE_VALUE),PeriodicInformInterval:parseInt(window.CLIENTCONFIG.ACS_PERIODICINFORMINTERVAL_VALUE),FirstBoot:1,MapTreePath:window.EXEC_PATH+"/map_tree.xml",RebootReason:0,DisposeStat:1,TrustCaFileDir:window.EXEC_PATH,IsCAKeyCheck:0,VerifyMode:c?1:0,cmdkey:m})}),e.abrupt("return",S);case 26:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),b=function(){return w.info("start startCwmpServer"),new u.default(function(e,t){O().then(function(e){return m(e)},function(){return v()}).then(function(){return S()},function(){return v()}).then(function(){return I()},function(){return v()}).then(function(){w.info("startCwmpServer success"),e()},function(){w.info("startCwmpServer failed"),t()})})},U=function(e){return w.info("start startCPEService"),new u.default(function(t,n){(0,f.getCPEEnable)().then(function(){return E()},function(){return w.info("CPE param is null"),v()}).then(function(){return x()},function(){return v()}).then(function(){return(0,f.send4ValueChange)(e)},function(){return v()}).then(function(){w.info("startCPEService success"),t()},function(){w.info("startCPEService failed"),n()})})},D=t.startStunService=function(){if(g){return new u.default(function(e,t){w.info("start startStunService"),(0,f.getStunEnable)().then(function(){return _()},function(){return w.info("stun is disable"),v()}).then(function(){return P()},function(){return v()}).then(function(){w.info("startStunService success"),e()},function(){w.info("startStunService failed"),t()})})}return w.info("http not start, can not start stun"),v()},L=t.startStunAndCPEService=function(e){return w.info("start startStunAndCPEService"),new u.default(function(t,n){U(e).then(function(){return D()},function(){return v()}).then(function(){$dispatch(coreUi.showLogUpload(!0)),w.info("startstunandcpeservice, enable log upload!"),t()},function(){w.info("startStunAndCPEService failed"),n()})})},M=function(){return w.info("start stopStunAndCPEService"),new u.default(function(e,t){N().then(function(){return y()},function(){return v()}).then(function(){w.info("stopStunAndCPEService success"),e()},function(){w.info("stopStunAndCPEService failed"),t()})})},R=function(){return w.info("start stopCwmpAllServer"),new u.default(function(e,t){M().then(function(){return T()},function(){return v()}).then(function(){w.info("stopCwmpAllServer success"),e()},function(){w.info("stopCwmpAllServer failed"),t()})})},F=function(){return w.info("start startCwmpAllServer"),new u.default(function(e,t){b().then(function(){return L([])},function(){return v()}).then(function(){w.info("startCwmpAllServer success"),e()},function(){w.info("startCwmpAllServer failed"),t()})})},V=t.initAndStartCwmpServer=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n,r,a,o,s,c,l,p,g;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreUt.utEventStart({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_ESIGHT_SERVER,params:[constant.UT_LOGIN_SERVER_NAME.UT_ESIGHT_SERVER]}),w.info("start initAndStartCwmpServer"),window.cwmpLocalIp=window.localIp,t=$getState().login.tmsServer,w.info("tmsServer: "),window.CLIENTCONFIG.ISMOBILE){e.next=30;break}if(n=t.split("/"),n[2]?(n=n[2],n=n.split(":")[0]):w.info("tmsSever format error"),r=new Array,a=/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/,o=a.exec(n),o&&(r={param:[{IPAddr:{IP:o[0]}}]}),!(r&&r.param&&r.param.length>0)){e.next=30;break}s=0;case 14:if(!(s<r.param.length)){e.next=30;break}if(!a.test(r.param[s].IPAddr.IP)){e.next=27;break}return e.next=18,coreTup.getToolInstance();case 18:return c=e.sent,e.next=21,c.tupToolGetLocalIp(r.param[s].IPAddr.IP,"",!1);case 21:if(l=e.sent,w.info("ret.param: ",l.param?{flag:l.param.flag,local_ip:handlePhoneNumber(l.param.local_ip),server_ip:l.param.server_ip}:null),window.cwmpLocalIp=0===l.result&&""!==l.param.local_ip?l.param.local_ip:window.localIp,0!==l.result){e.next=27;break}return w.info("cwmpServerIp: ",r.param[s].IPAddr.IP),e.abrupt("break",30);case 27:s++,e.next=14;break;case 30:return p=$getState().cwmpInfo.cwmpInitStatus,w.info("init cwmp module, status = "+p),g=new u.default(function(e,t){p?(0,f.initCwmpNotify)().then(function(){return R()},function(){return v()}).then(function(){return F()},function(){return v()}).then(function(){w.error("restart all cwmp server success"),e()},function(){w.error("restart all cwmp server failed"),t()}):k().then(function(){return b()},function(){return v()}).then(function(){window.CLIENTCONFIG.ISMOBILE||(w.info("set interval to check update"),C&&clearInterval(C),C=setInterval(function(){w.info("It is time to check version over 24 hours"),(0,d.changeUpdataState)({hasFirstUpdateNotify:!1}),(0,d.requestVersionUpdateCheck)()},864e5)),w.info("initAndStartCwmpServer success"),e()},function(){w.info("initAndStartCwmpServer failed"),t()})}),e.abrupt("return",g);case 34:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),B=function(){w.info("reInit cwmp params"),C&&clearInterval(C),C=null,(0,f.clearCwmpParam)()};t.stopCwmpServerAndUnInit=function(){return w.info("start stopCwmpServerAndUnInit"),$getState().cwmpInfo.cwmpInitStatus?new u.default(function(e,t){M().then(function(){T(),B(),(0,d.clearAllUpdataState)(),A()},function(){return v()}).then(function(){w.info("stopCwmpServerAndUnInit success"),e()},function(){w.info("stopCwmpServerAndUnInit failed"),t()})}):void w.warn("has no cwmpInitStatus, ignore!")},t.initESightService=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreAccount.getLoginModel();case 2:if(t=e.sent,t.useEsight){e.next=6;break}return w.info("[ initESightService ] useEsight is false"),e.abrupt("return");case 6:w.info("[ initESightService ]",handlePhoneNumber(t.account)),w.info("<account_login><9_esight>begin"),""!==t.tmsServer&&void 0!==t.tmsServer&&V().then(function(){w.info("[ initESightService ] ok! ",handlePhoneNumber(t.account)),w.info("<account_login><9_esight>ok")});case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()}});