webpackJsonp([16],{109:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwCallSdk=void 0;var o=n(135),i=r(o),c=n(4),l=r(c),s=n(908),u=r(s),d=n(909),f=r(d),p=n(806),h=r(p),C=n(807),m=a(C),v=n(910),w=r(v),I=n(808),g=a(I),_=n(1716),S=a(_),b=n(911),N=a(b),E=n(1717),k=a(E),y=n(912),T=a(y),x=n(1718),O=a(x);t.HwCallSdk=function e(){(0,l.default)(this,e),this.AudioCallService=u.default,this.CallManager=f.default,this.CallService=h.default,(0,i.default)(this,m),this.VideoCallService=w.default,(0,i.default)(this,g),(0,i.default)(this,S),(0,i.default)(this,N),(0,i.default)(this,k),(0,i.default)(this,T),(0,i.default)(this,O)}},131:function(e,t,n){e.exports={default:n(151),__esModule:!0}},132:function(e,t,n){e.exports=n(0)(45)},133:function(e,t,n){e.exports=n(0)(47)},135:function(e,t,n){e.exports=n(0)(562)},141:function(e,t,n){e.exports=n(0)(238)},142:function(e,t,n){"use strict";t.__esModule=!0;var a=n(159),r=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,r.default)(e)}},146:function(e,t,n){var a=n(10),r=n(8),o=n(148);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],i={};i[e]=t(n),a(a.S+a.F*o(function(){n(1)}),"Object",i)}},148:function(e,t,n){e.exports=n(0)(59)},149:function(e,t,n){e.exports={default:n(168),__esModule:!0}},151:function(e,t,n){n(152),e.exports=n(8).Object.getPrototypeOf},152:function(e,t,n){var a=n(141),r=n(153);n(146)("getPrototypeOf",function(){return function(e){return r(a(e))}})},153:function(e,t,n){e.exports=n(0)(585)},158:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=n(184),o=a(r),i=n(149),c=a(i);t.default=function(){function e(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=(0,c.default)(e);!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},159:function(e,t,n){e.exports={default:n(173),__esModule:!0}},166:function(e,t,n){var a=n(15);e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},168:function(e,t,n){n(23),n(22),e.exports=n(169)},169:function(e,t,n){var a=n(9),r=n(26);e.exports=n(8).getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}},1715:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CALL_ERR={SUCCESS:{code:0,msg:"成功"},MULTI_DEVICE_LOGIN:{code:5001,msg:"有其他设备登录该账户，不能呼叫"},NET_2G:{code:5002,msg:"2G网络下不支持视频通话"},EXIST_CALL:{code:5003,msg:"已经存在一路呼叫，不能呼叫"},IN_VIDEO:{code:5004,msg:"已经存在一路视频，不能呼叫"},CALL_MORE:{code:5005,msg:"已经存在一路视频，不能呼叫"},CALL_NUM_MORE:{code:5006,msg:"不能同时呼叫两个用户"},IN_SIM_CALL:{code:5007,msg:"当前在通话中，不能呼叫"},USER_CANCEL:{code:5008,msg:"3g/4g下用户取消创建会议"},NET_ERROR:{code:5009,msg:"网络异常"},OTHER:{code:5010,msg:"其他错误"},NO_PERMISSION:{code:5011,msg:"没有音/视频权限"}}},1716:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.startCtdCall=t.getSipNumber=t.voiceCallPC=t.initTupCtd=t.initCallBackNum=t.getCallTypeAndCallBackNumFromServer=t.setCallBackNumAS=t.setCallTypeAS=t.setCallTypeAndCallBackNumToServer=t.refreshCallBackNum=t.initCallBackNumAS=t.setCallBackNum=t.setCallBackNumList=t.setCallType=void 0;var r=n(69),o=a(r),i=n(1),c=a(i),l=n(2),s=a(l),u=n(808),d=coreLogger.getLogger("logic")("call"),f=t.setCallType=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.changeCallType(t)),n=[{key:"callType",value:t.toString()}],e.next=4,coreDb.saveUserConfig(n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),p=t.setCallBackNumList=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.changeCallBackNumList(t)),n=[{key:"callBackNumList",value:(0,o.default)(t)}],e.next=4,coreDb.saveUserConfig(n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),h=t.setCallBackNum=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.changeCallBackNum(t)),n=[{key:"callBackNum",value:t.toString()}],e.next=4,coreDb.saveUserConfig(n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),C=(t.initCallBackNumAS=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,o,i,l,s,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: initCallBackNumAS"),t=$getState().call.callBackNumList,e.next=4,m();case 4:if(!((n=e.sent)&&n.callMode&&n.callBackNumber)){e.next=13;break}return e.next=8,f("DirectVoIP"===n.callMode?0:1);case 8:return e.next=10,h(n.callBackNumber);case 10:return-1===t.findIndex(function(e){return e.number===n.callBackNumber})&&t.push({number:n.callBackNumber}),e.next=13,p(t);case 13:if(a=$getState().call.callBackNum,r=$getState().call.callType,!a){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,coreAccount.getLoginModel();case 19:return o=e.sent,e.next=22,coreContact.getUserInfo(o.account);case 22:if(i=e.sent,l=i.param,!(s=l.mobile)){e.next=38;break}return e.next=28,C(0===r?"DirectVoIP":"CallBack",s);case 28:if(u=e.sent,d.info("CTD: initCallBackNumAS_result: ",u),!u){e.next=36;break}return e.next=33,h(s);case 33:return t.unshift({number:s}),e.next=36,p(t);case 36:e.next=40;break;case 38:return e.next=40,f(0);case 40:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.refreshCallBackNum=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,o,i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.info("CTD: refreshCallBackNum"),t=$getState().call.callBackNum,n=$getState().call.callType,a=$getState().call.callBackNumList,r=0;case 5:if(!(r<a.length)){e.next=11;break}if(t!==a[r].number){e.next=8;break}return e.abrupt("return");case 8:r++,e.next=5;break;case 11:if(!(0<a.length)){e.next=24;break}return e.next=14,coreAccount.getLoginModel();case 14:if(o=e.sent,!o.isSupportAS){e.next=23;break}return e.next=18,C(0===n?"DirectVoIP":"CallBack",a[0].number);case 18:i=e.sent,d.info("CTD: refreshCallBackNum_result: ",i),i&&h(a[0].number),e.next=24;break;case 23:h(a[0].number);case 24:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setCallTypeAndCallBackNumToServer=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a,r,i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"chinaPR";return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: setCallTypeAndCallBackNumToServer"),a="ctd",r=(0,o.default)({country:s,callMode:t,callBackNumber:n}),e.next=5,v({path:a,body:r});case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,w(i,l);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),m=(t.setCallTypeAS=function(){var e=(0,s.default)(c.default.mark(function e(t,n,a){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t,n,1);case 2:if(!(r=e.sent)){e.next=6;break}return e.next=6,f(a);case 6:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setCallBackNumAS=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t,n);case 2:if(!(a=e.sent)){e.next=6;break}return e.next=6,h(n);case 6:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCallTypeAndCallBackNumFromServer=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: getCallTypeAndCallBackNumFromServer"),t="ctd",e.next=4,v({path:t});case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,w(n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),v=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o,i,l,s=t.path,u=void 0===s?"":s,f=t.body,p=void 0===f?"":f;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: constructCloudUSGParams"),e.next=3,coreAccount.getLoginModel();case 3:if(n=e.sent,a=n.authToken,r=n.serverUportalAddress,o=n.serverUportalPort,i="https://"+r+":"+o,"/"===u[0]?i+=u:i=i+"/rest/usg/abs/v1/"+u,""!==a){e.next=10;break}return d.error("invalid authToken for EUA Request."),e.abrupt("return",null);case 10:return l={url:i,type:constant.REQUEST_TYPE.GET,header:{Authorization:"Basic "+a},body:p},""!==p&&(l.type=constant.REQUEST_TYPE.PUT,l.header["Content-Type"]="application/json"),e.abrupt("return",l);case 13:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: usgRequest"),e.next=3,coreHttp.sendSyncRequest(t);case 3:if(n=e.sent){e.next=7;break}return d.error("Usg Request Failed, invalid response."),e.abrupt("return",null);case 7:if(n.hasOwnProperty("result")&&0===n.result){e.next=10;break}return d.error("Usg Request Failed, result: "+(n.result?n.result:"Unknown Reason.")),e.abrupt("return",null);case 10:if(!n.hasOwnProperty("param")||!n.param.hasOwnProperty("resp_code")){e.next=25;break}if(304!==n.param.resp_code&&200!==n.param.resp_code){e.next=15;break}d.info("Usg Request Succeed, rsp: "+n.param.resp_code),e.next=23;break;case 15:if(401!==n.param.resp_code){e.next=21;break}return I(),d.error("Usg Request Failed, rsp: "+n.param.resp_code),e.abrupt("return",null);case 21:return d.error("Usg Request Failed, rsp: "+n.param.resp_code),e.abrupt("return",null);case 23:e.next=27;break;case 25:return d.error("Usg Request Failed, rsp: missing param or resp_code."),e.abrupt("return",null);case 27:if(n.param.hasOwnProperty("recv_body")&&n.param.recv_body){e.next=30;break}return d.info("Usg Request Failed, recv_body is null."),e.abrupt("return",null);case 30:if(a=JSON.parse(n.param.recv_body),d.info("Usg Request Result: "+a.returnMessage.split(".").pop()),!r||"000000003"!==a.returnCode){e.next=34;break}return e.abrupt("return",a.data||!0);case 34:if("000000000"===a.returnCode){e.next=36;break}return e.abrupt("return",null);case 36:return d.info("Usg Request Succeed."),e.abrupt("return",a.data||!0);case 38:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=(0,s.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.isAnonymous();case 2:t=e.sent,window.CLIENTCONFIG.ENABLE_IT_MEETING&&!t?window.refreshImToken():coreAccount.actionRefreshToken();case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),g=function(){var e=$getState().call.callBackNum,t=$getState().myInfo.mobile;if(""===e)return!1;if(t&&t===e)return d.info("callback number is mobile number"),!0;for(var n=$getState().call.callBackNumList,a=0;a<n.length;a++)if(e===n[a].number)return d.info("find callback number in callBackNumList"),!0;return!1},_=(t.initCallBackNum=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==g()){e.next=2;break}return e.abrupt("return");case 2:return d.info("start initCallBackNum"),e.next=5,coreAccount.getLoginModel();case 5:return t=e.sent,e.next=8,coreContact.getUserInfo(t.account);case 8:n=e.sent,a=n.param,r=a.mobile,o=$getState().call.callBackNumList,r&&(h(r),o.unshift({number:r}),p(o));case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.initTupCtd=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,i,l,s,u,f,p,h,C,m;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCtdInstance();case 2:if(t=e.sent,n=void 0,a=$getState().login,r=a.isSupportCACertCheck,i=window.EXEC_PATH,!r){e.next=13;break}return e.next=10,t.ctdSetTls(i,1);case 10:n=e.sent,e.next=16;break;case 13:return e.next=15,t.ctdSetTls(i,0);case 15:n=e.sent;case 16:if(d.info("set ctd tls res=",n),!a.isSupportProxy){e.next=32;break}return l=a.proxyAddress,s=a.proxyPort,u=a.proxyAccount,e.next=21,coreSecurity.getPasswordManager();case 21:return f=e.sent,e.next=24,f.getPassword("proxyPassword");case 24:return p=e.sent,e.next=27,t.ctdSetProxy(l,s,u,p);case 27:if(n=e.sent,0===n.result){e.next=31;break}return d.info("set ctd proxy failed, res=",(0,o.default)(n)),e.abrupt("return");case 31:d.info("set ctd proxy success");case 32:return h=a.serverAddress,C=a.serverPort,m=a.ctdServerUri,isNullOrEmpty(m)&&(m=h),e.next=36,t.ctdSetServerParam(m,C);case 36:n=e.sent,0!==n.result&&d.info("set ctd server param failed, res=",(0,o.default)(n)),d.info("set ctd server param success"),t.setNotifyFunc(786433,N);case 40:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.voiceCallPC=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=$getState().call.callType,!window.SERVERCONFIG.HWUC&&$getState().call.isShowCTDcallbackToPC&&1===a?b(t,n):(0,u.CallOut)(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getSipNumber=function(){var e=$getState().login.sipAccount;if(e){var t=e.indexOf("@"),n=e.indexOf("sip:"),a=-1!==n?4:0;return e=-1!==t?e.substring(a,t):e.substring(a)}return""}),S=function(e){var t=$getState(),n="",a=_();return window.isOffline?(n=language.CALL_FAILED_OFFLINE,d.error("ctd offline, can not start call")):e?t.myInfo.bind_no!==e&&a!==e||(n=language.CONFIRM_MYNO,d.error("ctd callNum is self, num= "+handlePhoneNumber(e))):(n=language.NOT_EMPTYNO,d.error("ctd callNum is null, = "+handlePhoneNumber(e))),""!==n&&(window.CLIENTCONFIG.ISMOBILE?alert(n):window.Toast(n,2,!1,null,"WhiteWarning"),!0)},b=t.startCtdCall=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a,r,i,l,s,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!S(t)){e.next=3;break}return d.info("start ctd call failed, check before call abnormal"),e.abrupt("return");case 3:if(a=$getState().call.callBackNum,r=$getState().login.authToken,!isNullOrEmpty(a)){e.next=8;break}return window.ToastNew(language.CALLBACKNUM_NOT_DELETE,2),e.abrupt("return");case 8:return i=_(),d.info("startCtdCall, callNum:"+handlePhoneNumber(t)+", callBackNum:"+handlePhoneNumber(a)+", sipAccount:"+handlePhoneNumber(i)),e.next=12,coreTup.getCtdInstance();case 12:return l=e.sent,e.next=15,l.ctdStartCall(a,t,r,i);case 15:s=e.sent,0!==s.result?(d.info("start ctd call failed, res=",(0,o.default)(s)),(window.CLIENTCONFIG.ISWIN||"mac"===window.CLIENTCONFIG.PLATFORM)&&window.Toast(language.CALL_CALLING_FAILED,3,!1,"pcToast","")):(window.CLIENTCONFIG.ISWIN||"mac"===window.CLIENTCONFIG.PLATFORM)&&(u=language.CALL_BACK_TIPS1.format(a)+","+language.CALL_BACK_TIPS2,window.Toast(u,3,!1,"pcToast","")),d.info("start ctd call success"),$dispatch(coreUi.changeUserInfo(n)),$dispatch(coreUi.changeCtdCallingState(!0)),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==window.getRoute()&&window.goRoute("callMain");case 21:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),N=function(e){d.info("notify, get ctd call result, data=",e)}},1717:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.callRecordNotifyMessageToIM=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=coreLogger.getLogger("logic")("callRecordImNotify");t.callRecordNotifyMessageToIM=function(){var e=(0,c.default)(o.default.mark(function e(t){var n,a,r,i,c,s,u,d,f,p,h,C,m,v,w;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",isNullOrEmpty(t)){e.next=9;break}return a=t.peeraccount,r=t.iscallout,i=t.callernumber,c=t.calleenumber,s=t.starttime,u=t.callstate,d=t.calltype,f=t.duration,p=t.isVideo,h=t.callUserName,C=t.isCallSuccess,n=C?1===d?"视频":"音频":"已拒绝",e.next=6,coreIm.getLocalRecent({owner:a});case 6:m=e.sent,v=void 0,isNullOrEmpty(m)||(v=coreIm.createCallRecordMessage(m,n),w=$getState().recent.currentRecentInfo,w.owner===m.owner?(l.info("callRecordNotifyMessage 在当前会话"),$dispatch(coreUi.addNewMessage(v))):l.info("callRecordNotifyMessage 不在当前会话"),coreDb.saveMessage(v));case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},1718:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),o=a(r),i=n(2),c=a(i),l=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.code||"total"!==t.event){e.next=6;break}if(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=6;break}return e.next=5,coreCall.initTupCtd();case 5:coreCall.getInitCallRecordList();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),u=n(808);coreLogger.getLogger("call")("moduleMessager");coreCommon.registeModuleListener("login",l),coreCommon.registeModuleListener("logout",s),coreCommon.registeModuleListener("sipRegResultEvent",u.sipRegResultNotify)},172:function(e,t,n){e.exports={default:n(222),__esModule:!0}},173:function(e,t,n){n(22),n(174),e.exports=n(8).Array.from},174:function(e,t,n){"use strict";var a=n(11),r=n(10),o=n(141),i=n(31),c=n(32),l=n(27),s=n(175),u=n(26);r(r.S+r.F*!n(33)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,d,f=o(e),p="function"==typeof this?this:Array,h=arguments.length,C=h>1?arguments[1]:void 0,m=void 0!==C,v=0,w=u(f);if(m&&(C=a(C,h>2?arguments[2]:void 0,2)),void 0==w||p==Array&&c(w))for(t=l(f.length),n=new p(t);t>v;v++)s(n,v,m?C(f[v],v):f[v]);else for(d=w.call(f),n=new p;!(r=d.next()).done;v++)s(n,v,m?i(d,C,[r.value,v],!0):r.value);return n.length=v,n}})},175:function(e,t,n){"use strict";var a=n(25),r=n(176);e.exports=function(e,t,n){t in e?a.f(e,t,r(0,n)):e[t]=n}},176:function(e,t,n){e.exports=n(0)(79)},177:function(e,t,n){e.exports=n(0)(593)},184:function(e,t,n){e.exports={default:n(185),__esModule:!0}},185:function(e,t,n){n(23),n(22),e.exports=n(186)},186:function(e,t,n){var a=n(16),r=n(6)("iterator"),o=n(17);e.exports=n(8).isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||o.hasOwnProperty(a(t))}},191:function(e,t,n){"use strict";var a=n(25).f,r=n(204),o=n(29),i=n(11),c=n(28),l=n(24),s=n(205),u=n(206),d=n(37),f=n(30),p=n(177).fastKey,h=n(166),C=f?"_s":"size",m=function(e,t){var n,a=p(t);if("F"!==a)return e._i[a];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,s){var u=e(function(e,a){c(e,u,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[C]=0,void 0!=a&&l(a,n,e[s],e)});return o(u.prototype,{clear:function(){for(var e=h(this,t),n=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];e._f=e._l=void 0,e[C]=0},delete:function(e){var n=h(this,t),a=m(n,e);if(a){var r=a.n,o=a.p;delete n._i[a.i],a.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==a&&(n._f=r),n._l==a&&(n._l=o),n[C]--}return!!a},forEach:function(e){h(this,t);for(var n,a=i(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(h(this,t),e)}}),f&&a(u.prototype,"size",{get:function(){return h(this,t)[C]}}),u},def:function(e,t,n){var a,r,o=m(e,t);return o?o.v=n:(e._l=o={i:r=p(t,!0),k:t,v:n,p:a=e._l,n:void 0,r:!1},e._f||(e._f=o),a&&(a.n=o),e[C]++,"F"!==r&&(e._i[r]=o)),e},getEntry:m,setStrong:function(e,t,n){s(e,t,function(e,n){this._t=h(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?u(0,n.k):"values"==t?u(0,n.v):u(0,[n.k,n.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},192:function(e,t,n){"use strict";var a=n(7),r=n(10),o=n(177),i=n(148),c=n(35),l=n(29),s=n(24),u=n(28),d=n(15),f=n(36),p=n(25).f,h=n(207)(0),C=n(30);e.exports=function(e,t,n,m,v,w){var I=a[e],g=I,_=v?"set":"add",S=g&&g.prototype,b={};return C&&"function"==typeof g&&(w||S.forEach&&!i(function(){(new g).entries().next()}))?(g=t(function(t,n){u(t,g,e,"_c"),t._c=new I,void 0!=n&&s(n,v,t[_],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in S&&(!w||"clear"!=e)&&c(g.prototype,e,function(n,a){if(u(this,g,e),!t&&w&&!d(n))return"get"==e&&void 0;var r=this._c[e](0===n?0:n,a);return t?this:r})}),w||p(g.prototype,"size",{get:function(){return this._c.size}})):(g=m.getConstructor(t,e,v,_),l(g.prototype,n),o.NEED=!0),f(g,e),b[e]=g,r(r.G+r.W+r.F,b),w||m.setStrong(g,e,v),g}},193:function(e,t,n){var a=n(16),r=n(212);e.exports=function(e){return function(){if(a(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},194:function(e,t,n){"use strict";var a=n(10);e.exports=function(e){a(a.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},195:function(e,t,n){"use strict";var a=n(10),r=n(12),o=n(11),i=n(24);e.exports=function(e){a(a.S,e,{from:function(e){var t,n,a,c,l=arguments[1];return r(this),t=void 0!==l,t&&r(l),void 0==e?new this:(n=[],t?(a=0,c=o(l,arguments[2],2),i(e,!1,function(e){n.push(c(e,a++))})):i(e,!1,n.push,n),new this(n))}})}},204:function(e,t,n){e.exports=n(0)(133)},205:function(e,t,n){e.exports=n(0)(241)},206:function(e,t,n){e.exports=n(0)(589)},207:function(e,t,n){var a=n(11),r=n(208),o=n(141),i=n(27),c=n(209);e.exports=function(e,t){var n=1==e,l=2==e,s=3==e,u=4==e,d=6==e,f=5==e||d,p=t||c;return function(t,c,h){for(var C,m,v=o(t),w=r(v),I=a(c,h,3),g=i(w.length),_=0,S=n?p(t,g):l?p(t,0):void 0;g>_;_++)if((f||_ in w)&&(C=w[_],m=I(C,_,v),e))if(n)S[_]=m;else if(m)switch(e){case 3:return!0;case 5:return C;case 6:return _;case 2:S.push(C)}else if(u)return!1;return d?-1:s||u?u:S}}},208:function(e,t,n){e.exports=n(0)(236)},209:function(e,t,n){var a=n(210);e.exports=function(e,t){return new(a(e))(t)}},210:function(e,t,n){var a=n(15),r=n(211),o=n(6)("species");e.exports=function(e){var t;return r(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!r(t.prototype)||(t=void 0),a(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},211:function(e,t,n){e.exports=n(0)(595)},212:function(e,t,n){var a=n(24);e.exports=function(e,t){var n=[];return a(e,!1,n.push,n,t),n}},222:function(e,t,n){n(34),n(22),n(23),n(223),n(224),n(225),n(226),e.exports=n(8).Map},223:function(e,t,n){"use strict";var a=n(191),r=n(166);e.exports=n(192)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=a.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return a.def(r(this,"Map"),0===e?0:e,t)}},a,!0)},224:function(e,t,n){var a=n(10);a(a.P+a.R,"Map",{toJSON:n(193)("Map")})},225:function(e,t,n){n(194)("Map")},226:function(e,t,n){n(195)("Map")},69:function(e,t,n){e.exports={default:n(70),__esModule:!0}},70:function(e,t,n){var a=n(8),r=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},806:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i,c=n(3),l=a(c),s=n(69),u=a(s),d=n(1),f=a(d),p=n(2),h=a(p),C=n(4),m=a(C),v=n(5),w=a(v),I=coreLogger.getLogger("model")("model/callService/callService"),g=(o=r=function(){function e(t){(0,m.default)(this,e),i.call(this);var n=(new Date).getTime(),a=formatDateYYYYMMDDHHMM(n),r="undefined"+t.tel_num;this.callInfo={callNo:t.tel_num,callId:t.call_id,callType:t.call_type,callState:t.call_state,callee:this.getCallee(t.tel_num,r),milltime:isNullOrEmpty(t.milltime)?n:t.milltime,ucaccount:r,startTime:isNullOrEmpty(t.startTime)?a.time:t.startTime,date:isNullOrEmpty(t.date)?a.date:t.date,callUserInfo:"",isVideo:1===t.call_type,reasonCode:0,endcall_reason:"",callInOut:t.callInOut,isCallSuccess:t.isCallSuccess,addrVip:t.addr_vip,isCallRingBack:!1,isFocus:0,isAssignedBwForData:!1,callerNumber:t.callerNumber,ringNumber:t.ringNumber,pickupCallType:t.pickupCallType},this.cntOfSpeech={high:0,low:0}}return(0,w.default)(e,[{key:"getCallee",value:function(e,t){return{name:e,mobile:e,contactAvatar:"./bin/img/contacts/Avatar_"+(e%12||0)+".png",ucaccount:t}}},{key:"getCallInfo",value:function(){return this.callInfo}},{key:"endCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("call service ,callId = "+this.callInfo.callId),e.next=3,coreTup.getCallInstance();case 3:return t=e.sent,e.next=6,t.endCall(this.callInfo.callId);case 6:return n=e.sent,this.unInit(),e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"dialDTMF",value:function(e,t){return t?void(this.callInfo.dtmfNo=e):!e||/[^0-9*#]/.test(e)?this.callInfo.dtmfNo:(this.callInfo.dtmfNo=this.callInfo.dtmfNo+e,"*"===e?e=10:"#"===e&&(e=11),this.callTupSendDTMF(e),I.info("DTMF dial"),this.callInfo.dtmfNo)}},{key:"callTupSendDTMF",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:n=e.sent,n.dtmf(this.callInfo.callId,t),I.info("call service ,dialDTMF = ");case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"operateMic",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.operateMic(this.callInfo.callId,t);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return I.info("operate mic success"),e.abrupt("return",!0);case 11:return I.info("operate mic failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"switchAudioChannel",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.switchAudioChannel(this.callInfo.callId,t);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return I.info("switchAudioChannel success"),e.abrupt("return",!0);case 11:return I.info("switchAudioChannel failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallEnded",value:function(e){I.info("enter handleCallEnded reason_code: "+e.param.reason_code+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,e.param.reason_code&&(this.callInfo.reasonCode=e.param.reason_code),e.param.endcall_reason&&(this.callInfo.endcall_reason=e.param.endcall_reason),403===e.param.reason_code&&coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_BEENDEDCALL_ERROR,handlePhoneNumber($getState().call.callNum),e.param.reason_code]}),coreCommon.Observer.publish("CallEnded",this.callInfo),this.unInit(),window.CLIENTCONFIG.ISBIGWIN&&(4041===e.param.reason_code&&(coreConf.NotifyConfNoStart(0),I.info("NotifyConfNoStart")),4042===e.param.reason_code&&(coreConf.NotifyConfTermination(0),I.info("NotifyConfTermination")))}},{key:"handleCallDestroy",value:function(e){I.info("enter handleCallDestroy"),this.callInfo.callState=e.param.call_state,e.param.endcall_reason&&(this.callInfo.endcall_reason=e.param.endcall_reason),coreCommon.Observer.publish("CallDestroy",this.callInfo)}},{key:"handleCallHoldSuccess",value:function(e){I.info("handleCallHoldSuccess callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallHoldSuccess",this.callInfo)}},{key:"handleCallHoldFailed",value:function(e){I.info("handleCallHoldFailed callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallHoldFailed",this.callInfo)}},{key:"handleCallUnHoldSuccess",value:function(e){I.info("handleCallUnHoldSuccess callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallUnHoldSuccess",this.callInfo)}},{key:"handleCallUnHoldFailed",value:function(e){I.info("handleCallUnHoldFailed callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallUnHoldFailed",this.callInfo)}},{key:"handleCallUpateRemoteInfo",value:function(e){I.info("handleCallUpateRemoteInfo callId: "+e.param.call_id);var t=JSON.parse((0,u.default)(this.callInfo));if(t.callId===e.param.call_id&&t.callNo!==e.param.tel_num){var n=(new Date).getTime(),a=formatDateYYYYMMDDHHMM(n);this.callInfo.milltime=n,this.callInfo.startTime=a.time,this.callInfo.date=a.date,this.callInfo.fwd_from_num=e.param.fwd_from_num,this.callInfo.fwd_from_name=e.param.fwd_from_name,this.callInfo.callInOut=constant.CALL_IN_OUT_TYPE.CALL_IN,this.callInfo.callNo=e.param.tel_num,this.callInfo.ucaccount="undefined"+e.param.tel_num,this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallUpateRemoteInfo",[t,this.callInfo])}else I.info("the number is the same remote number does not need to be changed")}},{key:"replyAddVideo",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.replyAddVideo(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?I.info("reply add video success"):I.info("reply add video failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallRingBack",value:function(e){I.info("handleCallRingBack callId: "+e.param.call_id);var t=(new Date).getTime(),n=formatDateYYYYMMDDHHMM(t);this.callInfo.milltime=t,this.callInfo.startTime=n.time,this.callInfo.date=n.date,this.callInfo.callInOut=constant.CALL_IN_OUT_TYPE.CALL_OUT,this.callInfo.callState=e.param.call_state,0!==(e.param&&e.param.have_sdp)||this.callInfo.isCallRingBack||(coreCommon.Observer.publish("CallRingBack",e.param),this.callInfo.isCallRingBack=!0)}},{key:"handleLowVideoBW",value:function(e){coreCommon.Observer.publish("LowVideoBW",e.param),I.info("LowVideoBW")}},{key:"handleCallConnected",value:function(e){I.info("handleCallConnected callid: "+e.param.call_id);var t=(new Date).getTime();this.callInfo.milltime=t,this.callInfo.callState=e.param.call_state,this.callInfo.isCallSuccess=1,this.callInfo.callType=e.param.call_type,this.callInfo.isFocus=e.param.is_focus,this.callInfo.telNum=e.param.tel_num,coreCommon.Observer.publish("CallConnected",this.callInfo)}},{key:"handleCallAddVideo",value:function(e){I.info("AddVideoRequest"),coreCommon.Observer.publish("AddVideoRequest",e.param)}},{key:"handleCallDelVideo",value:function(e){I.info("DelVideoRequest"),coreCommon.Observer.publish("DelVideoRequest",e.param)}},{key:"handleCallRTPCreated",value:function(e){coreCommon.Observer.publish("CallRTPCreated",e.param),I.info("CallRTPCreated")}},{key:"handleCallModifyVideoResult",value:function(e){this.callInfo.reason_code=e.param.result,coreCommon.Observer.publish("CallModifyVideoResult",this.callInfo),I.info("CallModifyVideoResult",e.param)}},{key:"handleCallSessionModify",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreCommon.Observer.publish("CallSessionModify",this.callInfo),1!==this.callInfo.callType){e.next=12;break}return coreCommon.CameraControl.getInstance().setCallId(this.callInfo.callId),this.setDeviceControlCallId(t.param.call_id),e.next=6,coreCommon.CameraControl.getInstance().initAfterGetCallId();case 6:if(window.CLIENTCONFIG.ENABLE_IT_MEETING,!0){e.next=9;break}return e.next=9,window.dealFloatWindow();case 9:window.otherAudioDevicesConnect||coreCommon.SpkControl.getInstance().setHandsFree(!0),e.next=14;break;case 12:"ios"===window.CLIENTCONFIG.PLATFORM?setTimeout(function(){coreCommon.SpkControl.getInstance().setHandsFree(!1)},1e3):coreCommon.SpkControl.getInstance().setHandsFree(!1),coreCommon.CameraControl.getInstance().unInit();case 14:I.info("Call[Session]Modify",t.param.svc_lables);case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallBldTransferFailed",value:function(e){I.info("handleCallBldTransferFailed"),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallBldTransferFailed",e.param)}},{key:"handleCallBldTransferSuccess",value:function(e){I.info("handleCallBldTransferSuccess"),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallBldTransferSuccess",e.param)}},{key:"addSvcVideoWindow",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n,a,r,o){var i,c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return i=e.sent,e.next=5,i.addSvcVideoWindow(t,n,a,r,o,l);case 5:return c=e.sent,0===c.result?I.info("addSvcVideoWindow success"):I.info("addSvcVideoWindow failed, result = ",c),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"updateSvcVideoWindow",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n,a,r,o){var i,c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return i=e.sent,e.next=5,i.updateSvcVideoWindow(t,n,a,r,o,l);case 5:return c=e.sent,0===c.result?I.info("updateSvcVideoWindow success"):I.info("updateSvcVideoWindow failed, result = ",c),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"removeSvcVideoWindow",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n,a,r){var o,i;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return o=e.sent,e.next=5,o.removeSvcVideoWindow(t,n,a,r);case 5:return i=e.sent,0===i.result?I.info("removeSvcVideoWindow success"):I.info("removeSvcVideoWindow failed, result = ",i),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"resetBFCStatus",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n){var a,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.resetBFCStatus(t,n);case 5:return r=e.sent,0===r.result?I.info("resetBFCStatus success"):I.info("resetBFCStatus failed, result = "+r.result),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"svcRedistributeVideoTmmbr",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.svcRedistributeVideoTmmbr(t);case 5:return a=e.sent,0===a.result?I.info("svcRedistributeVideoTmmbr success"):I.info("svcRedistributeVideoTmmbr failed, result = "+a.result),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"startCall",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,h.default)(f.default.mark(function t(n,a){var r,o,i,c,l,s,u=this;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return I.info("startCall isVideo: "+n+" isConf: "+a),t.next=3,coreTup.getCallInstance();case 3:if(r=t.sent,o=e.getPromise(),r.setNotifyFunc(98308,function(e){u.callInfo.callType=e.param.call_type,u.callInfo.isVideo=1===e.param.call_type,u.callInfo.callState=e.param.call_state,a||(I.info("CallOutGoing start call"),coreCommon.Observer.publish("CallOutGoing",u.callInfo)),o.resolve(e)}),i=e.getPromise(),r.setNotifyFunc(98306,function(e){i.resolve(e)}),!n){t.next=11;break}return t.next=11,coreCommon.CameraControl.getInstance().initSetVideoIndex();case 11:if(c=void 0,!(window.CLIENTCONFIG.ISBIGWIN&&n&&this.callInfo.addrVip.length>0)){t.next=18;break}return t.next=15,r.startVipCall(this.callInfo.callNo,n,this.callInfo.addrVip);case 15:c=t.sent,t.next=21;break;case 18:return t.next=20,r.startCall(this.callInfo.callNo,n);case 20:c=t.sent;case 21:if(I.info("start call result = "+c.result),!c||0!==c.result){t.next=27;break}this.callInfo.callId=c.param.call_id,this.setDeviceControlCallId(c.param.call_id),t.next=30;break;case 27:return r.setNotifyFunc(98308,null),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_STARTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),c.result]}),t.abrupt("return");case 30:return t.next=32,i.promise;case 32:if(l=t.sent,I.info("CALL_E_EVT_CALL_STARTCALL_RESULT result = "+l.param.result),0!==l.param.result){t.next=46;break}return t.next=37,o.promise;case 37:if(s=t.sent,coreCommon.SpkControl.getInstance().cancelSysSpkMute(),!n){t.next=42;break}return t.next=42,coreCommon.CameraControl.getInstance().initAfterGetCallId();case 42:return r.setNotifyFunc(98308,null),t.abrupt("return",s);case 46:return r.setNotifyFunc(98308,null),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_STARTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),c.result]}),t.abrupt("return");case 49:case"end":return t.stop()}},t,this)}));return t}()},{key:"getCallBandwidth",value:function(){function e(){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(){var t,n,a,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={callid:this.callInfo.callId,infoid:0},n=0,a=void 0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=9;break}return e.next=6,coreCall.getBasicCallInfoNew(t);case 6:a=e.sent,e.next=15;break;case 9:return e.next=11,coreTup.getCallInstance();case 11:return r=e.sent,e.next=14,r.getBasicCallInfo(t);case 14:a=e.sent;case 15:return 0===a.result?(I.info("getCallBandwidth success,bandwidth = "+a.param.call_info.bandwidth),n=a.param.call_info.bandwidth):I.info("getCallBandwidth failed"),e.abrupt("return",n);case 17:case"end":return e.stop()}},e,this)}));return e}()},{key:"assignBandwidthForData",value:function(){function t(){return n.apply(this,arguments)}var n=(0,h.default)(f.default.mark(function t(){var n,a;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.callInfo.isVideo){t.next=3;break}return I.info("audio conf, default data bandwidth: 2M"),t.abrupt("return",2e3);case 3:return t.next=5,this.getCallBandwidth();case 5:return n=t.sent,a=e.assignBandwidth(n),I.info("assignBandwidthForData, total: "+n+", data: "+a[1]),t.abrupt("return",a[1]);case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"setDataBandwidth",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n){var a,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.callInfo.isVideo){e.next=3;break}return I.info("audio conf, not set data bandwidth."),e.abrupt("return");case 3:if(!(this.callInfo.isAssignedBwForData&&0===t||!this.callInfo.isAssignedBwForData&&2===t)){e.next=6;break}return I.info("not assign again, optType: ",t),e.abrupt("return");case 6:return e.next=8,coreTup.getCallInstance();case 8:return a=e.sent,e.next=11,a.setDataBandwidth(this.callInfo.callId,t,n);case 11:r=e.sent,0===r.result?(I.info("setBandwidth success"),0===t?this.callInfo.isAssignedBwForData=!0:2===t&&(this.callInfo.isAssignedBwForData=!1)):I.info("setBandwidth failed, res = ",r);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"startPickupCall",value:function(){function t(){return n.apply(this,arguments)}var n=(0,h.default)(f.default.mark(function t(){var n,a,r,o,i=this;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,coreTup.getCallInstance();case 2:if(n=t.sent,a=e.getPromise(),n.setNotifyFunc(98308,function(e){i.callInfo.callType=e.param.call_type,i.callInfo.isVideo=1===e.param.call_type,i.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallOutGoing",i.callInfo),a.resolve(e)}),"tel:"===this.callInfo.callerNumber.substr(0,4)?this.callInfo.callNo=this.callInfo.callerNumber.substr(4,this.callInfo.callerNumber.length-4):this.callInfo.callNo=this.callInfo.callerNumber,I.info("this.callInfo.callNo = ",this.callInfo.callNo),r=void 0,1!==this.callInfo.pickupCallType){t.next=14;break}return t.next=11,n.groupPickupEx(this.callInfo.callId,1,this.callInfo.callerNumber,this.callInfo.ringNumber);case 11:r=t.sent,t.next=18;break;case 14:if(2!==this.callInfo.pickupCallType){t.next=18;break}return t.next=17,n.pointPickupEx(this.callInfo.callId,1,this.callInfo.callerNumber,this.callInfo.ringNumber);case 17:r=t.sent;case 18:if(I.info("start call result = "+r.result),!r||0!==r.result){t.next=27;break}return t.next=22,a.promise;case 22:return o=t.sent,n.setNotifyFunc(98308,null),t.abrupt("return",o);case 27:return n.setNotifyFunc(98308,null),t.abrupt("return");case 29:case"end":return t.stop()}},t,this)}));return t}()},{key:"unInit",value:function(){function e(){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.SpkControl.getInstance().makeSysSpkMute();case 2:coreCommon.SpkControl.getInstance().setHandsFree(!1),coreCommon.CameraControl.getInstance().unInit(),coreCommon.SpkControl.getInstance().unInit(),coreCommon.MicControl.getInstance().unInit();case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setDeviceControlCallId",value:function(e){coreCommon.MicControl.getInstance().setCallId(e),coreCommon.SpkControl.getInstance().setCallId(e),coreCommon.CameraControl.getInstance().setCallId(e)}}],[{key:"getPromise",value:function(){var e={};return e.promise=new l.default(function(t,n){e.resolve=t,e.reject=n}),e}},{key:"addStarBeforeBindNo",value:function(e){return I.info("addStarBeforeBindNo = ",handlePhoneNumber(e)),"*"+e}},{key:"assignBandwidth",value:function(e){return e?e<128?[e/2,e/2]:e<256?[e/2,e/2]:e<384?[128,128]:e<512?[128,192]:e<768?[256,256]:e<1024?[384,384]:e<1152?[512,512]:e<1536?[640,512]:e<1920?[768,768]:e<2048?[1152,768]:e<2880?[1280,768]:e<3840?[1344,1536]:e<5760?[1920,1920]:[e/2,e/2]:[1152,768]}}]),e}(),i=function(){var e=this;this.handleCallIncomming=function(){var t=(0,h.default)(f.default.mark(function t(n){var a,r;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:I.info("handleCallIncomming callid: "+n.param.call_id),a=(new Date).getTime(),r=formatDateYYYYMMDDHHMM(a),e.callInfo.milltime=a,e.callInfo.startTime=r.time,e.callInfo.date=r.date,e.callInfo.callState=n.param.call_state,e.callInfo.callType=n.param.call_type,e.callInfo.callInOut=constant.CALL_IN_OUT_TYPE.CALL_IN,e.callInfo.fwd_from_num=n.param.fwd_from_num,e.callInfo.fwd_from_name=n.param.fwd_from_name,e.callInfo.display_name=n.param.display_name,coreCommon.Observer.publish("CallIncomming",e.callInfo);case 13:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()},o);t.default=g},807:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllDeviceCtrl=t.getSpkCtrl=t.getMicCtrl=t.getCameraCtrl=t.startPickupCall=t.createCallId=t.assignBandwidthForData=t.getCallBandwidth=t.setDataBandwidth=t.sendUniversalInfo=t.setEncoderMaxCap=t.getCallInfoByCallId=t.setBandwidth=t.callJointStopLinkage=t.callJointStartLinkage=t.setTUPCallCfg=t.pairPermit=t.pairEnable=t.pairLinkageEnd=t.pairLinkageLeave=t.pairLinkage=t.pairSubscribe=t.cancelPair=t.makePair=t.getCntOfSpeechLevel=t.setCntOfSpeechLevel=t.getCallById=t.closeSvcDataSocket=t.closeAllSvcRemoteSocket=t.closeSvcRemoteSocket=t.getSvcRender=t.setSvcBFCPVideoRender=t.setSvcLocalVideoRender=t.setSvcRemoteVideoRender=t.svcRedistributeVideoTmmbr=t.resetBFCStatus=t.removeSvcVideoWindow=t.updateSvcVideoWindow=t.addSvcVideoWindow=t.setVideoWindow=t.startData=t.getMicLevel=t.closeAudioPreview=t.openAudioPreview=t.deleteCallObject=t.newCallObject=t.getCallCount=t.transferConfEx=t.delVideo=t.setVideoRender=t.setVideoCollectMode=t.setDisplayRotation=t.setCaptureRotation=t.replyAddVideo=t.activeStopBFCPData=t.switchAudioChannel=t.operateMic=t.setVideoIndex=t.getVideoIndex=t.setSpkIndex=t.setAllSvcVideoWindows=t.setBfcpIsBigWnd=t.getSpkIndex=t.setMicIndex=t.getMicIndex=t.setSpkDeviceVol=t.setMicDeviceVol=t.getSpkDeviceVol=t.getMicDeviceVol=t.getMediaDevices=t.addVideo=t.consultTransfer=t.blindTransfer=t.divertCall=t.unHoldCall=t.holdCall=t.stopPlayMediaFile=t.startPlayMediaFile=t.getMicVol=t.getSpkVol=t.setMicVol=t.setCallReinvite=t.setCallCapability=t.setSpkVol=t.setVideoWHForMode=t.setVideoWH=t.closeDataCanvasSocket=t.closeRemoteCanvasSocket=t.closeLocalCanvasSocket=t.setBFCPVideoRender=t.setLocalVideoRender=t.setRemoteVideoRender=t.setCallNotifyFunc=t.getBasicCallInfoNew=t.dialDTMF=t.endCallService=t.acceptCall=t.startCall=void 0;var r=n(69),o=a(r),i=n(158),c=a(i),l=n(1),s=a(l),u=n(2),d=a(u),f=n(909),p=a(f),h=coreLogger.getLogger("model")("model/callService/index"),C=new p.default,m=(t.startCall=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("startCall isVideo: "+n),e.next=3,C.startCall(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.acceptCall=function(){var e=(0,d.default)(s.default.mark(function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("accept call, callId = "),e.next=3,C.acceptCall(t,n);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.endCallService=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("end call, callId = "+t),e.next=3,C.endCall(t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.dialDTMF=function(e,t,n){return C.dialDTMF(e,t,n)},t.getBasicCallInfoNew=function(e){return h.info("callService, getBasicCallInfoNew, param ="+e),C.getBasicCallInfoNew(e)},t.setCallNotifyFunc=function(){h.info("set call service callback func"),C.setCallNotifyFunc()},t.setRemoteVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r,o,i,l,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>remote winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setRemoteVideoRender unneeded for mobile"),e.abrupt("return");case 4:return n=document.getElementById("remoteCanvas"),n&&n.width&&n.height?h.info("<video>remoteCanvas width = "+n.width+",height = "+n.height):h.error("<video>remoteCanvas is null"),a=t.width,r=t.height,e.next=10,C.calcVideoRealSize(a,r);case 10:return o=e.sent,i=(0,c.default)(o,2),l=i[0],u=i[1],e.next=16,C.setRemoteVideo(n,{getUri:"remote_frame_share",viewW:l,viewH:u});case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setLocalVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r,o,i,l,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>local winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setLocalVideoRender unneeded for mobile"),e.abrupt("return");case 4:return n=document.getElementById("localCanvas"),n&&n.width&&n.height?h.info("<video>localCanvas width = "+n.width+",height = "+n.height):h.error("<video>localCanvas is null"),a=t.width,r=t.height,e.next=10,C.calcVideoRealSize(a,r);case 10:return o=e.sent,i=(0,c.default)(o,2),l=i[0],u=i[1],e.next=16,C.setLocalVideo(n,{getUri:"local_frame_share",viewW:l,viewH:u});case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setBFCPVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>bfcp winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setBFCPVideoRender unneeded for mobile"),e.abrupt("return");case 4:return n=document.getElementById("dataCanvas"),n&&n.width&&n.height?h.info("<video>bfcpCanvas width = "+n.width+",height = "+n.height):h.error("<video>bfcpCanvas is null"),a=t.width,r=t.height,e.next=10,C.setBFCPVideo(n,{getUri:"data_frame_share",viewW:a,viewH:r});case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.closeLocalCanvasSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeLocalCanvasSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,C.closeLocalSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeRemoteCanvasSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeRemoteCanvasSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,C.closeRemoteSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeDataCanvasSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeDataCanvasSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,C.closeDataSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setVideoWH=function(){var e=(0,d.default)(s.default.mark(function e(t,n){var a,r,o,i,l,u,d,f;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("change video WH, videoWinMode = "+t+",width = "+n.width+",height = "+n.height),a=n.width,r=n.height,e.next=5,C.calcVideoRealSize(a,r);case 5:if(o=e.sent,i=(0,c.default)(o,2),l=i[0],u=i[1],!t){e.next=15;break}return d=document.getElementById("remoteCanvas"),e.next=13,C.setRemoteVideoWH(l,u,d);case 13:e.next=18;break;case 15:return f=document.getElementById("localCanvas"),e.next=18,C.setLocalVideoWH(l,u,f);case 18:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setVideoWHForMode=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h.info("setVideoWHForMode, mode: "+t+"lastMode: "+n),0===t?(C.setBFCPDataWH(a.width,a.height),1===n?C.setRemoteVideoWH(r.width,r.height):2===n&&C.setLocalVideoWH(r.width,r.height)):1===t?(C.setRemoteVideoWH(a.width,a.height),0===n?C.setBFCPDataWH(r.width,r.height):2===n&&C.setLocalVideoWH(r.width,r.height)):2===t?(C.setLocalVideoWH(a.width,a.height),1===n?C.setRemoteVideoWH(r.width,r.height):0===n&&C.setBFCPDataWH(r.width,r.height)):h.info("win mode error!!!");case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),t.setSpkVol=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setSpkVol(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setCallCapability=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setCallCapability(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setCallReinvite=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setCallReinvite(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setMicVol=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setMicVol(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getSpkVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getSpkVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getMicVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startPlayMediaFile=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.startPlayMediaFile(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.stopPlayMediaFile=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.stopPlayMediaFile(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.holdCall=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.holdCall(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.unHoldCall=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.unHoldCall(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.divertCall=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.divertCall(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.blindTransfer=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.blindTransfer(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.consultTransfer=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.consultTransfer(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.addVideo=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.addVideo(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMediaDevices=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getMediaDevices(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMicDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getMicDeviceVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getSpkDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getSpkDeviceVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setMicDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setMicDeviceVol(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setSpkDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setSpkDeviceVol(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getMicIndex=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getMicIndex();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setMicIndex=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setMicIndex(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getSpkIndex=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getSpkIndex();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setBfcpIsBigWnd=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setBfcpIsBigWnd(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setAllSvcVideoWindows=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setAllSvcVideoWindows(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setSpkIndex=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setSpkIndex(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getVideoIndex=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getVideoIndex();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setVideoIndex=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setVideoIndex(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.operateMic=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.operateMic(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.switchAudioChannel=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.switchAudioChannel(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.activeStopBFCPData=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.activeStopBFCPData(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.replyAddVideo=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.replyAddVideo(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setCaptureRotation=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setCaptureRotation(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setDisplayRotation=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setDisplayRotation(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setVideoCollectMode=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setVideoCollectMode(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("call service setVideoRender"),e.next=3,C.setVideoRender(t,n,a,r,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.delVideo=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.delVideo(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.transferConfEx=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.transferConfEx(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCallCount=function(){return C.getCallCount()},t.newCallObject=function(e,t){C.newCallObject(e,t)},t.deleteCallObject=function(e){C.deleteCallObject(e)},t.openAudioPreview=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.openAudioPreview();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeAudioPreview=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.closeAudioPreview();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicLevel=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getMicLevel();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startData=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("start data, callId = "),e.next=3,C.startData(t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setVideoWindow=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setVideoWindow(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.addSvcVideoWindow=function(e,t,n,a,r){return C.addSvcVideoWindow(e,t,n,a,r)},t.updateSvcVideoWindow=function(e,t,n){return C.updateSvcVideoWindow(e,t,n)},t.removeSvcVideoWindow=function(e,t,n,a){return C.removeSvcVideoWindow(e,t,n,a)},t.resetBFCStatus=function(e,t){return C.resetBFCStatus(e,t)},t.svcRedistributeVideoTmmbr=function(e){return h.info("svcRedistributeVideoTmmbr"),C.svcRedistributeVideoTmmbr(e)},t.setSvcRemoteVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){var r,i,c;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("[SVC TupRender2]setSvcRemoteVideoRender,renderID =  "+t+",renderURI = "+n+" ,renderSize = "+(0,o.default)(a)),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setSvcRemoteVideoRender unneeded for mobile"),e.abrupt("return");case 4:if(!((r=document.getElementById(t))&&r.width&&r.height)){e.next=9;break}h.info("[SVC TupRender2]setSvcRemoteVideoRender,svcRemoteCanvas width = "+r.width+",height = "+r.height),e.next=11;break;case 9:return h.error("[SVC TupRender2]setSvcRemoteVideoRender,svcRemoteCanvas is null,return"),e.abrupt("return");case 11:return i=a.width,c=a.height,e.next=15,C.setSvcRemoteVideo(t,r,{getUri:n,viewW:i,viewH:c});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setSvcLocalVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("[SVC TupRender2]setSvcLocalVideoRender renderSize = "+(0,o.default)(t)),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setSvcLocalVideoRender unneeded for mobile"),e.abrupt("return");case 4:if(!((n=document.getElementById("-1"))&&n.width&&n.height)){e.next=9;break}h.info("[SVC TupRender2]setSvcRemoteVideoRender,svcLocalCanvas width = "+n.width+",height = "+n.height),e.next=11;break;case 9:return h.error("[SVC TupRender2]setSvcRemoteVideoRender,svcLocalCanvas is null,return"),e.abrupt("return");case 11:return a=t.width,r=t.height,e.next=15,C.setSvcLocalVideo(-1,n,{getUri:"local_frame_share",viewW:a,viewH:r});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setSvcBFCPVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r,i,c,l;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>bfcp winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setSvcBFCPVideoRender unneeded for mobile"),e.abrupt("return");case 4:if(!((n=document.getElementById("dataCanvas"))&&n.width&&n.height)){e.next=9;break}h.info("<video>bfcpCanvas width = "+n.width+",height = "+n.height),e.next=11;break;case 9:return h.error("<video>bfcpCanvas is null"),e.abrupt("return");case 11:return a=coreConf.getSvcAttendanceManager().getBigCanvasSize(),r={},i=$getState().conf.bfcpFrameSize,isNullOrEmpty(i)?(h.info("svc bfcpFrameSize is null"),r=v(t,a.width,a.height)):(h.info("svc bfcpFrameSize is ",i),r=m(i,a.width,a.height),h.info("bfcpSize = ",r)),c=r.width,l=r.height,n.width=c,n.height=l,h.info("winSize==",(0,o.default)(t)),h.info("bfcpCanvas=="+n.width+n.height),e.next=23,C.setSvcBFCPVideo(n,{getUri:"data_frame_share",viewW:c,viewH:l});case 23:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(e,t,n){var a=e.width/e.height;return a>=1?t>=n&&t/n>a?{width:Math.floor(n*a),height:n}:{width:t,height:Math.floor(t/a)}:t>=n?{width:Math.floor(n*a),height:n}:t/n>a?{width:Math.floor(n*a),height:n}:{width:t,height:Math.floor(t/a)}}),v=function(e,t,n){var a=(coreConf.getSvcAttendanceManager().getBigCanvasSize(),{width:0,height:0});if(e.width<t&&e.height<n)return a={width:e.width,height:e.height},h.info("newCanvasSize=",(0,o.default)(a),e,t,n),a;if(e.width>=t&&e.height<n)a={width:t,height:Math.floor(e.height/e.width*t)};else if(e.width<t&&e.height>=n)a={width:Math.floor(e.width/e.height*n),height:n};else{var r=e.width/t,i=e.height/n;a=r>i?{width:t,height:Math.floor(e.height/e.width*t)}:{width:Math.floor(e.width/e.height*n),height:n}}return a};t.getSvcRender=function(e){return h.info("getSvcRender"),p.default.getRemoteSvcRender(e)},t.closeSvcRemoteSocket=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeSvcRemoteSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,C.closeSvcRemoteSocket(t);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.closeAllSvcRemoteSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeAllSvcRemoteSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,C.closeAllSvcRemoteSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeSvcDataSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeAllSvcRemoteSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,C.closeSvcDataSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getCallById=function(e){return p.default.CallList[e]||{}},t.setCntOfSpeechLevel=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setCntOfSpeechLevel(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCntOfSpeechLevel=function(){var e=(0,d.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getCntOfSpeechLevel(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.makePair=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.makePair(t,n,a,r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),t.cancelPair=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.cancelPair(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairSubscribe=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.pairSubscribe(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairLinkage=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.pairLinkage(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.pairLinkageLeave=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.pairLinkageLeave(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairLinkageEnd=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.pairLinkageEnd(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairEnable=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.pairEnable(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairPermit=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r,o,i,c,l){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.pairPermit(t,n,a,r,o,i,c,l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r,o,i,c,l){return e.apply(this,arguments)}}(),t.setTUPCallCfg=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setTUPCallCfg(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.callJointStartLinkage=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.callJointStartLinkage();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.callJointStopLinkage=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.callJointStopLinkage();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setBandwidth=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setBandwidth(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCallInfoByCallId=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getCallInfoByCallId(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setEncoderMaxCap=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r,o){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setEncoderMaxCap(t,n,a,r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),t.sendUniversalInfo=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.sendUniversalInfo(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setDataBandwidth=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.setDataBandwidth(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.getCallBandwidth=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getCallBandwidth(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.assignBandwidthForData=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.assignBandwidthForData(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.createCallId=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.createCallId(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.startPickupCall=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.startPickupCall(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getCameraCtrl=function(e){return C.getCameraCtrl(e)},t.getMicCtrl=function(e){return C.getMicCtrl(e)},t.getSpkCtrl=function(e){return C.getSpkCtrl(e)},t.clearAllDeviceCtrl=function(e){C.clearAllDeviceCtrl(e)}},808:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.rejectPickupCall=t.acceptPickupCall=t.handleCallPickupRemoteInfo=t.handleCallPickupNotify=t.handleNotifyCallBeenHangup=t.resetCallInfo=t.IsDialingCallInfo=t.transferNumberToName=t.setTransferFlagHandle=t.changeCallHoldStatusLogic=t.refreshCallPage=t.blindTranseferEntrance=t.getIsTransFer=t.consultTransfer=t.resumeCall=t.hangupHoldCall=t.getCallInfoByCallId=t.changeDirectionForMobile=t.dealPassiveDirectionResult=t.doAfterSimCall=t.recallOrHangup=t.stopBfcpReceive=t.handleDeviceHowlStatus=t.handleUpdateSvcRender=t.handleSvcVideoWindows=t.handleSeessionModify=t.handleModifyVideoResult=void 0,t.switchToAudio=t.switchToVideo=t.holdCall=t.removeVideo=t.updateToVideo=t.getCallMediaInfo=t.getCallMediaInfoBySsrc=t.handleisSvcConfShowQOS=t.getCallMediaInfoOfNative=t.getCallMediaInfoOnMobile=t.resumeUserSelect=t.setUserSelectToNone=t.SipRegusterNotOK=t.SipRegusterOKMobile=t.callAfterPCKickout=t.sipRegResultNotify=t.startsipcallout=t.handleDataStopped=t.handleDataSending=t.handleDataStartError=t.changeNoStreamEndcall=t.handleNoStream=t.handleSpkMicList=t.handleCameraList=t.handlelowCallLocalQos=t.actionDialDTMF=t.produceCallMemberList=t.closeRemoteSocketWhenCallEnd=t.endCall=t.callDestroy=t.callInfo=t.callEnded=t.callRecordSave=t.updateHoldCallList=t.callOutGoing=t.callInComming=t.acceptCall=t.configMsDataConf=t.setCallReinvite=t.setcallcapability=t.setVoiceValue=t.switchAudioChannel=t.muteMicAndSpeaker=t.callLocalQos=t.onCallAtdTransferFailed=t.onCallAtdTransferSuccess=t.onCallUnHoldFailed=t.onCallUnHoldSuccess=t.onCallHoldFailed=t.onCallHoldSuccess=t.handleCallRingBack=t.getSpkValue=t.getMicValue=t.setMicValue=t.addVideoRequest=t.delVideoRequest=t.getBasicBandInfo=t.rejectUpdateToVideo=t.acceptUpdateToVideo=t.callJointEstablishedNotify=t.callConnected=t.getInfoList=t.showMediaInfo=t.toggleSmallPageWhenCall=t.setNoMoveTrue=t.checkHasCall=t.changeNotifyContent=t.showConfirmChairNotify=t.showConfirmNotify=t.clearCallOutTimer=t.callHangup=t.dealSipLoginCheck=t.callMultiTerminalCheck=t.handleErr=t.handleMobile=t.handleVideoCall=t.handleAudioCall=t.handlePairCallResult=t.pairCallOut=t.CallOut=t.setVoiceMailInfo=t.checkBeforeCallOut=t.Call2GNet=t.onekeyMobileCallOut=t.CalloutForTempConf=t.getCameraDevices=t.getSpkDevices=t.getMicDevices=t.getALLDevices=t.getCallList=t.setNotifyInfo=t.checkCallOutEnable=t.changeNotify=t.showBrowserWindow=t.dataTipsShowBrowserWindow=t.dataConfShowBrowserWindow=t.pickiupBrowserWindow=t.newCallNotifyshowBrowserWindow=t.notifyshowBrowserWindow=t.registerCallEvent=void 0;var r=n(172),o=a(r),i=n(142),c=a(i),l=n(69),s=a(l),u=n(135),d=a(u),f=n(3),p=a(f),h=n(1),C=a(h),m=n(2),v=a(m),w=n(807),I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(w),g=n(911),_=n(912),S=n(1715),b=coreLogger.getLogger("logic")("call/audio/index"),N=null,E=null,k=null,y=0,T=0,x=null,O=null,L=[],M={},R="",A=null,F=null,V=null;window.otherAudioDevicesConnect=!1;var D=(t.registerCallEvent=function(){b.info("registerCallEvent, Observer subscribe topics");var e=new coreCommon.ObserverOpts("MODULE_CALL_START_END");I.setCallNotifyFunc(),coreCommon.Observer.subscribe("CallIncomming",Ae,e),coreCommon.Observer.subscribe("CallOutGoing",Fe,e),coreCommon.Observer.subscribe("CallEnded",Ue,e),coreCommon.Observer.subscribe("callInfo",Be),coreCommon.Observer.subscribe("CallDestroy",$e,e),coreCommon.Observer.subscribe("CallConnected",le,e),coreCommon.Observer.subscribe("CallLocalQos",Le),coreCommon.Observer.subscribe("CallRingBack",ge),coreCommon.Observer.subscribe("CallHoldSuccess",_e),coreCommon.Observer.subscribe("CallHoldFailed",Se),coreCommon.Observer.subscribe("CallUnHoldSuccess",be),coreCommon.Observer.subscribe("CallUnHoldFailed",Ne),coreCommon.Observer.subscribe("CallAtdTransferFailed",ke),coreCommon.Observer.subscribe("CallAtdTransferSuccess",Ee),coreCommon.Observer.subscribe("CallUpateRemoteInfo",$t),coreCommon.Observer.subscribe("AddVideoRequest",me),coreCommon.Observer.subscribe("DelVideoRequest",Ce),coreCommon.Observer.subscribe("CallRTPCreated",qe),coreCommon.Observer.subscribe("handleNoStream",Je),coreCommon.Observer.subscribe("HandleSpkMicList",je),coreCommon.Observer.subscribe("HandleCameraList",ze),coreCommon.Observer.subscribe("CallModifyVideoResult",vt),coreCommon.Observer.subscribe("CallSessionModify",wt),coreCommon.Observer.subscribe("SvcVideoWindows",It),coreCommon.Observer.subscribe("DeviceHowlStatus",_t),coreCommon.Observer.subscribe("MediaSRTPStatus",St),coreCommon.Observer.subscribe("handleSipKickOff",Ke),coreCommon.Observer.subscribe("handleUploadChrFile",Kt),coreCommon.Observer.subscribe("lowCallLocalQos",We),coreCommon.Observer.subscribe("handleDataStartError",Qe),coreCommon.Observer.subscribe("handleDataSending",Ze),coreCommon.Observer.subscribe("BFCPDataStopRec",Xe),coreCommon.Observer.subscribe("updateSvcRender",gt),coreCommon.Observer.subscribe("handleSpeechLevelReport",yt),coreCommon.Observer.subscribe("pairClosedNotify",coreConf.pairClosedNotify),coreCommon.Observer.subscribe("pairSubscribeNotify",coreConf.pairSubscribeNotify),coreCommon.Observer.subscribe("pairCallStateNotify",coreConf.pairCallStateNotify),coreCommon.Observer.subscribe("pairLinkageConfNotify",coreConf.pairLinkageConfNotify),coreCommon.Observer.subscribe("pairLinkageConfStateNotify",coreConf.pairLinkageConfStateNotify),coreCommon.Observer.subscribe("pairInviteJoinConf",coreConf.pairInviteJoinConf),coreCommon.Observer.subscribe("newServiceRightNotify",coreUi.newServiceRightNotify),coreCommon.Observer.subscribe("callJointStartNotify",coreUi.callJointStartNotify),coreCommon.Observer.subscribe("callJointCloseNotify",coreUi.callJointCloseNotify),coreCommon.Observer.subscribe("callJointOffLineNotify",coreUi.callJointOffLineNotify),coreCommon.Observer.subscribe("callJointOffHookNotify",coreUi.callJointOffHookNotify),coreCommon.Observer.subscribe("callJointEstablishedNotify",se),coreCommon.Observer.subscribe("callJointOutGoingNotify",coreUi.callJointOutGoingNotify),coreCommon.Observer.subscribe("callJointOnlineNotify",coreUi.callJointOnlineNotify),coreCommon.Observer.subscribe("callJointPeerCapsReportNotify",coreUi.callJointPeerCapsReportNotify),coreCommon.Observer.subscribe("PassiveDirectionResult",Tt),coreCommon.Observer.subscribe("receivePairReqNotify",coreConf.receivePairReqNotify),coreCommon.Observer.subscribe("pairedOrCanceledResultNotify",coreConf.pairedOrCanceledResultNotify),coreCommon.Observer.subscribe("CallBldTransferFailed",Dt),coreCommon.Observer.subscribe("CallBldTransferSuccess",Ut),coreCommon.Observer.subscribe("SipAccountWmi",coreUi.sipAccountWmiNotify),coreCommon.Observer.subscribe("setTransferModify",Bt),coreCommon.Observer.subscribe("handleUniversalInfoNotify",D),coreCommon.Observer.subscribe("meetingHWstartCallFailed",zt),coreCommon.Observer.subscribe("CallBeenHangup",jt),coreCommon.Observer.subscribe("handleCallPickupNotify",Jt),coreCommon.Observer.subscribe("handleCallPickupRemoteInfo",Yt),coreCommon.Observer.subscribe("beTransferToConfToVideo",qt)},function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.isHubEnv){e.next=5;break}return e.next=3,coreConf.handleServerUniversalInfoNotify(t);case 3:e.next=7;break;case 5:return e.next=7,coreConf.handleClientUniversalInfoNotify(t);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),U=(t.notifyshowBrowserWindow=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.require("electron").screen,a=n.getDisplayNearestPoint(n.getCursorScreenPoint()).workArea;t?(e.setBounds({x:a.width,y:a.height-constant.VIDEO_EXTRA_SIZE.HEIGHT,width:constant.VIDEO_EXTRA_SIZE.WIDTH,height:constant.VIDEO_EXTRA_SIZE.HEIGHT}),e.setPosition(a.width-constant.VIDEO_EXTRA_SIZE.WIDTH,a.height-constant.VIDEO_EXTRA_SIZE.HEIGHT,!0)):(e.setBounds({x:a.width,y:a.height-80,width:300,height:80}),e.setPosition(a.width-320,a.height-100,!0),e.setSize(300,80)),e.showInactive()},t.newCallNotifyshowBrowserWindow=function(e){e.showInactive()},t.pickiupBrowserWindow=function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],window.require("electron").screen),n=t.getDisplayNearestPoint(t.getCursorScreenPoint()).workArea;e.setBounds({x:n.width,y:n.height,width:280,height:187}),e.setPosition(n.width-300,n.height-207,!0),e.showInactive()},t.dataConfShowBrowserWindow=function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],window.require("electron").screen),n=t.getDisplayNearestPoint(t.getCursorScreenPoint()).workArea,a="requestPrivilege"===window.$getState().notify.notifyUserInfo.type,r=void 0,o=void 0;a?(r=250,o=126):(r=250,o=92),e.setBounds({x:n.width,y:n.height-o,width:r,height:o}),e.setPosition(n.width-r-20,n.height-o-20,!0),e.showInactive()},t.dataTipsShowBrowserWindow=function(e){var t=window.require("electron").screen,n=t.getDisplayNearestPoint(t.getCursorScreenPoint()).workArea,a=void 0,r=void 0;a=250,r=92,e.setBounds({x:n.width,y:n.height-r,width:a,height:r}),e.setPosition(n.width-a-20,n.height-r-20,!0),e.showInactive()},t.showBrowserWindow=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.require("electron").screen,a=n.getDisplayNearestPoint(n.getCursorScreenPoint()).workArea;t?(e.setBounds({x:a.width,y:a.height-176,width:320,height:176}),e.setPosition(a.width-320,a.height-176,!0)):(e.setBounds({x:a.width,y:a.height-160,width:322,height:160}),e.setPosition(a.width-322,a.height-160,!0)),e.showInactive()},t.changeNotify=function(e){$dispatch(coreUi.changeNotifyInfo(e))}),B=t.checkCallOutEnable=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreAccount.getLoginModel();case 2:return n=e.sent,a=$getState(),r="",o=$getState(),i=o.conf.confTempAcsAccount,window.isOffline&&(!isNullOrEmpty(i)||a.login.sipLoginOnly||(b.error("offline, can not create conf"),r=language.CALL_FAILED_OFFLINE)),c=n.isSipRegSuc(),c||(b.error("sip register failed, can not start call"),(!n.isMobile||n.isMobile&&!$getState().login.isMultiDeviceLogined)&&coreAccount.sipResume({message:"checkCallOutEnable"})),e.next=11,n.checkSipState();case 11:if(r=n.isSipRegSuc()?r:language.THE_NETWORK_IS_ABNORMAL,t||(r=language.NOT_EMPTYNO,b.error("callNum is null, = "+handlePhoneNumber(t))),a.myInfo.bind_no===t&&(r=language.CONFIRM_MYNO,b.error("callNum is self bindNum, = "+handlePhoneNumber(t))),l||coreConf.isInReCall()||!a.call.showCallToolBar&&"CALL_INCOMING"!==a.call.callStatus&&"VIDEO_CONNECTED"!==a.call.callStatus&&"CALL_CONNECTED"!==a.call.callStatus&&"CALL_OUT"!==a.call.callStatus&&"VIDEO_OUT"!==a.call.callStatus||(r=language.PREVENT_TWO_CALLS,L.length>0&&(r=language.CALL_NOT_OUT_CALL_MORE),b.error("already exit a call, showCallToolBar = "+a.call.showCallToolBar+" callStatus = "+a.call.callStatus)),r!==language.THE_NETWORK_IS_ABNORMAL||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=18;break}return s&&window.confirm(language.THE_NETWORK_IS_ABNORMAL+language.FEEDBACK_MESSAGE_TIPS,{rightButton:language.FEEDBACK}).then(function(e){e.ret&&coreCommon.quickSubmitFeedback(constant.QUICK_FEEDBACK_KEYWORDS.SIP_NOT_REG_ERROR,language.THE_NETWORK_IS_ABNORMAL)}),e.abrupt("return",S.CALL_ERR.NET_ERROR);case 18:if(""===r){e.next=21;break}return window.CLIENTCONFIG.ISMOBILE?s&&alert(r):s&&window.Toast(r,2,!1,"WhiteWarning"),e.abrupt("return",{code:5010,msg:r});case 21:return e.abrupt("return",S.CALL_ERR.SUCCESS);case 22:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),$=t.setNotifyInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2],a=$getState().call.notifyInfo;return a.ContentNotify=e,a.showCtrl=t,a.nameclass=n||a.nameclass,a},P=(t.getCallList=function(e,t){var n=ie(e,t);if(0===n.length){var a=$getState().call.notifyInfo;return a.ContentNotify=language.CALLING_NO_NUMBER,a.showCtrl=!1,U(a),ae(!0,2e3),!1}return n},t.getALLDevices=function(){var e=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=9;break}return e.next=3,P();case 3:return e.next=5,G();case 5:return e.next=7,W();case 7:e.next=11;break;case 9:return e.next=11,p.default.all([P(),G(),W()]);case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicDevices=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMediaDevices(0);case 2:t=e.sent,0===t.result?(b.info("micDevicesList success = ."),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(0!==t.param.devicenum?$dispatch(coreUi.changeMicDevicesList(t.param.deviceinfo)):$dispatch(coreUi.changeMicDevicesList([])),$dispatch(coreUi.changeMicCount(t.param.devicenum))):(0!==t.param.device_num?$dispatch(coreUi.changeMicDevicesList(t.param.array)):$dispatch(coreUi.changeMicDevicesList([])),$dispatch(coreUi.changeMicCount(t.param.device_num)))):b.info("micDevicesList failed");case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),G=t.getSpkDevices=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMediaDevices(1);case 2:t=e.sent,0===t.result?(b.info("spkDevicesList success = ."),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(0!==t.param.devicenum?$dispatch(coreUi.changeSpkDevicesList(t.param.deviceinfo)):$dispatch(coreUi.changeSpkDevicesList([])),$dispatch(coreUi.changeSpkCount(t.param.devicenum))):(0!==t.param.device_num?$dispatch(coreUi.changeSpkDevicesList(t.param.array)):$dispatch(coreUi.changeSpkDevicesList([])),$dispatch(coreUi.changeSpkCount(t.param.device_num)))):b.info("spkDevicesList failed");case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),W=t.getCameraDevices=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMediaDevices(2);case 2:t=e.sent,0===t.result?(b.info("cameraDevicesList success ."),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?0!==t.param.devicenum?($dispatch(coreUi.setVideoNum(t.param.devicenum)),$dispatch(coreUi.changeCameraDevicesList(t.param.deviceinfo))):$dispatch(coreUi.changeCameraDevicesList([])):0!==t.param.device_num?($dispatch(coreUi.setVideoNum(t.param.device_num)),$dispatch(coreUi.changeCameraDevicesList(t.param.array))):$dispatch(coreUi.changeCameraDevicesList([]))):b.info("cameraDevicesList failed");case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),H=(t.CalloutForTempConf=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];b.info("CalloutForTempConf: confAcsId : "+e+", confAcsNum: "+handlePhoneNumber(t)),coreConf.oneKeyEnterConf(t,e,n,a)},t.onekeyMobileCallOut=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a,r,o,i,c,l,s,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={bConf:!1,oneKeyEnterConf:!0,bVideo:u,number:t,contactInfo:n},window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=9;break}return e.next=4,coreUi.checkMobileMultiDevice(a);case 4:if(!0!==(r=e.sent)){e.next=9;break}return b.info("multi device logined, return"),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_CONF_JOIN,extraTrackKey:null,resultParams:[0]}),e.abrupt("return");case 9:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=16;break}return e.next=12,ee();case 12:if(o=e.sent,window.requestMultiTerminalPromise=null,!o){e.next=16;break}return e.abrupt("return");case 16:if(!1!==window.skipLogin){e.next=25;break}return e.next=19,B(t,n);case 19:if(i=e.sent,0===i.code){e.next=23;break}return coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_CONF_JOIN,extraTrackKey:null,resultParams:[0]}),e.abrupt("return");case 23:e.next=31;break;case 25:return e.next=27,z(u);case 27:if(!e.sent){e.next=31;break}if(d){e.next=31;break}return coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_CONF_JOIN,extraTrackKey:null,resultParams:[0]}),e.abrupt("return");case 31:return b.info("onekeyMobileCallOut"),$dispatch(coreUi.changeUserInfo(n)),$dispatch(coreUi.changeCallNum(t)),u?$dispatch(coreUi.changeCallStatus("VIDEO_OUT")):$dispatch(coreUi.changeCallStatus("CALL_OUT")),c=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==c&&!d&&(b.info("onekeyMobileCallOut go callmain"),window.goRoute("callMain"),l=getContactName(n),s=language.METTING,$dispatch(coreUi.createConfTipMsg([s]))),e.next=39,coreConf.getConfInfo(n.conf_id,n.cycle_conf_id);case 39:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),z=t.Call2GNet=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return",!1);case 2:if(window.netWorkType!==constant.NETWORK_TYPE.TYPE_2G){e.next=5;break}return e.next=5,window.getCurrentNetWorkType();case 5:if(!t||window.netWorkType!==constant.NETWORK_TYPE.TYPE_2G){e.next=9;break}return b.info("The network type is 2G. not support video "),window.isPluginEnv||alert(language.CALL_2G_NETWORK_NOT_SUPPORT_VIDEO),e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),j=t.checkBeforeCallOut=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}return e.next=3,coreUi.checkMobileMultiDevice(t);case 3:if(!0!==(n=e.sent)){e.next=7;break}return b.info("multi device logined, return"),e.abrupt("return",S.CALL_ERR.MULTI_DEVICE_LOGIN);case 7:if(window.skipLogin){e.next=13;break}return e.next=10,B(t.number,t.isConsultTransfer,c);case 10:if(a=e.sent,0===a.code){e.next=13;break}return e.abrupt("return",a);case 13:return e.next=15,z(t.bVideo);case 15:if(!e.sent){e.next=17;break}return e.abrupt("return",S.CALL_ERR.NET_2G);case 17:if(!t.isConsultTransfer){e.next=34;break}if(!O||O.callState===constant.CALL_STATE.CALL_E_CALL_STATE_END){e.next=25;break}if(!t.bVideo){e.next=22;break}return c&&window.ToastNew(language.PREVENT_CONFERENCE_AFTER_CALL,2),e.abrupt("return",S.CALL_ERR.EXIST_CALL);case 22:if(!O.isVideo){e.next=25;break}return c&&window.ToastNew(language.CALL_NOT_OUT_VIDEO_CALL_MORE,2),e.abrupt("return",S.CALL_ERR.IN_VIDEO);case 25:if(!(L.length+1>=constant.CALL_CONST.MAX_CALL_LENGTH)){e.next=28;break}return c&&window.ToastNew(language.CALL_NOT_OUT_CALL_MORE,2),e.abrupt("return",S.CALL_ERR.EXIST_CALL);case 28:if(Lt(t.number)){e.next=32;break}return b.info("this call num is already in call"),c&&window.ToastNew(language.ALREADY_IN_CALL,2),e.abrupt("return",S.CALL_ERR.CALL_MORE);case 32:if(!O||O.callState!==constant.CALL_STATE.CALL_E_CALL_STATE_OUT){e.next=34;break}return e.abrupt("return",S.CALL_ERR.CALL_NUM_MORE);case 34:if(e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=39;break}return e.next=38,window.isSimCardCall();case 38:e.t0=e.sent;case 39:if(!(r=e.t0)){e.next=44;break}return b.info("checkBeforeCallOut now is in sim card call"),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?window.itWeLinkNotifyCallEnded(0,language.PLEASE_HANG_UP_CALL):c&&alert(language.PLEASE_HANG_UP_CALL),e.abrupt("return",S.CALL_ERR.IN_SIM_CALL);case 44:return e.next=46,(0,g.callPermissionCheck)(t.bVideo);case 46:if(o=e.sent,window.requestPermissionPromise&&(window.requestPermissionPromise=null),o){e.next=51;break}return b.info("do not have permission for call"),e.abrupt("return",S.CALL_ERR.NO_PERMISSION);case 51:if(i=!0,!t.bVideo||coreConf.isInReCall()||$getState().login.sipLoginOnly||!c){e.next=56;break}return e.next=55,(0,g.createVideoPreCheck)();case 55:i=e.sent;case 56:if(i){e.next=60;break}return window.CLIENTCONFIG.ISMOBILE&&(b.info("<video>mobile is 3G/4G, user cancel continue video out"),"callMain"===window.getRoute()?history.back():"mConfMemberPage"===window.getRoute()&&window.goRoute("main/conference")),b.info("<video>mobile is 3G/4G,user cancel continue video out"),e.abrupt("return",S.CALL_ERR.USER_CANCEL);case 60:return e.abrupt("return",S.CALL_ERR.SUCCESS);case 61:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),J=t.setVoiceMailInfo=function(e,t){b.info("callOut of set voice mail info");var n=$getState().call.voiceMailNum,a=null;return e===n&&(a=coreContact.getTempCallUserInfo(n,language.VOICE_MAIL_BOX,!0)),{info:a,is_video:!1,is_prompt:t}},Y=t.CallOut=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a,r,o,i,c,l,s,u,d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null),p=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("start call ,isVideo = "+d+" callnum = "+handlePhoneNumber(t)+" isConsultTransfer = "+p),$dispatch(coreUi.changeIsConsultTransfer(p)),coreConf.setServerIp&&coreConf.setServerIp(""),coreUi.showSearchPanel(!1),$dispatch(coreUi.changeHasSentState(!1)),a=$getState().call.voiceMailNum,t===a&&(r=J(t,d),n=r.info,d=r.is_video,r.is_prompt&&(window.CLIENTCONFIG.ISMOBILE?alert(language.VIDEO_PERMISSIONS_ARE_RESTRICTED):window.Toast(language.VIDEO_PERMISSIONS_ARE_RESTRICTED,2,!1,null))),o=$getState().call.initiativeHoldCall,b.info("Call Out isCallHold: "+o),i={bConf:!1,bVideo:d,number:t,contactInfo:n,isConsultTransfer:p||o},b.info("call out isVmFlag = "+(n&&n.isVmFlag)),window.CLIENTCONFIG.ISBIGWIN&&(coreConf.getSvcAtdManager().closeVideoFrame(),coreConf.getSvcAtdManager().closeBfcpFrame()),e.next=14,j(i,h);case 14:if(c=e.sent,0===c.code){e.next=19;break}return window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyJoinConfFailedEx(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0)))),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(b.info("[IT-meeting] meetingHW callHangup"),window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)),e.abrupt("return",c);case 19:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=26;break}return e.next=22,ee();case 22:if(l=e.sent,window.requestMultiTerminalPromise=null,!l){e.next=26;break}return e.abrupt("return",S.CALL_ERR.MULTI_DEVICE_LOGIN);case 26:if($dispatch(coreUi.saveCalleeInfo({})),coreConf.handleIsShowJoinButton(!1),window.webView&&d&&window.webView.initCallVideo(),d?$dispatch(coreUi.changeCallStatus("VIDEO_OUT")):$dispatch(coreUi.changeCallStatus("CALL_OUT")),!1!==window.skipLogin){e.next=38;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=36;break}return e.next=34,it(n,!0,!0);case 34:e.next=38;break;case 36:return e.next=38,it(n,!1,!0);case 38:if(s=null,!f){e.next=44;break}I.newCallObject(f.call_id,d),s={param:{call_id:f.call_id}},e.next=47;break;case 44:return e.next=46,I.startCall({tel_num:t,addr_vip:n.addr_vip||""},d);case 46:s=e.sent;case 47:if(!s){e.next=53;break}return e.next=50,q(s,i);case 50:return e.abrupt("return",S.CALL_ERR.SUCCESS);case 53:return X(),window.CLIENTCONFIG.ISMOBILE&&"callMain"===(u=window.getRoute())&&(b.info("callmain page, start call failed"),window.stayCallMainPageNotify(!1),history.back()),window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyJoinConfFailedEx(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0)))),e.abrupt("return",S.CALL_ERR.OTHER);case 57:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),q=(t.pairCallOut=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("BLE: start pairCallOut"),coreUi.showSearchPanel(!1),n=t.access_number,!1!==window.skipLogin){e.next=10;break}return e.next=6,B(n,!1);case 6:if(a=e.sent,0===a.code){e.next=10;break}return b.info("BLE: pairCallOut access number is invalid"),e.abrupt("return");case 10:return $dispatch(coreUi.saveCalleeInfo({})),coreConf.handleIsShowJoinButton(!1),$dispatch(coreUi.changeCallStatus("CALL_OUT")),$dispatch(coreUi.changeEnterConfState(!0)),e.next=16,coreConf.startPairMeeting(t);case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.handlePairCallResult=function(){b.info("BLE: enter handlePairCallResult");var e=$getState(),t=e.synergismInfo.pairConfInfo,n=e.contactGroups.contact_status_map,a=e.myInfo,r=a.account,o=a.statusDesc;$dispatch(coreUi.changeOldStatus(n[r]&&n[r].status,o)),b.info("handlePairCallResult changeOldStatus = ",n[r]&&n[r].status,",desc:",o),$dispatch(coreUi.changeUserInfo({number:t.access_number})),$dispatch(coreUi.changeCallNum(t.access_number)),(0,g.changeScreenState)("middle"),b.info("handlePairCallResult,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),bt(constant.ONLINE_STATUS.BUSY,"Calling");var i=0!=(t.media_type&constant.CONF_MEDIATYPE.CONF_MEDIATYPE_FLAG_VIDEO)||0!=(t.media_type&constant.CONF_MEDIATYPE.CONF_MEDIATYPE_FLAG_HDVIDEO),c=void 0;if(i?c="VIDEO_OUT":(c="CALL_OUT",$dispatch(coreUi.changeCallToolBarShowStatus(!0))),$dispatch(coreUi.changeCallStatus(c)),window.CLIENTCONFIG.ISMOBILE){var l=t.conf_id;$dispatch(coreUi.changeCallId(l)),"ios"===window.CLIENTCONFIG.PLATFORM&&window.callStatusChangeNotify(l,c,!0);if("callMain"!==window.getRoute()){b.info("handlePairCallResult go callmain"),window.goRoute("callMain");var s=language.METTING;$dispatch(coreUi.createConfTipMsg([s]))}}},function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a,r,o,i,c,l;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$getState(),r=a.contactGroups.contact_status_map,o=a.myInfo,i=o.account,c=o.statusDesc,L.length<1&&(b.info("start call success handleCallResult changeOldStatus = "+(r[i]&&r[i].status)+",desc:"+c),$dispatch(coreUi.changeOldStatus(r[i]&&r[i].status,c))),O&&(O.userInfo=n.contactInfo,O.callNo=n.number),$dispatch(coreUi.changeUserInfo(n.contactInfo)),$dispatch(coreUi.changeCallNum(n.number)),(0,g.changeScreenState)("middle"),b.info("handleCallResult,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),bt(constant.ONLINE_STATUS.BUSY,"Calling"),$dispatch(coreUi.changeCallId(t.param.call_id)),!n.bVideo){e.next=19;break}if(!(l=$getState().phoneLinkage.isEnablePLA)){e.next=15;break}K(t.param.call_id),e.next=17;break;case 15:return e.next=17,Q(t.param.call_id);case 17:e.next=20;break;case 19:K(t.param.call_id);case 20:return b.info("video or video conf open speaker outer : "+window.otherAudioDevicesConnect),n.bVideo&&!window.otherAudioDevicesConnect?coreCommon.SpkControl.getInstance().setHandsFree(!0):coreCommon.SpkControl.getInstance().setHandsFree(!1),Z(n.contactInfo,t.param.call_id,n.enterConfParam),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&window.CLIENTCONFIG.ISMOBILE&&(b.info("callOut timer begin"),y=setTimeout(function(){"CALL_OUT"===$getState().call.callStatus&&""!==$getState().call.callId&&(b.info("debug info call out show toast!"),window.Toast(language.JOIN_CONF_LONG_TIME_TIP,3,null,!1))},2e4)),e.abrupt("return",!0);case 25:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),K=t.handleAudioCall=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeCallStatus("CALL_OUT")),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t,"CALL_OUT");case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Q=t.handleVideoCall=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$dispatch(coreUi.changeCallStatus("VIDEO_OUT"));case 2:if(b.info("<video>dispatch,changeCallStatus,value = VIDEO_OUT"),!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}window.callStatusChangeNotify(t,"VIDEO_OUT"),e.next=24;break;case 7:if(window.CLIENTCONFIG.ISBIGWIN){e.next=24;break}if(n={set_window_title:{title:$getState().call.userInfo.name}},a=(0,d.default)({},n),a.set_window_title.title=handlePhoneNumber(a.set_window_title.title),b.info("set_window_title is",a),!window.CLIENTCONFIG.ISWIN){e.next=19;break}return b.info("Native初始化本地视频界面"),b.info("cwp init initCallInterface joinConf "),e.next=17,coreConf.initCallInterface(t,1,1);case 17:e.next=24;break;case 19:return r=(0,g.getBigContainerSize)(),r=(0,g.calcRealVideoSize)({width:16,height:9},r),$dispatch(coreUi.changeBigWinStyle(r)),e.next=24,I.setLocalVideoRender(r);case 24:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Z=t.handleMobile=function(e,t,n){var a=window.getRoute();if(window.CLIENTCONFIG.ISMOBILE&&"callMain"!==a){b.info("handleMobile go callmain"),window.goRoute("callMain");var r=getContactName(e),o=language.ON_CALLING.format(r);n&&(o=language.METTING),$dispatch(coreUi.createConfTipMsg([o]))}},X=t.handleErr=function(){$dispatch(coreUi.changeCallStatus("")),coreConf.handleIsShowJoinButton(!0),L.length>0?(O=Rt(),At(O),Ft(O.callId)):O=null,$dispatch(coreUi.changeNotifyInfo($(language.CALL_CALLING_FAILED))),ae(!0,2e3),b.error("start call fail"),window.webView&&window.webView.unInitCallVideo()},ee=t.callMultiTerminalCheck=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("mobile terminal check"),e.next=11;break;case 10:return e.abrupt("return",!1);case 11:if(0===(t=window.webView.checkTerminalStateForVoip())){e.next=20;break}return $dispatch(coreUi.changeEnterConfState(!1)),window.clickCreateWorking=!1,window.alreadyTerminalConfirm=!1,window.requestMultiTerminalPromise=new PromiseObject,e.abrupt("return",window.requestMultiTerminalPromise);case 20:return e.next=22,coreAccount.registerResumeEvent();case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.dealSipLoginCheck=function(){var e=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("mobile do sip login wait"),!window.alreadyDoSipRegiser){e.next=4;break}return b.info("mobile do sip login wait111"),e.abrupt("return","");case 4:return window.requestSipLoginPromise=new PromiseObject,window.requestSipLoginTimer=setTimeout(function(){window.requestSipLoginPromise.resolve()},8e3),e.abrupt("return",window.requestSipLoginPromise);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.dealTerminalResult=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("mobile terminal result :"+t),t+="",window.requestMultiTerminalPromise&&("1"===t?window.isOffline?window.alreadyTerminalConfirm=!0:window.requestMultiTerminalPromise.resolve(!1):"0"===t&&window.requestMultiTerminalPromise.resolve(!0));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();var te=t.callHangup=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,v;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},window.CLIENTCONFIG.ENABLE_IT_MEETING&&(a=void 0,r=void 0,$getState().call.userInfo.contactsId&&(a=$getState().call.userInfo.contactsId),r=getContactName($getState().call.userInfo)?getContactName($getState().call.userInfo):$getState().call.userInfo.account,n={account:a,name:r},window.switchToBackMode()),$getState().call.acceptPickupCall&&$dispatch(coreUi.changeAcceptPickupCall(!1)),coreCommon.Observer.publish("CallBeenHangup",t),o=$getState().call.callId,b.info("callHangup active do endCall. callId: "+t+" currentCallId: "+o),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&$dispatch(coreUi.changeCallToolBarShowStatus(!1)),!t){e.next=11;break}return e.next=10,I.endCallService(t);case 10:window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyMyLeaveConf(0),b.info("NotifyMyLeaveConf"));case 11:i=(0,d.default)({},Ot(t)),t===o?L.length>0?(O=Rt(),O&&t===O.consultTransferId&&(O.consultTransferId="",$dispatch(coreUi.changeConsultTransferId(""))),At(O),O.isClickHold||(Ft(O.callId),0===L.length&&Wt(!1,"callHangup"))):isNullOrEmpty(M)?Pe(t):(O=M,At(O),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),Wt(!1,"callHangup"),M={},$dispatch(coreUi.changeNewIncommingCall(M)),c=$getState().notify.callNotify,coreUi.showCallNotify(c)):isNullOrEmpty(M)||M.callId!==t?(Mt(t),0===L.length&&Wt(!1,"callHangup")):(M={},$dispatch(coreUi.changeNewIncommingCall(M)),coreUi.closeCallNotify(t),l=$getState().call.initiativeHoldCall,s=$getState().call.isCallHold,l||s||Wt(!1,"callHangup"),coreUi.stopRing()),$getState().login.sipLoginOnly||coreConf.getConfList(),u=I.getCallById(t),f=$getState().callRecord.IdByIdGenerateRecord,p=$getState().call.receiveCallUpateInfo,!isNullOrEmpty(u.callInfo)&&(f.indexOf(t)<0||p)&&($dispatch(coreUi.changeReceiveUpateInfo(!1)),f.push(t),f.length>20&&(f=f.slice(f.length-20,f.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(f)),window.CLIENTCONFIG.ENABLE_IT_MEETING?De(u.callInfo,n):De(u.callInfo)),window.CLIENTCONFIG.ENABLE_IT_MEETING?(I.deleteCallObject(t),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(b.info("[IT-Meeting] active hangUp, doLogout."),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT))):(h=I.getCallById(t),b.info("build a record callHangup"),m=$getState().callRecord.IdByIdGenerateRecord,v=$getState().call.receiveCallUpateInfo,!isNullOrEmpty(i)&&(m.indexOf(t)<0||v)?($dispatch(coreUi.changeReceiveUpateInfo(!1)),m.push(t),m.length>20&&(m=m.slice(m.length-20,m.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(m)),De(i)):!isNullOrEmpty(h.callInfo)&&(m.indexOf(t)<0||v)&&($dispatch(coreUi.changeReceiveUpateInfo(!1)),m.push(t),m.length>20&&(m=m.slice(m.length-20,m.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(m)),De(h.callInfo)),I.deleteCallObject(t),window.CLIENTCONFIG.ISMOBILE&&window.Toast(language.END_CALL,2,!1));case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ne=t.clearCallOutTimer=function(){var e=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y>0&&(b.info("clearCallOutTimer"),clearTimeout(y),y=0);case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ae=t.showConfirmNotify=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b.info("showNotify =",e),$dispatch(coreUi.confirmNotify(e)),t&&(b.info("confirmNotify false,  time out",t),setTimeout(function(){$dispatch(coreUi.confirmNotify(!1))},t))},re=(t.showConfirmChairNotify=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;b.info("showNotify =",e),$dispatch(coreUi.confirmChairNotify(e)),t&&(b.info("confirmChairNotify false,  time out",t),setTimeout(function(){$dispatch(coreUi.confirmChairNotify(!1))},t))},t.changeNotifyContent=function(e){$dispatch(coreUi.changeNotifyInfo(e))},t.checkHasCall=function(){b.info("checkHasCall"),$getState().call.callStatus&&re()},t.setNoMoveTrue=function(){var e=$getState().call;(e.showCallToolBar||"VIDEO_CONNECTED"===e.callStatus||"VIDEO_OUT"===e.callStatus)&&(b.info("setNoMoveTrue",!0),(0,g.changeScreenState)("min",!0))}),oe=(t.toggleSmallPageWhenCall=function(){re()},t.showMediaInfo=function(e){if($getState().conf.isSvcConf&&e)return void b.info("showMediaInfo,isSvcConf,return");window.CLIENTCONFIG.IS_DEBUG&&$dispatch(coreUi.changeShowCallMediaInfo(e))}),ie=t.getInfoList=function(e,t){var n=[];return t.forEach(function(t){var a=t;if("account"===t&&(a="bind_no"),e[a]){var r={name:t,num:e[a]};n.push(r)}}),n},ce=function(){var e=(new Date).getTime();return e=parseInt(e/1e3),b.info("call start time =",e),$dispatch(coreUi.changetime(e)),e},le=t.callConnected=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(isNullOrEmpty(R)||R!==t.callId){e.next=3;break}return b.info("user hangup already in callConnected step 101",t.callId),e.abrupt("return");case 3:if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING,!0){e.next=7;break}return ne(),b.info("[IT-Meeting] in IS_LINK_IT_SMC_MEETING callconnected return"),e.abrupt("return");case 7:if(n=window.CLIENTCONFIG,b.info("callConnected,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),b.info("callConnected, callType: "+t.callType+" callId: "+t.callId+" isFocus: "+t.isFocus),$dispatch(coreUi.changeTransformCallBtnDisable(!1)),$dispatch(coreUi.changeCallIsFocus(t.isFocus)),bt(constant.ONLINE_STATUS.BUSY,"Calling"),a=$getState().call,"CALL_OUT"===a.callStatus||"VIDEO_OUT"===a.callStatus){e.next=25;break}if(b.info("is call or video out,no need to open contact chat,callstatus = "+a.callStatus),window.CLIENTCONFIG.ISMOBILE){e.next=21;break}return e.next=19,it($getState().call.userInfo,!0,!0);case 19:e.next=23;break;case 21:return e.next=23,it($getState().call.userInfo,!1,!0);case 23:e.next=26;break;case 25:ne();case 26:if(isNullOrEmpty(R)||R!==t.callId){e.next=30;break}return b.info("user hangup already in callConnected step 102",t.callId),I.deleteCallObject(t.callId),e.abrupt("return");case 30:if("CALL_TRANSTO_CONF"!==a.callStatus&&"VIDEO_TRANSTO_CONF"!==a.callStatus&&ce(),r=t.callId,o=a.callId,i=Ot(t.callId),i&&((0,d.default)(i,t),i.timer=$getState().call.timer),o!==r&&(b.info("currentCallId: "+o+" callId: "+r),L.unshift(O),Mt(r),O=i,At(O)),window.webView&&window.webView.setKeepScreenOn(),coreUi.stopRing(),isNullOrEmpty(R)||R!==t.callId){e.next=42;break}return b.info("user hangup already in step 103",t.callId),I.deleteCallObject(t.callId),e.abrupt("return");case 42:1===t.callType?ve(t.callId):("VIDEO_OUT"===$getState().call.callStatus&&window.CLIENTCONFIG.ISWIN&&(b.info("video callout,but be audio accepted"),coreConf.closeBfcpFrame(),coreConf.closeCallInterface()),$dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeCallStatus("CALL_CONNECTED")),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t.callId,"CALL_CONNECTED")),!0===$getState().call.acceptPickupCall&&(b.info("user pickupCallerInfo "),c=$getState().call.pickupCallerInfo,l=$getState().call.pickupCallerInfo.account,$dispatch(coreUi.changeUserInfo(c)),$dispatch(coreUi.changeCallNum(l)),O&&(O.userInfo=c,O.callNo=l)),coreUi.closeCallNotify(t.callId),$dispatch(coreUi.createConfTipMsg([])),window.CLIENTCONFIG.ISWIN&&(b.info("notify native enter_conf_flow_ended"),coreConf.getSvcAtdManager().setParam({enter_conf_flow_ended:!0}));case 47:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),se=t.callJointEstablishedNotify=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("callJointEstablishedNotify,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),bt(constant.ONLINE_STATUS.BUSY,"Calling"),n=$getState().call,"CALL_OUT"===n.callStatus||"VIDEO_OUT"===n.callStatus){e.next=14;break}if(b.info("is call or video out,no need to open contact chat,callstatus = "+n.callStatus),window.CLIENTCONFIG.ISMOBILE){e.next=10;break}return e.next=8,it($getState().call.userInfo,!0,!0);case 8:e.next=12;break;case 10:return e.next=12,it($getState().call.userInfo,!1,!0);case 12:e.next=15;break;case 14:y>0&&(b.info("callOut timer clear when call connected"),clearTimeout(y),y=0);case 15:"CALL_TRANSTO_CONF"!==n.callStatus&&"VIDEO_TRANSTO_CONF"!==n.callStatus&&ce(),$dispatch(coreUi.changeCallId(t.call_id)),b.info("dispatch,changeCallId,value = "+t.call_id+",call_type = "+t.call_type),window.webView&&window.webView.setKeepScreenOn(),coreUi.stopRing(),1===t.call_type?ve(t.call_id):($dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeCallStatus("CALL_CONNECTED")),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t.call_id,"CALL_CONNECTED"),b.info("CALL_CONNECTED, data.call_type !== 1"+t.call_id)),b.info("callconnected $getState().call.acceptPickupCall",$getState().call.acceptPickupCall),!0===$getState().call.acceptPickupCall&&(b.info("user pickupCallerInfo "),a=$getState().call.pickupCallerInfo,r=$getState().call.pickupCallerInfo.account,$dispatch(coreUi.changeUserInfo(a)),$dispatch(coreUi.changeCallNum(r)),O&&(O.userInfo=a,O.callNo=r)),coreUi.closeCallNotify(t.call_id),$dispatch(coreUi.createConfTipMsg([]));case 25:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ue=t.acceptUpdateToVideo=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("acceptUpdateToVideo"),e.next=3,I.replyAddVideo(t,!0);case 3:n=e.sent,coreUi.closeCallNotify(t),clearTimeout(E),$dispatch(coreUi.changeAddVideoBtnStatus(!1));case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),de=t.rejectUpdateToVideo=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.replyAddVideo(t,!1);case 2:n=e.sent,n?b.info("rejectUpdateToVideo success"):b.info("rejectUpdateToVideo failed, res = ",n),coreUi.closeCallNotify(t),clearTimeout(E),$dispatch(coreUi.changeAddVideoBtnStatus(!1));case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("handleApplyTimeout,reject update to video, and enable ClickAddVideo"),e.next=3,de(t);case 3:$dispatch(coreUi.changeAddVideoBtnStatus(!1)),clearTimeout(E);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,d;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.getCallMediaParams(t);case 5:if(a=e.sent,r=$getState().conf.isSvcConf,!(a.param.svc_stream_info&&a.param.svc_stream_info.length&&a.param.svc_stream_info.length>0)){e.next=49;break}o=0;case 9:if(!(o<a.param.svc_stream_info.length)){e.next=49;break}if(!r){e.next=44;break}if(a.param.svc_stream_info[o].encode_name="H264"===a.param.svc_stream_info[o].encode_name?"H.264 SVC":a.param.svc_stream_info[o].encode_name,a.param.svc_stream_info[o].decode_name="H264"===a.param.svc_stream_info[o].decode_name?"H.264 SVC":a.param.svc_stream_info[o].decode_name,i=a.param.svc_stream_info[o],""===i.decoder_size||""!==i.encoder_size){e.next=38;break}c=o+1;case 16:if(!(c<a.param.svc_stream_info.length)){e.next=25;break}if(!a.param.svc_stream_info[c].send_delay){e.next=22;break}return l=a.param.svc_stream_info[c].send_delay/2,i.send_delay=l,i.recv_delay=l,e.abrupt("break",25);case 22:c++,e.next=16;break;case 25:if(i.recv_delay){e.next=36;break}s=o-1;case 27:if(!(s>=0)){e.next=36;break}if(!a.param.svc_stream_info[s].send_delay){e.next=33;break}return u=a.param.svc_stream_info[s].send_delay/2,i.send_delay=u,i.recv_delay=u,e.abrupt("break",36);case 33:s--,e.next=27;break;case 36:e.next=41;break;case 38:d=i.send_delay/2,i.send_delay=d,i.recv_delay=d;case 41:a.param.svc_stream_info[o]=i,e.next=46;break;case 44:a.param.svc_stream_info[o].encode_name="H264"===a.param.svc_stream_info[o].encode_name?"H.264":a.param.svc_stream_info[o].encode_name,a.param.svc_stream_info[o].decode_name="H264"===a.param.svc_stream_info[o].decode_name?"H.264":a.param.svc_stream_info[o].decode_name;case 46:o++,e.next=9;break;case 49:return a.param.video_stream_info&&(a.param.video_stream_info.encode_name="H264"===a.param.video_stream_info.encode_name?"H.264":a.param.video_stream_info.encode_name,a.param.video_stream_info.decode_name="H264"===a.param.video_stream_info.decode_name?"H.264":a.param.video_stream_info.decode_name),a.param.data_stream_info&&(a.param.data_stream_info.encode_name="H264"===a.param.data_stream_info.encode_name?"H.264":a.param.data_stream_info.encode_name,a.param.data_stream_info.decode_name="H264"===a.param.data_stream_info.decode_name?"H.264":a.param.data_stream_info.decode_name),a.param.audio_stream_info&&(a.param.audio_stream_info.recv_delay=a.param.audio_stream_info.recv_delay/2,a.param.audio_stream_info.send_delay=a.param.audio_stream_info.send_delay/2),e.abrupt("return",a);case 53:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,a={callid:t,infoid:0},e.next=4,coreTup.getCallInstance();case 4:return r=e.sent,e.next=7,r.getBasicCallInfo(a);case 7:return o=e.sent,0===o.result&&(n=o.param.call_info.conf_media_type),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ce=(t.getBasicBandInfo=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=0,a={callid:t,infoid:0},r=void 0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=9;break}return e.next=6,coreCall.getBasicCallInfoNew(a);case 6:r=e.sent,e.next=15;break;case 9:return e.next=11,coreTup.getCallInstance();case 11:return o=e.sent,e.next=14,o.getBasicCallInfo(a);case 14:r=e.sent;case 15:return 0===r.result?(b.info("getBasicBandInfo success,bandwidth = "+r.param.call_info.bandwidth),n=r.param.call_info.bandwidth):b.info("getBasicBandInfo failed"),e.abrupt("return",n);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.delVideoRequest=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("delVideoRequest, tup reject audio to video request, so ui auto close confirm window"),window.clearDialogQueueIt('"'+language.SWITCH_TO_VIDEO+'"'),(window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.isPluginEnv)&&window.openOrCloseFloatingWindowPrompt(0);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),me=t.addVideoRequest=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(t.call_id);case 2:if(!(n=e.sent)){e.next=9;break}return b.info("addVideoRequest,auto accept to video"),e.next=7,I.replyAddVideo(t.call_id,!0);case 7:return a=e.sent,e.abrupt("return");case 9:if(r={isShow:!0,isUpdateToVideo:!0,callId:t.call_id,isVideo:1},!(L.length>0)){e.next=13;break}return de(r.callId),e.abrupt("return");case 13:if(!window.CLIENTCONFIG.ISMOBILE){e.next=22;break}return e.next=16,z(!0);case 16:if(!(o=e.sent)){e.next=20;break}return b.info("The network type is 2G. not support video"),e.abrupt("return");case 20:return e.next=22,(0,g.callPermissionCheck)(!0);case 22:return(window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.isPluginEnv)&&window.openOrCloseFloatingWindowPrompt(1),e.next=25,window.confirm(language.SWITCH_TO_VIDEO,!0,{leftButton:language.REJECT,rightButton:language.AGREE});case 25:i=e.sent,(window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.isPluginEnv)&&window.openOrCloseFloatingWindowPrompt(0),i.ret?(b.info("userClick  SWITCH_TO_VIDEO acceptUpdateToVideo"),ue(r.callId)):(b.info("userClick  SWITCH_TO_VIDEO rejectUpdateToVideo"),de(r.callId)),$dispatch(coreUi.changeAddVideoBtnStatus(!0)),E=setTimeout(function(){fe(t.call_id)},3e4);case 30:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a,r,o,i,c,l,s,u,d,f;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k=setTimeout(function(){$dispatch(coreUi.setIsDecodeSuc()),clearTimeout(k)},3e3),a=$getState().call,!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}b.info("<video>callStatus = "+a.callStatus+",need set local and remote render"),n||($dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),window.callStatusChangeNotify(t,"VIDEO_CONNECTED")),e.next=51;break;case 7:if("VIDEO_OUT"!==a.callStatus){e.next=12;break}$getState().conf.isSvcConf?window.CLIENTCONFIG.ISBIGWIN?coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BIG):window.CLIENTCONFIG.ISWIN&&(window.isHubEnv?(b.info("initVideoFrame maxhub set divide mode"),coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE)):window.CLIENTCONFIG.ISWIN||window.CLIENTCONFIG.ISBIGWIN?(coreConf.updateLocalwindowCallId(t),coreConf.initRemotWindow(t)):(r=(0,g.getBigContainerSize)(),r=(0,g.calcRealVideoSize)({width:16,height:9},r),$dispatch(coreUi.changeBigWinStyle(r)),I.setRemoteVideoRender(r),o={height:constant.VIDEO_SMALL_SIZE.HEIGHT,width:constant.VIDEO_SMALL_SIZE.WIDTH},$dispatch(coreUi.changeSmallWinStyle(o)),I.setVideoWH(!1,o)),$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),e.next=51;break;case 12:if(b.info("<video>callStatus = "+a.callStatus+",need set local and remote render"),""===a.callStatus&&!1===$getState().conf.isOpenCameraDe&&!0===$getState().login.sipLoginOnly&&(coreConf.getSvcAtdManager().userCameraStu=!1,window.userCameraStu=!1),!1===window.userCameraStu&&"VIDEO_CONNECTED"===a.callStatus&&"mac"===window.CLIENTCONFIG.PLATFORM&&(window.userCameraStu=!0,coreCommon.CameraControl.getInstance().switchCameraStateAction(!1)),!window.CLIENTCONFIG.ISBIGWIN){e.next=21;break}b.info("bigwin init video frame, $getState().conf.isSvcConf:"+$getState().conf.isSvcConf),$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BIG),e.next=51;break;case 21:if(!window.CLIENTCONFIG.ISWIN){e.next=49;break}if(!$getState().conf.isSvcConf){e.next=27;break}$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),window.isCreatingAVCFrame?(i=0,c=setInterval(function(){window.isCreatingAVCFrame?++i>50&&(clearInterval(c),b.info("initVideoFrame in creatting AVCFrame time = "+100*i+",please check!!!"),window.isHubEnv?(b.info("initVideoFrame maxhub set divide mode"),coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE)):(clearInterval(c),b.info("initVideoFrame after create AVCFrame time = "+100*i),window.isHubEnv?(b.info("initVideoFrame maxhub set divide mode"),coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE))},100)):window.isHubEnv?(b.info("initVideoFrame maxhub set divide mode"),coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.getSvcAtdManager().initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE),e.next=47;break;case 27:if("VIDEO_TRANS_CONF"!==a.callStatus){e.next=39;break}return $dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),b.info("P2P trans to AVC conf.",t,"setViewMode",constant.AVC_VIEW_MODE.VIDEO_MODE),l=$getState().conf,s=l.confServerId,u=l.vmrId,isNullOrEmpty(u)||(s=u),e.next=34,coreConf.updateLocalwindowCallId(t);case 34:coreConf.setViewMode(constant.AVC_VIEW_MODE.VIDEO_MODE),coreConf.setSubject($getState().conf.confSubject),coreConf.setConfServerId(s),e.next=47;break;case 39:return b.info("cwp init initCallInterface confConnected WRONG"),$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),window.isCreatingAVCFrame=!0,e.next=44,coreConf.initCallInterface(t,constant.AVC_VIEW_MODE.VIDEO_MODE,constant.SVC_VERSION_FLAG.BASE);case 44:return e.next=46,coreConf.initRemotWindow(t);case 46:window.isCreatingAVCFrame=!1;case 47:e.next=51;break;case 49:$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),$getState().conf.isSvcConf||(d=(0,g.getBigContainerSize)(),d=(0,g.calcRealVideoSize)({width:16,height:9},d),$dispatch(coreUi.changeBigWinStyle(d)),I.setRemoteVideoRender(d),f={height:constant.VIDEO_SMALL_SIZE.HEIGHT,width:constant.VIDEO_SMALL_SIZE.WIDTH},$dispatch(coreUi.changeSmallWinStyle(f)),I.setLocalVideoRender(f));case 51:$dispatch(coreUi.changeCallToolBarShowStatus(!1)),window.CLIENTCONFIG.ISWIN&&isNullOrEmpty($getState().conf.confhandle)&&coreConf.getSvcAtdManager().setParam({p2pConnected:!0});case 53:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),we=(t.setMicValue=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.MicControl.getInstance().muteMic(!1);case 2:return t=parseInt(t,10),e.next=5,I.setMicVol(t);case 5:$dispatch(coreUi.changeMicValue(t)),coreConf.getSvcAtdManager().setMuteState(!0),b.info("set mic value = ",t);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMicValue=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMicVol();case 2:return t=e.sent,b.info("getMicValue ="+t),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),Ie=t.getSpkValue=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getSpkVol();case 2:return t=e.sent,b.info("getSpkValue ="+t),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ge=t.handleCallRingBack=function(e){b.info("handleCallRingBack,callId = "+e.call_id),coreUi.stopRing(),e&&e.have_sdp||coreUi.incommingRing("ring",!1)},_e=t.onCallHoldSuccess=function(e){b.info("onCallHoldSuccess callId: "+e.callId);var t=e.callId,n=Ot(t);n&&(0,d.default)(n,e),t===$getState().call.callId&&(b.info("onCallHoldSuccess changeCallTransferFlag(true)"),Wt(!0,"onCallHoldSuccess")),Ve(L),At(O)},Se=t.onCallHoldFailed=function(e){b.info("onCallHoldFailed callId: "+e.callId),$dispatch(coreUi.changeHoldCallInitiative(!1));var t=e.callId,n=Ot(t);n&&((0,d.default)(n,e),n.isClickHold&&(n.isClickHold=!1)),Ve(L),$getState().call.initiativeHoldCall&&window.Toast(language.HOLD_CALL_FAILE,2,!1)},be=t.onCallUnHoldSuccess=function(e){b.info("onCallUnHoldSuccess callId: "+e.callId);var t=e.callId,n=Ot(t);n&&((0,d.default)(n,e),n.isClickHold&&(n.isClickHold=!1)),e.callId!==O.callId?(L.push(O),Mt(e.callId),O=n,Wt(!0,"onCallUnHoldSuccess")):(Wt(!1,"onCallUnHoldSuccess"),b.info("onCallUnHoldSuccess changeCallTransferFlag(false)"),$dispatch(coreUi.changeHoldCallInitiative(!1))),Ve(L),At(O)},Ne=t.onCallUnHoldFailed=function(e){b.info("onCallHoldFailed callId: "+e.callId);var t=e.callId,n=Ot(t);n&&(0,d.default)(n,e),Ve(L),$getState().call.initiativeHoldCall&&window.Toast(language.RESUME_CALL_FAILE,2,!1)},Ee=t.onCallAtdTransferSuccess=function(e){b.info("onCallAtdTransferSuccess, callId: "+t);var t=e.call_id;window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_SUCCEEDED,2,null,!0):window.ToastNew(language.CALL_TRANSFER_SUCCEEDED,2)},ke=t.onCallAtdTransferFailed=function(e){b.info("onCallAtdTransferFailed, callId: "+t+", reason code: "+e.reason_code);var t=e.call_id;window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_FAILED,2,null,!0):window.ToastNew(language.CALL_TRANSFER_FAILED,2)},ye=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o,i,c,l,u,d,f,p,h,m,v,w;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe({});case 2:if(t=e.sent,0!==t.result){e.next=40;break}if(F=t,e.prev=5,n=$getState().conf,a=n.isVideoConf,r=n.isSvcConf,o=-1,t.param.audio_stream_info&&(o=t.param.audio_stream_info.recv_average_mos),i=[],c=0,r){if((l=t.param.svc_stream_info)&&l.length>0)for(u=0;u<l.length;u++)l[u].dec_ssrc>0&&(c+=l[u].bandwidth,i.push(l[u].recv_loss_fraction),i.push(l[u].send_loss_fraction))}else c=t.param.video_stream_info.bandwidth,t.param.video_stream_info&&(i.push(t.param.video_stream_info.recv_loss_fraction),i.push(t.param.video_stream_info.send_loss_fraction));if(t.param.data_stream_info&&(i.push(t.param.data_stream_info.recv_loss_fraction),i.push(t.param.data_stream_info.send_loss_fraction)),t.param.audio_stream_info&&(i.push(t.param.audio_stream_info.recv_loss_fraction),i.push(t.param.audio_stream_info.send_loss_fraction)),0!==i.length){e.next=17;break}return b.info("calculateLocalQosPrama Err data_stream_info = "+(0,s.default)(t.param.data_stream_info)+", audio_stream_info = "+(0,s.default)(t.param.audio_stream_info)+", video_stream_info = "+(0,s.default)(t.param.video_stream_info)),e.abrupt("return",null);case 17:d=i.sort(function(e,t){return e-t}),f=d.length-1,p=d[f],h=f;case 21:if(!(h>=0)){e.next=28;break}if(!(d[h]<p)){e.next=25;break}return p=d[h],e.abrupt("break",28);case 25:h--,e.next=21;break;case 28:return m=t.param.effective_bitrate||0,v=t.param.data_stream_info.bandwidth||0,w=$getState().call.isLowVideoBWCloseCamera,e.abrupt("return",{isVideoConf:a,MOS:o,lossRate:p,TMMBR:m,videoBandWidth:c,BFCPBandWidth:v,isLowVideoBWCloseCamera:w});case 34:return e.prev=34,e.t0=e.catch(5),b.error("calculateLocalQosPrama Err = "+(0,s.default)(e.t0)),e.abrupt("return",null);case 38:e.next=42;break;case 40:F=null,b.info("calculateLocalQosPrama Err res.result = "+t.result);case 42:case"end":return e.stop()}},e,void 0,[[5,34]])}));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o,i,c,l,s,u,d;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=4,e.next=3,ye();case 3:if(n=e.sent,!isNullOrEmpty(n)){e.next=7;break}return b.info("calculateLocalQos Err, get param err"),e.abrupt("return",t);case 7:if(a=n.MOS,r=n.lossRate,o=n.TMMBR,i=n.videoBandWidth,c=n.BFCPBandWidth,l=n.isLowVideoBWCloseCamera,-1!==a&&(t=a>=4?4:a>=3?3:a>=2?2:1),s=r<=1?4:r<=5?3:r<=15?2:1,u=i+c,d=0,!(u>0&&o>0)){e.next=16;break}d=o/u<.4?2:4,e.next=18;break;case 16:return b.info("calculateLocalQos data = "+t),e.abrupt("return",t);case 18:return 4===d?t=s:2===d&&(t=l&&4===s?3:s<d?s:d),b.info("calculateLocalQos data = "+t),e.abrupt("return",t);case 21:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:V&&(clearInterval(V),V=null),b.info("stop querying qos.");case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o,i,c;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call,n=t.isSvcConfShowQOS,a=t.showMediaInfo,r=$getState().conf.isSvcConf,o=$getState().call.callId){e.next=6;break}return xe(),e.abrupt("return");case 6:if(window.CLIENTCONFIG.ISMOBILE&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&(st(F),coreConf.firstQosReport()),!window.CLIENTCONFIG.IS_DEBUG){e.next=35;break}if(!r){e.next=25;break}if(!window.CLIENTCONFIG.ISMOBILE){e.next=15;break}if(!(!window.CLIENTCONFIG.IS_SVC_CONF_DEBUG||window.CLIENTCONFIG.IS_SVC_CONF_DEBUG&&n)){e.next=13;break}return e.next=13,st(F);case 13:e.next=23;break;case 15:if(!window.CLIENTCONFIG.ISWIN){e.next=20;break}return e.next=18,ut(F);case 18:e.next=23;break;case 20:if(!a){e.next=23;break}return e.next=23,dt(T);case 23:e.next=35;break;case 25:if(!window.CLIENTCONFIG.ISWIN||"VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=30;break}return e.next=28,ut(F);case 28:e.next=35;break;case 30:if(!a){e.next=35;break}return e.next=33,ft();case 33:i=e.sent,window.CLIENTCONFIG.ISWIN&&coreConf.isInDataScreenOrWbSharing()&&i&&(c=(0,d.default)({},{QOS:i}),coreConf.getNativeInterface().reportQos(0,c));case 35:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),Le=t.callLocalQos=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().call.callLocalQoslevel,e.next=3,Te();case 3:n=e.sent,$dispatch(coreUi.changeCallLocalQoslevel(n)),n<3&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&coreConf.qosAlertSend(),window.CLIENTCONFIG.ISWIN&&t!==n&&coreConf.getSvcAtdManager().setSignal(n),V||(V=setInterval(function(){Oe()},2e3));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),Me=t.muteMicAndSpeaker=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$getState().call,0!==t){e.next=4;break}e.next=7;break;case 4:if(1!==t){e.next=7;break}return e.next=7,I.operateMic(a.callId,n);case 7:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),Re=t.switchAudioChannel=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=$getState().call.callId,e.next=3,I.switchAudioChannel(n,t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ae=(t.setVoiceValue=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.SpkControl.getInstance().muteSpk(!1);case 2:return t=parseInt(t,10),e.next=5,I.setSpkVol(t);case 5:$dispatch(coreUi.changeVoiceValue(t)),b.info("set voice value = ",t);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setcallcapability=function(){var e=(0,v.default)(C.default.mark(function e(t,n,a){var r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={callid:$getState().call.callId,protocol:0,cap_id:9,val:{audio_dir:t,video_dir:n,aux_dir:a}},b.info("set Call Capability = ",r),e.next=4,I.setCallCapability(r);case 4:o=e.sent,0===o.result?b.info("[ action_call ] HWTUP.setCallCapability success,",o):b.error("[ action_call ] HWTUP.setCallCapability faild, ",o);case 6:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setCallReinvite=function(){var e=(0,v.default)(C.default.mark(function e(){var t;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("call setCallReinvite"),e.next=3,I.setCallReinvite($getState().call.callId);case 3:t=e.sent,0===t.result?b.info("[ action_call ] HWTUP.setCallReinvite success",t):b.error("[ action_call ] HWTUP.setCallReinvite faild",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.configMsDataConf=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("configMsDataconf "+t),n={conf:{enable_ms_dataconf:t}},e.next=4,coreTup.getCallInstance();case 4:return a=e.sent,e.next=7,a.config(n);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.acceptCall=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("acceptCall, callId = "+t+" isForceAudio: "+a),window.CLIENTCONFIG.ISMOBILE||($getState().common.isShowModal?coreUi.hideModal():$getState().common.isShowPop?window.hideAlert():$getState().common.isShowNotifyModal&&$dispatch(coreUi.hideNotifyModal())),coreUi.stopRing(),(0,g.changeScreenState)("middle"),window.CLIENTCONFIG.ISMOBILE&&window.netWorkType===constant.NETWORK_TYPE.TYPE_2G&&(b.info("The network is 2G not support video conf"),a=!0),n=$getState().notify.callNotify,b.info("callNotify.callType: "+n.callType+" isForceAudio: "+a),1!==n.callType||a||window.webView&&window.webView.initCallVideo(),e.next=10,I.acceptCall(t,a);case 10:O&&O.callId===t?(O.userInfo=$getState().call.userInfo,O.callNo=$getState().call.callNum):isNullOrEmpty(M)||M.callId!==t||(L.push(O),Ve(L),O=M,At(O),M={},$dispatch(coreUi.changeNewIncommingCall(M)),$dispatch(coreUi.changetime(0))),n.isShow=!1,n.isUpdateToVideo=!1,a&&(n.callType=0),coreUi.showCallNotify(n),b.info("callNotify.isShow = false");case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.callInComming=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,v,w,_,S,N,E,k;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("callInComming, data.callId: "+t.callId),n=$getState().call,a=n.callStatus,e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=8;break}return e.next=7,window.isSimCardCall();case 7:e.t0=e.sent;case 8:if(!(r=e.t0)){e.next=14;break}return b.info("callInComming, now is in sim card call,end call"),e.next=13,I.endCallService(t.callId);case 13:return e.abrupt("return");case 14:if(!("VIDEO_OUT"===a||"CALL_OUT"===a||"CALL_INCOMING"===a||"CALL_CONNECTED"===a||"VIDEO_CONNECTED"===a||"VIDEO_TRANSTO_CONF"===a||"CALL_TRANSTO_CONF"===a||coreConf.isInConf()||window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv||window.isPluginEnv)){e.next=20;break}if(!t.callId){e.next=19;break}return b.info("already exist a call, end this call, callId: "+t.callId),e.next=19,I.endCallService(t.callId);case 19:return e.abrupt("return");case 20:if(!(L.length+1>=constant.CALL_CONST.MAX_CALL_LENGTH)){e.next=26;break}if(!t.callId){e.next=25;break}return b.info("call list is max, end this call, callId: "+t.callId),e.next=25,I.endCallService(t.callId);case 25:return e.abrupt("return");case 26:if(!O||O.isEnd||!t.isVideo&&!O.isVideo){e.next=32;break}if(!t.callId){e.next=31;break}return b.info(": "+t.callId),e.next=31,I.endCallService(t.callId);case 31:return e.abrupt("return");case 32:return window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.switchToFront(),o=$getState().call.callId,""===o&&$dispatch(coreUi.changeCallStatus("CALL_INCOMING")),""===o&&(i=$getState(),c=i.myInfo,l=c.account,s=c.statusDesc,u=i.contactGroups.contact_status_map,$dispatch(coreUi.changeOldStatus(u[l]&&u[l].status,s)),b.info("dispatch changeOldStatus status= "+(u[l]&&u[l].status)+",desc = "+s),b.info("callInComming,status: "+constant.ONLINE_STATUS.BUSY+",desc = Calling"),bt(constant.ONLINE_STATUS.BUSY,"Calling")),e.next=38,coreContact.getContactByCallNumber(t.callNo);case 38:if(f=e.sent,e.t1=t.callNo,e.t2=t.callNo,e.t3=t.fwd_from_name,e.t3){e.next=46;break}return e.next=45,Ht(t.fwd_from_num);case 45:e.t3=e.sent;case 46:if(e.t4=e.t3,e.t5=t.fwd_from_num,e.t6=t.callId,e.t7=f,e.t8=t.isVideo?1:0,e.t9=t.callType,p={isShow:!0,isUpdateToVideo:!1,callerName:e.t1,callerDepartment:"",callerNumber:e.t2,callTransferName:e.t4,callTransferNumber:e.t5,callId:e.t6,callAccount:e.t7,isVideo:e.t8,callType:e.t9},h=t.callNo,m=void 0,v=void 0,"*"===t.callNo.substr(0,1)&&(h=t.callNo.substr(1,t.callNo.length-1)),window.skipLogin){e.next=66;break}return e.next=60,coreContact.searchServerContact({query_key:h,pageOffset:1,SearchType:1});case 60:w=e.sent,_=w.userInformationList||[],p.callerNumber=h,_.length>0?(p.callerName=getContactName(_[0]),""===p.callerName&&(p.callerName=p.callerNumber),p.callAccount=_[0].account,p.callerDepartment=getContactDept(_[0]),m=_[0],v=p.callerNumber):(S={account:h},isNullOrEmpty(t.display_name)||(p.callerName=t.display_name,S.account=t.display_name),m=S,v=p.callerNumber),e.next=69;break;case 66:N={account:h},m=N,v=p.callerNumber;case 69:return""===o?(O=(0,d.default)({},t),O.userInfo=m,O.callNo=v,At(O),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t.callId,"CALL_INCOMING")):(b.info("current callId: "+o),M=(0,d.default)({},t),M.userInfo=m,M.callNo=v,$dispatch(coreUi.changeNewIncommingCall(M)),Wt(!0,"callInComming")),window.webView&&window.webView.setFrontToLock(),1===t.callType&&window.webView,coreUi.showCallNotify(p),coreUi.incommingRing("in",!0),E=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==E&&($dispatch(coreUi.changeCtdCallingState(!1)),window.goRoute("callMain"),window.isPluginEnv&&(b.info("incoming call, open sdk back to native view"),coreCommon.dispatchModuleEvent("callIncomingShown",t))),e.next=78,(0,g.callPermissionCheck)(1===t.callType,!1);case 78:return window.requestPermissionPromise&&(window.requestPermissionPromise=null),e.next=81,it({account:p.callAccount},!1,!0);case 81:if(window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=92;break}if(1!==t.callType){e.next=92;break}return e.next=85,(0,g.createVideoPreCheck)();case 85:if(k=e.sent){e.next=92;break}if(b.info("userClick  <video>mobile user 3/4G reject callincoming"),!t.callId){e.next=92;break}return b.info("callHangup,calID = "+t.callId),e.next=92,I.endCallService(t.callId);case 92:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Fe=t.callOutGoing=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState().call.callId,b.info("callOutGoing callId: "+t.callId+" currentCallId: "+n),n&&(b.info("callOutGoing push currentCall to holdCallList"),L.push(O),Ve(L)),a=(0,d.default)({},t),O=a,n!==t.callId&&(r=$getState().call.isConsultTransfer,r&&(O.consultTransferId=n,$dispatch(coreUi.changeConsultTransferId(O.consultTransferId))),$dispatch(coreUi.changeCallId(t.callId)),Gt(!1)),Vt();case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ve=t.updateHoldCallList=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("updateHoldCallList size: "+t.length),$dispatch(coreUi.changeHoldCallListInfo(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),De=t.callRecordSave=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,l,s,u,d,f,p,h,m,v,w,I,g,_,S,N,E,k,y,T,x,O,L=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||""!==t.callNo&&void 0!==t.callNo&&"undefined"!==t.callNo){e.next=3;break}return b.info("callRecordSave callNo is empty!"),e.abrupt("return");case 3:if(!t){e.next=62;break}if(n=$getState(),a=parseInt(t.milltime),r=parseInt((new Date).getTime()),o=r-a,i={},l=0,s=isNullOrEmpty(t.callInOut)?constant.CALL_IN_OUT_TYPE.CALL_OUT:t.callInOut,window.CLIENTCONFIG.ENABLE_IT_MEETING&&1===s&&(t.userInfo=L),!t.userInfo){e.next=16;break}i=t.userInfo,e.next=22;break;case 16:return u=t.callNo,e.next=19,coreContact.searchServerContact({query_key:u,pageOffset:1,SearchType:1});case 19:d=e.sent,f=d.userInformationList||[],f.length>0?i=f[0]:(p={account:u},isNullOrEmpty(t.display_name)||(p.account=t.display_name),i=p);case 22:if(h=void 0,m=void 0,!isNullOrEmpty(i)&&i.contact_id&&isNullOrEmpty(i.account)?(h=t.callNo,l=i.contact_id,m=getContactName(i)):isNullOrEmpty(i)||isNullOrEmpty(i.account)?(h=t.callNo,l=0,m=t.callNo):(h=i.account,l=0,m=getContactName(i)),v=n.myInfo,w=isNullOrEmpty(t.isCallSuccess)?0:t.isCallSuccess,!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=35;break}if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=29;break}return e.abrupt("return");case 29:if(isNullOrEmpty(i)||isNullOrEmpty(i.contactsId)||(h=i.contactsId,b.info("save current num call 2")),isNullOrEmpty(i)||isNullOrEmpty(i.contactId)||(h=i.contactId,b.info("save current num call 3")),void 0!==m){e.next=33;break}return e.abrupt("return");case 33:return s?window.callRecordNotify(v.bind_no,t.callNo,v.account,h,m,a,r,0,t.callType?1:0,s,w):window.callRecordNotify(t.callNo,v.bind_no,h,v.account,m,a,r,0,t.callType?1:0,s,w),e.abrupt("return");case 35:return I={peeraccount:h,iscallout:s,callernumber:v.bind_no,calleenumber:t.callNo,starttime:a,callstate:t.callState,calltype:t.callType,duration:o,confid:"",confpasscode:"",confmembers:"",groupid:"",isVideo:t.callType?1:0,callUserName:m,contact_id:l,isCallSuccess:t.isCallSuccess?1:0},e.next=38,coreDb.saveCallRecord(I);case 38:if(!(g=e.sent)){e.next=62;break}return window.CLIENTCONFIG.ISMOBILE,e.next=43,coreDb.queryCallRecord({peeraccount:h,starttime:9999999999999,limitcount:1});case 43:if(_=e.sent,isNullOrEmpty(_)){e.next=62;break}return S=n.callRecord,N=S.callRecordList,E=S.callItemInfoList,N.unshift(_),e.next=49,coreContact.getContactByAccount(_.peeraccount);case 49:if(k=e.sent,y=JSON.parse(_.exparams),!y.contact_id){e.next=57;break}return e.next=54,coreDb.queryContactByContactId({contact_id:y.contact_id});case 54:k=e.sent,e.next=58;break;case 57:isNullOrEmpty(k)&&(T=$getState().call,x=T.voiceMailNum,O=T.userInfo,k=O&&O.number===x&&O.isVmFlag?coreContact.getTempCallUserInfo(_.peeraccount,language.VOICE_MAIL_BOX,!0):coreContact.getTempCallUserInfo(_.peeraccount));case 58:b.info(" 保存最新一条通话记录 "),E.unshift(k),$dispatch(coreUi.getCallRecordList([].concat((0,c.default)(N)))),$dispatch(coreUi.getCallRecordListInfo([].concat((0,c.default)(E))));case 62:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ue=t.callEnded=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,v,w,g;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},window.CLIENTCONFIG.ENABLE_IT_MEETING&&(a=void 0,r=void 0,$getState().call.userInfo.contactsId&&(a=$getState().call.userInfo.contactsId),r=getContactName($getState().call.userInfo)?getContactName($getState().call.userInfo):$getState().call.userInfo.account,n={account:a,name:r}),$getState().call.acceptPickupCall&&$dispatch(coreUi.changeAcceptPickupCall(!1)),x&&(b.info("close last update confirm window"),x.close(),x=null),o=Ot(t.callId),b.info("build a record callEnded"),i=$getState().callRecord.IdByIdGenerateRecord,c=$getState().call.receiveCallUpateInfo,window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||!(i.indexOf(t.callId)<0||c)){e.next=21;break}if($dispatch(coreUi.changeReceiveUpateInfo(!1)),i.push(t.callId),i.length>20&&(i=i.slice(i.length-20,i.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(i)),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=19;break}return e.next=17,De((0,d.default)({},o,t),n);case 17:e.next=21;break;case 19:return e.next=21,De((0,d.default)({},o,t));case 21:if(l=t.reasonCode,s=$getState(),u=s.conf.confTempAcsAccount,f=s.call.callId,b.info("callEnded, callId: "+t.callId+" current callId: "+f+" reason_code is "+l),p=!0,window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.requestPermissionPromise&&(p=!1,window.requestPermissionPromise.resolve(!1)),isNullOrEmpty(M)||M.callId!==t.callId){e.next=36;break}return M={},$dispatch(coreUi.changeNewIncommingCall(M)),coreUi.stopRing(),coreUi.closeCallNotify(t.callId),I.deleteCallObject(t.callId),h=$getState().call.initiativeHoldCall,m=$getState().call.isCallHold,h||m||0!==L.length||Wt(!1,"callEnded"),e.abrupt("return");case 36:if(f!==t.callId){e.next=54;break}if(!(L.length>0)){e.next=44;break}return O=Rt(),At(O),O.isClickHold||(Ft(O.callId),0===L.length&&Wt(!1,"callEnded")),I.deleteCallObject(t.callId),coreUi.stopRing(),e.abrupt("return");case 44:if(isNullOrEmpty(M)){e.next=52;break}return O=M,At(O),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),Wt(!1,"callEnded"),M={},$dispatch(coreUi.changeNewIncommingCall(M)),e.abrupt("return");case 52:e.next=61;break;case 54:return Mt(t.callId),I.deleteCallObject(t.callId),O&&t.callId===O.consultTransferId&&(O.consultTransferId="",$dispatch(coreUi.changeConsultTransferId(""))),0===L.length&&Wt(!1,"callEnded"),coreUi.stopRing(),isNullOrEmpty(f)&&(b.info("clear CurrentCall for callId is empty!"),O=null),e.abrupt("return");case 61:coreConf.handleIsShowJoinButton(!0),"extra"===$getState().call.screenState&&(delegate.resumeShow(!1),delegate.winMinimize()),v=!1,coreConf.isInConf()&&!window.CLIENTCONFIG.ISBIGWIN?b.info("still exit conf, ignore call ended msg"):(window.CLIENTCONFIG.ISBIGWIN&&(w=$getState().call,"CALL_OUT"!==w.callStatus&&"VIDEO_OUT"!==w.callStatus||(coreConf.NotifyJoinConfFailedEx(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0))))),Pe(t.callId),I.deleteCallObject(t.callId),$getState().conf.isSvcConf&&(window.CLIENTCONFIG.ISWIN||window.CLIENTCONFIG.ISBIGWIN)?(coreConf.getSvcAtdManager().closeVideoFrame(),coreConf.getSvcAtdManager().closeBfcpFrame(),coreConf.getSvcAtdManager().clear()):!$getState().conf.isSvcConf&&window.CLIENTCONFIG.ISWIN?(coreConf.closeBfcpFrame(),coreConf.closeCallInterface()):window.CLIENTCONFIG.ENABLE_IT_MEETING&&!v&&(p&&window.switchToBackMode(),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(b.info("[IT-Meeting] inactive callend, doLogout."),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)))),g=language.END_CALL,480===l?g=language.CALL_NOT_ONLINE:486===l?g=language.CALL_BUSY:4041===l?g=language.IT_CONF_NOT_STARTED:4042===l&&(g=language.IT_CONF_ENDED),window.CLIENTCONFIG.ISMOBILE?(window.Toast(g,2,!1),window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.itWeLinkNotifyCallEnded(l,g)):480!==l&&486!==l||alert(g),$dispatch(coreUi.clearConfInfo()),$dispatch(coreUi.clearBuriedData()),$dispatch(coreUi.changeHoldCallInitiative(!1));case 71:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Be=t.callInfo=function(e){0===e.param.bIsRomoteHangup&&0===e.param.is_passive_end&&0===e.param.reason_code&&0===e.param.audio_send_mode&&(b.info("call number illegal"),alert(language.STOP_CALL_NUMBER_AT_BEHIND_NOT_IP_OR_DOMAIN)),coreConf.handleIsShowJoinButton(!0)},$e=t.callDestroy=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState(),a=n.call.callId,b.info("handle receive call destory,callId: "+t.callId+" current callId: "+a),t.callId===a&&(L.length>0?(O=Rt(),At(O),O.isClickHold||(Ft(O.callId),0===L.length&&Wt(!1,"callDestroy")),I.deleteCallObject(t.callId)):O=null);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Pe=t.endCall=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,d,f,p,h,m,v,w;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreAccount.getLoginModel();case 2:if(n=e.sent,a=$getState().call,r=$getState().call.timer,b.info("end call callId: "+t),o=window.getRoute(),i=$getState(),c=i.callRecord.isCallRecordDetailMenuBack,coreUi.stopRing(),l=i.login.sipLoginOnly,""!==$getState().call.callId){e.next=17;break}return window.CLIENTCONFIG.ISMOBILE&&(b.info("end call call id is empty currentPage: "+o),"callMain"!==o||l?"mConfMemberPage"===o?window.goRoute("main/conference"):"mSelectBox"===o&&coreUi.clearTransferOfShowBox():(history.back(),"falg"===c&&(0,_.setIsCallRecordDetailMenuBack)(!0))),$dispatch(coreUi.changeCallStatus("")),coreConf.handleIsShowJoinButton(!0),b.info("call id is empty, call has ended"),e.abrupt("return");case 17:s=$getState(),u=s.myInfo.account,d=s.contactGroups.contact_status_map,f=$getState().call,p=f.oldStatus,h=f.oldStatusDesc,(d[u]&&d[u].status)!==constant.ONLINE_STATUS.OFFLINE&&(b.info("endCall,changeStatus:",p,",desc = ",h),bt(p,h)),window.CLIENTCONFIG.ISMOBILE&&(b.info("audio or video ended currentPage: "+o),"callMain"!==o||l?"mConfMemberPage"===o?window.goRoute("main/conference"):"mSelectBox"===o?coreUi.clearTransferOfShowBox():window.goRoute("main/conference"):(window.CLIENTCONFIG.ENABLE_IT_MEETING?window.goRoute("main/conference"):(b.info("endCall history back"),history.back()),"falg"===c&&(0,_.setIsCallRecordDetailMenuBack)(!0)),window.isPluginEnv&&(b.info("call end, opensdk need back to native"),window.backToNativeView())),x&&(x.close(),x=null),Nt(t),coreUi.closeCallNotify(t),O=null,M={},coreConf.handleIsShowJoinButton(!0),$dispatch(coreUi.changeNewIncommingCall(M)),$dispatch(coreUi.changeConsultTransferId("")),$dispatch(coreUi.changeIsConsultTransfer(!1)),$dispatch(coreUi.changeCallId("")),Gt(!1),$dispatch(coreUi.changeMuteMic(!1)),$dispatch(coreUi.changeMuteSpk(!1)),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),$dispatch(coreUi.changeIsSrtp(!1)),$dispatch(coreUi.changeCallNum("")),$dispatch(coreUi.changCurrentPageInfo({currentPage:0,totalPage:1})),$dispatch(coreUi.clearPhoneAddrInfo()),$dispatch(coreUi.changeHoldCallInitiative(!1)),oe(!1),T=0,b.info("dispatch,changeCallId,value = "+t),$getState().login.sipLoginOnly||coreConf.getConfList(),Ge(),(window.CLIENTCONFIG.ISBIGWIN&&"CALL_OUT"===a.callStatus||"VIDEO_OUT"===a.callStatus)&&!$getState().bigwinBuried.buried.postHasSent&&(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0))),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),$dispatch(coreUi.changeCallStatus("")),$dispatch(coreUi.initVideoDucks()),$dispatch(coreUi.changetime(0)),$dispatch(coreUi.switchSpeakerAndReceive(!1)),$dispatch(coreUi.changeHasUnreadMsg(!1)),(0,g.resumeScreenStateWhenCallOrConfEnd)(),coreCwmp.checkUpdateConfig(),n.isPortalUpgrade?coreAccount.reStartUpgrade():coreCwmp.restartUpgrade(),window.CLIENTCONFIG.ISMOBILE&&(window.callOrConfEnded(),coreConf.handleMobileBfcpStatus(),$dispatch(coreUi.changeHadPreSetCamera(!1)),window.CLIENTCONFIG.ENABLE_IT_MEETING&&y>0&&(clearTimeout(y),y=0,b.info("callOut timer clear when call end"))),window.CLIENTCONFIG.ISWIN&&$getState().conf.isSvcConf?(coreConf.getSvcAtdManager().closeVideoFrame(),coreConf.getSvcAtdManager().clear()):!$getState().conf.isSvcConf&&window.CLIENTCONFIG.ISWIN&&(coreConf.closeBfcpFrame(),coreConf.closeCallInterface()),window.CLIENTCONFIG.ISBIGWIN&&"CALL_OUT"!==a.callStatus&&"VIDEO_OUT"!==a.callStatus&&(m=0,v=!0,coreConf.buriedNormalEnd(m,v,r),window.bigWinCommonLogOut(),coreConf.getSvcAtdManager().closeVideoFrame(),coreConf.getSvcAtdManager().closeBfcpFrame()),$dispatch(coreUi.clearConfInfo()),$dispatch(coreUi.changeUserInfo({})),w=$getState().call.isCallTransfer,w&&Wt(!1,"endCall"),$dispatch(coreUi.clearBuriedData());case 63:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ge=t.closeRemoteSocketWhenCallEnd=function(){var e=$getState().call.callStatus;"VIDEO_OUT"!==e&&"VIDEO_CONNECTED"!==e||window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify($getState().call.callId,"VIDEO_END")},We=(t.produceCallMemberList=function(){var e=$getState().call.userInfo,t=$getState().myInfo,n=$getState().call.callNum,a=t.bind_no,r={number:a,userInfo:t,role:0,is_mute:0,is_deaf:0,state:constant.CONF_AUDIO_STATE.CONF_AUDIO_INCONF,hand_state:0,media_type:0,is_self:!0,is_speaking:!1,speak_volume:0,participant_id:"",is_broadcast:0},o={number:n,userInfo:e,role:0,is_mute:0,is_deaf:0,state:constant.CONF_AUDIO_STATE.CONF_AUDIO_INCONF,hand_state:0,media_type:0,is_self:!1,is_speaking:!1,speak_volume:0,participant_id:"",is_broadcast:0},i=[r,o];$dispatch(coreUi.changeMemberListInfo(i)),isNullOrEmpty($getState().conf.searchText)||coreConf.searchMemberList($getState().conf.searchText,i)},t.actionDialDTMF=function(e,t,n){return b.info("actionDialDTMF"),I.dialDTMF(e,t,n)},t.handlelowCallLocalQos=function(e){e>=3?(b.info("handlelowCallLocalQos",e),window.CLIENTCONFIG.ISMOBILE&&window.ToastNew(language.LOW_CALL_QS,2,!1,!1),$dispatch(coreUi.changelowCallLocalQos(!0))):$dispatch(coreUi.changelowCallLocalQos(!1))}),He=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!0;b.info("deviceInfo = ",e),b.info("updateDeviceList = ",t);for(var r=0,o=t.length;r<o;r++){var i=t[r];if(n){if(i.name===e.name){a=!1;break}}else{if(i.device_id===e.device_id){a=!1;break}}}return a},ze=t.handleCameraList=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,u,f,p,h,m,v,w,I,_,S,N,E,k,y,T,x;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("handleCameraList ",(0,s.default)(t)),n=$getState().call,a=void 0,r=void 0,o=$getState().setting.camIndex,i=$getState().call.cameraDevicesList,c=i.length,l={},b.info("cameraIndex = ",o),b.info("call.cameraDevicesList = ",n.cameraDevicesList),u=$getState().call.callStatus;case 10:if(0===t.capture_num){e.next=30;break}if($dispatch(coreUi.changeCameraDevicesList(t.array)),!window.CLIENTCONFIG.ISBIGWIN){e.next=20;break}if(0===n.cameraDevicesList.length&&""!==n.callId&&((0,g.openOrOffCamera)(!1),b.info("open camera")),!(n.cameraDevicesList.length<o+1)){e.next=17;break}return b.error("cameraIndex error"),e.abrupt("break",51);case 17:He(n.cameraDevicesList[o],t.array)&&(b.info("pull camera : ",n.cameraDevicesList[o]),a=n.cameraDevicesList[o].device_id,r=n.cameraDevicesList[o].name,coreConf.NotifyLocalCameraPull(0,a,r)),e.next=28;break;case 20:f=0,0!==c&&o<c&&(f=i[o].device_id),p=void 0,t.capture_num>c?(h=coreSetting.getInsertDeviceById(i,t.array),b.info("Camera device added, get insert device serial number= ",h),-1!==h?(p=coreSetting.getValidCamDeviceSerialNum(t.array,h,f),coreSetting.setAndSaveCamDevice(p)):(p=coreSetting.getValidCamDeviceSerialNum(t.array,-1,f),coreSetting.setAndSaveCamDevice(p))):t.capture_num<c&&(p=coreSetting.getValidCamDeviceSerialNum(t.array,-1,f),b.info("some Camera device has deleted, set default device serial number=",p),coreSetting.setAndSaveCamDevice(p)),window.CLIENTCONFIG.ISWIN&&!$getState().conf.isSvcConf&&coreConf.updateCameraList(p),$dispatch(coreUi.setVideoNum(t.capture_num)),t.capture_num>0&&coreCommon.CameraControl.getInstance().switchCameraStateAction(!0),"win"===window.CLIENTCONFIG.PLATFORM&&(m=$getState().call,v=m.isOpenCamera,w=m.isMuteMic,I=$getState().conf.isConfMicMute,_=w||I?0:100,l=(0,d.default)(l,{init_device_state:{mic_volume:_,camera_on:t.capture_num>0?v:-1}}),l=(0,d.default)(l,{camera_devices:{camIndex:p,cameraDevicesList:t.array}}),coreConf.getSvcAtdManager().setParam(l));case 28:e.next=50;break;case 30:return $dispatch(coreUi.changeCameraDevicesList([])),"win"===window.CLIENTCONFIG.PLATFORM&&(S=$getState().call.isMuteMic,N=$getState().conf.isConfMicMute,E=S||N?0:100,l=(0,d.default)(l,{init_device_state:{mic_volume:E,camera_on:-1}}),l=(0,d.default)(l,{camera_devices:{camIndex:0,cameraDevicesList:[]}}),coreConf.getSvcAtdManager().setParam(l)),e.next=34,coreTup.getCallInstance();case 34:return k=e.sent,y=window.VIDEO_DEFAULT_IMG+"default_camera.bmp",T={media:{video_default_image:y}},e.next=39,k.config(T);case 39:if(""!==n.callId&&((0,g.openOrOffCamera)(!0),b.info("close camera")),!window.CLIENTCONFIG.ISBIGWIN){e.next=48;break}if(!(n.cameraDevicesList.length<o+1)){e.next=44;break}return b.error("cameraIndex error"),e.abrupt("break",51);case 44:a=n.cameraDevicesList[o].device_id,r=n.cameraDevicesList[o].name,b.info("pull camera : ",n.cameraDevicesList[o]),coreConf.NotifyLocalCameraPull(0,a,r);case 48:"VIDEO_OUT"!==u&&"VIDEO_CONNECTED"!==u||("win"===window.CLIENTCONFIG.PLATFORM&&coreConf.getSvcAtdManager().alertBox(language.NATIVE_NO_CAMERA_THEN_TIPS,3),"mac"===window.CLIENTCONFIG.PLATFORM&&window.alert(language.NO_CAMERA_THEN_TIPS)),window.CLIENTCONFIG.ISWIN&&!$getState().conf.isSvcConf&&coreConf.updateCameraList();case 50:case 51:coreCommon.isWin()&&(x=$getState().call.callStatus,"VIDEO_CONNECTED"===x||"VIDEO_OUT"===x||"CALL_OUT"===x||"CALL_CONNECTED"===x?coreSetting.showDevicesListFunc():$dispatch(coreUi.changeIsShowDevicesList(!0))),window.CLIENTCONFIG.ISBIGWIN&&coreConf.NotifyCameraListUpdateEx(0);case 53:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),je=t.handleSpkMicList=function(e){b.info("handleSpkMicList ",(0,s.default)(e));var t={};if(0!==e.input_num){window.isOpenSpeechDetect=!0,b.info("isOpenSpeechDetect.true");var n=$getState().call.micDevicesList;$dispatch(coreUi.changeMicDevicesList(e.input_array));var a=$getState().setting.micCount;if(e.input_num>a){var r=coreSetting.getInsertDeviceByName(n,e.input_array);b.info("Mic device added, get new device serial number=",r),-1!==r?coreSetting.setAndSaveMicDevice(r):coreSetting.setAndSaveMicDevice(0),t=(0,d.default)(t,{mic_devices:{micIndex:-1===r?0:r,micDevicesList:e.input_array}}),coreConf.getSvcAtdManager().setParam(t)}else e.input_num<a&&(b.info("some mic device has deleted, set device index 0"),coreSetting.setAndSaveMicDevice(0))}else $dispatch(coreUi.changeMicDevicesList([])),t=(0,d.default)(t,{mic_devices:{micDevicesList:[]}}),coreConf.getSvcAtdManager().setParam(t);if(0!==e.output_num){var o=$getState().call.spkDevicesList;$dispatch(coreUi.changeSpkDevicesList(e.output_array));var i=$getState().setting.spkCount,c=void 0;if(window.CLIENTCONFIG.ISBIGWIN){var l=coreSetting.getDefaultSpkDevice(e.output_array);coreSetting.setAndSaveSpkDevice(l)}else if(e.output_num>i){var u=coreSetting.getInsertDeviceByName(o,e.output_array);b.info("some spk device added, get new device serial number=",u),-1!==u?(c=coreSetting.getValidSpkDeviceSerialNum(e.output_array,u),coreSetting.setAndSaveSpkDevice(c)):(c=coreSetting.getValidSpkDeviceSerialNum(e.output_array),coreSetting.setAndSaveSpkDevice(c)),t=(0,d.default)(t,{spk_devices:{spkIndex:c,spkDevicesList:e.output_array}}),coreConf.getSvcAtdManager().setParam(t)}else e.output_num<i&&(c=coreSetting.getValidSpkDeviceSerialNum(e.output_array),b.info("some spk device has deleted, set default device serial number=",c),coreSetting.setAndSaveSpkDevice(c))}else $dispatch(coreUi.changeSpkDevicesList([])),t=(0,d.default)(t,{spk_devices:{spkDevicesList:[]}}),coreConf.getSvcAtdManager().setParam(t);if($dispatch(coreUi.changeMicCount(e.input_num)),$dispatch(coreUi.changeSpkCount(e.output_num)),coreCommon.isWin()){var f=$getState().call.callStatus;"VIDEO_CONNECTED"===f||"VIDEO_OUT"===f||"CALL_OUT"===f||"CALL_CONNECTED"===f?(b.info("handleSpkMicList showDevicesListFunc()"),coreSetting.showDevicesListFunc()):$dispatch(coreUi.changeIsShowDevicesList(!0))}},Je=t.handleNoStream=function(e){var t=$getState().call.noStreamEndcall;if(e.Duration&&(5===e.Duration?t=1:10===e.Duration?t=2:e.Duration>=15&&(t=3)),b.info("receive no stream notify,noStreamEndCall = ",t),t>=3){b.info("receive 3 times no stream notify,need active hangup call"),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&coreConf.meetingHWreCallTimeOut("30s No Stream");var n=coreConf.isInConf(),a=void 0;if(n){a=[coreConf.getCurrentConfId()]}else{var r=$getState().call.callNum;a=[handlePhoneNumber(r)]}coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_NO_STREAM_HANGUP,params:[a]});var o=coreConf.getSavedRecallInfo();Et(o,!0,e.callId),t=0}Ye(t)},Ye=t.changeNoStreamEndcall=function(e){b.info("changenoStreamEndcall: Num"+e+" bNeedReCall: "+coreConf.isInReCall()),window.CLIENTCONFIG.ISMOBILE?1===e?b.info("continues 5 seconds without stream"):2===e?(b.info("continues 10 seconds without stream"),window.ToastNew(language.NO_STREAM_AFTER_TIMES.format(5*e),2)):coreConf.isInReCall()&&window.ToastNew(language.READY_TO_RECALL,2):window.CLIENTCONFIG.ISWIN&&(1===e?b.info("continues 5 seconds without stream"):2===e?(b.info("continues 10 seconds without stream"),coreConf.getSvcAtdManager().alertBox(language.NO_STREAM_AFTER_TIMES.format(5*e),3)):coreConf.isInReCall()&&coreConf.getSvcAtdManager().alertBox(language.READY_TO_RECALL,3)),$dispatch(coreUi.changenoStreamEndcall(e))},qe=function(e){e.call_id===$getState().call.callId&&coreUi.stopRing()},Ke=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call,"CALL_OUT"!==n.callStatus&&"VIDEO_OUT"!==n.callStatus||1===t.param.is_kick_off&&Pe(n.callNum),1!==t.param.is_kick_off||window.CLIENTCONFIG.USE_IM&&window.isEserverOnline){e.next=10;break}if(b.info("sip kickOff"),"function"!=typeof window.isJudgeDialogExist||!window.isJudgeDialogExist(language.LOGIN_LOGGEDON_ANOTHER)){e.next=7;break}return b.info("sip kickOff, has exit alert"),e.abrupt("return");case 7:return e.next=9,coreAccount.clearResumeService();case 9:coreAccount.checkAndEndCall().then(function(){if(window.CLIENTCONFIG.ENABLE_IT_MEETING)return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.setSipState("0"),b.info("handleSipKickOff, set isOffline true"),window.isOffline=!0,coreAccount.sipserverDeregister(),void b.info("it welink return by kick off");coreAccount.setOffline({}),window.endCallPromise&&(window.endCallPromise=null)}).then((0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE||appService.showMainWindow(!0),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=7;break}return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?window.itWeLinkNotifyCallEnded(0,language.LOGIN_LOGGEDON_ANOTHER):window.setSipState("0"),b.info("handleSipKickOff, set isOffline true"),window.isOffline=!0,b.info("it welink return by kick off 1"),e.abrupt("return");case 7:return b.info("sip kickOff to loginPage"),e.next=10,coreAccount.cancelLogin();case 10:if(window.isPluginEnv){e.next=13;break}return e.next=13,alert(language.LOGIN_LOGGEDON_ANOTHER);case 13:return coreCommon.dispatchModuleEvent("sipKickOutFinished"),e.next=16,coreAccount.clearState();case 16:window.CLIENTCONFIG.ISMOBILE?window.goRoute("loginCtn"):window.goRoute(window.isHubEnv?"maxhubLogin":"login");case 17:case"end":return e.stop()}},e,this)})));case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Qe=t.handleDataStartError=function(e){var t=$getState(),n=t.call.callId;window.CLIENTCONFIG.ISMOBILE&&e.param.call_id===n||n&&e.param.call_id===n&&(b.error("data start error"),window.ToastNew(language.CONFERENCE_DATA_START_FAIL,2),$dispatch(coreUi.hideDataShareButton(!1)),b.info("isDataSharing false 1"),window.isDataSharing=!1,$dispatch(coreUi.showDataControl(!1)),(0,g.exitFullScreen)())},Ze=t.handleDataSending=function(e){if(window.CLIENTCONFIG.ISMOBILE){var t=$getState().call.callId;e.param.call_id===t?(b.info("[bfcp] send bfcp from socket success!"),$getState().call.isReceiveBfcp?(1,0):(0,0),$dispatch(coreUi.changeSendBfcp(!0)),$dispatch(coreUi.changeReceiveBfcp(!1)),$dispatch(coreUi.createConfTipMsg([language.ISSHARING_NOT_WATCH_VIDEO]))):(b.info("[bfcp] send bfcp from socket failed!"),$dispatch(coreUi.createConfTipMsg([language.SHARE_FAILED])))}},Xe=t.handleDataStopped=function(e,t){if(window.CLIENTCONFIG.ISMOBILE){var n=$getState().call.callId;t.param.call_id===n?(b.info("[bfcp] stop bfcp from socket success!"),$getState().call.isSendBfcp?(0,0):$getState().call.isReceiveBfcp&&(1,0),$dispatch(coreUi.createConfTipMsg([])),$dispatch(coreUi.changeSendBfcp(!1)),$dispatch(coreUi.changeReceiveBfcp(!1))):b.info("[bfcp] stop bfcp from socket failed!")}},et=t.startsipcallout=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().login.tempConfInfo,e.next=3,coreConf.oneKeyEnterConf(t.access_code,t.conf_id,t.conf_pwd,!0);case 3:n=e.sent,!n&&window.isPluginEnv&&coreCommon.dispatchModuleEvent("joinMeetingAnonymousNotify",{code:-3,msg:"oneKeyEnterConf failed!"});case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),tt=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return coreConf.NotifyLoginSuccess(),e.next=3,coreAccount.getLoginModel();case 3:if(t=e.sent,b.info("big win login sucess"),b.debug("CloudLink confAcc "+window.confAccesscode+", confPas ***"),isNullOrEmpty(window.confAccesscode)||isNullOrEmpty(window.confPasscode)){e.next=29;break}if(n=window.confVip?window.confVip:"",$dispatch(coreUi.changeBuriedAccesscode(window.confAccesscode)),$dispatch(coreUi.changeBuriedPasscode(window.confPasscode)),$dispatch(coreUi.changeBuriedJoinConfVip(window.confVip)),a=window.confAccesscode+"*"+window.confPasscode,(r=t.isSipRegSuc())&&!window.isOffline){e.next=17;break}return b.error("CloudLink is offline, auto call is failed"),coreConf.NotifyJoinConfFailedEx(0),e.abrupt("return");case 17:if(isNullOrEmpty(window.ConfUsername)){e.next=22;break}return e.next=20,coreTup.getCallInstance();case 20:o=e.sent,o.configTUPCallCfgAccountName(window.ConfUsername);case 22:b.info("window.bigConfIsVideo = "+window.bigConfIsVideo),Y(a,{number:a,addr_vip:n},window.bigConfIsVideo),window.confAccesscode="",window.confPasscode="",window.confVip="",window.ConfUsername="",window.switchAccount=!1;case 29:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),nt=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.noactivity&&!coreConf.isInReCall()){e.next=14;break}return b.info("[IT-Meeting] recv sip register OK, start call enter conf"),t=appService.getItUserInfo(),n=t.userNameEN,isNullOrEmpty(n)&&(n=window.linkSmcW3Acc),e.next=7,coreTup.getCallInstance();case 7:a=e.sent,a.configTUPCallCfgAccountName(n),r=window.linkSmcAccessCode,o=window.linkSmcPasscode,coreConf.oneKeyEnterConf(r,"",o,window.linkSmcIsVideo),e.next=17;break;case 14:return b.info("[IT-Meeting] recv sip register OK but no activity, do logout."),e.next=17,coreAccount.meetinghwSipEnableToLogout();case 17:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),at=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreAccount.getLoginModel();case 2:return t=e.sent,t.sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED,n=$getState().login.sipLoginOnly,a=$getState().call,r="VIDEO_CONNECTED"===a.callStatus||"CALL_CONNECTED"===a.callStatus||"VIDEO_OUT"===a.callStatus,b.info("[sip register] sip register ok. siploginonly = "+n+" isCallConnected: "+r),o=[],n&&isNullOrEmpty($getState().conf.confTempAcsAccount)&&(r||(window.CLIENTCONFIG.ENABLE_IT_MEETING||o.push(coreConf.confctrlInit()),o.push(coreConf.saveTempMediaxInfo()))),o.push(ct()),e.next=13,p.default.all(o);case 13:if(window.CLIENTCONFIG.ENABLE_IT_MEETING&&(window.requestMultiTerminalPromise&&(b.info("[sip register] resume start conf"),window.requestMultiTerminalPromise.resolve(!1)),b.info("sipResultStateRegisted, set isOffline false"),window.isOffline=!1),!n||!$getState().conf.enableAnonymousJoinConf){e.next=24;break}if(!coreConf.isInReCall()){e.next=19;break}coreConf.reCallEnterConf(),e.next=23;break;case 19:if(r){e.next=23;break}return e.next=22,coreAccount.registerResumeEvent();case 22:et();case 23:return e.abrupt("return");case 24:if(!window.CLIENTCONFIG.ISBIGWIN){e.next=29;break}return e.next=27,tt();case 27:e.next=30;break;case 29:window.isHubEnv&&(coreConf.NotifySipRegisterd(),coreConf.NotifyLoginSuccess(),b.info("send maxhub notify, sip register success and Login Success"));case 30:if(window.CLIENTCONFIG.ISMOBILE?rt(n):b.debug("no need to call"),isNullOrEmpty(window.enterNoNameConfUrl)){e.next=36;break}return b.info("[sip register] handle delay join temp conf"),e.next=35,window.handleJoinTempConfNoName(window.enterNoNameConfUrl);case 35:window.enterNoNameConfUrl=null;case 36:if(!coreConf.getLinkJoinConfService().shouldJoinConfByLink){e.next=40;break}return b.info("[sip register] handle delay join link conf"),e.next=40,coreConf.getLinkJoinConfService().actionJoinConfByLink();case 40:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=47;break}return e.next=43,coreAccount.resetSipResumeFlag();case 43:return e.next=45,nt();case 45:e.next=48;break;case 47:coreConf.reCallEnterConf();case 48:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.sipRegResultNotify=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().login,a=n.sipImpi,b.info("[sip register]"),t.param.tel_number===a){e.next=6;break}return b.info(" [sip register] account not compared, no handle "),e.abrupt("return");case 6:if(1!==t.param.register_state&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&$dispatch(coreUi.enableHangUp(!0)),r=$getState().call,"CALL_OUT"!==r.callStatus&&"VIDEO_OUT"!==r.callStatus||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||2!==t.param.register_state&&4!==t.param.register_state||te(r.callNum),b.info("[sip register] reason_code",t.param.reason_code),o="0",constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED!==t.param.register_state||0!==t.param.reason_code){e.next=31;break}return coreCommon.Observer.unsubsribleAll(),coreCall.registerCallEvent(),coreCall.registerVideoEvent(),coreConf.getRegisterConfEventAtomic().reset(),coreConf.getSubScribeConfListAndInfoResAtomic().reset(),coreConf.getRegisterConfEventAtomic().wait(),e.next=20,coreAccount.getLoginModel();case 20:if(i=e.sent,!i.useMetting){e.next=24;break}return e.next=24,coreConf.initializeDataConf();case 24:return(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ISWIN)&&coreConf.registerNativeWndEvent(),window.CLIENTCONFIG.ENABLE_IT_MEETING||(c=$getState().login.sipLoginOnly)||window.CLIENTCONFIG.ISBIGWIN||coreConf.getVRMList(),o="1",e.next=29,at();case 29:e.next=36;break;case 31:if(constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING!==t.param.register_state){e.next=34;break}e.next=36;break;case 34:return e.next=36,ot(t);case 36:window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING!==t.param.register_state&&(window.requestSipLoginPromise&&window.requestSipLoginPromise.resolve(),window.requestSipLoginTimer&&(clearTimeout(window.requestSipLoginTimer),window.requestSipLoginTimer=null),window.alreadyDoSipRegiser=!0),window.setSipState(o));case 37:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.dealStartCall=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,t=o,b.info("debug info [delete] deal start call : ",handlePhoneNumber(t.calleeNumber)),!t){e.next=19;break}if(t.calleeNumber&&(t.calleeNumber=t.calleeNumber.replace(/\s*/g,"").replace(/-/g,"")),t.number=t.calleeNumber,t.name||(t.name=t.number),!t.name||t.name!==t.number){e.next=15;break}return n=t.number,n.length>11&&0===n.indexOf("+86")&&(n=n.replace("+86","")),e.next=12,coreContact.searchServerContact({query_key:n});case 12:a=e.sent,r=a.userInformationList||[],r.length>0&&(t.name=getContactName(r[0]),t.account=r[0].account,t.contactsId=r[0].account,t.contactId=r[0].account,b.info("debug info [delete] deal start call : "+handlePhoneNumber(t.account)+handlePhoneNumber(t.contactsId)));case 15:t.acount||(t.contactsId?t.account=t.contactsId:t.account=t.calleeNumber),t.name||(t.name=t.calleeNumber),window.CLIENTCONFIG.ENABLE_IT_MEETING&&$dispatch(coreUi.changeUserInfo({contactsId:t.contactsId,name:t.name})),Y(t.number,t,!1);case 19:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.dealStartVideo=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,t=n,b.info("dealStartVideo, set isOffline false"),window.isOffline=!1,t&&(t.account||(t.account=t.contactsId),t.calleeNumber&&(t.calleeNumber=t.calleeNumber.replace(/\s*/g,"").replace(/-/g,"")),t.isVideo=!0,t.number||(t.number=t.calleeNumber),Y(t.number,t,!0));case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();var rt=(t.callAfterPCKickout=function(){if(window.CLIENTCONFIG.ISMOBILE){var e=$getState(),t=e.call.savedCalleeInfo;isNullOrEmpty(t)||(b.info("call after kick out pc"),window.Toast("",0,null,!1,!0),t.bConf?window.dispatchEvent(new Event("sipRegisterSuc")):t.oneKeyEnterConf?H(t.number,t.contactInfo,t.bVideo):coreConf.oneKeyEnterConf(t.number,t.enterConfParam.pstconfparam.confid,t.enterConfParam.pstconfparam.conf_paswd,t.bVideo))}},t.SipRegusterOKMobile=function(e){var t=$getState(),n=t.call,a=n.savedCalleeInfo,r=n.tempConfInfo;isNullOrEmpty(a)?isNullOrEmpty(r)?b.debug("no need to call"):(b.info("call by temp conf"),window.dispatchEvent(new Event("sipRegisterSuc"))):(b.info("refresh [token] after kickout pc"),coreAccount.actionRefreshToken())}),ot=t.SipRegusterNotOK=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ENABLE_IT_MEETING&&(b.info("SipRegusterNotOK, set isOffline true"),window.isOffline=!0),!window.CLIENTCONFIG.ISMOBILE){e.next=9;break}if(n=$getState(),a=n.call,r=a.savedCalleeInfo,o=a.tempConfInfo,isNullOrEmpty(r)||(b.info("notify sip register failed"),window.Toast(language.CALL_CALLING_FAILED,3,null,!1),$dispatch(coreUi.saveCalleeInfo({}))),isNullOrEmpty(o)||(b.info("notify sip register failed for temp conf"),window.Toast(language.CALL_CALLING_FAILED,3,null,!1),$dispatch(coreUi.saveTempConfInfo({})),coreAccount.logout({isBackLogin:!0,isKickout:!0})),i=coreConf.getSavedRecallInfo(),isNullOrEmpty(i)){e.next=9;break}return window.CLIENTCONFIG.USE_IM&&(b.info("notify sip register failed,recallOrHangup"),Et(i,!0,"")),e.abrupt("return");case 9:if(window.CLIENTCONFIG.ISBIGWIN&&constant.SIP_REGISTER_STATE.SIP_REGISTER_DEREGISTERING!==t.param.register_state&&constant.SIP_REGISTER_STATE.SIP_REGISTER_BUTT!==t.param.register_state&&(coreConf.NotifyJoinConfFailedEx(1),b.info("big win login failed",t.param.register_state)),!(c=$getState().login.sipLoginOnly)||!$getState().conf.enableAnonymousJoinConf){e.next=21;break}if($dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),coreConf.isInReCall()){e.next=20;break}return window.isPluginEnv||window.ToastNew(language.ENTER_CONF_FAIL,2),e.next=18,coreAccount.getLoginModel();case 18:l=e.sent,l.sipLoginOnly&&coreCommon.dispatchModuleEvent("joinMeetingAnonymousNotify",{code:t.reason_code,msg:"sip register failed"});case 20:b.info("SipRegusterNotOK alter ");case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),it=(t.setUserSelectToNone=function(){window.getSelection().removeAllRanges(),document.documentElement.style["user-select"]="none",document.unselectable="on",document.onselectstart=function(){return!1},document.activeElement&&document.activeElement.blur instanceof Function&&document.activeElement.blur()},t.resumeUserSelect=function(){document.documentElement.style["user-select"]="text",document.unselectable="off",document.onselectstart=null},function(){var e=(0,v.default)(C.default.mark(function e(t,n,a){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.USE_IM){e.next=2;break}return e.abrupt("return");case 2:if(t.account){e.next=4;break}return e.abrupt("return");case 4:if(b.debug("refresh recent by userInfo: "+handlePhoneNumber(t.account)),!a){e.next=7;break}return e.abrupt("return");case 7:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}()),ct=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=we(),n=Ie(),e.next=4,t;case 4:return a=e.sent,e.next=7,n;case 7:r=e.sent,$dispatch(coreUi.changeMicValue(a)),$dispatch(coreUi.changeVoiceValue(r)),b.info("init mic volume: ",a,", init spk volume: ",r);case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),lt=function(e){for(var t=e,n=$getState().conf,a=n.svcOnLineAttendances,r=n.svcShowAttendances,o=n.svcWatchIndNotify,i=0;i<r.length;i++)if(e===r[i].ssrc&&r[i].number)for(var c=0;c<a.length;c++)r[i].number===a[c].number&&(t=a[c].name);for(var l=0;l<o.length;l++)e===o[l].ssrc&&o[l].conf_name&&(t=o[l].conf_name);return t},st=t.getCallMediaInfoOnMobile=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o,i,c,l,u,d,f,p,h,m,v,w,I,g,_,S,N,E,k,y,T,x,O,L,M,R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=R,!isNullOrEmpty(t)){e.next=5;break}return e.next=4,pe({});case 4:t=e.sent;case 5:if(window.CLIENTCONFIG.ENABLE_IT_MEETING,n=$getState().conf,a=n.svcShowAttendances,r=n.isDataConfSharing,o=$getState().call,i=o.iSreceivingBFCP,c=o.mediaInfo,0!==t.result){e.next=54;break}if(l="",u="",d="",f="",p="",h="",m="",v="",w="",I="",g="",_="",S="",N="",E="",k="",y="",T={audio:{send:{},recv:{}},video:{send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{ssrc:"--",decodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"}}},x=$getState(),O=x.conf.svcNativeToJS.multiStreamMode,r&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(window.getASCodeInfo(),isNullOrEmpty(c.data)||(b.info("get old data info:"+c.data),T.data=c.data)),!(t.param.svc_stream_info&&t.param.svc_stream_info.length&&t.param.svc_stream_info.length>0&&2!==O)){e.next=50;break}L=0;case 31:if(!(L<t.param.svc_stream_info.length)){e.next=50;break}if(""!==t.param.svc_stream_info[L].encoder_size&&(l=t.param.svc_stream_info[L].encode_name+" "+t.param.svc_stream_info[L].encoder_profile+";"+l,u=t.param.svc_stream_info[L].video_send_bit_rate/1e3+";"+u,d=t.param.svc_stream_info[L].encoder_size+";"+d,f=t.param.svc_stream_info[L].send_fram_rate+";"+f,p=t.param.svc_stream_info[L].send_loss_fraction+";"+p,h=t.param.svc_stream_info[L].send_delay+";"+h,m=t.param.svc_stream_info[L].send_jitter+";"+m,v=t.param.svc_stream_info[L].is_srtp+";"+v),0===t.param.svc_stream_info[L].dec_ssrc){e.next=46;break}if((M=lt(t.param.svc_stream_info[L].dec_ssrc))!==language.FAILURE_ERR_TUP){e.next=37;break}return e.abrupt("return");case 37:w=M+";"+w,I=t.param.svc_stream_info[L].encode_name+" "+t.param.svc_stream_info[L].encoder_profile+";"+I,g=t.param.svc_stream_info[L].video_recv_bit_rate/1e3+";"+g,_=t.param.svc_stream_info[L].decoder_size+";"+_,S=t.param.svc_stream_info[L].recv_fram_rate+";"+S,N=t.param.svc_stream_info[L].recv_loss_fraction+";"+N,E=t.param.svc_stream_info[L].recv_delay+";"+E,k=t.param.svc_stream_info[L].recv_jitter+";"+k,y=t.param.svc_stream_info[L].is_srtp+";"+y;case 46:(0!==t.param.svc_stream_info[L].dec_ssrc&&!t.param.svc_stream_info[L].video_recv_bit_rate||!t.param.svc_stream_info[L].send_fram_rate&&""!==t.param.svc_stream_info[L].encoder_size)&&b.info("getCallMediaParams OnMobile no stream recv. tempSSRC=",t.param.svc_stream_info[L].dec_ssrc,(0,s.default)(t.param.svc_stream_info[L]));case 47:L++,e.next=31;break;case 50:T.video={send:{encodeProtocol:isNullOrEmpty(l)?"--":l,bitRate:isNullOrEmpty(u)?"--":u,frameSize:isNullOrEmpty(d)?"--":d,frameRate:isNullOrEmpty(f)?"--":f,lost:isNullOrEmpty(p)?"--":p,delay:isNullOrEmpty(h)?"--":h,jitter:isNullOrEmpty(m)?"--":m,srtp:isNullOrEmpty(v)?"--":v},recv:{confName:isNullOrEmpty(w)?"--":w,decodeProtocol:isNullOrEmpty(I)?"--":I,bitRate:isNullOrEmpty(g)?"--":g,frameSize:isNullOrEmpty(_)?"--":_,frameRate:isNullOrEmpty(S)?"--":S,lost:isNullOrEmpty(N)?"--":N,delay:isNullOrEmpty(E)?"--":E,jitter:isNullOrEmpty(k)?"--":k,srtp:isNullOrEmpty(y)?"--":y}},i&&(T.bfcp={send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{decodeProtocol:t.param.data_stream_info.decode_name+" "+t.param.data_stream_info.decoder_profile,bitRate:t.param.data_stream_info.video_recv_bit_rate/1e3,frameSize:t.param.data_stream_info.decoder_size,frameRate:t.param.data_stream_info.recv_fram_rate,lost:t.param.data_stream_info.recv_loss_fraction,delay:t.param.data_stream_info.recv_delay,jitter:t.param.data_stream_info.recv_jitter,srtp:t.param.data_stream_info.is_srtp}}),T.audio={send:{encodeProtocol:t.param.audio_stream_info.encode_protocol,bitRate:t.param.audio_stream_info.send_bit_rate,lost:t.param.audio_stream_info.send_loss_fraction,srtp:t.param.audio_stream_info.is_srtp,delay:t.param.audio_stream_info.send_delay,jitter:t.param.audio_stream_info.send_jitter},recv:{decodeProtocol:t.param.audio_stream_info.decode_protocol,bitRate:t.param.audio_stream_info.recv_bit_rate,lost:t.param.audio_stream_info.recv_loss_fraction,srtp:t.param.audio_stream_info.is_srtp,delay:t.param.audio_stream_info.recv_delay,jitter:t.param.audio_stream_info.recv_jitter}},$dispatch(coreUi.changeCallMediaInfo(T));case 54:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.notifyAsGetCodecInfo=function(e){var t=$getState().call.mediaInfo;if(!isNullOrEmpty(t)){if(isNullOrEmpty(e))return b.info("asCodeInfo is null"),void(t.data=null);b.info("asCodeInfo",e),t.data={send:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"},recv:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"}},0!==e.codecType?t.data.send={frameRate:e.frameRate+"",byteRate:e.byteRate+"",frameSize:e.width+"*"+e.height,codecVersion:pt(e.codecVersion)}:t.data.recv={frameRate:e.frameRate+"",byteRate:e.byteRate+"",frameSize:e.width+"*"+e.height,codecVersion:pt(e.codecVersion)},$dispatch(coreUi.changeCallMediaInfo(t))}};var ut=t.getCallMediaInfoOfNative=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,i,c,l,s,u,f,p,h,m,v,w,I,g,_,S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S,!isNullOrEmpty(t)){e.next=5;break}return e.next=4,pe({});case 4:t=e.sent;case 5:if(n=$getState().call,a=n.showMediaInfo,r=n.iSreceivingBFCP,i=$getState().conf.isSvcConf,c=$getState().conf.isDataConfSharing,l=new Array,s=new o.default,0!==t.result){e.next=25;break}if(u={audio_stream_info:t.param.audio_stream_info},r&&(u=(0,d.default)({},u,{data_stream_info:t.param.data_stream_info})),t.param.svc_stream_info&&t.param.svc_stream_info.length>0)for(f=0;f<t.param.svc_stream_info.length;f++)p=t.param.svc_stream_info[f],h=p.dec_ssrc,h>0&&(m=coreConf.getSvcAtdManager().getConfhwndBySsrc(h))>0&&(v=t.param.svc_stream_info[f].recv_loss_fraction,w=v<10?0:v<25?1:2,s.set(m,w)),a&&(I="",h>0?(I=coreConf.getSvcAtdManager().getConfNameBySsrc(h),p=(0,d.default)(p,{conf_name:I}),l.push(p)):f<4&&(p=(0,d.default)(p,{conf_name:I}),l.push(p)));if(s.size>0&&coreConf.getSvcAtdManager().reportSingleState(s),!a){e.next=23;break}if(u=i?(0,d.default)(u,{svc_stream_info:l}):(0,d.default)(u,{video_stream_info:t.param.video_stream_info}),!coreConf.isInDataScreenOrWbSharing()){e.next=22;break}return e.next=20,coreConf.getDataStreamInfo();case 20:g=e.sent,g&&g.param&&(b.info(" set share_stream_info"),_={},0===g.param.status?(_.status=1,_.enc_version=g.param.version,_.enc_width=g.param.width,_.enc_height=g.param.height,_.enc_framerate=g.param.framerate,_.enc_bitrate=g.param.bitrate,_.enc_pktloss=g.param.pktloss,_.enc_rtt=g.param.rtt,_.enc_jitter=g.param.jitter):1===g.param.status&&(_.status=2,_.dec_version=g.param.version,_.dec_width=g.param.width,_.dec_height=g.param.height,_.dec_framerate=g.param.framerate,_.dec_bitrate=g.param.bitrate,_.dec_pktloss=g.param.pktloss,_.dec_rtt=g.param.rtt,_.dec_jitter=g.param.jitter),u=(0,d.default)(u,{share_stream_info:_}));case 22:coreConf.getSvcAtdManager().reportQos(u);case 23:e.next=26;break;case 25:b.info("getCallMediaInfoOfNative getCallMediaParams failed!");case 26:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),dt=(t.handleisSvcConfShowQOS=function(e){b.info("userClick  change SvcConf Show QOS = ",e),$dispatch(coreUi.changeisSvcConfShowQOS(e))},t.getCallMediaInfoBySsrc=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,v,w,I,g,_,S,N,E,k;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("getCallMediaInfoBySsrc,ssrc = ",t),T=t,!(!t||t>$getState().conf.ssrcRange.max||t<$getState().conf.ssrcRange.min)){e.next=5;break}return b.info("getCallMediaInfoBySsrc, ssrc is invalid, return"),e.abrupt("return");case 5:return n={},e.next=8,pe(n);case 8:if(a=e.sent,0!==a.result){e.next=34;break}if(r="",o="",i="",c="",l="",s="",u="--",f={encodeProtocol:u,bitRate:u,frameSize:u,frameRate:u,lost:u,delay:u,jitter:u,srtp:u},p={decodeProtocol:u,bitRate:u,frameSize:u,frameRate:u,lost:u,delay:u,jitter:u,srtp:u},h={version:u,width:u,height:u,frameRate:u,bitRate:u},m={audio:{send:f,recv:p},video:{send:f,recv:p}},v={decodeProtocol:a.param.data_stream_info.decode_name+" "+a.param.data_stream_info.decoder_profile,bitRate:a.param.data_stream_info.video_recv_bit_rate/1e3,frameSize:a.param.data_stream_info.decoder_size,frameRate:a.param.data_stream_info.recv_fram_rate,lost:a.param.data_stream_info.recv_loss_fraction,delay:a.param.data_stream_info.recv_delay,jitter:a.param.data_stream_info.recv_jitter,srtp:a.param.data_stream_info.is_srtp},w=$getState().conf,I=w.isSvcShareMode,g=w.svcShareData,_=$getState().call.iSreceivingBFCP,(window.isDataSharing||I&&g.hasOwnProperty("ssrc")&&-2===g.ssrc)&&(v={decodeProtocol:"",bitRate:0,frameSize:"",frameRate:0,lost:0,delay:0,jitter:0,srtp:a.param.data_stream_info.is_srtp}),!(a.param.svc_stream_info&&a.param.svc_stream_info.length&&a.param.svc_stream_info.length>0)){e.next=32;break}for(S=0;S<a.param.svc_stream_info.length;S++)""!==a.param.svc_stream_info[S].encoder_size&&(r=a.param.svc_stream_info[S].video_send_bit_rate/1e3+","+r,o=a.param.svc_stream_info[S].encoder_size+","+o,i=a.param.svc_stream_info[S].send_fram_rate+","+i,c=a.param.svc_stream_info[S].send_loss_fraction+","+c,l=a.param.svc_stream_info[S].send_delay+","+l,s=a.param.svc_stream_info[S].send_jitter+","+s),a.param.svc_stream_info[S].dec_ssrc===t&&(m={audio:{send:{encodeProtocol:a.param.audio_stream_info.encode_protocol,bitRate:a.param.audio_stream_info.send_bit_rate,lost:a.param.audio_stream_info.send_loss_fraction,srtp:a.param.audio_stream_info.is_srtp,delay:a.param.audio_stream_info.send_delay,jitter:a.param.audio_stream_info.send_jitter},recv:{decodeProtocol:a.param.audio_stream_info.decode_protocol,bitRate:a.param.audio_stream_info.recv_bit_rate,lost:a.param.audio_stream_info.recv_loss_fraction,srtp:a.param.audio_stream_info.is_srtp,delay:a.param.audio_stream_info.recv_delay,jitter:a.param.audio_stream_info.recv_jitter}},video:{send:{encodeProtocol:a.param.svc_stream_info[S].encode_name+" "+a.param.svc_stream_info[S].encoder_profile,bitRate:r,frameSize:o,frameRate:i,lost:c,delay:l,jitter:s,srtp:a.param.svc_stream_info[S].is_srtp},recv:{decodeProtocol:a.param.svc_stream_info[S].decode_name+" "+a.param.svc_stream_info[S].decoder_profile,bitRate:a.param.svc_stream_info[S].video_recv_bit_rate/1e3,frameSize:a.param.svc_stream_info[S].decoder_size,frameRate:a.param.svc_stream_info[S].recv_fram_rate,lost:a.param.svc_stream_info[S].recv_loss_fraction,delay:a.param.svc_stream_info[S].recv_delay,jitter:a.param.svc_stream_info[S].recv_jitter,srtp:a.param.svc_stream_info[S].is_srtp}}},_?m.bfcp={send:{encodeProtocol:a.param.data_stream_info.encode_name+" "+a.param.data_stream_info.encoder_profile,bitRate:a.param.data_stream_info.video_send_bit_rate/1e3,frameSize:a.param.data_stream_info.encoder_size,frameRate:a.param.data_stream_info.send_fram_rate,lost:a.param.data_stream_info.send_loss_fraction,delay:a.param.data_stream_info.send_delay,jitter:a.param.data_stream_info.send_jitter,srtp:a.param.data_stream_info.is_srtp},recv:v}:m.video.send={encodeProtocol:a.param.svc_stream_info[S].encode_name+" "+a.param.svc_stream_info[S].encoder_profile,bitRate:r,frameSize:o,frameRate:i,lost:c,delay:l,jitter:s,srtp:a.param.svc_stream_info[S].is_srtp});if(!coreConf.isInDataScreenOrWbSharing()){e.next=32;break}return e.next=30,coreConf.getDataStreamInfo();case 30:N=e.sent,N&&N.param&&(E={send:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"},recv:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"}},k={codecVersion:pt(N.param.version),frameSize:N.param.width+"*"+N.param.height,frameRate:N.param.framerate,byteRate:N.param.bitrate},0===N.param.status?(m.data=E,m.data.send=k):1===N.param.status&&(m.data=E,m.data.recv=k),b.info(" set share_stream_info "));case 32:n=(0,d.default)({},m),$dispatch(coreUi.changeCallMediaInfo(n));case 34:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),ft=t.getCallMediaInfo=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r,o,i,c,l,s,u,f,p,h;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call,n=t.showMediaInfo,a=t.iSreceivingBFCP,r=t.mediaInfo,o=t.callStatus,i=$getState().conf.isDataConfSharing,c="VIDEO_OUT"===o||"VIDEO_CONNECTED"===o,l={},s={},!n){e.next=12;break}if(!coreConf.isInDataScreenOrWbSharing()||window.CLIENTCONFIG.ISMOBILE){e.next=12;break}return e.next=9,coreConf.getDataStreamInfo();case 9:u=e.sent,u&&u.param&&(b.info(" set share_stream_info"),0===u.param.status?(l.status=1,l.enc_version=u.param.version,l.enc_width=u.param.width,l.enc_height=u.param.height,l.enc_framerate=u.param.framerate,l.enc_bitrate=u.param.bitrate,l.enc_pktloss=u.param.pktloss,l.enc_rtt=u.param.rtt,l.enc_jitter=u.param.jitter):1===u.param.status&&(l.status=2,l.dec_version=u.param.version,l.dec_width=u.param.width,l.dec_height=u.param.height,l.dec_framerate=u.param.framerate,l.dec_bitrate=u.param.bitrate,l.dec_pktloss=u.param.pktloss,l.dec_rtt=u.param.rtt,l.dec_jitter=u.param.jitter)),s=(0,d.default)(s,{share_stream_info:l});case 12:return f={},e.next=15,pe(f);case 15:if(p=e.sent,0!==p.result){e.next=27;break}return f={audio:{send:{encodeProtocol:p.param.audio_stream_info.encode_protocol,bitRate:p.param.audio_stream_info.send_bit_rate/1e3,lost:p.param.audio_stream_info.send_loss_fraction,srtp:p.param.audio_stream_info.is_srtp,delay:p.param.audio_stream_info.send_delay,jitter:p.param.audio_stream_info.send_jitter},recv:{decodeProtocol:p.param.audio_stream_info.decode_protocol,bitRate:p.param.audio_stream_info.recv_bit_rate,lost:p.param.audio_stream_info.recv_loss_fraction,srtp:p.param.audio_stream_info.is_srtp,delay:p.param.audio_stream_info.recv_delay,jitter:p.param.audio_stream_info.recv_jitter}}},c&&(f.video={send:{encodeProtocol:p.param.video_stream_info.encode_name+" "+p.param.video_stream_info.encoder_profile,bitRate:p.param.video_stream_info.video_send_bit_rate/1e3,frameSize:p.param.video_stream_info.encoder_size,frameRate:p.param.video_stream_info.send_fram_rate,lost:p.param.video_stream_info.send_loss_fraction,delay:p.param.video_stream_info.send_delay,jitter:p.param.video_stream_info.send_jitter,srtp:p.param.video_stream_info.is_srtp},recv:{decodeProtocol:p.param.video_stream_info.decode_name+" "+p.param.video_stream_info.decoder_profile,bitRate:p.param.video_stream_info.video_recv_bit_rate/1e3,frameSize:p.param.video_stream_info.decoder_size,frameRate:p.param.video_stream_info.recv_fram_rate,lost:p.param.video_stream_info.recv_loss_fraction,delay:p.param.video_stream_info.recv_delay,jitter:p.param.video_stream_info.recv_jitter,srtp:p.param.video_stream_info.is_srtp}}),a&&(f.bfcp={send:{encodeProtocol:p.param.data_stream_info.encode_name+" "+p.param.data_stream_info.encoder_profile,bitRate:p.param.data_stream_info.video_send_bit_rate/1e3,frameSize:p.param.data_stream_info.encoder_size,frameRate:p.param.data_stream_info.send_fram_rate,lost:p.param.data_stream_info.send_loss_fraction,delay:p.param.data_stream_info.send_delay,jitter:p.param.data_stream_info.send_jitter,srtp:p.param.data_stream_info.is_srtp},recv:{decodeProtocol:p.param.data_stream_info.decode_name+" "+p.param.data_stream_info.decoder_profile,bitRate:p.param.data_stream_info.video_recv_bit_rate/1e3,frameSize:p.param.data_stream_info.decoder_size,frameRate:p.param.data_stream_info.recv_fram_rate,lost:p.param.data_stream_info.recv_loss_fraction,delay:p.param.data_stream_info.recv_delay,jitter:p.param.data_stream_info.recv_jitter,srtp:p.param.data_stream_info.is_srtp}}),i&&(window.CLIENTCONFIG.ISMOBILE?(window.getASCodeInfo(),isNullOrEmpty(r.data)||(b.info("get old data info:"+r.data),f.data=r.data)):(h={send:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"},recv:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"}},1===l.status?(f.data=h,f.data.send={codecVersion:0===pt(l.enc_version)?"--":pt(l.enc_version),frameSize:0===l.enc_width||0===l.enc_height?"--":l.enc_width+"*"+l.enc_height,frameRate:0===l.enc_framerate?"--":l.enc_framerate,byteRate:0===l.enc_bitrate?"--":l.enc_bitrate}):2===l.status&&(f.data=h,f.data.recv={codecVersion:0===pt(l.dec_version)?"--":pt(l.dec_version),frameSize:0===l.dec_width||0===l.dec_height?"--":l.dec_width+"*"+l.dec_height,frameRate:0===l.dec_framerate?"--":l.dec_framerate,byteRate:0===l.dec_bitrate?"--":l.dec_bitrate}))),$dispatch(coreUi.changeCallMediaInfo(f)),s=c?(0,d.default)(s,{audio_stream_info:p.param.audio_stream_info},{video_stream_info:p.param.video_stream_info}):(0,d.default)(s,{audio_stream_info:p.param.audio_stream_info}),a&&(s=(0,d.default)(s,{data_stream_info:p.param.data_stream_info})),e.abrupt("return",s);case 27:b.error("getCallMediaParams failed, result = "+p.result);case 28:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),pt=function(e){var t=void 0;switch(e){case 0:t="Codec 1.0";break;case 2:t="Codec 2.0";break;case 3:t="H264";break;case 4:t="H265";break;case 5:t="Codec 3.0";break;default:t=e+""}return t};window.callInLink=function(e){coreAccount.getLoginModel().then(function(t){if(!t.isSipRegSuc())return void b.error("sip register failed, can not start call");Y(e,{number:e},!0)})};var ht=function(){b.info("handleTimeout,enable ClickAddVideo"),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),clearTimeout(N)},Ct=(t.updateToVideo=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.callPermissionCheck)(!0);case 2:if(n=e.sent,window.requestPermissionPromise&&(window.requestPermissionPromise=null),n){e.next=7;break}return b.info("updateToVideo do not have permission for call"),e.abrupt("return");case 7:if(!$getState().call.isDisableClickAddVideo){e.next=10;break}return b.info("changeAddVideoBtnStatus is disabled,return"),e.abrupt("return");case 10:return e.next=12,z(!0);case 12:if(!(a=e.sent)){e.next=16;break}return b.info("The network type is 2G. not support video"),e.abrupt("return");case 16:if(!t){e.next=25;break}return $dispatch(coreUi.changeAddVideoBtnStatus(!0)),b.info("dispatch  changeAddVideoBtnStatus,true,disable click"),e.next=21,I.addVideo(t);case 21:b.info("updateToVideo,calID = "),N=setTimeout(function(){ht()},3e4),e.next=28;break;case 25:$dispatch(coreUi.changeAddVideoBtnStatus(!1)),b.info("dispatch  changeAddVideoBtnStatus,false,enable click"),b.error("updateToVideo,calID is null");case 28:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.removeVideo=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return b.info("removeVideo,calID = "),e.next=4,I.delVideo(t);case 4:e.next=7;break;case 6:b.error("removeVideo,calID is null");case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.holdCall=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return b.info("holdCall,calID = "),e.next=4,I.holdCall(t);case 4:e.next=7;break;case 6:b.error("holdCall,calID is null");case 7:n=Ot(t),n&&(n.isClickHold=!0);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.switchToVideo=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=3;break}return b.error("<video>already status is VIDEO_CONNECTED,not switchToVideo"),e.abrupt("return");case 3:window.webView&&window.webView.initCallVideo(),ve(t),b.info("handleModifyVideoResult, go to video call view");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),mt=t.switchToAudio=function(){var e=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("enter switchToAudio"),window.CLIENTCONFIG.ISWIN&&!0===$getState().conf.isShowMemberListNew&&$dispatch(coreUi.changeIsShowMemberListNew(!$getState().conf.isShowMemberListNew)),coreConf.closeCallInterface(),$dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeMeetingType(!1)),$dispatch(coreUi.changeCallStatus("CALL_CONNECTED")),window.CLIENTCONFIG.ISMOBILE&&(window.switchToAudioFromVideo($getState().call.callId),window.callStatusChangeNotify($getState().call.callId,"CALL_CONNECTED"));case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),vt=t.handleModifyVideoResult=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.reason_code){e.next=6;break}return b.info("handleCallModifyVideoResult,result is false,return"+t.reason_code),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),window.CLIENTCONFIG.ENABLE_IT_MEETING?window.Toast(language.CALL_UPDATE_TO_VIDEO_REGECT,3,null,!1):window.Toast(language.CALL_UPDATE_TO_VIDEO_REGECT,2,!1,null),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),e.abrupt("return");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),wt=t.handleSeessionModify=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Ot(t.callId),n&&(0,d.default)(n,t),clearTimeout(N),t.isVideo?Ct(t.callId):mt(),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),b.info("dispatch  changeAddVideoBtnStatus,false,enable click");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),It=t.handleSvcVideoWindows=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("handleSvcVideoWindows",(0,s.default)(t)),$dispatch(coreUi.changeSvcVideoWindows(t)),"ios"===window.CLIENTCONFIG.PLATFORM&&window.setSvcVideoWindows(t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),gt=t.handleUpdateSvcRender=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("handleUpdateSvcRender"),$dispatch(coreUi.changeSvcRenders(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),_t=t.handleDeviceHowlStatus=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,d,f;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("handleDeviceHowlStatus",t),n=$getState(),a=n.conf.screamDetectionFlag,1===a){e.next=5;break}return b.info("scream detection is closed"),e.abrupt("return");case 5:if(1!==t.iStatus){e.next=30;break}if(r=$getState().conf,o=r.confHandle,i=r.isConfMicMute,c=r.memberListInfo,l=$getState().conf.selfNum,s=$getState().myInfo.bind_no,""===o){e.next=23;break}if(b.info("handleDeviceHowlStatus in conf "),!(isNullOrEmpty(c)||c.length<=1)){e.next=14;break}return b.info("memberListInfo length is less than 1 "),e.abrupt("return");case 14:if(coreCommon.isMobile()&&(b.info("mobile howling speaker mut."),coreCommon.SpkControl.getInstance().setHandsFree(!1)),!(i>=1)){e.next=18;break}return b.info("middle mute state, do nothing..."),e.abrupt("return");case 18:b.info("conf mute self mic"),u=isNullOrEmpty(l)?s:l,coreConf.actionMuteAttendee(!0,u,!0),e.next=26;break;case 23:b.info("handleDeviceHowlStatus in p2p "),coreCommon.isMobile()&&(b.info("mobile howling speaker mut."),coreCommon.SpkControl.getInstance().setHandsFree(!1)),coreCommon.MicControl.getInstance().muteMic(!0);case 26:b.info("show mic mut tips."),d=10,coreCommon.isWin()&&(b.info("tips: "+language.CONF_MIC_MUTE),coreConf.getSvcAtdManager().alertBox(language.CONF_MIC_MUTE,3,0,0,1,1e3*d)),coreCommon.isMobile()&&(f=window.showMicMutTips,f(language.CONF_MIC_MUTE),setTimeout(function(){f("")},1e3*d));case 30:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),St=function(e){b.info("call is srtp media.  callId: "+e.call_id+" is_srtp: "+e.is_srtp);var t=Ot(e.call_id);t&&(t.isSrtp=0!==e.is_srtp),$dispatch(coreUi.changeIsSrtp(0!==e.is_srtp)),coreConf.getSvcAtdManager().reportSRTPStatus()},bt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.webView&&(e===constant.ONLINE_STATUS.BUSY?window.webView.setTalkingState():window.webView.cancelTalkingState()),window.CLIENTCONFIG.USE_IM&&(b.info(" changeStatus status: "+e+", not handle offline"),e!==constant.ONLINE_STATUS.OFFLINE&&coreAccount.pushStatusToEServer({status:e,desc:t}))};window.pageInfoChangeNotify=function(e){b.info("debug info page info : ",e);var t={currentPage:e.currentPage,totalPage:e.totalPage};$dispatch(coreUi.changCurrentPageInfo(t))},window.JSToNativeToastLocalize=function(e){var t=e.times,n=void 0===t?0:t,a=e.text,r=e.delayTimes,o=void 0===r?0:r;b.info("JSToNativeToastLocalize -1 times="+n+",text="+a+",delayTimes="+o),language[a]&&(a=language[a]),b.info("JSToNativeToastLocalize times="+n+",text="+a+",delayTimes="+o),isNullOrEmpty(a)||window.JSToNativeToast(n,a,o)},window.setMobileRemoteViewHandle=function(e){b.info("debug info mobileRemoteViewHandleInfo : ",e);var t=new Array;t.push(e.remoteFirstViewIdx),t.push(e.remoteSecondViewIdx),t.push(e.remoteThirdViewIdx),t.push(e.remoteFourthViewIdx),t.push(e.remoteFifthViewIdx),t.push(e.remoteSixthViewIdx);var n={remoteLargeViewIdx:e.remoteLargeViewIdx,remoteViewIdx:t};$dispatch(coreUi.changeSvcMobileConfHandles(n));var a=$getState().conf.isFirstSvcConfSSRC;b.info("isFirstSvcConfSSRC",a),coreConf.handleSSRCURL(-1);var r=$getState().conf.svcMobileConfHandles;b.info("debug info mobileRemoteViewHandleInfo :",r);var o=Math.ceil(t.length/window.CLIENTCONFIG.SVC_WINDOW_PHONE_RATIO)||window.CLIENTCONFIG.SVC_WINDOW_MAX_DIVIDE_NUM_PHONE;window.CLIENTCONFIG.SVC_WINDOW_PHONE_FLAG&&(o=window.CLIENTCONFIG.SVC_WINDOW_MAX_DIVIDE_NUM_PHONE),$dispatch(coreUi.changeSvcMobileHandleNum(o))},window.audioOutputDevicesChange=function(e,t,n){b.info("debug info audioOutputDevicesChange : ",e,t,n);var a=$getState().call.isSpeaker,r=$getState().call.callStatus,o="true"===e||!0===e;window.otherAudioDevicesConnect=o,"ios"===window.CLIENTCONFIG.PLATFORM&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?t===constant.AUDIO_ROUTE_CHANGE_REASON.DETECT_AUDIO_ROUTE_RESULT?n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONE?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONEBT&&($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):""===$getState().conf.confHandle?t!==constant.AUDIO_ROUTE_TYPE.OLD_DEVICE_UNAVAILABLE||o?n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONEBT&&($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):isIPad?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!0))):($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_SPEAKER?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!0))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_RECEIVER?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONE?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONEBT&&($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):"android"===window.CLIENTCONFIG.PLATFORM&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?"1"===t?"2"===n?($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):"3"===t?(b.info("扬声器状态插拔设备"),$dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!0))):o&&"2"===n?($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):("android"===window.CLIENTCONFIG.PLATFORM?"2"!==n?"0"===t?"VIDEO_CONNECTED"===r?(coreCommon.SpkControl.getInstance().setHandsFree(!0),$dispatch(coreUi.switchSpeakerAndReceive(!0))):(coreCommon.SpkControl.getInstance().setHandsFree(a),$dispatch(coreUi.switchSpeakerAndReceive(a))):$dispatch(coreUi.switchSpeakerAndReceive(!1)):$dispatch(coreUi.switchSpeakerAndReceive(!0)):a&&0===t?(b.info("debug info turn receiver"),$dispatch(coreUi.switchSpeakerAndReceive(!1))):a||1!==t||$dispatch(coreUi.switchSpeakerAndReceive(!0)),o&&"android"===window.CLIENTCONFIG.PLATFORM&&"2"===n&&"0"!==t?$dispatch(coreUi.switchSpeakerBluetooth(!0)):$dispatch(coreUi.switchSpeakerBluetooth(!1)))};var Nt=t.stopBfcpReceive=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!0===$getState().call.iSreceivingBFCP&&(b.info("stop bfcp call in end call"),$dispatch(coreUi.setBfcpReceiving(!1)),""===e&&(e=$getState().call.callId),e&&I.activeStopBFCPData(e))},Et=t.recallOrHangup=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("recallOrHangup, need to leave conf or dispatch recallStart event, bNeedLeaveConf: "+n),isNullOrEmpty(t)?(b.info("recallOrHangup,savedRecallInfo is empty,no stream hangup call"),coreConf.isInConf()?coreConf.actionLeaveConf():te(a)):coreConf.reCallStart(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}();window.answerSimCardCalling=function(){if(b.info("enter afterAnswerSimCall"),""===$getState().call.callId)return void b.info("afterAnswerSimCall call id is null ");window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&""!==$getState().conf.confHandle&&(b.info("[IT-Meeting] afterAnswerSimCall actionLeaveConf"),coreConf.actionLeaveConf())},window.mobileDoBeforeSimCall=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("enter mobileDoBeforeSimCall"),""!==$getState().call.callId){e.next=4;break}return b.info("mobileDoBeforeSimCall call id is null "),e.abrupt("return");case 4:return $dispatch(coreUi.changeSimIncomming(!0)),e.next=7,coreCommon.SpkControl.getInstance().muteSpk(!0,!1);case 7:return e.next=9,Me(1,1);case 9:if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&!window.linkSmcIsVideo){e.next=12;break}return e.next=12,Re(1);case 12:b.info("leave mobileDoBeforeSimCall");case 13:case"end":return e.stop()}},e,void 0)})),window.mobileDoAfterSimCall=(0,v.default)(C.default.mark(function e(){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("enter mobileDoAfterSimCall"),""!==$getState().call.callId){e.next=5;break}return b.info("mobileDoAfterSimCall call id is null "),$dispatch(coreUi.changeSimIncomming(!1)),e.abrupt("return");case 5:setTimeout(function(){return kt()},2e3);case 6:case"end":return e.stop()}},e,void 0)}));var kt=t.doAfterSimCall=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("enter doAfterSimCall"),$dispatch(coreUi.changeSimIncomming(!1)),e.next=4,coreCommon.SpkControl.getInstance().muteSpk(!1,!1);case 4:if(t=$getState().call.isMuteMic){e.next=8;break}return e.next=8,Me(1,0);case 8:return e.next=10,Re(0);case 10:n=$getState().call.isSpeaker,n||coreCommon.SpkControl.getInstance().setHandsFree(!n),coreCommon.SpkControl.getInstance().setHandsFree(n),b.info("leave doAfterSimCall");case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.noPermissionLeaveConfNotify=function(){b.info("enter noPermissionLeaveConf"),window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)};var yt=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a,r,o,i,c,l;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE&&!window.CLIENTCONFIG.ISBIGWIN){e.next=2;break}return e.abrupt("return");case 2:if(!1!==(a=window.isOpenSpeechDetect)){e.next=6;break}return b.info("this call is stop check speech level"),e.abrupt("return");case 6:return b.info("handleSpeechLevelReport in logic,send_speech__level = "+t+",send_noise_level = "+n),r=$getState().common.modalContent,o=r.props?r.props.children:"",i=o===language.IS_MUTE_NEED_CHANGE_INPUT&&$getState().common.isShowModal,e.next=12,I.getCntOfSpeechLevel($getState().call.callId);case 12:if(c=e.sent,c&&((t<90||n<=50)&&++c.low>1&&(c.low=0,window.isOpenSpeechDetect=!1,b.info("isOpenSpeechDetect.false,normal"),i&&coreUi.hideModal()),t>=90&&n>=75?i||$getState().setting.isShowSetting||c.high++:c.high=0),!(c&&c.high>1)||$getState().call.isMuteMic){e.next=26;break}if(b.info("is need to change"),c.high=0,!($getState().setting.micCount>2)||i){e.next=26;break}if(!window.isHubEnv){e.next=22;break}return b.info("maxhub no to confirm change input audio"),window.isOpenSpeechDetect=!1,e.abrupt("return");case 22:return e.next=24,window.confirm(language.IS_MUTE_NEED_CHANGE_INPUT,!0,{leftButton:language.FALSE_ALARM,rightButton:language.BTN_ENSURE_TO_SET});case 24:l=e.sent,l.ret?(b.info("userClick yes to confirm change input audio,result = "+l),coreSetting.showSystemSettings(!0)):(b.info("userClick no to confirm change input audio,result = "+l),window.isOpenSpeechDetect=!1);case 26:return e.next=28,I.setCntOfSpeechLevel($getState().call.callId,c);case 28:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),Tt=t.dealPassiveDirectionResult=function(e){if(b.info("change Current Direction Status Passive."),window.CLIENTCONFIG.ISMOBILE){var t=$getState().call.isBidirection,n=1===e.param.dir;return b.info("audience js Notity audienceDirectionNotify ,data.param.dir = "+n+",isBidirection = "+t),void xt(n)}e&&e.param&&(1===e.param.dir?(b.info("Passive change Current Direction Status to bidirection."),$dispatch(coreUi.changeBidirectionStatus(!0)),b.info("deal[Pass]iveDirectionResult isOpenCamera = "+$getState().call.isOpenCamera),coreCommon.CameraControl.getInstance().switchCameraStateAction(!0),$dispatch(coreUi.toggleSmallSvcVisible(!0))):(b.info("Passive change Current Direction Status to onedirection."),$dispatch(coreUi.changeBidirectionStatus(!1)),b.info("deal[Pass]iveDirectionResult isOpenCamera = "+$getState().call.isOpenCamera),coreCommon.CameraControl.getInstance().switchCameraStateAction(!1),$dispatch(coreUi.toggleSmallSvcVisible(!1)))),window.CLIENTCONFIG.ISWIN&&coreConf.notifyChangePassiveBidirectionStatus(e)},xt=t.changeDirectionForMobile=function(e){b.info("audience, changeDirectionForMobile");var t=null;t=e?language.PASSIVE_BIDIRECTION:language.ONEDIRECTION,$dispatch(coreUi.changeBidirectionStatus(e)),window.showWebView(),window.switchLocalVideoState(!1,e),$dispatch(coreUi.CloseOrOpenPIP(e)),$dispatch(coreUi.changeAudienceHint(!0)),$dispatch(coreUi.createConfHintMsg([t])),setTimeout(function(){$dispatch(coreUi.createConfHintMsg([])),$dispatch(coreUi.changeAudienceHint(!1))},3e3)},Ot=t.getCallInfoByCallId=function(e){var t=void 0,n=L.length;if(e===$getState().call.callId)return O;for(var a=0;a<n;a++)if(t=L[a],e===t.callId)return t;return M&&e===M.callId?M:(b.info("getCallInfoByCallId error. callid: "+e),null)},Lt=function(e){var t=void 0;if(O&&O.callNo===e)return!1;if(O&&O.userInfo&&O.userInfo.bind_no===e)return!1;for(var n=L.length,a=0;a<n;a++){if(t=L[a],e===t.callNo)return!1;if(t.userInfo&&t.userInfo.bind_no===e)return!1}return!0},Mt=function(e){L=L.filter(function(t){return e!==t.callId}),Ve(L)},Rt=function(){var e=L.pop();return Ve(L),e},At=function(e){var t={callId:e.callId,userInfo:e.userInfo,callNum:e.callNo,callStatus:"",noStreamEndcall:0,tipMsg:[],isSrtp:e.isSrtp,consultTransferId:"",timer:e.timer};e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_OUT?1===e.callType?t.callStatus="VIDEO_OUT":t.callStatus="CALL_OUT":e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_LIVE||e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_HOLD?1===e.callType?t.callStatus="VIDEO_CONNECTED":t.callStatus="CALL_CONNECTED":e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_IN&&(t.callStatus="CALL_INCOMING");var n=$getState().call.callStatus;"VIDEO_TRANSTO_CONF"!==n&&"CALL_TRANSTO_CONF"!==n||(t.callStatus=n),e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_HOLD?t.isCallHold=!0:t.isCallHold=!1,e.consultTransferId&&(t.consultTransferId=e.consultTransferId),$dispatch(coreUi.changeCurrentCallInfo(t))},Ft=(t.hangupHoldCall=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("hangupHoldCall callId: "+t),e.next=3,I.endCallService(t);case 3:n=Ot(t),a=$getState().callRecord.IdByIdGenerateRecord,r=$getState().call.receiveCallUpateInfo,n&&(a.indexOf(t)<0||r)&&($dispatch(coreUi.changeReceiveUpateInfo(!1)),a.push(t),b.info("build a record hangupHoldCall"),a.length>20&&(a=a.slice(a.length-20,a.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(a)),De(n)),Mt(t),I.deleteCallObject(t),0===L.length&&Wt(!1,"hangupHoldCall"),t===O.consultTransferId&&(O.consultTransferId="",$dispatch(coreUi.changeConsultTransferId("")));case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.resumeCall=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("resume call callid: "+t),e.next=3,I.unHoldCall(t);case 3:a&&(n=Ot(t))&&(n.isClickHold=!1);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Vt=(t.consultTransfer=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=O.consultTransferId,n=$getState().call.callId,b.info("consultTransfer currentCallId: "+n+" consultId: "+t),t&&n){e.next=6;break}return b.info("user consultTransfer call error, currentCallId: "+n+" consultId: "+t),e.abrupt("return");case 6:return e.next=8,I.consultTransfer(t,n);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(C.default.mark(function e(){var t,n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,I.getMicDeviceVol();case 4:return t=e.sent,0===t.result&&0===t.param.volume&&I.setMicDeviceVol(0,50),e.next=8,I.getSpkDeviceVol();case 8:n=e.sent,0===n.result&&0===n.param.volume&&I.setSpkDeviceVol(0,50);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),Dt=(t.getIsTransFer=function(){var e=$getState().selectBox,t=e.selectBox_modalType,n=e.selectBox_accessPoint;return t===constant.CONTACT_SELECT_DIALOG_TYPE.CONTACT_SELECT_DIALOG_TRANSFERCALL&&n===constant.SELECT_BOX_ACCESSPOINT.TRANSFER_CALL_IN},t.blindTranseferEntrance=function(){var e=(0,v.default)(C.default.mark(function e(t,n){var a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b.info("start blindTransefer Entrance [1]"),a=$getState().call.callId,isNullOrEmpty(a)&&b.error("start blindTransefer Entrance callId is null or undefined"),!isNullOrEmpty(n)){e.next=8;break}b.error("start blindTransefer Entrance transferNumber is null or undefined"),e.next=11;break;case 8:return b.info("start blindTransefer Entrance [1]",t),e.next=11,I.blindTransfer(a,n);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),b.error("blindTransefer Entrance");case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t,n){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("handleCallBldTransferFailed callId: "+t.call_id),window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_FAILED,2,!1):window.Toast(language.CALL_TRANSFER_FAILED,2,!1,null),e.next=4,I.unHoldCall(t.call_id);case 4:n=$getState().call.isCallTransfer,n&&Wt(!1,"handleCallBldTransferFailed");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Ut=function(){var e=(0,v.default)(C.default.mark(function e(t){var n;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.call_id&&(b.info("handleCallBldTransferSuccess callId: "+t.call_id),window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_SUCCEEDED,2,!1):window.Toast(language.CALL_TRANSFER_SUCCEEDED,2,!1,null),(n=$getState().call.isCallTransfer)&&Wt(!1,"handleCallBldTransferSuccess"));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Bt=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("handleSetTransferModify callId: "+t.call_id),n=t.call_id,a=$getState().call.callId,n===a&&(r=$getState().call.isCallTransfer,2===t.audio_send_mode?(b.info("handleSetTransferModify changeCallTransferFlag(true)"),Wt(!0,"handleSetTransferModify")):4===t.audio_send_mode&&r&&0===L.length&&(b.info("handleSetTransferModify changeCallTransferFlag(false)"),Wt(!1,"handleSetTransferModify")));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),$t=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.callId,isNullOrEmpty(t)||!Array.isArray(t)||2!==t.length){e.next=8;break}if(a=$getState().callRecord.IdByIdGenerateRecord,$dispatch(coreUi.changeReceiveUpateInfo(!0)),t[0]&&t[0].callId&&n===t[0].callId&&a.indexOf(t[0].callId)<0&&(a.push(n),a.length>20&&(a=a.slice(a.length-20,a.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(a)),b.info("build a record handleCallUpateRemoteInfo"),De(t[0])),!t[1]||!t[1].callId||n!==t[1].callId){e.next=8;break}return e.next=8,Pt(t[1]);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Pt=t.refreshCallPage=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("refreshCallPage start"),n={callerName:t.callNo,callerDepartment:"",callerNumber:t.callNo,callAccount:t.ucaccount},a=t.callNo,"*"===t.callNo.substr(0,1)&&(a=t.callNo.substr(1,t.callNo.length-1)),r=void 0,window.skipLogin){e.next=14;break}return e.next=8,coreContact.searchServerContact({query_key:a,pageOffset:1,SearchType:1});case 8:o=e.sent,i=o.userInformationList||[],n.callerNumber=a,i.length>0?(n.callerName=getContactName(i[0]),""===n.callerName&&(n.callerName=n.callerNumber),n.callAccount=i[0].account,n.callerDepartment=getContactDept(i[0]),r=i[0],$dispatch(coreUi.changeUserInfo(r)),$dispatch(coreUi.changeCallNum(n.callerNumber))):(r={account:a},$dispatch(coreUi.changeUserInfo(r)),$dispatch(coreUi.changeCallNum(n.callerNumber))),e.next=17;break;case 14:r={account:a},$dispatch(coreUi.changeUserInfo(r)),$dispatch(coreUi.changeCallNum(n.callerNumber));case 17:return c=Ot(t.callId),c&&(c.userInfo=r,c.callNo=n.callerNumber),e.next=21,it({account:n.callAccount},!1,!0);case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Gt=t.changeCallHoldStatusLogic=function(e){b.info("changeCallHoldStatusLogic: "+e),$dispatch(coreUi.changeCallHoldStatus(e))},Wt=t.setTransferFlagHandle=function(e,t){b.info("setTransferFlagHandle ["+t+"]("+e+")"),$dispatch(coreUi.changeCallTransferFlag(e))},Ht=t.transferNumberToName=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,a="",""!==t){e.next=4;break}return e.abrupt("return",a);case 4:return"*"===t.substr(0,1)&&(n=t.substr(1,t.length-1)),e.next=7,coreContact.searchServerContact({query_key:n});case 7:return r=e.sent,o=r.userInformationList||[],o.length>0&&""===(a=getContactName(o[0]))&&(a=n),e.abrupt("return",a);case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),zt=(t.IsDialingCallInfo=function(e){$dispatch(coreUi.changeIsDialingCallInfo(e))},t.resetCallInfo=function(){b.info("set current call null"),O=null,L=[],M={}},function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:coreConf.startCallFailed(t);case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),jt=t.handleNotifyCallBeenHangup=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:R=t;case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Jt=t.handleCallPickupNotify=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,v,w,I,g,_,S,N,E,k,y,T;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.CLIENTCONFIG,0!==(a=parseInt(n["Device.ComCfg.Service.pickupActive"]))){e.next=5;break}return b.info("pickup call is not active : "+a),e.abrupt("return");case 5:if(t.sipAccountID=t.sipaccoutid,t.callerNumber=t.callerno,t.ringNumber=t.ringno,t.pickupCallType=t.pickup_type,t.pickupType=t.indicate,b.info("callPickupNotify, data.pickupCallType: "+t.pickupCallType),b.info("callPickupNotify, data.pickupType: "+t.pickupType),r=$getState().call.pointPickupCap,o=$getState().call.groupPickupCap,1===t.pickupCallType||2===t.pickupCallType){e.next=17;break}return b.info("wrong pickupCallType"),e.abrupt("return");case 17:if(i=$getState().call,c=i.callStatus,e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=24;break}return e.next=23,window.isSimCardCall();case 23:e.t0=e.sent;case 24:if(l=e.t0,null!==A){e.next=31;break}if(0!==t.pickupType){e.next=29;break}return b.info("data.pickupCallType: "+t.pickupCallType),e.abrupt("return");case 29:e.next=55;break;case 31:if(0!==t.pickupType){e.next=53;break}if(!$getState().call.acceptPickupCall){e.next=36;break}A=null,e.next=51;break;case 36:if(!A||A.callerNumber!==t.callerNumber||A.ringNumber!==t.ringNumber||A.pickupCallType!==t.pickupCallType){e.next=49;break}return b.info("run at close a notify"),coreUi.closePickupCallNotify(),s=window.getRoute(),b.info("currentPage + ",s),b.info("acceptPickupCall + ",$getState().call.acceptPickupCall),window.CLIENTCONFIG.ISMOBILE&&!1===$getState().call.acceptPickupCall&&(b.info("rejectPickupCall end call "+s),"callMain"===s?history.back():"mConfMemberPage"===s?window.goRoute("main/conference"):"mSelectBox"===s&&coreUi.clearTransferOfShowBox()),coreUi.stopRing(),!1===$getState().call.acceptPickupCall&&(b.info("handleCallPickupNotify, changeStatus"),bt(constant.ONLINE_STATUS.ONLINE)),A=null,e.abrupt("return");case 49:return b.info("run at receive a wrong notify"),e.abrupt("return");case 51:e.next=55;break;case 53:return b.info("run at receive a new notify"),e.abrupt("return");case 55:if($dispatch(coreUi.changeAcceptPickupCall(!1)),!l){e.next=59;break}return b.info("callPickupNotify, now is in sim card call,end call"),e.abrupt("return");case 59:if(!("VIDEO_OUT"===c||"CALL_OUT"===c||"CALL_INCOMING"===c||"CALL_CONNECTED"===c||"VIDEO_CONNECTED"===c||"VIDEO_TRANSTO_CONF"===c||"CALL_TRANSTO_CONF"===c||coreConf.isInConf()||window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv)){e.next=61;break}return e.abrupt("return");case 61:if(u=$getState().call.callId,""===u&&(f=$getState(),p=f.myInfo,h=p.account,m=p.statusDesc,v=f.contactGroups.contact_status_map,$dispatch(coreUi.changeOldStatus(v[h]&&v[h].status,m)),b.info("dispatch changeOldStatus status= "+(v[h]&&v[h].status)+",desc = "+m),b.info("callInComming,status: "+constant.ONLINE_STATUS.BUSY+",desc = Calling"),bt(constant.ONLINE_STATUS.BUSY)),A=(0,d.default)({},{callerNumber:t.callerNumber,ringNumber:t.ringNumber,pickupCallType:t.pickupCallType,isConnected:0}),w={isShow:!0,pickupType:t.pickupType,sipAccountID:t.sipAccountID,callAccount:"",callerDepartment:"",callerName:"",callerNumber:t.callerNumber,ringAccount:"",ringDepartment:"",ringName:"",ringNumber:t.ringNumber,pickupCallType:t.pickupCallType},I=t.callerNumber,g=t.ringNumber,_=void 0,"tel:"===t.callerNumber.substr(0,4)&&(I=t.callerNumber.substr(4,t.callerNumber.length-4)),"tel:"===t.ringNumber.substr(0,4)&&(g=t.ringNumber.substr(4,t.ringNumber.length-4)),S=void 0,window.skipLogin){e.next=85;break}return e.next=74,coreContact.searchServerContact({query_key:I,pageOffset:1,SearchType:1});case 74:return N=e.sent,e.next=77,coreContact.searchServerContact({query_key:I,pageOffset:1,SearchType:1});case 77:E=e.sent,k=N.userInformationList||[],y=E.userInformationList||[],w.ringNumber=g,k.length>0?(w.callerName=getContactName(k[0]),""===w.callerName&&(w.callerName=w.callerNumber),w.callAccount=k[0].account,w.callerDepartment=getContactDept(k[0]),S=k[0]):(S={account:I},w.callerName=w.callerNumber),y.length>0?(w.ringName=getContactName(y[0]),""===w.ringName&&(w.ringName=w.ringNumber),w.ringAccount=y[0].account,w.ringDepartment=getContactDept(y[0])):w.ringName=w.ringNumber,e.next=86;break;case 85:S={account:I};case 86:$dispatch(coreUi.changePickupCallerInfo(S)),b.info("callPickupNotify "+w),window.webView&&window.webView.setFrontToLock(),b.info("showPickupCallNotify"),coreUi.showPickupCallNotify(w),T=window.getRoute(),b.info("go into callmain, current page : "+T),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==T&&(b.info("go into callmain"),window.goRoute("callMain")),b.info("pickup call incommingRing"),coreUi.incommingRing("in",!0);case 96:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Yt=t.handleCallPickupRemoteInfo=function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),qt=(t.acceptPickupCall=function(){var e=(0,v.default)(C.default.mark(function e(t,n,a,r){var o,i,c,l,s,u,d,f,p,h,m,v,w,g,_,S,N,E;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return coreConf.setServerIp&&coreConf.setServerIp(""),coreUi.showSearchPanel(!1),$dispatch(coreUi.changeAcceptPickupCall(!0)),o=$getState().call.initiativeHoldCall,b.info("Call Out isCallHold: "+o),i={},i.account=a,c={bConf:!1,bVideo:!1,number:a,contactInfo:i,enterConfParam:null,isConsultTransfer:!0},e.next=10,j(c);case 10:if(l=e.sent,0===l.code){e.next=14;break}return window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyJoinConfFailed(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0)))),e.abrupt("return",!1);case 14:if($dispatch(coreUi.saveCalleeInfo({})),s=$getState(),u=s.myInfo,d=u.account,f=u.statusDesc,p=s.login.sipLoginOnly,h=null,coreConf.handleIsShowJoinButton(!1),$dispatch(coreUi.changeCallStatus("CALL_OUT")),!1!==window.skipLogin){e.next=27;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=25;break}return e.next=23,it(i,!0,!0);case 23:e.next=27;break;case 25:return e.next=27,it(i,!1,!0);case 27:return coreUi.closePickupCallNotify(),coreUi.stopRing(),m=null,e.next=32,I.createCallId(n,0,0);case 32:if(!(m=e.sent)||0!==m.result){e.next=52;break}if(0!==m.param.call_id){e.next=37;break}return b.info("create call id failed, call_id"+m.param.call_id),e.abrupt("return",!1);case 37:return e.next=39,I.startPickupCall({call_id:m.param.call_id,callerNumber:a,ringNumber:r,pickupCallType:t});case 39:if(m=e.sent){e.next=48;break}return $dispatch(coreUi.changeAcceptPickupCall(!1)),v=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&(b.info("rejectPickupCall end call"),"callMain"===v?history.back():"mConfMemberPage"===v?window.goRoute("main/conference"):"mSelectBox"===v&&coreUi.clearTransferOfShowBox()),w=$getState().call,g=w.oldStatus,_=w.oldStatusDesc,b.info("acceptPickupCall, oldStatus = "+g+"oldStatusDesc = "+_),bt(g,_),e.abrupt("return",!1);case 48:b.info("current call status : ",$getState().call.callStatus),$dispatch(coreUi.changeCallStatus("VIDEO_OUT")),e.next=57;break;case 52:return b.info("create call id failed"),S=$getState().call,N=S.oldStatus,E=S.oldStatusDesc,b.info("acceptPickupCall, oldStatus = "+N+"oldStatusDesc = "+E),bt(N,E),e.abrupt("return",!1);case 57:A=null;case 58:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),t.rejectPickupCall=function(){var e=(0,v.default)(C.default.mark(function e(){var t,n,a,r;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A=null,t=window.getRoute(),$dispatch(coreUi.changeAcceptPickupCall(!1)),b.info("rejectPickupCall end call"),window.CLIENTCONFIG.ISMOBILE&&(b.info("rejectPickupCall end call"),"callMain"===t?history.back():"mConfMemberPage"===t?window.goRoute("main/conference"):"mSelectBox"===t&&coreUi.clearTransferOfShowBox()),coreUi.closePickupCallNotify(),coreUi.stopRing(),n=$getState().call,a=n.oldStatus,r=n.oldStatusDesc,b.info("rejectPickupCall, oldStatus = "+a+"oldStatusDesc = "+r),bt(a,r);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(C.default.mark(function e(t){return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),$dispatch(coreUi.changeCallId(t.call_id)),$dispatch(coreUi.changeMeetingType(!0)),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),window.CLIENTCONFIG.ISMOBILE&&window.transToConfFromVideo();case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Kt=function(){var e=(0,v.default)(C.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,d,f,p,h,m,v,w,I,g,_,S;return C.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.CLIENTCONFIG["Device.ComCfg.CHR.CHRAddress"],a=window.CLIENTCONFIG["Device.ComCfg.CHR.CHRName"],e.next=4,coreSecurity.getPasswordManager();case 4:return r=e.sent,e.next=7,r.getPassword("CHRPassword");case 7:if(o=e.sent,i=t.path,c=isNullOrEmpty(i),l=isNullOrEmpty(n),s=isNullOrEmpty(a),u=isNullOrEmpty(o),!(c||l||s||u)){e.next=16;break}return b.info("CHR basci info is null, address=",l+", userName=",s+", [psd]=",u),e.abrupt("return");case 16:return d="TRUE"===window.CLIENTCONFIG["Device.ComCfg.CHR.enableCHR"]?1:0,e.next=19,coreSetting.getChrEnableValue(d);case 19:if(0!==(f=e.sent)){e.next=23;break}return b.info("CHR file upload is closed, server data is:"+d),e.abrupt("return");case 23:return p="/chrFile/",h=window.APP_DATA_PATH+p+i,window.fs&&(h=window.path.join(window.APP_DATA_PATH,p,i)),m=void 0,v=$getState(),w=v.login,I=w.account,g=w.real_user_account,isNullOrEmpty(g)?m=I:(m=g,b.info("use real_user_account")),_={Account:m},S=function(e){var t=e.param.rsp_body.rsp_code;200!==t?b.info("tup upload chr files to server failed, rsp_code=",t):b.info("tup upload chr files to server success, rsp_code=",t)},e.next=33,coreHttp.uploadFile({params:{url:n,auth_mode:1,username:a,password:o,filePath:h,content:_,is_cwmp:!0},resultCallback:S});case 33:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},908:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=n(131),s=a(l),u=n(4),d=a(u),f=n(5),p=a(f),h=n(132),C=a(h),m=n(133),v=a(m),w=n(806),I=a(w),g=coreLogger.getLogger("model")("model/callService/audioCallService"),_=function(e){function t(e){(0,d.default)(this,t);var n=(0,C.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return e?n:(g.info("can not create AudioCallService object"),(0,C.default)(n))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"acceptCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.acceptCall(this.callInfo.callId,!1);case 5:n=e.sent,0===n.result?(g.info("accept call success"),this.setDeviceControlCallId(this.callInfo.callId),coreCommon.SpkControl.getInstance().cancelSysSpkMute(),coreCommon.SpkControl.getInstance().setHandsFree(!1)):(coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ACCEPTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),n.result]}),g.info("accept call failed, result = "+n.result));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"holdCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.holdCall(this.callInfo.callId);case 5:n=e.sent,0===n.result?g.info("hold call success"):g.info("hold call failed, result = "+n.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"unHoldCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.unHoldCall(this.callInfo.callId);case 5:n=e.sent,0===n.result?g.info("unhold call success"):g.info("unhold call failed, result = "+n.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"divertCall",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.divertCall(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?g.info("divert call success"):g.info("divert call failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"blindTransfer",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.blindTransfer(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?g.info("blind transfer call success"):g.info("blind transfer call failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"consultTransfer",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.consultTransfer(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?g.info("consult transfer call success"):g.info("consult transfer call failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"addVideo",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.addVideo(this.callInfo.callId);case 5:n=e.sent,0===n.result?(this.callInfo.isVideo=!0,g.info("add video call success")):g.info("add video call failed");case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"transferConfEx",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.transferConfEx(t,this.callInfo.callId);case 5:return a=e.sent,0===a.result?g.info("transfer conference success"):g.info("transfer conference failed, result = "+a.result),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"createCallId",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.createCallId(t,r,i);case 5:return a=e.sent,0===a.result?g.info("create call ID success"):g.info("create call ID failed, result = "+a.result),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"pointPickup",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a,r){var i,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return i=e.sent,e.next=5,i.pointPickupEx(t,n,a,r);case 5:return c=e.sent,0===c.result?g.info("point pickup success"):g.info("point pickup failed, result = "+c.result),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"groupPickup",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a,r){var i,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return i=e.sent,e.next=5,i.groupPickupEx(t,n,a,r);case 5:return c=e.sent,0===c.result?g.info("group pickup success"):g.info("group pickup failed, result = "+c.result),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallDivertFailed",value:function(e){this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallDivertFailed",e.param),g.info("CallDivertFailed")}}]),t}(I.default);t.default=_},909:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=n(69),c=a(i),l=n(135),s=a(l),u=n(1),d=a(u),f=n(2),p=a(f),h=n(4),C=a(h),m=n(5),v=a(m),w=n(908),I=a(w),g=n(910),_=a(g),S=coreLogger.getLogger("model")("model/callService/callManager"),b=window.tupVideo,N=null,E=null,k=null,y=null,T=0,x=!1,O=(o=r=function(){function e(){(0,C.default)(this,e)}return(0,v.default)(e,[{key:"acceptCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return S.info("acceptCall callId: "+n),i&&(a=e.CallList[n],r={call_id:n,call_type:0,tel_num:a.callInfo.callNo,call_state:a.callInfo.callState,callInOut:a.callInfo.callInOut,isCallSuccess:a.callInfo.isCallSuccess},delete e.CallList[n],e.CallList[n]=e.getCallObject(r,!1)),o=e.CallList[n],t.next=5,o.acceptCall(i);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"endCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("endCall callId: "+n),!(a=e.CallList[n])){t.next=9;break}return t.next=5,a.endCall();case 5:r=t.sent,0===r.result?S.info("end call success"):(S.info("end call failed"),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ENDCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),r.result]})),t.next=11;break;case 9:S.info("call id is not exist "),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ENDCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),"callid_not_exist"]});case 11:case"end":return t.stop()}},t,this)}));return t}()},{key:"startCall",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r,o,i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getCallObject(n,a),o=!n.hasOwnProperty("addr_vip"),t.next=4,r.startCall(a,o);case 4:return i=t.sent,i?(e.CallList[r.callInfo.callId]=r,S.info("start call success")):S.info("start call failed"),t.abrupt("return",i);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"startPickupCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.getCallObject(n,!1),t.next=3,a.startPickupCall();case 3:return r=t.sent,r?(e.CallList[a.callInfo.callId]=a,S.info("start pickup call success")):S.info("start pickup call failed"),t.abrupt("return",r);case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"dialDTMF",value:function(t,n,a){var r=e.CallList[t];n&&r&&r.dialDTMF(n,a)}},{key:"setCallNotifyFunc",value:function(){function t(){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(){var n;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,coreTup.getCallInstance();case 2:n=t.sent,n.setNotifyFunc(98307,e.handleCallIncomming),n.setNotifyFunc(98309,e.handleCallRingBack),n.setNotifyFunc(98310,e.handleCallConnected),n.setMultiNotifyFunc(98311,e.handleCallEnded),n.setNotifyFunc(98312,e.handleCallDestroy),n.setNotifyFunc(98313,e.handleCallRTPCreated),n.setNotifyFunc(98314,e.handleCallAddVideo),n.setNotifyFunc(98315,e.handleCallDelVideo),n.setNotifyFunc(98316,e.handleCallModifyVideoResult),n.setNotifyFunc(98317,e.handleVideoRefreshView),n.setNotifyFunc(98318,e.handleVideoDecodeSuccess),n.setNotifyFunc(98320,e.handleAudioFileEnd),n.setNotifyFunc(98321,e.handleCallLocalQos),n.setNotifyFunc(98325,e.handleSpeechLevelReport),n.setNotifyFunc(98326,e.handleSpkVolChange),n.setNotifyFunc(98327,e.handleMicVolChange),n.setNotifyFunc(98335,e.handleBFCPFrameSizeChange),n.setNotifyFunc(98337,e.handleDataSending),n.setNotifyFunc(98338,e.handleBFCPDataBeginRec),n.setNotifyFunc(98339,e.handleDataStartError),n.setNotifyFunc(98340,e.handleBFCPDataStop),n.setMultiNotifyFunc(98341,e.handleCallSessionModify),n.setNotifyFunc(98343,e.handleCallHoldSuccess),n.setNotifyFunc(98344,e.handleCallHoldFailed),n.setNotifyFunc(98345,e.handleCallUnHoldSuccess),n.setNotifyFunc(98346,e.handleCallUnHoldFailed),n.setNotifyFunc(98348,e.handleCallDivertFailed),n.setNotifyFunc(98350,e.handleCallBldTransferSuccess),n.setNotifyFunc(98351,e.handleCallBldTransferFailed),n.setNotifyFunc(98352,e.handleCallAtdTransferSuccess),n.setNotifyFunc(98353,e.handleCallAtdTransferFailed),n.setNotifyFunc(98356,e.handleSipAccountWmi),n.setNotifyFunc(98367,e.handleCallJointStartNotify),n.setNotifyFunc(98368,e.handleCallJointCloseNotify),n.setNotifyFunc(98381,e.handleCallJointOnlineNotify),n.setNotifyFunc(98382,e.handleCallJointOffLineNotify),n.setNotifyFunc(98384,e.handleCallJointOffHookNotify),n.setNotifyFunc(98385,e.handleCallJointOutGoingNotify),n.setNotifyFunc(98386,e.handleCallJointEstablishedNotify),n.setNotifyFunc(98397,e.handleCallJointPeerCapsReportNotify),n.setNotifyFunc(98435,e.handleIsKickOff),n.setNotifyFunc(98440,e.handleNewServiceRight),n.setNotifyFunc(98469,e.handleCallPickupNotify),n.setNotifyFunc(98483,e.handleCallPickupRemoteInfo),n.setNotifyFunc(98488,e.handleCallUpateRemoteInfo),n.setNotifyFunc(98489,e.handleMediaSRTPStatus),n.setNotifyFunc(98544,e.handleSpkMicList),n.setNotifyFunc(98547,e.handleCameraList),n.setNotifyFunc(98548,e.handlesetVideoIdxRet),n.setNotifyFunc(98572,e.handleNoStream),n.setNotifyFunc(98642,e.handleLowVideoBW),n.setNotifyFunc(98644,e.handleDeviceHowlStatus),n.setNotifyFunc(98648,e.handleUploadChrFile),n.setNotifyFunc(98657,e.receivePairReqNotify),n.setNotifyFunc(98659,e.pairedOrCanceledResultNotify),n.setNotifyFunc(98661,e.pairClosedNotify),n.setNotifyFunc(98668,e.pairSubscribeNotify),n.setNotifyFunc(98669,e.pairCallStateNotify),n.setNotifyFunc(98671,e.pairLinkageConfNotify),n.setNotifyFunc(98672,e.pairLinkageConfStateNotify),n.setNotifyFunc(98678,e.handlePassiveDirectionResult),n.setNotifyFunc(98679,e.handleUniversalInfoNotify),n.setNotifyFunc(98687,e.handleAudioNoStreamLeaveConf);case 66:case"end":return t.stop()}},t,this)}));return t}()},{key:"setLocalVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return S.info("<video>set local video render"),a.resUpdateFn=e.resUpdateLocalFn,a.getFrameFn=b.getLocalFrame,a.onSocketClose=e.onLocalSocketClose,a.canvas=n,N?(N.setViewWH(a.viewW,a.viewH,n),S.info("<video>local video render is exist")):N=new TUPRender2(a),t.abrupt("return",N);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"setRemoteVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return S.info("<video>set remote video render"),a.resUpdateFn=e.resUpdateRemoteFn,a.getFrameFn=b.getRemoteFrame,a.onSocketClose=e.onRemoteSocketClose,a.canvas=n,E?(E.setViewWH(a.viewW,a.viewH,n),S.info("<video>remote video render is exist")):E=new TUPRender2(a),t.abrupt("return",E);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"setBFCPVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:S.info("<video>set bfcp render"),a.resUpdateFn=e.resUpdateBFCPFn,a.getFrameFn=b.getDataFrame,a.onSocketClose=e.onBFCPSocketClose,a.canvas=n,k?(k.setViewWH(a.viewW,a.viewH,a.canvas),S.info("<video>bfcp render is exist")):k=new TUPRender2(a);case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeLocalSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<video> close local socket"),N&&N.closeSocket(),N=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeRemoteSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<video> close remote socket"),E&&E.closeSocket(),E=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeDataSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<video> close data socket"),k&&k.closeSocket(),k=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"setLocalVideoWH",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<video> set local video wh,width = "+t+",height = "+n),N&&N.setViewWH(t,n,a);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"setRemoteVideoWH",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<video> set remote video wh,width = "+t+",height = "+n),E&&E.setViewWH(t,n,a);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"calcVideoRealSize",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,r=n,t>n?t>1280&&(a=1280,r=1280*n/t):n>1280&&(r=1280,a=1280*t/n),S.info("<video> calcVideoRealSize,width = "+a+",height = "+r),e.abrupt("return",[a,r]);case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"setBFCPDataWH",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<bfcp> set bfcp data wh,width = "+t+",height = "+n),k&&k.setViewWH(t,n);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"setSpkVol",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.setSpkVol(t*window.CLIENTCONFIG.SPK_GAIN/100);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return S.info("setSpkVol success"),e.abrupt("return",!0);case 11:return S.info("setSpkVol failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCallCapability",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.setCallCapability(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCallReinvite",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.setCallReinvite(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setMicVol",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.setMicVol(t*window.CLIENTCONFIG.MIC_GAIN/100);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return S.info("setMicVol success"),e.abrupt("return",!0);case 11:return S.info("setMicVol failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSpkVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getSpkVol();case 5:return n=e.sent,e.abrupt("return",100*n.param.out_gain/window.CLIENTCONFIG.SPK_GAIN);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getMicVol();case 5:return n=e.sent,e.abrupt("return",100*n.param.in_gain/window.CLIENTCONFIG.MIC_GAIN);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMediaDevices",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,S.info("getMediaDevices,type = ",t),e.next=6,n.getMediaDevices(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicDeviceVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getMicDeviceVol();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSpkDeviceVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getSpkDeviceVol();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setMicDeviceVol",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.setMicDeviceVol(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setSpkDeviceVol",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.setSpkDeviceVol(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicIndex",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getMicIndex();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setMicIndex",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,S.info("setMicIndex, index = ",t),e.next=6,n.setMicIndex(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSpkIndex",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getSpkIndex();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setBfcpIsBigWnd",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.setBfcpIsBigWnd(t,n);case 5:return r=e.sent,0===r.result?S.info("setBfcpIsBigWnd success isBfcpBigWnd = "+n):S.info("setBfcpIsBigWnd failed, res = "+r+", isBfcpBigWnd = "+n),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setAllSvcVideoWindows",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=3;break;case 3:return e.next=5,coreTup.getCallInstance();case 5:return r=e.sent,e.next=8,r.setAllSvcVideoWindows(t,n,a);case 8:return o=e.sent,0===o.result?S.info("setAllSvcVideoWindows success "):S.info("setAllSvcVideoWindows failed, res = ",o),i={count:t,windowArray:a},coreCommon.Observer.publish("SvcVideoWindows",i),e.abrupt("return",o);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"getCallBandwidth",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.CallList[n],t.next=3,a.getBandwidth();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"assignBandwidthForData",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o,i,c,l;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info(">>>callid: ",n),!(a=e.CallList[n])){t.next=8;break}return t.next=5,a.assignBandwidthForData();case 5:return t.abrupt("return",t.sent);case 8:return S.info("call object is not exist"),r={callid:n,infoid:0},o=0,t.next=13,coreTup.getCallInstance();case 13:return i=t.sent,t.next=16,i.getBasicCallInfo(r);case 16:return c=t.sent,0===c.result?(S.info("getBandwidth success,bandwidth = "+c.param.call_info.bandwidth),o=c.param.call_info.bandwidth):S.info("getBandwidth failed"),l=I.default.assignBandwidth(o),t.abrupt("return",l[1]);case 20:case"end":return t.stop()}},t,this)}));return t}()},{key:"setBandwidth",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.setBandWidth(t,n);case 5:return r=e.sent,0===r.result?S.info("setBandwidth success "):S.info("setBandwidth failed, res = ",r),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setDataBandwidth",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("setDataBandwidth, callid: "+n+" operationType: "+a+", bandwidth: "+r),!(o=e.CallList[n])){t.next=8;break}return t.next=5,o.setDataBandwidth(a,r);case 5:S.info("setDataBandwidth success!"),t.next=9;break;case 8:S.error("call object not found!");case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"setEncoderMaxCap",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r,o){var i,c;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return i=e.sent,e.next=5,i.setEncoderMaxCap(t,n,a,r,o);case 5:return c=e.sent,0===c.result?S.info("setEncoderMaxCap success "):S.info("setEncoderMaxCap failed, res = ",c),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setSpkIndex",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,S.info("setSpkIndex, index = ",t),e.next=6,n.setSpkIndex(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"getVideoIndex",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getVideoIndex();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoIndex",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,S.info("setVideoIndex, index = ",t),e.next=6,n.setVideoIndex(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"operateMic",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.CallList[n],S.info("userClick  operateMic, callId: "+n+"to_mute = "+a),!r){t.next=8;break}return t.next=5,r.operateMic(a);case 5:return t.abrupt("return",t.sent);case 8:return S.info("operateMic not find callId: "+n),t.abrupt("return",{});case 10:case"end":return t.stop()}},t,this)}));return t}()},{key:"switchAudioChannel",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],S.info("switchAudioChannel, isStop = ",a),t.next=4,r.switchAudioChannel(a);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"replyAddVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],S.info("replyAddVideo, is_accept = ",a),t.next=4,r.replyAddVideo(a);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"setCaptureRotation",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.CallList[n],S.info("setCaptureRotation callId: "+n+",capture_index: "+a+",capture_rotation: "+r),!o){t.next=6;break}return t.next=5,o.setCaptureRotation(n,a,r);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"setDisplayRotation",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.CallList[n],S.info("setDisplayRotation callId: "+n+" render_type: "+a+" rotation:"+r),t.next=4,o.setDisplayRotation(n,a,r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"setVideoCollectMode",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],S.info("setVideoCollectMode callId: "+n+" collect_mode: "+a),t.next=4,r.setVideoCollectMode(n,a);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"setVideoRender",value:function(){function t(e,t,a,r,o){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r,o,i){var c;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=e.CallList[n],t.next=3,c.setVideoRender(n,a,r,o,i);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"delVideo",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.CallList[n],S.info("delVideo, callId = "+n),t.next=4,a.delVideo();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"transferConfEx",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[a],S.info("transferConfEx = ",n,a),t.next=4,r.transferConfEx(n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"activeStopBFCPData",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:n=e.sent,n.stopData(t);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"startPlayMediaFile",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.startPlayMediaFile(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"stopPlayMediaFile",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.stopPlayMediaFile(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"holdCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("holdCall callId: "+n),!(a=e.CallList[n])){t.next=7;break}return t.next=5,a.holdCall();case 5:t.next=8;break;case 7:S.info("holdCall no found call by callId = "+n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"unHoldCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("unHoldCall callId: "+n),!(a=e.CallList[n])||!a.unHoldCall){t.next=7;break}return t.next=5,a.unHoldCall();case 5:t.next=8;break;case 7:S.info("unHoldCall no found call by callId = "+n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"divertCall",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return S.info("divertCall = ",n,a),r=e.CallList[n],t.next=4,r.divertCall(a);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"blindTransfer",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],S.info("blindTransfer = "),t.next=4,r.blindTransfer(a);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"consultTransfer",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("consultTransfer callId: "+n+" transtoCallId: "+a),!(r=e.CallList[n])){t.next=7;break}return t.next=5,r.consultTransfer(a);case 5:t.next=8;break;case 7:S.info("consultTransfer no found call by callId = "+n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"addVideo",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.CallList[n],S.info("addVideo = "),t.next=4,a.addVideo();case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"getCallCount",value:function(){var t=0;for(var n in e.CallList)S.info("getCallCount, callId = "+n),t++;return S.info("getCallCount, result = "+t),t}},{key:"getCallInfoByCallId",value:function(t){var n=e.CallList[t];return n?n.getCallInfo():{}}},{key:"newCallObject",value:function(t,n){if(e.CallList[t])S.info("already exist call object, callId = "+t);else{var a=e.getCallObject({call_id:t},n);a&&(e.CallList[t]=a),S.info("newCallObject, callId = "+t)}}},{key:"deleteCallObject",value:function(t){S.info("deleteCallObject, callId = "+t),e.CallList[t]&&delete e.CallList[t]}},{key:"openAudioPreview",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.openAudioPreview();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeAudioPreview",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.closeAudioPreview();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicLevel",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.getMicLevel();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"startData",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.abrupt("return",n.startData(t));case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoWindow",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return r=e.sent,e.next=5,r.setVideoWindow(t,n,a);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"addSvcVideoWindow",value:function(t,n,a,r,o){var i=e.CallList[t];S.info("addSvcVideoWindow 参数: calid="+t+",window = "+n+",ssrc="+a+",width = "+r+",height = "+o),i?(i.addSvcVideoWindow(t,n,a,r,o),S.info("addSvcVideoWindow found call by call_id,window ="+n+",width = "+r+",height = "+o)):S.info("addSvcVideoWindow no found call by call_id = ")}},{key:"updateSvcVideoWindow",value:function(){function t(e,t,a,r,o){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r,o,i){var c;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=e.CallList[n],c?(c.updateSvcVideoWindow(n,a,r,o,i),S.info("updateSvcVideoWindow found call by call_id,width = "+o+",height = "+i+",window="+a+",ssrcId="+r)):S.info("updateSvcVideoWindow no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"removeSvcVideoWindow",value:function(){function t(e,t,a,r){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r,o){var i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=e.CallList[n],i?(i.removeSvcVideoWindow(n,a,r,o),S.info("removeSvcVideoWindow found call by call_id = ")):S.info("removeSvcVideoWindow no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"resetBFCStatus",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.CallList[n],r?(r.resetBFCStatus(n,a),S.info("resetBFCStatus found call by call_id = ")):S.info("resetBFCStatus no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"svcRedistributeVideoTmmbr",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=e.CallList[n],a?(a.svcRedistributeVideoTmmbr(n),S.info("svcRedistributeVideoTmmbr found call by call_id = ")):S.info("svcRedistributeVideoTmmbr no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"setSvcLocalVideo",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o,i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r.getFrameFn=b.getLocalFrame,r.onSocketClose=e.onSvcSocketClose,r.resUpdateFn=e.resUpdateSvcLocalFn,r.canvas=a,o=e.getRemoteSvcRender(n),i=e.CallList[$getState().call.callId],o?(o.setViewWH(r.viewW,r.viewH,a),S.info("setSvcLocalVideo, video render is exist,canvasId = "+a.id)):(o=new TUPRender2(r),S.info("setSvcLocalVideo,create a new video render,canvasId = "+a.id)),t.abrupt("return",o);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"setSvcRemoteVideo",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o,i,c,l,s,u,f,p;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.ssrc=n,r.getFrameFn=b.getSVCFrame,r.onSocketClose=e.onSvcSocketClose,r.resUpdateFn=e.resUpdateSvcRemoteFn,r.canvas=a,o=320,i=180,c=0,(0===$getState().conf.svcViewMode||2===$getState().conf.svcViewMode)&&r.viewH>70?(o=1280,i=720,c=window.CLIENTCONFIG.SVC_SHARPENING_SWITCH?1:0):(l=coreConf.getSvcAttendanceManager().getSmallWatchAttendeeSize(),o=l.width,i=l.height),s=e.getRemoteSvcRender(n),u=$getState().call.callId,s){t.next=22;break}if(s=new TUPRender2(r),S.info("[SVC TupRender2]setSvcRemoteVideo,create a new video render,ssrc is "+n+",canvasId= "+a.id),!u){t.next=19;break}return t.next=17,coreTup.getCallInstance();case 17:f=t.sent,f.addSvcVideoWindow(u,0,n,o,i,c);case 19:S.info("setSvcRemoteVideo,addSvcVideoWindow,ssrc is "+n+", width is "+o+", height is "+i),t.next=31;break;case 22:if(S.info("[SVC TupRender2]setSvcRemoteVideo, video render is exist, ssrc is "+n+",option.viewW = "+r.viewW+",option.viewH is "+r.viewH+",canvasId= "+s.canvas.id),s.setViewWH(r.viewW,r.viewH,a),S.info("[SVC TupRender2]setSvcRemoteVideo, video render is exist, canvasId = "+a.id),!u){t.next=30;break}return t.next=28,coreTup.getCallInstance();case 28:p=t.sent,p.updateSvcVideoWindow(u,0,n,o,i,c);case 30:S.info("setSvcRemoteVideo, updateSvcVideoWindow, ssrc is "+n+", width = "+o+", height = "+i);case 31:return t.abrupt("return",s);case 32:case"end":return t.stop()}},t,this)}));return t}()},{key:"setSvcBFCPVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:S.info("setSvcBFCPVideo <video>set bfcp render"),a.resUpdateFn=e.resUpdateBFCPFn,a.getFrameFn=b.getDataFrame,a.onSocketClose=e.onSvcBFCPSocketClose,a.canvas=n,y?(y.setViewWH(a.viewW,a.viewH,n),S.info("setSvcBFCPVideo <video>bfcp render is exist")):(y=new TUPRender2(a),S.info("setSvcBFCPVideo,create a data render")),coreCommon.Observer.publish("SVCBFCPWHSTYLE",a);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeSvcRemoteSocket",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o,i,c,l;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("[SVC TupRender2]closeSvcRemoteSocket,renderID = "+n),a=e.getRemoteSvcRender(n),r=$getState().call.callId,!a||!r){t.next=11;break}if(a.wsocket?a.closeSocket():S.info("[SVC TupRender2]closeSvcRemoteSocket,wsocket is null,render id = ",n),-1===n){t.next=11;break}return b.releaseSVC(Number(n)),t.next=9,coreTup.getCallInstance();case 9:o=t.sent,o.removeSvcVideoWindow(r,0,n,!1);case 11:if(r){for(i=new Array,c=$getState().conf.svcRenders,l=0;l<c.length;l++)c[l].ssrc!==n&&i.push(c[l]);e.handleUpdateSvcRender(i)}case 12:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeAllSvcRemoteSocket",value:function(){function t(){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(){var n,a,r,o,i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=$getState().conf.svcRenders,t.next=3,coreTup.getCallInstance();case 3:a=t.sent,r=$getState().call.callId,S.info("[SVC TupRender2]closeAllSvcRemoteSocket,svcRenders length is ",n.length),o=0;case 7:if(!(o<n.length)){t.next=19;break}if(!n[o].render||!r){t.next=16;break}if(n[o].render.wsocket?(S.info("[SVC TupRender2]closeAllSvcRemoteSocket,render id = ",n[o].ssrc),n[o].render.closeSocket()):S.info("[SVC TupRender2]closeAllSvcRemoteSocket,wsocket is null,render id = ",o),-1===n[o].ssrc){t.next=16;break}return b.releaseSVC(Number(n[o].ssrc)),t.next=14,coreTup.getCallInstance();case 14:i=t.sent,i.removeSvcVideoWindow(r,0,n[o].ssrc,!1);case 16:o++,t.next=7;break;case 19:r&&e.handleUpdateSvcRender([]),S.info("<video> close local socket"),N&&N.closeSocket(),N=null,k&&k.closeSocket(),k=null;case 25:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeSvcDataSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("<video> close svc data socket"),y&&y.closeSocket(),y=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"getCameraCtrl",value:function(t){var n=e.CallList[t];return n?n.getCameraCtrl():(S.error("getCameraCtrl,no found call by callId = "+t),null)}},{key:"getMicCtrl",value:function(t){var n=e.CallList[t];return n?n.getMicCtrl():(S.error("getMicCtrl,no found call by callId = "+t),null)}},{key:"getSpkCtrl",value:function(t){var n=e.CallList[t];return n?n.getSpkCtrl():(S.error("getSpkCtrl,no found call by callId = "+t),null)}},{key:"clearAllDeviceCtrl",value:function(t){var n=e.CallList[t];return n?n.clearAllDeviceCtrl():(S.error("clearAllDeviceCtrl,no found call by callId = "+t),null)}},{key:"setCntOfSpeechLevel",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.CallList[n],r?r.cntOfSpeech=(0,s.default)(r.cntOfSpeech,a):S.error("setCntOfSpeechLevel,no found call by callId = "+n);case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"getCntOfSpeechLevel",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=e.CallList[n])){t.next=5;break}return t.abrupt("return",a.cntOfSpeech);case 5:return S.error("getCntOfSpeechLevel,no found call by callId = "+n),t.abrupt("return",null);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"makePair",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r,o){var i,c;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return i=e.sent,e.next=5,i.makePair(t,n,a,r,o);case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"cancelPair",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.cancelPair(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairSubscribe",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.pairSubscribe(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairLinkage",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return r=e.sent,e.next=5,r.pairLinkage(t,n,a);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairLinkageLeave",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.pairLinkageLeave(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairLinkageEnd",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.pairLinkageEnd(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairEnable",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.pairEnable(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairPermit",value:function(){function e(e,n,a,r,o,i,c,l){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r,o,i,c,l){var s,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return s=e.sent,e.next=5,s.pairPermit(t,n,a,r,o,i,c,l);case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setTUPCallCfg",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return n=e.sent,e.next=5,n.setTUPCallCfg(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"callJointStartLinkage",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.callJointStartLinkage();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"callJointStopLinkage",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.callJointStopLinkage();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"sendUniversalInfo",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.sendUniversalInfo(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"createCallId",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return r=e.sent,e.next=5,r.createCallId(t,n,a);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pointPickupEx",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r){var o,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return o=e.sent,e.next=5,o.pointPickupEx(t,n,a,r);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"groupPickupEx",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r){var o,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return o=e.sent,e.next=5,o.groupPickupEx(t,n,a,r);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getBasicCallInfoNew",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S.info("[IT-meeting] getBasicCallInfoNew isGettingBasicCallInfo = "+x);case 1:if(!x){e.next=6;break}return e.next=4,sleep(300);case 4:e.next=1;break;case 6:return x=!0,e.next=9,coreTup.getCallInstance();case 9:return n=e.sent,e.next=12,n.getBasicCallInfo(t);case 12:return a=e.sent,S.info("[IT-meeting] getBasicCallInfoNew getBasicCallInfo,res = "+a),x=!1,e.abrupt("return",a);case 16:case"end":return e.stop()}},e,this)}));return e}()}],[{key:"handleUniversalInfoNotify",value:function(e){S.info("handleUniversalInfoNotify"),coreCommon.Observer.publish("handleUniversalInfoNotify",e.param)}},{key:"handlePassiveDirectionResult",value:function(e){if(!1===$getState().conf.isAudience)return void S.info("you are not an audience");coreCommon.Observer.publish("PassiveDirectionResult",e)}},{key:"handleAudioNoStreamLeaveConf",value:function(e){S.info("[IT-Meeting] meeting audio no stream to leave conference."),coreConf.actionLeaveConf({isPassivity:!0})}},{key:"handlesetVideoIdxRet",value:function(e){S.info("handlesetVideoIdxRet."),coreCommon.Observer.publish("handlesetVideoIdxRet",e.param)}},{key:"handleSpkMicList",value:function(e){S.info("handleSpkMicList. status: ",e),coreCommon.Observer.publish("HandleSpkMicList",e.param)}},{key:"handleCameraList",value:function(e){S.info("handleCameraList. status: ",e),coreCommon.Observer.publish("HandleCameraList",e.param)}},{key:"handleUploadChrFile",value:function(e){S.info("handleUploadChrFile. status: "+(0,c.default)(e)),coreCommon.Observer.publish("handleUploadChrFile",e.param)}},{key:"handleSpeechLevelReport",value:function(e){}},{key:"onLocalSocketClose",value:function(){S.info("local socket close ,set local render null"),N=null}},{key:"onRemoteSocketClose",value:function(){S.info("Remote socket close ,set local render null"),E=null}},{key:"onBFCPSocketClose",value:function(){S.info("BFCP socket close ,set local render null"),k=null}},{key:"resUpdateBFCPFn",value:function(e,t,n,a){var r={};r.width=n||e,r.height=a||t,$getState().conf.isSvcConf&&(r.width=e||n,r.height=t||a),r.videoWinMode=2,S.info("<video> resUpdateBFCPFn,videoWH= ",(0,c.default)(r)),coreCommon.Observer.publish("VideoWHGet",r)}},{key:"resUpdateLocalFn",value:function(e,t,n,a){var r={};r.width=n||e,r.height=a||t,r.videoWinMode=0,r.ssrc=-1,S.info("<video> handleVideoWHGet,videoWH= ",(0,c.default)(r)),coreCommon.Observer.publish("VideoWHGet",r)}},{key:"resUpdateRemoteFn",value:function(e,t,n,a){var r={};if(r.width=n||e,r.height=a||t,r.videoWinMode=1,S.info("<video> handleVideoWHGet,videoWH= ",(0,c.default)(r)),$getState().conf.isSvcConf)return void S.info("<video>resUpdateRemoteFn,isSvcConf,do nothing,return");coreCommon.Observer.publish("VideoWHGet",r)}},{key:"resUpdateSvcLocalFn",value:function(e,t,n,a,r){var o={};o.width=e||n,o.height=t||a,o.videoWinMode=0,o.ssrc=-1,S.info("<video> handleVideoWHGet,ssrc = "+r+" videoWH= "+(0,c.default)(o)),coreCommon.Observer.publish("VideoWHGet",o)}},{key:"resUpdateSvcRemoteFn",value:function(e,t,n,a,r){var o={};o.width=e||n,o.height=t||a,o.videoWinMode=1,o.ssrc=r,S.info("<video> handleVideoWHGet,ssrc = "+r+" videoWH= "+(0,c.default)(o)),coreCommon.Observer.publish("VideoWHGet",o)}},{key:"handleUpdateSvcRender",value:function(e){coreCommon.Observer.publish("updateSvcRender",e),S.info("handleUpdateSvcRender")}},{key:"handleSipRegResult",value:function(e){coreCommon.Observer.publish("SipRegResultNotify",e)}},{key:"handleCallEnded",value:function(t){var n=e.CallList[t.param.call_id];if(window.endCallPromise&&window.endCallPromise.resolve(),window.CLIENTCONFIG.ISBIGWIN){var a=$getState().call;"CALL_OUT"!==a.callStatus&&"VIDEO_OUT"!==a.callStatus||$getState().bigwinBuried.buried.postHasSent||(coreCommon.BigwinObserver.publish("OnJoinConfFailed"),coreCommon.BigwinObserver.publish("OnChangeHasSent",!0))}n?(n.handleCallEnded(t),delete e.CallList[t.param.call_id],S.info("handleCallEnded found call by callId = "+t.param.call_id)):S.info("handleCallEnded no found call by call_id = "+t.param.call_id)}},{key:"handleCallDestroy",value:function(t){S.info("handleCallDestroy  callId: "+t.param.call_id);var n=e.CallList[t.param.call_id];n?(n.handleCallDestroy(t),delete e.CallList[t.param.call_id]):S.info("handleCallDestroy no found call by call_id = "+t.param.call_id)}},{key:"handleCallRingBack",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallRingBack(t),S.info("handleCallRingBack found call by call_id = "+t.param.call_id)):S.info("handleCallRingBack no found call by call_id = "+t.param.call_id)}},{key:"handleCallLocalQos",value:function(t){var n=e.countCallQos(t.param.netquality_change.net_level);coreCommon.Observer.publish("CallLocalQos",n)}},{key:"handleBFCPDataBeginRec",value:function(e){S.info("handleBFCPDataBeginRec notify param : ",e),coreCommon.Observer.publish("BFCPDataBeginRec",e)}},{key:"handleBFCPFrameSizeChange",value:function(e){S.info("handleBFCPFrameSizeChange notify param : ",e),coreCommon.Observer.publish("BFCPFrameSizeChange",e)}},{key:"handleBFCPDataStop",value:function(e){S.info("handleBFCPDataStop notify param : ",e),coreCommon.Observer.publish("BFCPDataStopRec",!1,e)}},{key:"handlePlayMedia",value:function(e){var t=e.param.play_handle;S.info("handlePlayMedia play_handle = ",t),coreCommon.Observer.publish("PlayMediaHandle",t)}},{key:"handleLowVideoBW",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleLowVideoBW(t),S.info("handleLowVideoBW found call by call_id = "+t.param.call_id)):S.info("handleLowVideoBW no found call by call_id = "+t.param.call_id)}},{key:"handleDeviceHowlStatus",value:function(e){S.info("handleDeviceHowlStatus. howlstatus ",e),coreCommon.Observer.publish("DeviceHowlStatus",e.param)}},{key:"handleMediaSRTPStatus",value:function(e){S.info("handleMediaSRTPStatus. status: ",e),coreCommon.Observer.publish("MediaSRTPStatus",e.param)}},{key:"handleIsKickOff",value:function(e){S.info("handleSipKickOff",e),coreCommon.Observer.publish("handleSipKickOff",e)}},{key:"handleDataStartError",value:function(e){S.info("handleDataStartError",e),coreCommon.Observer.publish("handleDataStartError",e)}},{key:"handleDataSending",value:function(e){S.info("handleDataSending",e),coreCommon.Observer.publish("handleDataSending",e)}},{key:"countCallQos",value:function(e){if(coreConf.isInConf())return void S.info("countCallQos isInConf return");var t=0;return t=e>2.8?5:e>2.4?4:e>2?3:e>1.6?2:1,e<=2.4?(T+=1)>=3&&coreCommon.Observer.publish("lowCallLocalQos",T):(T>=3&&coreCommon.Observer.publish("lowCallLocalQos",0),T=0),t}},{key:"handleCallIncomming",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(S.info("handleCallIncomming callId: "+n.param.call_id),S.info("before callInfo "+handlePhoneNumber(n.param.domain_ip)),!coreConf.isInConf()){t.next=13;break}if(S.info("handleCallIncomming already exist conf,end this call"),!(n&&n.param&&n.param.call_id)){t.next=12;break}return t.next=7,coreTup.getCallInstance();case 7:return a=t.sent,t.next=10,a.endCall(n.param.call_id);case 10:r=t.sent,0===r.result?S.info("handleCallIncomming end call success"):S.info("handleCallIncomming end call failed");case 12:return t.abrupt("return");case 13:/[@]/.test(n.param.domain_ip)&&/[a-zA-Z]/.test(n.param.tel_num)&&(n.param.tel_num=n.param.domain_ip),S.info("after callInfo "+handlePhoneNumber(n.param.domain_ip)),o=e.getCallObject(n.param,n.param.call_type),o.callInfo.callType=n.param.call_type,e.CallList[n.param.call_id]=o,o.handleCallIncomming(n);case 19:case"end":return t.stop()}},t,this)}));return t}()},{key:"handleCallConnected",value:function(t){var n=e.CallList[t.param.call_id];if(S.info("debug info turnV handleCallConnected outer"),n.callInfo.callType!==t.param.call_type){S.info("debug info turnV handleCallConnected inner");var a=1===t.param.call_type,r=e.getCallObject({call_id:t.param.call_id},a);r.callInfo.callNo=n.callInfo.callNo,r.callInfo.callId=n.callInfo.callId,r.callInfo.callType=t.param.call_type,r.callInfo.callState=t.param.call_state,r.callInfo.callee=n.callInfo.callee,r.callInfo.ucaccount=n.callInfo.ucaccount,r.callInfo.isVideo=a,r.callInfo.callInOut=n.callInfo.callInOut,r.callInfo.isCallSuccess=n.callInfo.isCallSuccess,r.callInfo.milltime=n.callInfo.milltime,r.callInfo.startTime=n.callInfo.startTime,r.callInfo.date=n.callInfo.date,r.callInfo.remoteAddr=t.param.remote_addr,delete e.CallList[t.param.call_id],e.CallList[t.param.call_id]=r,n=r}n?(n.handleCallConnected(t),S.info("handleCallConnected found call by callId = "+t.param.call_id)):S.info("handleCallConnected no found call by callId = "+t.param.call_id)}},{key:"handleCallRTPCreated",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallRTPCreated(t),S.info("handleCallRTPCreated found call by callId = "+t.param.call_id)):S.info("handleCallRTPCreated no found call by callId = "+t.param.call_id)}},{key:"handleCallHoldSuccess",value:function(t){S.info("handleCallHoldSuccess callId = "+t.param.call_id);var n=e.CallList[t.param.call_id];n?n.handleCallHoldSuccess(t):S.info("handleCallHoldSuccess no found call by callId = "+t.param.call_id)}},{key:"handleCallHoldFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallHoldFailed(t),S.info("handleCallHoldFailed found call by callId = "+t.param.call_id)):S.info("handleCallHoldFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallUnHoldSuccess",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallUnHoldSuccess(t),S.info("handleCallUnHoldSuccess found call by callId = "+t.param.call_id)):S.info("handleCallUnHoldSuccess no found call by callId = "+t.param.call_id)}},{key:"handleCallUnHoldFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallUnHoldFailed(t),S.info("handleCallUnHoldFailed found call by callId = "+t.param.call_id)):S.info("handleCallUnHoldFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallDivertFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallDivertFailed(t),S.info("handleCallDivertFailed found call by callId = "+t.param.call_id)):S.info("handleCallDivertFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallBldTransferFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallBldTransferFailed(t),S.info("handleCallBldTransferFailed found call by callId = "+t.param.call_id)):S.info("handleCallBldTransferFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallBldTransferSuccess",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallBldTransferSuccess(t),S.info("handleCallBldTransferSuccess found call by call_id = "+t.param.call_id)):S.info("handleCallBldTransferSuccess no found call by call_id = "+t.param.call_id)}},{key:"handleCallModifyVideoResult",value:function(t){var n=e.CallList[t.param.call_id];n?(S.info("handleCallModifyVideoResult found call by call_id = "+n.callInfo.callId),n.handleCallModifyVideoResult(t)):S.info("handleCallModifyVideoResult no found call by call_id ")}},{key:"handleCallSessionModify",value:function(t){var n=e.CallList[t.param.call_id];if(S.info("handleCall[Session]Modify audio_send_mode: "+t.param.audio_send_mode+" data_send_mode: "+t.param.data_send_mode),n){if(S.info("handleCall[Session]Modify: callInfo "+n.callInfo.callType),2===t.param.audio_send_mode&&0===t.param.video_send_mode&&0===n.callInfo.callType)return S.info("handleCall[Session]Modify audio_send_mode = "+t.param.audio_send_mode),void coreCommon.Observer.publish("setTransferModify",t.param);if(4===t.param.audio_send_mode&&0===t.param.video_send_mode&&0===n.callInfo.callType)return S.info("handleCall[Session]Modify audio_send_mode = "+t.param.audio_send_mode),void coreCommon.Observer.publish("setTransferModify",t.param);if(0===n.callInfo.isFocus&&4===t.param.video_send_mode&&4===t.param.audio_send_mode&&1===t.param.is_focus&&(S.info("handleCall[Session]Modify set conf to video"),coreCommon.Observer.publish("beTransferToConfToVideo",t.param),!window.CLIENTCONFIG.ENABLE_IT_MEETING))return;var a=0;if(4===t.param.video_send_mode&&0===n.callInfo.callType)a=1;else{if(0!==t.param.video_send_mode||1!==n.callInfo.callType||4!==t.param.audio_send_mode)return void S.info("handleCall[Session]Modify, not update to video, return, video_send_mode ="+t.param.video_send_mode+"oldCallType = "+n.callInfo.callType);a=0}var r={call_id:t.param.call_id,tel_num:n.callInfo.callNo,call_type:a,call_state:n.callInfo.callState,callInOut:n.callInfo.callInOut,isCallSuccess:n.callInfo.isCallSuccess,milltime:n.callInfo.milltime,startTime:n.callInfo.startTime,date:n.callInfo.date};delete e.CallList[n.callInfo.callId];var o=e.getCallObject(r,a);e.CallList[o.callInfo.callId]=o,o.handleCallSessionModify(t),S.info("handleCallModifyVideoResult found call by call_id = "+t.param.call_id)}else S.info("handleCallModifyVideoResult no found call by call_id = "+t.param.call_id)}},{key:"handleMicVolChange",value:function(e){coreCommon.Observer.publish("CallMicVolChange",e),S.info("handleMicVolChange, CallMicVolChange = ",e)}},{key:"handleSpkMuteChange",value:function(e){coreCommon.Observer.publish("SpkMuteChange",e),S.info("SpkMuteChange, SpkMute = ",e)}},{key:"handleSpkVolChange",value:function(e){coreCommon.Observer.publish("CallSpkVolChange",e),S.info("handleSpkVolChange, CallSpkVolChange = ",e)}},{key:"handleCallAddVideo",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getBasicCallInfo(n.param.call_id);case 2:if(!(a=t.sent)){t.next=7;break}return S.info("AddVideoRequest"),coreCommon.Observer.publish("AddVideoRequest",n.param),t.abrupt("return");case 7:r=e.CallList[n.param.call_id],r?(r.handleCallAddVideo(n),S.info("handleCallAddVideo found call by call_id = ")):S.info("handleCallAddVideo no found call by call_id = ");case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"handleCallSocketClose",value:function(){}},{key:"handleCallDelVideo",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallDelVideo(t),S.info("handleCallDelVideo found call by call_id = ")):S.info("handleCallDelVideo no found call by call_id = ")}},{key:"handleVideoRefreshView",value:function(e){S.info("<video> handleVideoRefreshView,data.param= ",e.param),coreCommon.Observer.publish("VideoRefreshView",e.param)}},{key:"handleVideoDecodeSuccess",value:function(t){var n=e.CallList[t.param.call_id];n?(2===t.param.media_type?n.handleVideoDecodeSuccess(t):3===t.param.media_type&&n.handleBfcpDecodeSuccess(t.param.call_id),S.info("handleVideoDecodeSuccess found call by call_id = ")):S.info("handleVideoDecodeSuccess no found call by call_id = ")}},{key:"handleMobileRouteChange",value:function(e){coreCommon.Observer.publish("MobileRouteChange",e.param),S.info("handleMobileRouteChange MobileRouteChange = ",e)}},{key:"handleAudioFileEnd",value:function(e){"function"==typeof window.notifyAudioFileEnd&&(S.info("handleAudioFileEnd = ",e),window.notifyAudioFileEnd(e.param.handle))}},{key:"handleCallAtdTransferSuccess",value:function(e){coreCommon.Observer.publish("CallAtdTransferSuccess",e.param),S.info("handleCallAtdTransferSuccess CallAtdTransferSuccess = "+e.param)}},{key:"handleCallAtdTransferFailed",value:function(e){coreCommon.Observer.publish("CallAtdTransferFailed",e.param),S.info("handleCallAtdTransferFailed CallAtdTransferFailed = "+e.param)}},{key:"handleSipAccountWmi",value:function(e){coreCommon.Observer.publish("SipAccountWmi",e.param),S.info("handleSipAccountWmi SipAccountWmi = ")}},{key:"getCallObject",value:function(e,t){return t?(S.info("getCallObject isVideo "),new _.default(e)):(S.info("getCallObject not isVideo"),new I.default(e))}},{key:"getRemoteSvcRender",value:function(e){for(var t=$getState().conf.svcRenders,n=0;n<t.length;n++)if(t[n].ssrc===e)return S.info("getRemoteSvcRender, has found render by renderID = "+e+",render = "+t[n].render),t[n].render;return S.info("getRemoteSvcRender, do not found render by renderID = ",e),null}},{key:"onSvcBFCPSocketClose",value:function(){S.info("svc BFCP socket close ,set svcBfcpR null"),y=null}},{key:"onSvcSocketClose",value:function(){S.info("Svc socket closed")}},{key:"receivePairReqNotify",value:function(e){S.info("receivePairReqNotify"),coreCommon.Observer.publish("receivePairReqNotify",e.param)}},{key:"pairedOrCanceledResultNotify",value:function(e){S.info("pairedOrCanceledResultNotify"),coreCommon.Observer.publish("pairedOrCanceledResultNotify",e.param)}},{key:"pairClosedNotify",value:function(e){S.info("pairClosedNotify, data: ",e),coreCommon.Observer.publish("pairClosedNotify",e.param)}},{key:"pairSubscribeNotify",value:function(e){S.info("pairSubscribeNotify, data: ",e),coreCommon.Observer.publish("pairSubscribeNotify",e.param)}},{key:"pairCallStateNotify",value:function(e){S.info("pairCallStateNotify, data: ",e),coreCommon.Observer.publish("pairCallStateNotify",e.param)}},{key:"pairLinkageConfNotify",value:function(e){S.info("pairLinkageConfNotify, data: ",e),coreCommon.Observer.publish("pairLinkageConfNotify",e.param)}},{key:"pairLinkageConfStateNotify",value:function(e){S.info("pairLinkageConfStateNotify, data: ",e),coreCommon.Observer.publish("pairLinkageConfStateNotify",e.param)}},{key:"handleNewServiceRight",value:function(e){S.info("handleNewServiceRight"),coreCommon.Observer.publish("newServiceRightNotify",e.param)}},{key:"handleCallUpateRemoteInfo",value:function(t){S.info("handleCallUpateRemoteInfo callId: "+t.param.call_id);var n=e.CallList[t.param.call_id];n&&""!==t.param.domain_ip?(n.handleCallUpateRemoteInfo(t),S.info("handleCallUpateRemoteInfo found call by call_id = "+t.param.call_id)):S.info("handleCallUpateRemoteInfo no found call by call_id = "+t.param.call_id)}},{key:"handleCallJointStartNotify",value:function(e){S.info("handleCallJointStartNotify, data: ",e),coreCommon.Observer.publish("callJointStartNotify",e.param)}},{key:"handleCallJointCloseNotify",value:function(e){S.info("handleCallJointCloseNotify, data: ",e),coreCommon.Observer.publish("callJointCloseNotify",e.param)}},{key:"handleCallJointOnlineNotify",value:function(e){S.info("handleCallJointOnlineNotify, data: ",e),coreCommon.Observer.publish("callJointOnlineNotify",e.param)}},{key:"handleCallJointOffLineNotify",value:function(e){S.info("handleCallJointOffLineNotify, data: ",e),coreCommon.Observer.publish("callJointOffLineNotify",e.param)}},{key:"handleCallJointOffHookNotify",value:function(e){S.info("handleCallJointOffHookNotify, data: ",e),coreCommon.Observer.publish("callJointOffHookNotify",e.param)}},{key:"handleCallJointOutGoingNotify",value:function(e){S.info("handleCallJointOutGoingNotify, data: ",e),coreCommon.Observer.publish("callJointOutGoingNotify",e.param)}},{key:"handleCallJointEstablishedNotify",value:function(e){S.info("handleCallJointEstablishedNotify, data: ",e),coreCommon.Observer.publish("callJointEstablishedNotify",e.param)}},{key:"handleCallJointPeerCapsReportNotify",value:function(e){S.info("handleCallJointPeerCapsReportNotify, data: ",e),coreCommon.Observer.publish("callJointPeerCapsReportNotify",e.param)}},{key:"handleCallPickupNotify",value:function(e){S.info("handleCallPickupNotify, data: ",e),coreCommon.Observer.publish("handleCallPickupNotify",e.param)}},{key:"handleCallPickupRemoteInfo",value:function(e){S.info("handleCallPickupRemoteInfo, data: ",e),coreCommon.Observer.publish("handleCallPickupRemoteInfo",e.param)}},{key:"getBasicCallInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a,r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,a={callid:t,infoid:0},e.next=4,coreTup.getCallInstance();case 4:return r=e.sent,e.next=7,r.getBasicCallInfo(a);case 7:return o=e.sent,0===o.result&&(n=o.param.call_info.conf_media_type),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),r.CallList={},r.handleNoStream=function(e){coreCommon.Observer.publish("handleNoStream",e.params)},o);t.default=O},910:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=n(131),s=a(l),u=n(4),d=a(u),f=n(5),p=a(f),h=n(132),C=a(h),m=n(133),v=a(m),w=n(806),I=a(w),g=coreLogger.getLogger("model")("model/callService/videoCallService"),_=function(e){function t(e){(0,d.default)(this,t);var n=(0,C.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return n.callInfo.isVideo=!0,e?n:(g.error("can not create VideoCallService object"),(0,C.default)(n))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"acceptCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n,a,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,g.info("<video> acceptCall,callId = ",this.callInfo.callId),n=!r,e.next=7,t.acceptCall(this.callInfo.callId,n);case 7:if((a=e.sent)&&0===a.result){e.next=13;break}g.error("<video>accept call failed, result = ",a),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ACCEPTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),a.result]}),e.next=18;break;case 13:return this.setDeviceControlCallId(this.callInfo.callId),e.next=16,coreCommon.CameraControl.getInstance().initAfterGetCallId();case 16:coreCommon.SpkControl.getInstance().cancelSysSpkMute(),n&&!window.otherAudioDevicesConnect?coreCommon.SpkControl.getInstance().setHandsFree(!0):coreCommon.SpkControl.getInstance().setHandsFree(!1);case 18:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCaptureRotation",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a){var r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return r=e.sent,e.next=5,r.setCaptureRotation(t,n,a);case 5:return i=e.sent,0===i.result?g.info("set Capture Rotation success"):g.info("set Capture Rotation failed, result = "+i.result),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setDisplayRotation",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a){var r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return r=e.sent,e.next=5,r.setDisplayRotation(t,n,a);case 5:return i=e.sent,0===i.result?g.info("set Display Rotation success"):g.info("set Display Rotation failed, result = "+i.result),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoCollectMode",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n){var a,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return a=e.sent,e.next=5,a.setVideoCollectMode(t,n);case 5:return r=e.sent,0===r.result?g.info("set Video CollectMode success"):g.info("set Video CollectMode failed, result = "+r.result),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoRender",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a,r,i){var c,l;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return c=e.sent,e.next=5,c.setVideoRender(t,n,a,r,i);case 5:l=e.sent;case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"delVideo",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getCallInstance();case 2:return t=e.sent,e.next=5,t.delVideo(this.callInfo.callId);case 5:return n=e.sent,0===n.result?(coreCommon.SpkControl.getInstance().setHandsFree(!1),g.info("delete video success")):g.info("delete video failed, result = "+n.result),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleVideoRefreshView",value:function(e){g.info("<video> handleVideoRefreshView,data.param= ",e.param),coreCommon.Observer.publish("VideoRefreshView",e.param)}},{key:"handleVideoDecodeSuccess",value:function(e){g.info("<video> handleVideoDecodeSuccess,data.param= ",e.param),coreCommon.Observer.publish("VideoDecodeSuccess",e.param)}},{key:"handleBfcpDecodeSuccess",value:function(e){g.info("<video> handleBfcpDecodeSuccess callID: ",e),coreCommon.Observer.publish("BFCPDecodeSuc",e,!1)}}]),t}(I.default);t.default=_},911:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return["callMain","ConfMemberList","mConfMemberPage","mSelectBox","mInitShowSelectBox","selectCorporateDirectory","selectPhoneAddress","selectCorporateDirctory","contactBasics"].includes(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.callPermissionCheck=t.createVideoPreCheck=t.handleSvcWatchIndNotify=t.checkIsSupportWebgl=t.closeAllVideoSocket=t.handleLowVideoBWNotify=t.getBigContainerSize=t.changeBigContainerSize=t.changeScreenState=t.changeFullScreenReceiveShare=t.exitFullScreen=t.toFullScreen=t.setCurrentVideoWinForMode=t.exchangeSvcVideoWin=t.changeVideoWin=t.calcSmallWinPos=t.calcRealVideoSize=t.calcVideoSize=t.switchMobileVideoFullScreen=t.changeFullScreen=t.pcHandup=t.mlockConf=t.switchPIPMode=t.openOrOffCamera=t.resumeScreenStateWhenCallOrConfEnd=t.changeIsToolBarEnter=t.changeIsShowToolBar=t.handleSVCBFCPWHSTYLE=t.handlesetVideoIdxRet=t.registerVideoEvent=t.DoCloseSmallWin=void 0;var o=n(3),i=a(o),c=n(135),l=a(c),s=n(69),u=a(s),d=n(149),f=a(d),p=n(1),h=a(p),C=n(2),m=a(C);t.isNeedFloatWindowCurrentPage=r;var v=n(807),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(v),I=coreLogger.getLogger("logic")("video/index"),g=0,_=0,S=/M\d+T0/,b=!1,N=(t.DoCloseSmallWin=function(){var e=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.CloseSmallWinAction()),I.info("dispatch,CloseSmallWinAction,no value");case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.registerVideoEvent=function(){I.info("registerVideoEvent, Observer subscribe topics"),coreCommon.Observer.subscribe("VideoWHGet",F),coreCommon.Observer.subscribe("VideoRefreshView",U),coreCommon.Observer.subscribe("VideoDecodeSuccess",B),coreCommon.Observer.subscribe("BFCPDecodeSuc",$),coreCommon.Observer.subscribe("BFCPDataStopRec",P),coreCommon.Observer.subscribe("SVCBFCPWHSTYLE",E),coreCommon.Observer.subscribe("BFCPDataBeginRec",G),coreCommon.Observer.subscribe("BFCPFrameSizeChange",W),coreCommon.Observer.subscribe("LowVideoBW",J),coreCommon.Observer.subscribe("handleSvcWatchInd",ne),coreCommon.Observer.subscribe("handlesetVideoIdxRet",N)},t.handlesetVideoIdxRet=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("handlesetVideoIdxRet media_type"+t.media_type+"error_type"+t.error_type),2===t.media_type&&1===t.error_type?window.CLIENTCONFIG.ISMOBILE||(coreConf.getSvcAtdManager().alertBox(language.SET_CAMERA_FAILED,2),n={msg_type:1},coreCommon.CameraControl.getInstance().switchCameraStateAction(!1)):1===t.media_type&&t.error_type,coreCommon.isWin()&&(a=$getState().call.callStatus,"VIDEO_CONNECTED"===a||"VIDEO_OUT"===a||"CALL_OUT"===a||"CALL_CONNECTED"===a?(I.info("handlesetVideoIdxRet showDevicesListFunc()"),coreSetting.showDevicesListFunc()):$dispatch(coreUi.changeIsShowDevicesList(!0)));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),E=t.handleSVCBFCPWHSTYLE=function(){var e=(0,m.default)(h.default.mark(function e(t){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($getState().conf.isSvcConf){e.next=2;break}return e.abrupt("return");case 2:I.info("handleSVCBFCPWHSTYLE= ",t.viewW,t.viewH),0===$getState().conf.svcViewMode&&$dispatch(coreUi.changeBigWinStyle({width:t.viewW,height:t.viewH,position:"absolute"}));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),k=(t.changeIsShowToolBar=function(){var e=(0,m.default)(h.default.mark(function e(t){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("changeIsShowToolBar,isShow = "+t),$dispatch(coreUi.changeToolBarShow(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.changeIsToolBarEnter=function(){var e=(0,m.default)(h.default.mark(function e(t){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("changeIsToolBarEnter,isShow = "+t),$dispatch(coreUi.changeToolBarEnter(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.resumeScreenStateWhenCallOrConfEnd=function(){var e=(0,m.default)(h.default.mark(function e(){var t;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().call.screenState,I.info("<video>resumeScreenStateWhenCallOrConfEnd,change screen state,screenStateNow = "+t),window.CLIENTCONFIG.ISBIGWIN?appService.hideWindow():"full"===t?M():"extra"===t?(delegate.resumeShow(!1),window.CLIENTCONFIG.ISMOBILE||delegate.winMinimize()):A("middle");case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.openOrOffCamera=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.isOpenCamera,a=$getState().call.callId,I.info("openOrOffCamera",t,"===",n),t===n){e.next=6;break}return I.error("Camera is",t?"OFF":"OPEN"),e.abrupt("return");case 6:coreCommon.CameraControl.getInstance().switchCameraStateAction(!t),window.CLIENTCONFIG.ISBIGWIN&&coreConf.NotifyLocalCameraStatus(0,!t);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.switchPIPMode=function(){var e=$getState().call.isOpenPIP;I.info("userClick  switchPIPMode isOpenPIP: "+e),window.switchLocalVideoState(!1,!e),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&coreConf.itmeetingSmallWin(!e),$dispatch(coreUi.CloseOrOpenPIP(!e))},t.mlockConf=function(e){var t="lock"===e.action?1:0;I.info("mlockConf isLock: (1 locked 0 unlocked)"+t),coreConf.lockConfService(t)},t.pcHandup=function(){var e=$getState().conf.isHandup,t=e?0:1;I.info("userClick  pcHandup isHandup: (1 handup 0 unhandup)"+t);var n=$getState().conf.memberListInfo,a=k(n);I.info("pcHandup selfnum: (1 handup 0 unhandup)"+a),coreConf.handup(t,a)},function(e){var t=void 0,n=!0,a=!1,r=void 0;try{for(var o,i=(0,f.default)(e);!(n=(o=i.next()).done);n=!0){var c=o.value;if(c.is_self){t=c.number;break}}}catch(e){a=!0,r=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw r}}return t}),y=(t.changeFullScreen=function(){var e=(0,m.default)(h.default.mark(function e(){var t;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().call.screenState,I.info("<video> userClick  change screen state,screenStateNow = "+t),"min"===t?A("middle"):"middle"===t?(R(!0),L()):"full"===t?(R(!1),M()):delegate.resumeShow(!0);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.switchMobileVideoFullScreen=function(){var e=(0,m.default)(h.default.mark(function e(){var t,n,a,r,o,i,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call.screenState,I.info("<video> userClick switchMobileVideoFullScreen = "+t+",screenMode :"+c),coreUi.hidePopoverMenu(),c!==t){e.next=6;break}return I.info("<video> switchMobileVideoFullScreen same mode return"),e.abrupt("return");case 6:n="VIDEO_CONNECTED"===$getState().call.callStatus||"VIDEO_OUT"===$getState().call.callStatus,window.CLIENTCONFIG.ISMOBILE&&$getState().conf.isSvcConf&&window.changeScreenOrientation(constant.SCREEN_ORIENTATION.SCREEN_ORIENTATION_PORTRAIT),a=void 0===c?"min"!==t:"min"===c,a?($dispatch(coreUi.changeFullScreenState("min")),$getState().synergismInfo.inPairConf&&(n=!1),window.showCallViewFullScreen(!1,n)):(r=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==r?coreUi.hideModal():I.info("already call main view"),o=$getState().call.screenState,i=document.querySelector(".am-modal-mask"),"full"!==o&&i&&(window.dispatchEvent(new Event("closeModalAlert")),window.dispatchEvent(new Event("closeModalConfirm"))),$dispatch(coreUi.changeFullScreenState("full")),$getState().synergismInfo.inPairConf&&(n=!1),window.showCallViewFullScreen(!0,n));case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());window.mobileChangeFullScreen=y,window.mobileBackToCallPage=function(){var e=window.getRoute();I.info("userClick  mobileBackToCallPage current page is: "+e);var t=$getState().call.callId;coreUi.hidePopoverMenu(),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&"android"===window.CLIENTCONFIG.PLATFORM&&(I.info("[IT-Meeting] userClick mobileBackToCallPage closeTheWeImg"),window.closeTheWeImg()),!window.CLIENTCONFIG.ISMOBILE||r(e)||isNullOrEmpty(t)?I.info("already call main view"):(I.info("window.mobileBackToCallPage go to callmain"),window.goRoute("callMain"),coreUi.hideModal(),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&$getState().synergismInfo.pairState===constant.PAIR_STATE.PAIR_SUCCESS&&coreConf.endPairWithPeripherals({tips:language.PAIR_CLOSED})),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==e&&window.changeScreenOrientation(1);var n=$getState().call.screenState,a=document.querySelector(".am-modal-mask");"full"!==n&&a&&(window.dispatchEvent(new Event("closeModalAlert")),window.dispatchEvent(new Event("closeModalConfirm"))),window.CLIENTCONFIG.ENABLE_IT_MEETING&&(window.delayCreateFloat&&clearTimeout(window.delayCreateFloat),window.showPageLoading(!1)),setTimeout(function(){$dispatch(coreUi.changeFullScreenState("full"))},1e3)},window.changeToSvcIosGoToPage=function(){var e=window.getRoute();I.info("userClick  changeToSvcIosPage current page is: "+e),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==e&&"mConfMemberPage"!==e?(I.info("go to callmain"),window.goRoute("callMain"),coreUi.hideModal()):I.info("already call main view");var t=$getState().call.screenState,n=document.querySelector(".am-modal-mask");"full"!==t&&n&&(window.dispatchEvent(new Event("closeModalAlert")),window.dispatchEvent(new Event("closeModalConfirm"))),$dispatch(coreUi.changeFullScreenState("full"));var a="VIDEO_CONNECTED"===$getState().call.callStatus||"VIDEO_OUT"===$getState().call.callStatus;$getState().synergismInfo.inPairConf&&(a=!1),window.showCallViewFullScreen(!0,a)};var T=t.calcVideoSize=function(e,t){var n=0;if($getState().conf.isSvcConf){if(0===$getState().conf.svcViewMode||2===$getState().conf.svcViewMode){var a=$getState().conf.ssrcRange,r=a.min+"_frame_share";n=coreConf.getSvcAttendanceManager().calcCanvas16And9Size(e),I.info("calcVideoSize,big canvasSize is ",n),w.setSvcRemoteVideoRender(a.min,r,n)}}else n=x(e,t),1===e.videoWinMode?w.setVideoWH(!0,n):0===e.videoWinMode&&w.setVideoWH(!1,n);return n},x=t.calcRealVideoSize=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={width:0,height:0};if(e&&t){var r=e.width/e.height,o=t.width,i=t.height;I.info("<video>calcVideoSize,oldsize width = "+e.width+",height = "+e.height+",containerSize width = "+t.width+",heigth = "+t.height);var c=Math.floor(o/r),l=Math.floor(i*r),s=Math.floor((i-c)/2),d=Math.floor((o-l)/2);r>1&&s>0||r<1&&d<0?(a=n?{width:o,height:c,top:s}:{width:o,height:c},I.info("<video>newSize = ",(0,u.default)(a))):(a={width:l,height:i},I.info("<video>newSize = ",(0,u.default)(a)))}return t||I.warn("<video>containerSize is null"),a},O=(t.calcSmallWinPos=function(e,t,n,a){var r={newDragTopX:e,newDragTopY:t};if(void 0!==e&&void 0!==t&&void 0!==n&&void 0!==a){var o=e;n.clientWidth,a.clientWidth,n.clientHeight,a.clientHeight;t>n.clientHeight-a.clientHeight&&(t=n.clientHeight-a.clientHeight),r=o<=Math.floor(n.clientHeight/2)?{newDragTopX:5,newDragTopY:t}:{newDragTopX:n.clientWidth-a.clientWidth-5,newDragTopY:t}}else I.warn("dragX,dragY,bigContainerSize,smallContainerSize is null");return r},t.changeVideoWin=function(){var e=(0,m.default)(h.default.mark(function e(){var t,n,a,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.setIsDecodeSuc()),t=$getState().call,n=j(),a={height:constant.VIDEO_SMALL_SIZE.HEIGHT,width:constant.VIDEO_SMALL_SIZE.WIDTH},t.isRemoteBig?(n=x({width:$getState().call.smallWinStyle.width,height:$getState().call.smallWinStyle.height},n),w.setVideoWH(!1,n),a=x({width:$getState().call.bigWinStyle.width,height:$getState().call.bigWinStyle.height},a,!1),w.setVideoWH(!0,a)):(a=x({width:$getState().call.bigWinStyle.width,height:$getState().call.bigWinStyle.height},a,!1),w.setVideoWH(!1,a),n=x({width:$getState().call.smallWinStyle.width,height:$getState().call.smallWinStyle.height},n),w.setVideoWH(!0,n)),$dispatch(coreUi.changeSmallWinStyle(a)),$dispatch(coreUi.changeBigWinStyle(n)),r&&$dispatch(coreUi.changeBigSmallWin());case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.exchangeSvcVideoWin=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={};if(a=n?coreConf.getSvcAttendanceManager().calcCanvas16And9Size(0,constant.VIDEO_SIZE_BITE.SIZE_9_B_16):coreConf.getSvcAttendanceManager().calcCanvas16And9Size(),$dispatch(coreUi.changeBigWinStyle(a)),-1===e?$dispatch(coreUi.setIsOppsite(!0)):$dispatch(coreUi.setIsOppsite(!1)),-2!==e&&-3!==e&&(coreConf.getSvcAttendanceManager().changeSvcWindowSize(e,a),I.info("change vedio window size, ssrc: "+e+",size: "+(0,u.default)(a))),-2!==t&&-3!==t){var r={width:127,height:70};coreConf.getSvcAttendanceManager().changeSvcWindowSize(t,r),I.info("change vedio window size, ssrc: "+t+",size: "+(0,u.default)(r))}},t.setCurrentVideoWinForMode=function(){var e=(0,m.default)(h.default.mark(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:!0!==$getState().conf.isDataConfSharing&&(_=t,I.info("setCurrentVideoWinForMode methed called, mode: "+t+" lastMode: "+n),setTimeout(function(){var e=j(),a=D({width:16,height:9},e);a&&$dispatch(coreUi.changeBFCPWinStyle(a));var r={height:200,width:337};w.setVideoWHForMode(t,n,a,r)},100));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),L=t.toFullScreen=function(){var e=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("call toFullScreen "),!$getState().call.showCallToolBar||$getState().conf.showDataShareMode!==constant.SHOW_DATACONF_MODE.SHOW_DATACONF_NONE){e.next=4;break}return I.info(" toFullScreen showCallToolBar is true , showDataShareMode is 0"),e.abrupt("return");case 4:"extra"===$getState().call.screenState&&(I.info("<video> toFullScreen,resume screenState "+$getState().call.screenState),delegate.resumeShow(!1)),window.CLIENTCONFIG.ISMOBILE||window.isHubEnv||window.isPluginEnv||win.setFullScreen(!0),A("full"),$getState().conf.showDataShareMode===constant.SHOW_DATACONF_MODE.SHOW_DATACONF_NORMAL&&$dispatch(coreUi.showDataShareMode(constant.SHOW_DATACONF_MODE.SHOW_DATACONF_FULL));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),M=t.exitFullScreen=function(){var e=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("call exitFullScreen "),"extra"!==$getState().call.screenState){e.next=4;break}return I.info("<video> data conf end,no need todo restore,screenState now is "+$getState().call.screenState),e.abrupt("return");case 4:window.CLIENTCONFIG.ISMOBILE||window.isHubEnv||window.isPluginEnv||win.setFullScreen(!1),A("middle"),$getState().conf.showDataShareMode===constant.SHOW_DATACONF_MODE.SHOW_DATACONF_FULL&&$dispatch(coreUi.showDataShareMode(constant.SHOW_DATACONF_MODE.SHOW_DATACONF_NORMAL));case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),R=t.changeFullScreenReceiveShare=function(){var e=(0,m.default)(h.default.mark(function e(t){var n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("changInitiativeToFullScreenState , isInitiative = ",t),n=coreConf.isInDataScreenOrWbSharing()&&!window.isDataSharing,n&&$dispatch(coreUi.changeisFullScreenReceiveShare(t));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),A=t.changeScreenState=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if($dispatch(coreUi.changeFullScreenState(e)),!t||!$getState().conf.isSvcConf){if("extra"===e)return void I.info("<video>changeScreenState screenState = extra,no need to set videoWH");I.info("<video>changeScreenState screenState = "+e),"VIDEO_CONNECTED"!==$getState().call.callStatus&&"VIDEO_OUT"!==$getState().call.callStatus||window.CLIENTCONFIG.ISMOBILE||($getState().conf.isSvcConf&&(coreConf.refreshShareSize($getState().conf.svcBigPicInfo.ssrc),1===$getState().conf.svcViewMode&&coreConf.getSvcAttendanceManager().handleWinResize(1)),$getState().call.iSreceivingBFCP&&!0!==$getState().conf.isDataConfSharing?O(_):setTimeout(function(){var t=j(e),n=$getState().call.bigWinStyle;t=$getState().conf.isSvcConf?Math.abs(n.width)<Math.abs(n.height)?x(constant.VIDEO_SIZE_BITE.SIZE_9_B_16,t):x(constant.VIDEO_SIZE_BITE.SIZE_16_B_9,t):x({width:Math.abs($getState().call.bigWinStyle.width),height:Math.abs($getState().call.bigWinStyle.height)},t),$dispatch(coreUi.changeBigWinStyle(t)),"VIDEO_CONNECTED"!==$getState().call.callStatus||!$getState().call.isRemoteBig&&"min"!==e&&"extra"!==e?w.setVideoWH(!1,t):w.setVideoWH(!0,t),$getState().conf.isSvcConf&&coreConf.getSvcAttendanceManager().setSvcVideoRender($getState().conf.svcShowAttendances,"Size")},100))}},F=(t.changeBigContainerSize=function(){var e=(0,m.default)(h.default.mark(function e(){var t;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call,"min"!==t.screenState){e.next=3;break}return e.abrupt("return");case 3:$getState().call.iSreceivingBFCP&&!0!==$getState().conf.isDataConfSharing?O(_):setTimeout(function(){var e=j();e=x({width:$getState().call.bigWinStyle.width,height:$getState().call.bigWinStyle.height},e),$dispatch(coreUi.changeBigWinStyle(e)),"VIDEO_CONNECTED"===t.callStatus&&(t.isRemoteBig&&"extra"!==t.screenState||"extra"===t.screenState)?w.setVideoWH(!0,e):w.setVideoWH(!1,e)},100);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e){I.info("<video> recieve video wh,data.isRemote = "+e.videoWinMode+",width = "+e.width+",height = "+e.height);var t=$getState().call;if($getState().conf.isSvcConf)I.info("<video> getVideoWH,calc svc canvas size"),0===$getState().conf.svcViewMode&&"VIDEO_CONNECTED"===t.callStatus?e.ssrc===$getState().conf.ssrcRange.min?H(e):2===e.videoWinMode&&(I.info("getVideoWH,data.videoWinMode=",e),$dispatch(coreUi.changeBfcpFrameSize(e)),w.setSvcBFCPVideoRender(e)):1===$getState().conf.svcViewMode&&"VIDEO_CONNECTED"===t.callStatus?-1!==e.ssrc&&coreConf.getSvcAttendanceManager().handleDivideModeCanvasSize(e.ssrc,e.width,e.height):2===$getState().conf.svcViewMode&&"VIDEO_CONNECTED"===t.callStatus&&(1!==e.videoWinMode||$getState().conf.isOppsite||H(e));else{if($getState().call.iSreceivingBFCP&&!0!==$getState().conf.isDataConfSharing)return void V(e);(t.isRemoteBig&&"min"!==t.screenState&&"extra"!==t.screenState||"min"===t.screenState||"extra"===t.screenState)&&"VIDEO_CONNECTED"===t.callStatus?1===e.videoWinMode?H(e):0===e.videoWinMode&&z(e):1===e.videoWinMode?z(e):0===e.videoWinMode&&H(e)}}),V=function(e){I.info("updateWinSizeWhenRecBfcp enter");var t=!1;if(2===_&&0===e.videoWinMode?t=!0:1===_&&1===e.videoWinMode?t=!0:0===_&&2===e.videoWinMode&&(t=!0),t){var n=j(),a=D(e,n);a&&$dispatch(coreUi.changeBFCPWinStyle(a))}},D=function(e,t){var n={width:t.width,height:t.height};"min"!==$getState().call.screenState&&"extra"!==$getState().call.screenState&&(n.height=t.height-100);var a=x(e,n);return a.left=Math.floor((n.width-a.width)/2),a.top=Math.floor((n.height-a.height)/2),{width:a.width,height:a.height,left:a.left,top:a.top}};window.mobileOrientationChanged=function(e){if("number"!=typeof e)return void I.info("setCameraOrient param error!");if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||$getState().login.sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED){var t=($getState().call.isSvcConfShowQOS,$getState().conf),n=t.isSvcConf,a=t.svcHadPreSetCamera,r=t.hadPreSetCamera;t.confHandle;I.info("window.mobileOrientationChanged "+e),$dispatch(coreUi.recordMobileOrientChange(e)),window.CLIENTCONFIG.ISMOBILE&&(n&&!a&&$dispatch(coreUi.changeSvcHadPreSetCamera(!0)),n||r||$dispatch(coreUi.changeHadPreSetCamera(!0))),coreCommon.CameraControl.getInstance().setCameraOrient(e,!1)}};var U=function(){var e=(0,m.default)(h.default.mark(function e(t){var n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("<video> recieve refreshView,data.media_type = "+t.media_type+" data.view_event: "+t.view_event),2!==t.media_type&&1!==t.media_type){e.next=12;break}if(1!==t.view_event){e.next=11;break}if(!(n=$getState().conf.isSvcConf)||!window.CLIENTCONFIG.ISMOBILE){e.next=8;break}if(1!==t.media_type){e.next=8;break}return I.info("curr is svcConf, refreshLocalVideoView do nothings"),e.abrupt("return");case 8:window.updateVideoLocalView(),e.next=12;break;case 11:2===t.view_event&&window.removeVideoLocalView();case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=(0,m.default)(h.default.mark(function e(t){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("<video> recieve decodeSuccess"),window.CLIENTCONFIG.ISMOBILE?window.updateRemoteVideoView(t.call_id):$dispatch(coreUi.setIsDecodeSuc());case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=(0,m.default)(h.default.mark(function e(t,n){var a,r;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("<video> bfcp decode success : "+$getState().conf.isDataConfSharing+" inDataConf: "+coreConf.isInDataConf()),b=!0,!window.CLIENTCONFIG.ISMAC){e.next=9;break}if(!n){e.next=9;break}return e.next=6,coreConf.bfcpWinAttach(0);case 6:return a=e.sent,I.info("notify mac dataconf decode bfcp"),e.abrupt("return");case 9:r=function(){var e=(0,m.default)(h.default.mark(function e(){var a,r,o,i,c,l,s,u,d,f,p;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$getState().conf.isDataConfSharing,I.info("bfcp decode success inner function "+a),"VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=45;break}if($dispatch(coreUi.setBfcpReceiving(!0)),window.CLIENTCONFIG.ISMOBILE&&window.decodeBFCPSuccess(t),!a){e.next=9;break}return w.resetBFCStatus($getState().call.callId,0),I.info("bfcpDecodeSuccessHandler isDataConfSharing is true, resetBFCStatus to 0"),e.abrupt("return");case 9:if(r=$getState().conf,o=r.isSvcConf,i=r.isEnterDataConf,c=r.svcShowAttendances,l=r.svcViewMode,s=r.maxSizeForPage,u=r.svcOnLineAttendances,!window.CLIENTCONFIG.ISBIGWIN||!o){e.next=19;break}if(a){e.next=17;break}return l===constant.SVC_VIEW_MODE.DIVIDE_MODE&&(d=coreConf.getSvcAtdManager().getMaxSizeForPage(l),$dispatch(coreUi.changeMaxSizeForPage(d)),I.info("changeMaxSizeForPage DIVIDE_MODE size : ",d),c.length>d&&(I.info("current attenden size : "+c.length+" >  pageMaxSize :"+d),coreConf.getSvcAtdManager().destroyLastNativeWin(),coreConf.getSvcAtdManager().setPageNum(l,u.length))),e.next=15,coreConf.getSvcAtdManager().initBfcpFrame(t,n);case 15:I.info("isEnterDataConf = "+i),i?(I.info("notify to proxy bfcp is start"),coreConf.NotifyStartSharing(0,"")):(window.delayDispatchRecvBFCP=!0,I.info("can not dispatch join conf message,  should delay dispatch"));case 17:e.next=43;break;case 19:if(!o||!window.CLIENTCONFIG.ISWIN){e.next=23;break}a||coreConf.getSvcAtdManager().initBfcpFrame(t,n),e.next=43;break;case 23:if(o||!window.CLIENTCONFIG.ISWIN){e.next=27;break}a||coreConf.initBfcpWindow(t,n),e.next=43;break;case 27:if(!window.CLIENTCONFIG.ISMAC){e.next=42;break}if(!o){e.next=34;break}return I.info("svc conf bfcp decode success"),e.next=32,coreConf.getSvcAttendanceManager().receviceSvcShareOrBfcp(1,"");case 32:e.next=40;break;case 34:I.info("avc conf bfcp decode success"),f=j(),p=$getState().conf.bfcpFrameSize,isNullOrEmpty(p)?(I.info("avc bfcpFrameSize is null"),f=D({width:16,height:9},f)):(I.info("avc bfcpFrameSize is not null"),f=D({width:p.width,height:p.height},f)),$dispatch(coreUi.changeBFCPWinStyle(f)),w.setBFCPVideoRender(f);case 40:e.next=43;break;case 42:coreConf.getSvcAttendanceManager().setSvcVideoRender($getState().conf.svcShowAttendances);case 43:e.next=46;break;case 45:n&&!a&&window.CLIENTCONFIG.ISWIN&&($getState().conf.isSvcConf?coreConf.getSvcAtdManager().initBfcpFrame(t,n):coreConf.initBfcpWindow(t,n));case 46:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),coreConf.isInDataConf()?g=setTimeout(function(){r()},1500):r();case 11:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),P=function(){var e=(0,m.default)(h.default.mark(function e(t,n){var a,r,o,i,c,l,s,u,d,f;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("bfcp stop handler called"),clearTimeout(g),$dispatch(coreUi.setBfcpReceiving(!1)),a=$getState().conf,r=a.isSvcConf,o=a.svcShareData,window.CLIENTCONFIG.ISMOBILE?window.bfcpDataStopEvent(n.param.call_id):window.CLIENTCONFIG.ISBIGWIN?(i=$getState().conf.bfcpFrameHwnd,i>0&&(coreConf.NotifyStopSharing(0,""),I.info("NotifyStopSharing")),coreConf.getSvcAtdManager().closeBfcpFrame()):window.CLIENTCONFIG.ISWIN?(t&&coreConf.bfcpWinDetach(),r?(I.info("win-stop bfcp"),coreConf.getSvcAtdManager().closeBfcpFrame(),c=$getState().conf,l=c.svcViewMode,s=c.maxSizeForPage,u=c.isShowMinWin,d=coreConf.getSvcAtdManager().getMaxSizeForPage(l),l===constant.SVC_VIEW_MODE.DIVIDE_MODE&&s!==d&&(I.info("changeMaxSizeForPage :",d),$dispatch(coreUi.changeMaxSizeForPage(d)),u||(I.info("isShowMinWin is false RedrawVideoMain"),coreConf.getSvcAtdManager().RedrawVideoMain())),window.isDataSharing||(f=$getState().conf.isSvcConf,coreConf.getSvcAtdManager().switchVideoToMain())):(I.info("win-stop bfcp in avc"),coreConf.closeBfcpFrame(),window.isDataSharing||coreConf.switchVideoToMain())):r&&o.hasOwnProperty("ssrc")&&-3===o.ssrc&&coreConf.getSvcAttendanceManager().stopSvcShareOrBfcp();case 5:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=(0,m.default)(h.default.mark(function e(t){var n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b=!1,I.info("bfcp data comming handler"),window.CLIENTCONFIG.ISMOBILE?(window.bfcpDataBeginEvent(t.param.call_id),n=$getState().call.callId,t.param.call_id===n?(I.info("[bfcp] client isReceiving bfcp success!"),$dispatch(coreUi.changeReceiveBfcp(!0)),$dispatch(coreUi.changeShowBfcp(!1)),$dispatch(coreUi.toggleIsMobileAcceptShareSuccess(!0)),$dispatch(coreUi.createConfTipMsg([language.YOU_ISWATCHING_SHARE_BFCP]))):$dispatch(coreUi.changeReceiveBfcp(!1))):window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ISWIN?I.info("deal in bfcp decode success!"):I.info("mac receive bfcp info");case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("bfcp frame size = ",t.param),$dispatch(coreUi.changeBfcpFrameSize(t.param)),!$getState().conf.isDataConfSharing){e.next=4;break}return e.abrupt("return");case 4:b&&(I.info("bfcp have decode success -- bfcp frame size changed"),n=$getState().conf.isSvcConf,window.CLIENTCONFIG.ISMAC&&(n?w.setSvcBFCPVideoRender(t.param):(a=j(),a=D({width:t.param.width,height:t.param.height},a),$dispatch(coreUi.changeBFCPWinStyle(a)),w.setBFCPVideoRender(a))));case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o,i;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=j(),a=$getState().conf,r=a.isSvcConf,o=a.svcViewMode,r&&(n=coreConf.getSvcAttendanceManager().getBigCanvasSize()),i=T(t,n),i?($dispatch(coreUi.changeBigWinStyle(i)),I.info("change big win style:",i)):I.error("bigContainerSize: style = ",i);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),z=function(e){var t={width:constant.VIDEO_SMALL_SIZE.WIDTH,height:constant.VIDEO_SMALL_SIZE.HEIGHT};(t=T(e,t))&&$dispatch(coreUi.changeSmallWinStyle(t))},j=t.getBigContainerSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=e;"default"===t&&(t=$getState().call.screenState);var n=document.getElementsByClassName("main-frame-pc")[0],a=constant.VIDEO_SMALL_SIZE.WIDTH,r=constant.VIDEO_SMALL_SIZE.HEIGHT;switch(isNullOrEmpty(n)||(a=n.width||n.clientWidth||n[0],r=n.height||n.clientHeight||n[1]),t){case"full":case"extra":break;case"max":a-=50,r-=156;break;case"middle":a-=50,r-=49;break;case"min":a=constant.VIDEO_SMALL_SIZE.WIDTH,r=constant.VIDEO_SMALL_SIZE.HEIGHT}return{width:a,height:r}},J=t.handleLowVideoBWNotify=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("handleLowVideoBWNotify, msg type is "+t.msg_type),n=$getState().call.isOpenCamera,a=$getState().call.callId,r=$getState().call.cameraIsPassiveClosed,e.t0=t.msg_type,e.next=0===e.t0?7:1===e.t0?8:2===e.t0?13:3===e.t0?17:4===e.t0?18:19;break;case 7:return e.abrupt("break",20);case 8:return n?(coreCommon.CameraControl.getInstance().switchCameraStateAction(!1),I.info("handleLowVideoBWNotify, camera is open, should be forced to close, set isPassiveClosed true"),$dispatch(coreUi.changeCameraPassiveClosed(!0)),!window.CLIENTCONFIG.ISMOBILE&&o&&(window.CLIENTCONFIG.ISWIN?coreConf.getSvcAtdManager().alertBox("LOW_BW_AND_CLOSE_CAMERA",4):window.Toast(language.LOW_BW_AND_CLOSE_CAMERA,5,!1,"pcToast","")),window.CLIENTCONFIG.ISMOBILE&&o&&window.confirm(language.LOW_BW_AND_CLOSE_CAMERA)):I.info("handleLowVideoBWNotify, camera has been closed, no need to close again"),window.CLIENTCONFIG.ISWIN&&coreConf.getToolbarManager().setCameraState(-1),$dispatch(coreUi.changeCameraDisabed(!0)),$dispatch(coreUi.setIsLowVideoBWCloseCamera(!0)),e.abrupt("break",20);case 13:return n?I.info("handleLowVideoBWNotify, camera has been opened, no need to open again"):r?(coreCommon.CameraControl.getInstance().switchCameraStateAction(!0),!window.CLIENTCONFIG.ISMOBILE&&o&&(window.CLIENTCONFIG.ISWIN?coreConf.getSvcAtdManager().alertBox("LOW_BW_END_OPEN_CAMERA",4):window.Toast(language.LOW_BW_END_OPEN_CAMERA,5,!1,"pcToast","")),$dispatch(coreUi.changeCameraPassiveClosed(!1)),window.CLIENTCONFIG.ISMOBILE&&(n||$getState().call.isOpenPIP||$dispatch(coreUi.CloseOrOpenPIP(!0)),o&&window.JSToNativeToast(2e3,language.LOW_BW_END_OPEN_CAMERA)),I.info("handleLowVideoBWNotify, camera should be forced to open, set isPassiveClosed false")):I.info("handleLowVideoBWNotify, camera has been active closed, can not open"),$dispatch(coreUi.changeCameraDisabed(!1)),$dispatch(coreUi.setIsLowVideoBWCloseCamera(!1)),e.abrupt("break",20);case 17:case 18:case 19:return e.abrupt("break",20);case 20:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Y=(t.closeAllVideoSocket=function(){var e=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.closeLocalCanvasSocket();case 2:return e.next=4,w.closeRemoteCanvasSocket();case 4:return e.next=6,w.closeDataCanvasSocket();case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.checkIsSupportWebgl=function(){var e=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e,t){var n="";if(t&&!isNaN(t.length)&&t.length>0)for(var a=0;a<t.length;a++)n=n+";ssrc"+t[a].ssrc+",name:"+(t[a].conf_name.length>2?t[a].conf_name.substr(0,1)+"****"+t[a].conf_name.substr(-1):t[a].conf_name.substr(0,1)+"****");I.info(e,n)}),q=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o,i,c,s,d,f,p,C,m,v,w,g;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($dispatch(coreUi.changesvcWatchIndNotify(t.svc_conf_info)),n=$getState().conf,a=n.svcShowAttendances,r=n.svcShowAttendancesMobile,o=n.isSameGradeMcu,i=n.isBigConf,I.info("current devide PagerNo"+$getState().conf.svcShowPage),!i||1!==$getState().conf.svcShowPage){e.next=35;break}if(!(c=(0,l.default)([],a))||c.length!==t.conf_num){e.next=20;break}s=0;case 7:if(!(s<c.length)){e.next=20;break}d=0;case 9:if(!(d<t.svc_conf_info.length)){e.next=17;break}if(c[s].ssrc!==t.svc_conf_info[d].ssrc){e.next=14;break}return c[s].number=t.svc_conf_info[d].number,c[s].name=t.svc_conf_info[d].conf_name,e.abrupt("break",17);case 14:d++,e.next=9;break;case 17:s++,e.next=7;break;case 20:$dispatch(coreUi.changeSvcActiveAttendances(c)),f=$getState().conf.svcOnLineAttendances,p=sortPreAndOrigiArray(c,f),f=$getState().conf.svcOnLineAttendances,C=0;case 25:if(!(C<p.length)){e.next=34;break}if(m=p[C],1!==m.is_self){e.next=31;break}return p.splice(C,1),p.unshift(m),e.abrupt("break",34);case 31:C++,e.next=25;break;case 34:(0,u.default)(p)!==(0,u.default)(f)&&($dispatch(coreUi.changeSvcOnLineAttendances(p)),window.updateVideoView(p,!1));case 35:if(!(0===o&&t.conf_num>=1&&r.length>0&&r[0].ssrc===t.svc_conf_info[0].ssrc)){e.next=39;break}"M0T0"===t.svc_conf_info[0].number?(r[0].name=language.FAILURE_ERR_TUP,t.svc_conf_info[0].conf_name=language.FAILURE_ERR_TUP,$dispatch(coreUi.changeSvcShowAttendances(r)),window.svcWatchIndNotify(t)):(I.info("grade_mcu:serialNumber",t.svc_conf_info[0].number),$dispatch(coreUi.changeMobileSerialNumber(t.svc_conf_info[0].number)),t.is_same_grade_mcu=0,window.svcWatchIndNotify(t)),e.next=67;break;case 39:if(1!==t.conf_num){e.next=45;break}if(a.length>0)for(v=0;v<a.length;v++)a[v].ssrc===t.svc_conf_info[0].ssrc&&("M0T0"===t.svc_conf_info[0].number?(a[v].name=language.FAILURE_ERR_TUP,t.svc_conf_info[v].conf_name=language.FAILURE_ERR_TUP,$dispatch(coreUi.changeSvcShowAttendances(a))):t.svc_conf_info[0].number=isNullOrEmpty(a[v].number)?t.svc_conf_info[0].number:a[v].number);t.is_same_grade_mcu=1,window.svcWatchIndNotify(t),e.next=67;break;case 45:if(!(t.conf_num>1)){e.next=67;break}if(a.length!==t.conf_num){e.next=65;break}w=0;case 48:if(!(w<a.length)){e.next=65;break}g=0;case 50:if(!(g<t.svc_conf_info.length)){e.next=62;break}if(a[w].ssrc!==t.svc_conf_info[g].ssrc){e.next=59;break}if("M0T0"!==t.svc_conf_info[g].number){e.next=57;break}return a[w].name=language.FAILURE_ERR_TUP,t.svc_conf_info[w].conf_name=language.FAILURE_ERR_TUP,$dispatch(coreUi.changeSvcShowAttendances(a)),e.abrupt("continue",59);case 57:return t.svc_conf_info[g].number=a[w].number,e.abrupt("break",62);case 59:g++,e.next=50;break;case 62:w++,e.next=48;break;case 65:t.is_same_grade_mcu=1,window.svcWatchIndNotify(t);case 67:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf.svcShowAttendances,coreConf.getDecoderManager().createDivideDecoderList(n),n.length>=1){for(a=(0,l.default)([],n),r=!1,o=0;o<a.length;o++)t.svc_conf_info[0].ssrc===a[o].ssrc&&(t.svc_conf_info[0].conf_name&&t.svc_conf_info[0].conf_name!==a[o].name&&(a[o].name=t.svc_conf_info[0].conf_name,r=!0),t.svc_conf_info[0].number&&t.svc_conf_info[0].number!==a[o].number&&(a[o].number=t.svc_conf_info[0].number,S.test(t.svc_conf_info[0].number)&&(a[o].name=language.MULTI_VIEW_BROADCAST_NAME,r=!0)));r&&(I.info("handleBigWinDefaultSVCWatchInd,nameIsUpdate only one!"),$dispatch(coreUi.changeSvcShowAttendances(a)),coreConf.getSvcAtdManager().setWindowName(a))}case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o,i,c,l;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf,a=n.svcShowAttendances,r=n.svcControlMode,o=n.isSvcShareMode,i=n.svcBigPicInfo,c=n.svcViewMode,!((0===c||2===c)&&o&&i.hasOwnProperty("ssrc")&&i.ssrc<0)){e.next=3;break}return e.abrupt("return");case 3:if(2!==c||o||1!==r){e.next=5;break}return e.abrupt("return");case 5:return isNullOrEmpty(t.svc_conf_info[0].conf_name)||(l={name:t.svc_conf_info[0].conf_name,ssrc:t.svc_conf_info[0].ssrc,number:t.svc_conf_info[0].number},I.info("handleMacDefaultSVCWatchInd, the default terminal name:"+handlePhoneNumber(l.name)+", terminal number:"+handlePhoneNumber(l.number)+", terminal ssrc:"+l.ssrc),$dispatch(coreUi.changeSvcBigPicInfo(l))),e.next=8,coreConf.getSvcAttendanceManager().setSvcVideoRender(a,"NoChange");case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState().conf,a=n.svcShowAttendances,r=n.svcOnLineAttendances,isNullOrEmpty(t.svc_conf_info[0].conf_name)||(o={name:t.svc_conf_info[0].conf_name,ssrc:t.svc_conf_info[0].ssrc,number:t.svc_conf_info[0].number},I.info("handleWinDefaultSVCWatchInd, the default terminal name:"+handlePhoneNumber(o.name)+", terminal number:"+handlePhoneNumber(o.number)+", terminal ssrc:"+o.ssrc),$dispatch(coreUi.changeSvcBigPicInfo(o))),r.length>=1&&coreConf.getSvcAtdManager().setWindowName(a);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=(0,m.default)(h.default.mark(function e(t){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISBIGWIN){e.next=5;break}return e.next=3,K(t);case 3:e.next=12;break;case 5:if(!window.CLIENTCONFIG.ISWIN){e.next=10;break}return e.next=8,Z(t);case 8:e.next=12;break;case 10:return e.next=12,Q(t);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o,i,c,s,d,f,p,C,m,v,w,g,_;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf,a=n.svcBigPicInfo,r=n.svcWndHandles,o=n.isSvcWatchSuc,i=n.svcViewMode,c=n.bfcpFrameHwnd,s=n.bfcpIsBigHwnd,d=n.dataIsBigHwnd,f=$getState().call.iSreceivingBFCP,!window.CLIENTCONFIG.ISMAC&&!window.CLIENTCONFIG.ISWIN){e.next=24;break}if(0!==i&&2!==i){e.next=24;break}if(!(!0===f&&c>0&&s)){e.next=7;break}return I.info("recv bfcp and bfcp is big pic, no need update big pic info"),e.abrupt("return");case 7:if(!0!==window.isDataSharing||!0!==d){e.next=10;break}return I.info("recv data and data is big pic, no need update big pic info"),e.abrupt("return");case 10:if(a.name=t.svc_conf_info[0].conf_name,!(1===a.is_self||a.ssrc>0)){e.next=24;break}if(p={name:t.svc_conf_info[0].conf_name,ssrc:t.svc_conf_info[0].ssrc,number:t.svc_conf_info[0].number},I.info("handleDesktopSVCWatchInd,the big picture terminal name: "+handlePhoneNumber(p.name)+" terminal number: "+handlePhoneNumber(p.number)+" terminal ssrc: "+p.ssrc),!1===o&&($dispatch(coreUi.svcWatchSuccess(!0)),I.info("before isSvcWatchSuc false,clear data,now isSvcWatchSuc is ",o)),"M0T0"===t.svc_conf_info[0].number&&(window.CLIENTCONFIG.ISWIN?(p.name=language.NATIVE_FAILURE_ERR_TUP,p.number="",$dispatch(coreUi.changeSvcBigPicInfo(p)),C=$getState().conf,m=C.videoFrameHwnd,v=C.isSvcWatchSuc,$dispatch(coreUi.svcWatchSuccess(!1)),w=r[0].hwnd,g=(0,l.default)({},{svc_watch_success:v,wnd_handle:w}),coreConf.getNativeInterface().setParam(g,m),I.info("send param to PC_native",g)):(p.name=language.FAILURE_ERR_TUP,p.number="",$dispatch(coreUi.changeSvcBigPicInfo(p)),$dispatch(coreUi.svcWatchSuccess(!1)))),_=$getState().conf.svcBigPicInfo,(0,u.default)(_)===(0,u.default)(p)){e.next=23;break}if("M0T0"!==t.svc_conf_info[0].number&&$dispatch(coreUi.changeSvcBigPicInfo(p)),!window.CLIENTCONFIG.ISWIN){e.next=21;break}return e.abrupt("return",!0);case 21:e.next=24;break;case 23:I.info("handleSvcWatchIndNotify,BigPictureInfo is same with svcBigPicInfo ");case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r,o,i,c,s,u,d,f,p,C,m,v,w,g,_,b,N;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf,a=n.svcShowAttendances,r=n.svcOnLineAttendances,o=n.isBigConf,i=n.svcShowPage,c=n.svcViewMode,1!==t.conf_num){e.next=6;break}return e.next=4,X(t);case 4:e.next=49;break;case 6:for(s=new Array,u=0;u<a.length;u++)d=a[u],s[u]=(0,l.default)({},d);return e.next=10,ee(t);case 10:if(f=e.sent,I.info("handleSvcWatchIndNotify,newSvcShowAttendances.length is ",s.length),!(s.length>0&&t.conf_num>0)){e.next=48;break}p=0;case 14:if(!(p<t.conf_num)){e.next=44;break}C=0;case 16:if(!(C<s.length)){e.next=41;break}if(t.svc_conf_info[p].ssrc!==s[C].ssrc){e.next=38;break}if("M0T0"!==t.svc_conf_info[p].number){e.next=36;break}if(!window.CLIENTCONFIG.ISWIN&&!window.CLIENTCONFIG.ISBIGWIN){e.next=31;break}return s[C].name=language.NATIVE_FAILURE_ERR_TUP,window.CLIENTCONFIG.ISBIGWIN&&(s[C].name="",s[C].number=""),f=!0,m=$getState().conf,v=m.videoFrameHwnd,w=m.isSvcWatchSuc,$dispatch(coreUi.svcWatchSuccess(!1)),g=s[C].wnd_handle,_=(0,l.default)({},{svc_watch_success:w,wnd_handle:g}),coreConf.getNativeInterface().setParam(_,v),e.abrupt("continue",38);case 31:return s[C].name=language.FAILURE_ERR_TUP,s[C].number=t.svc_conf_info[p].number,e.next=35,coreConf.getSvcAttendanceManager().setSvcVideoRender(a,"NoChange");case 35:return e.abrupt("continue",38);case 36:t.svc_conf_info[p].conf_name&&t.svc_conf_info[p].conf_name!==s[C].name&&(I.info("handleSvcWatchIndNotify,nameIsUpdate,ssrc is "+t.svc_conf_info[p].ssrc+",old name is "+(s[C].name.length>=2?s[C].name.substr(0,1)+"****"+s[C].name.substr(-1):s[C].name)+",new name is "+(t.svc_conf_info[p].conf_name.length>=2?t.svc_conf_info[p].conf_name.substr(0,1)+"****"+t.svc_conf_info[p].conf_name.substr(-1):t.svc_conf_info[p].conf_name)),s[C].name=t.svc_conf_info[p].conf_name,f=!0),t.svc_conf_info[p].number&&t.svc_conf_info[p].number!==s[C].number&&(I.info("handleSvcWatchIndNotify,numberIsUpdate,ssrc is "+t.svc_conf_info[p].ssrc+",old number is "+s[C].number+",new number is "+t.svc_conf_info[p].number),"M0T0"!==t.svc_conf_info[p].number&&(s[C].number=t.svc_conf_info[p].number),S.test(t.svc_conf_info[p].number)&&(s[C].name=language.MULTI_VIEW_BROADCAST_NAME,f=!0));case 38:C++,e.next=16;break;case 41:p++,e.next=14;break;case 44:f&&(I.info("handleSvcWatchIndNotify,nameIsUpdate,dispatch  newSvcShowAttendances"),$dispatch(coreUi.changeSvcShowAttendances(s)),(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ISWIN)&&coreConf.getSvcAtdManager().setWindowName(s)),!o||0!==i||c!==constant.SVC_VIEW_MODE.BIG_SMALL_MODE&&c!==constant.SVC_VIEW_MODE.DIVIDE_MODE&&c!==constant.SVC_VIEW_MODE.MIN_WIN_VERTICAL&&0!==c&&1!==c||($dispatch(coreUi.changeSvcActiveAttendances(s)),b=$getState().conf.svcActiveAttendances,f&&(N=sortPreAndOrigiArray(b,r),$dispatch(coreUi.changeSvcOnLineAttendances(N)))),e.next=49;break;case 48:I.info("handleSvcWatchIndNotify,newSvcShowAttendances.length <= 0 || param.conf_num <= 0 ");case 49:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ne=t.handleSvcWatchIndNotify=function(){var e=(0,m.default)(h.default.mark(function e(t){var n,a,r;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("handleSvcWatchIndNotify,attendee count is ",t.conf_num),Y("会场指示源处理 ",t.svc_conf_info),n=[0],t.conf_num>0){n.push(t.conf_num);for(a in t.svc_conf_info)(r=t.svc_conf_info[a].number)&&n.push(handlePhoneNumber(r))}if(coreUt.utConfOperate({eventId:constant.EVENT_ID.UT_CONF_WATCH_SVC,params:n}),!(t.conf_num<=0)){e.next=8;break}return I.error("param.conf_num <= 0, return"),e.abrupt("return");case 8:if(!window.CLIENTCONFIG.ISMOBILE){e.next=13;break}return e.next=11,q(t);case 11:e.next=15;break;case 13:return e.next=15,te(t);case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();t.createVideoPreCheck=function(){var e=(0,m.default)(h.default.mark(function e(){var t,n,a;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE&&!window.isPluginEnv){e.next=2;break}return e.abrupt("return",!0);case 2:if(window.netWorkType!==constant.NETWORK_TYPE.TYPE_2G){e.next=5;break}return e.next=5,window.getCurrentNetWorkType();case 5:if((t=window.netWorkType)!==constant.NETWORK_TYPE.TYPE_3G&&t!==constant.NETWORK_TYPE.TYPE_4G){e.next=24;break}if(!$getState().conf.isShowMobileNetTip){e.next=21;break}if(n=language.CALL_VIDEO_TO_START_WHEN_4G,"function"!=typeof window.isJudgeDialogExist||!window.isJudgeDialogExist(n)){e.next=12;break}return I.error("dialog is exist return "),e.abrupt("return",!1);case 12:return $dispatch(coreUi.changeEnableAnonymousJoinConf(!1)),e.next=15,window.confirm(n);case 15:return a=e.sent,a.ret?$dispatch(coreUi.toggleMobileNetTip(!1)):$dispatch(coreUi.changeCallStatus("")),$dispatch(coreUi.changeEnableAnonymousJoinConf(!0)),e.abrupt("return",a.ret);case 21:return e.abrupt("return",!0);case 22:e.next=25;break;case 24:return e.abrupt("return",!0);case 25:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.requestPermissionFinish=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.requestPermissionState=1;case 1:case"end":return e.stop()}},e,void 0)}));var ae=function(){var e=(0,m.default)(h.default.mark(function e(t){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new i.default(function(e,n){setTimeout(function(){e()},t)}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();t.callPermissionCheck=function(){var e=(0,m.default)(h.default.mark(function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return",!0);case 2:return I.info("mobile callPermissionCheck"),e.next=5,window.isHavePermission(t?"AUDIO_AND_CAMERA_PERMISSION":"AUDIO_PERMISSION");case 5:if(window.isHavePerm){e.next=24;break}if(window.requestPermissionState=0,window.requestPermissions(t?"AUDIO_AND_CAMERA_PERMISSION":"AUDIO_PERMISSION"),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=17;break}if(window.requestPermissionPromise=new PromiseObject,!window.webView){e.next=14;break}return e.abrupt("return",window.requestPermissionPromise);case 14:return e.abrupt("return",!1);case 15:e.next=24;break;case 17:if("android"!==window.CLIENTCONFIG.PLATFORM||!n){e.next=24;break}case 18:if(0!==window.requestPermissionState){e.next=24;break}return I.info("[requestPermissions] sleep"),e.next=22,ae(2e3);case 22:e.next=18;break;case 24:if(window.CLIENTCONFIG.ENABLE_IT_MEETING||"android"!==window.CLIENTCONFIG.PLATFORM||!n){e.next=27;break}return e.next=27,window.isHavePermission(t?"AUDIO_AND_CAMERA_PERMISSION":"AUDIO_PERMISSION");case 27:return e.abrupt("return",window.isHavePerm);case 28:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.resumeCamera=(0,m.default)(h.default.mark(function e(){var t,n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=coreCommon.TaskQueue.getInstance("closeOrResumeCameta"),n=coreCommon.TaskOptions.defaultOptions(),t.addTask((0,m.default)(h.default.mark(function e(){var t,n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("enter resume camera. "),"VIDEO_CONNECTED"!==(t=$getState().call.callStatus)){e.next=10;break}if(n=$getState().call.isOpenCamera){e.next=7;break}return I.warn("resumeCamera the camera is not open. return "),e.abrupt("return");case 7:return e.next=9,coreCommon.CameraControl.getInstance().switchCameraStateAction(!0);case 9:"mConfMemberPage"===window.getRoute()&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.changeScreenOrientation(constant.SCREEN_ORIENTATION.SCREEN_ORIENTATION_PORTRAIT);case 10:case"end":return e.stop()}},e,void 0)})),n,null);case 3:case"end":return e.stop()}},e,void 0)})),window.mobileGotoBackground=(0,m.default)(h.default.mark(function e(){var t,n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=coreCommon.TaskQueue.getInstance("closeOrResumeCameta"),n=coreCommon.TaskOptions.defaultOptions(),t.addTask((0,m.default)(h.default.mark(function e(){var t,n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("enter mobileGotoBackground. "),"VIDEO_CONNECTED"!==(t=$getState().call.callStatus)){e.next=10;break}if(n=$getState().call.isOpenCamera){e.next=7;break}return I.warn("mobileGotoBackground the camera is not open. return "),e.abrupt("return");case 7:if(window.isPluginEnv){e.next=10;break}return e.next=10,coreCommon.CameraControl.getInstance().setDefaultCapture();case 10:case"end":return e.stop()}},e,void 0)})),n,null);case 3:case"end":return e.stop()}},e,void 0)})),window.setFloatWinDefaultCapture=(0,m.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("enter setFloatWinDefaultCapture."),e.next=3,coreCommon.CameraControl.getInstance().setDefaultCapture();case 3:case"end":return e.stop()}},e,void 0)}))},912:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.filterCallRecordList=t.setActiveKeyValue=t.saveCallItemInfo=t.saveCallRecordItem=t.setIsCallRecordDetailMenuBack=t.getMoreAccountCallRecordList=t.getAccountCallRecordList=t.getMoreCallRecordList=t.getInitCallRecordList=void 0;var r=n(142),o=a(r),i=n(1),c=a(i),l=n(2),s=a(l),u=coreLogger.getLogger("logic")("callRecord"),d=(t.getInitCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=3;break}return u.info("[IT-Meeting] no need to init callrecord"),e.abrupt("return");case 3:return e.prev=3,u.info("首次加载通话记录"),e.next=7,coreDb.queryAllCallRecord({starttime:9999999999999,limitcount:window.CLIENTCONFIG.ISMOBILE?+window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE});case 7:if(t=e.sent,isNullOrEmpty(t)){e.next=14;break}return $dispatch(coreUi.getCallRecordList(t)),e.next=12,d(t);case 12:n=e.sent,$dispatch(coreUi.getCallRecordListInfo(n));case 14:isNullOrEmpty(t)?$dispatch(coreUi.hasMoreCallRecord(!1)):($dispatch(coreUi.hasMoreCallRecord(!0)),a=t[t.length-1].starttime,$dispatch(coreUi.setNextStartTimeStamp(a))),u.info("通话记录",(t.length||0)+"条"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),u.error("callRecordList 通话记录",{e:e.t0.toJSON()});case 21:case"end":return e.stop()}},e,void 0,[[3,18]])}));return function(){return e.apply(this,arguments)}}(),t.getMoreCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,i,l,s,f,p,h,C;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=$getState(),n=t.callRecord.nextStartTime,a=t.callRecord,r=a.callRecordList,i=a.callItemInfoList,l=r||[],s=i||[],f=window.CLIENTCONFIG.ISMOBILE?window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE,!isNullOrEmpty(r)&&0!==r.length){e.next=8;break}return e.abrupt("return");case 8:return p=void 0,e.next=11,coreDb.queryCallRecordList({starttime:n,limitcount:f});case 11:if(p=e.sent,isNullOrEmpty(p)||0===p.length){e.next=26;break}return $dispatch(coreUi.hasMoreCallRecord(!0)),l=r.concat(p),$dispatch(coreUi.getCallRecordList([].concat((0,o.default)(l)))),e.next=18,d(l);case 18:h=e.sent,s=i.concat(h),$dispatch(coreUi.getCallRecordListInfo(s)),C=p[p.length-1].starttime,$dispatch(coreUi.setNextStartTimeStamp(C)),u.info("更多通话记录",(s.length||0)+"条"),e.next=28;break;case 26:return $dispatch(coreUi.hasMoreCallRecord(!1)),e.abrupt("return");case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(0),u.error("callRecordList 更多通话记录",{e:e.t0.toJSON()});case 33:case"end":return e.stop()}},e,void 0,[[0,30]])}));return function(){return e.apply(this,arguments)}}(),t.getAccountCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreDb.queryCallRecordList({peeraccount:t,starttime:9999999999999,limitcount:window.CLIENTCONFIG.ISMOBILE?window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE});case 3:n=e.sent,$dispatch(coreUi.getAccountCallRecordList(n)),u.info("通话记录"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),u.error("callRecordList 通话记录",{e:e.t0.toJSON()});case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),t.getMoreAccountCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=$getState(),a=n.call.accountCallRecordList,r=a||[],!a){e.next=9;break}return e.next=7,coreDb.queryCallRecordList({peeraccount:t,starttime:9999999,limitcount:window.CLIENTCONFIG.ISMOBILE?window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE});case 7:o=e.sent,r=a.concat(o);case 9:$dispatch(coreUi.getAccountCallRecordList(r)),u.info("更多通话记录"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),u.error("callRecordList 更多通话记录",{e:e.t0.toJSON()});case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t){return e.apply(this,arguments)}}(),t.setIsCallRecordDetailMenuBack=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];$dispatch(coreUi.setIsCallRecordDetailMenuBack(e))},t.saveCallRecordItem=function(e){$dispatch(coreUi.saveCallRecordItem(e))},t.saveCallItemInfo=function(e){$dispatch(coreUi.saveCallItemInfo(e))},t.setActiveKeyValue=function(e){$dispatch(coreUi.setActiveKeyValue(e))},t.filterCallRecordList=function(e,t){var n=$getState().call.voiceMailNum;return e.map(function(e,a){return isNullOrEmpty(e)?t[a]===n?coreContact.getTempCallUserInfo(t[a],language.VOICE_MAIL_BOX,!0):coreContact.getTempCallUserInfo(t[a]):e})},function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0;case 2:if(!(a<t.length)){e.next=11;break}return r=t[a],e.next=6,f(r);case 6:o=e.sent,n.push(o);case 8:a++,e.next=2;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),f=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.voiceMailNum,a={},t.peeraccount!==n){e.next=6;break}a=coreContact.getTempCallUserInfo(t.peeraccount,language.VOICE_MAIL_BOX,!0),e.next=16;break;case 6:if(!t.contact_id){e.next=12;break}return e.next=9,coreDb.queryContactByContactId({contact_id:t.contact_id});case 9:a=e.sent,e.next=16;break;case 12:return e.next=14,coreContact.getContactByAccount(t.peeraccount);case 14:a=e.sent,isNullOrEmpty(a)&&(a=coreContact.getTempCallUserInfo(t.peeraccount));case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()}});