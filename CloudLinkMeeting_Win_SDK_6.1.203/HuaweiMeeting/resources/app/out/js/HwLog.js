webpackJsonp([33],{135:function(e,t,r){e.exports=r(0)(562)},1680:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwLogSdk=void 0;var a=r(135),i=n(a),o=r(4),u=n(o),c=r(1681);t.HwLogSdk=function e(){(0,u.default)(this,e),this.getLogApi=c.getLogApi,(0,i.default)(this,(0,c.getLogApi)().getApiList())}},1681:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.LogImpl=t.getLogApi=void 0;var i=r(1),o=a(i),u=r(2),c=a(u),s=r(131),f=a(s),l=r(4),d=a(l),p=r(132),g=a(p),v=r(133),h=a(v),x=r(723),w=n(x),k=r(890),_=n(k),b=r(1683),L=(coreLogger.getLogger("log")("LogImpl"),void 0),F=(t.getLogApi=function(){return isNullOrEmpty(L)&&(L=new F),L},t.LogImpl=function(e){function t(){var e=this;(0,d.default)(this,t);var r=(0,g.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return r.collectLogs=function(){var t=(0,c.default)(o.default.mark(function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.isOpen;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w.collectLogs(n));case 1:case"end":return e.stop()}},t,e)}));return function(){return t.apply(this,arguments)}}(),r.zipFeedbackFile=function(){var t=(0,c.default)(o.default.mark(function t(r){var n=r.value,a=r.isUploadLog,i=r.imgList,u=r.isLogin;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.zipFeedbackFile)(n,a,i,u));case 1:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),r.quickZipFeedbackFile=function(){var t=(0,c.default)(o.default.mark(function t(r){var n=r.value,a=r.keyWords,i=r.crashList,u=r.isLogin;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.quickZipFeedbackFile)(n,a,i,u));case 1:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),r.collectLogsAndOpen=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w.collectLogsAndOpen());case 1:case"end":return e.stop()}},t,e)})),r.collectLogCuts=function(){var t=(0,c.default)(o.default.mark(function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.logName;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w.collectLogCuts(n));case 1:case"end":return e.stop()}},t,e)}));return function(){return t.apply(this,arguments)}}(),r.cleanHistorySetUpLog=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.cleanHistorySetUpLog());case 1:case"end":return e.stop()}},t,e)})),r.deleteCrashLog=(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w.deleteCrashLog());case 1:case"end":return e.stop()}},t,e)})),r}return(0,h.default)(t,e),t}(coreLazyLoad.LogApi))},1682:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getCrashLogMac=void 0;var a=r(3),i=n(a),o=r(1),u=n(o),c=r(2),s=n(c),f=r(725),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),d=coreLogger.getLogger("log")("crashClean"),p=function(){var e=(0,s.default)(u.default.mark(function e(t,r){var n,a,i,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.readDir(t);case 2:if(!1!==(n=e.sent)){e.next=6;break}return d.info("copyCrashFolderMac readdir failed"),e.abrupt("return");case 6:a=0;case 7:if(!(a<n.length)){e.next=16;break}if(i=n[a],!i.startsWith("CloudLink")&&!i.startsWith("WeLinkSdk")){e.next=13;break}return o=window.path.join(t,i),e.next=13,appService.copyFile(o,r);case 13:a++,e.next=7;break;case 16:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}();t.getCrashLogMac=function(){var e=(0,s.default)(u.default.mark(function e(){var t,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 2:d.info("getCrashLogMac start"),t=window.process.env.HOME,r=window.path.join(window.LOG_PATH,"fr_exception"),e.prev=5,window.fs.existsSync(r)&&(appService.deleteFileDir(r),d.info("getCrashLogMac delete old dir")),e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(5),d.error("getCrashLogMac err=",e.t0),e.abrupt("return");case 13:return e.abrupt("return",new i.default(function(e,n){var a=this;appService.makeDir(r).then((0,s.default)(u.default.mark(function n(){var i;return u.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=window.path.join(t,"Library/Logs/DiagnosticReports"),n.prev=1,!window.fs.existsSync(i)){n.next=7;break}return n.next=5,p(i,r);case 5:n.next=8;break;case 7:d.info("getCrashLogMac system crash dir not exist");case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),d.error("getCrashLogMac err=",n.t0);case 13:e();case 14:case"end":return n.stop()}},n,a,[[1,10]])})),function(){d.info("getCrashLogMac make dir failed"),n()})}));case 14:case"end":return e.stop()}},e,void 0,[[5,9]])}));return function(){return e.apply(this,arguments)}}()},1683:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="",r=e.length,n=Math.round(r/4),a=r-n;if(!e)return"";if(r<=2)return e[0]+"x";for(var i=0;i<a-n;i++)t+="x";return e.substring(0,n)+t+e.substring(a,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.quickZipFeedbackFile=t.zipFeedbackFile=void 0;var i=r(1),o=n(i),u=r(3),c=n(u),s=r(2),f=n(s),l=r(889),d=r(723),p=r(724),g=coreLogger.getLogger("log")("feedback");t.zipFeedbackFile=function(){var e=(0,f.default)(o.default.mark(function e(t,r,n){var i;!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("zipFeedbackFile start"),i=new c.default(function(){var e=(0,f.default)(o.default.mark(function e(i,u){var s,v,h,x;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],!t&&0===n.length){e.next=12;break}return e.prev=2,e.next=5,appService.makeDir(window.FEEDBACK_PATH);case 5:t&&(t=t.replaceAll("\n","\r\n"),g.info("zipFeedbackFile write content"),v=appService.writeFile(window.FEEDBACK_PATH,"feedback.txt",t),s.push(v)),0!==n.length&&n.map(function(e){g.info("zipFeedbackFile copy img path=",e);var t=appService.copyFile(e,window.FEEDBACK_PATH);s.push(t)}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),g.error("zipFeedbackFile makeDir error=",e.t0);case 12:if(h=[],!r){e.next=18;break}return g.info("zipFeedbackFile add log"),e.next=17,(0,d.getLogListBeforeZip)();case 17:h=e.sent;case 18:x=function(){var e=(0,f.default)(o.default.mark(function e(t){var r,n,c,s,f,d,v,h,x;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<=0)){e.next=5;break}g.info("zipFeedbackFile failed, list is null"),u(),e.next=17;break;case 5:return r=window.getZipLogPath(),e.next=8,coreAccount.getLoginModel();case 8:n=e.sent,c=n.show_account,s=n.tempSipNick,f=n.displayAccount,d=(new Date).format("yyyy_MM_dd_hh_mm_ss"),v=p.LOG_FEEDBACK_ZIP_FILE_NAME,-1===c.indexOf("Anonymous")||isNullOrEmpty(s)||(c="Anonymous_"+a(s)),h=c||a(f)||"Anonymous",v=h+"_"+d+".zip",x=r+"/"+v,(0,l.dealZip)(t,x).then(function(e){appService.deleteFileDir(window.FEEDBACK_PATH),g.info("zipFeedbackFile zip success"),i(e)},function(){appService.deleteFileDir(window.FEEDBACK_PATH),g.info("zipFeedbackFile failed"),u()});case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),s.length>0?(g.info("zipFeedbackFile start promiseArr"),c.default.all(s).then(function(){h.push(window.FEEDBACK_PATH),x(h)},function(){x(h)})):x(h);case 20:case"end":return e.stop()}},e,void 0,[[2,9]])}));return function(t,r){return e.apply(this,arguments)}}()),e.abrupt("return",i);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),t.quickZipFeedbackFile=function(){var e=(0,f.default)(o.default.mark(function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];arguments[3];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("quickZipFeedbackFile start ,value is:",t,"[key] words is:",desensitive(r)),e.abrupt("return",new c.default(function(){var e=(0,f.default)(o.default.mark(function e(i,u){var s,v,h,x,w,k,_;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],e.prev=1,e.next=4,appService.makeDir(window.FEEDBACK_PATH);case 4:return t&&(t="content:"+t+" keywords:"+r,g.info("quickZipFeedbackFile write content"),v=appService.writeFile(window.FEEDBACK_PATH,"feedback.txt",t),s.push(v)),h=n,g.info("quickZipFeedbackFile add log"),x=(new Date).format("yyyyMMdd_hhmmss"),w="logMini_win_"+x+"_"+r+".zip",e.prev=9,e.next=12,(0,d.collectLogCuts)(w);case 12:k=e.sent,k&&h.push(k),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),g.error("quickZipFeedbackFile collectLogCuts error");case 19:if(_=function(){var e=(0,f.default)(o.default.mark(function e(t){var n,c,s,f,d,v,h,x,w;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<=0)){e.next=5;break}g.info("quickZipFeedbackFile failed, list is null"),u("startZipFile length error"),e.next=18;break;case 5:return n=window.getZipLogPath(),e.next=8,coreAccount.getLoginModel();case 8:return c=e.sent,s=c.show_account,f=c.tempSipNick,d=c.displayAccount,v=(new Date).format("yyyy_MM_dd_hh_mm_ss"),h=p.LOG_FEEDBACK_ZIP_FILE_NAME,-1===s.indexOf("Anonymous")||isNullOrEmpty(f)||(s="Anonymous_"+a(f)),x=s||a(d)||"Anonymous",h=x+"_"+r+"_"+v+".zip",w=n+"/"+h,e.next=18,(0,l.dealZip)(t,w).then(function(e){appService.deleteFileDir(window.FEEDBACK_PATH),g.info("quickZipFeedbackFile zip success"),i(e)},function(){appService.deleteFileDir(window.FEEDBACK_PATH),g.info("quickZipFeedbackFile failed"),u("startZipFile zip error")});case 18:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),!(s.length>0)){e.next=37;break}return g.info("quickZipFeedbackFile start promiseArr"),e.prev=22,e.next=25,c.default.all(s);case 25:return h.push(window.FEEDBACK_PATH),e.next=28,_(h);case 28:e.next=35;break;case 30:return e.prev=30,e.t1=e.catch(22),e.next=34,_(h);case 34:g.error("quickZipFeedbackFile promiseArr error=",e.t1);case 35:e.next=39;break;case 37:return e.next=39,_(h);case 39:e.next=45;break;case 41:e.prev=41,e.t2=e.catch(1),g.error("quickZipFeedbackFile error=",e.t2),u(e.t2);case 45:case"end":return e.stop()}},e,void 0,[[1,41],[9,16],[22,30]])}));return function(t,r){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()},69:function(e,t,r){e.exports={default:r(70),__esModule:!0}},70:function(e,t,r){var n=r(8),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},723:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCrashLog=t.collectLogCuts=t.getLogCutsListBeforeZip=t.collectLogsAndOpen=t.collectLogs=t.getLogListBeforeZip=t.getCrashLogPath=t.getAllFilesPathAndMTimeInDir=void 0;var a=r(1),i=n(a),o=r(3),u=n(o),c=r(2),s=n(c),f=r(724),l=r(1682),d=r(889),p=r(890),g=r(725),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(g),h=coreLogger.getLogger("log")("collect"),x=function(){var e=(0,s.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new u.default(function(e,r){t.file(function(t){e(t.lastModifiedDate)},function(t){h.info("getMobileFileStats, fail=",t),e()})}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),w=t.getAllFilesPathAndMTimeInDir=function(){var e=(0,s.default)(i.default.mark(function e(t,r){var n,a,o,u,c,s,f,l,d,p,g,k,_;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.CLIENTCONFIG.ISMOBILE){e.next=26;break}return e.next=4,window.getDirEntries(t);case 4:n=e.sent,a=0;case 6:if(!(a<n.length)){e.next=24;break}if(o=n[a],u=o.toURL(),u=decodeURIComponent(u),c=getFileName(u),s=t+"/"+c,!o.isDirectory){e.next=17;break}return e.next=15,w(s,r);case 15:e.next=21;break;case 17:return e.next=19,x(o);case 19:f=e.sent,r.push({filePath:s,time:f});case 21:a++,e.next=6;break;case 24:e.next=53;break;case 26:return e.next=28,v.readDir(t);case 28:if(!1!==(l=e.sent)){e.next=32;break}return h.info("getAllFilesPathAndMTimeInDir readdir failed, dir=",t),e.abrupt("return");case 32:d=0;case 33:if(!(d<l.length)){e.next=53;break}return p=l[d],g=t+"/"+p,e.next=38,v.stat(g);case 38:if(!1!==(k=e.sent)){e.next=43;break}h.info("addFilesToArchiver stat failed, path=",g),e.next=50;break;case 43:if(!k.isDirectory()){e.next=48;break}return e.next=46,w(g,r);case 46:e.next=50;break;case 48:_=k.mtime.getTime(),r.push({filePath:g,time:_});case 50:d++,e.next=33;break;case 53:e.next=58;break;case 55:e.prev=55,e.t0=e.catch(0),h.error("getAllFilesPathAndMTimeInDir error=",e.t0);case 58:case"end":return e.stop()}},e,void 0,[[0,55]])}));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,s.default)(i.default.mark(function e(){var t,r,n,a,o,u,c,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("deleteOldLog start"),t=window.LOG_PATH,r=[],e.next=5,(0,p.cleanHistorySetUpLog)();case 5:return e.next=7,w(t,r);case 7:for(n=0;n<r.length;n++)a=r[n],o=(new Date).getTime(),u=Math.floor(o-a.time),c=1296e6,u>c&&(s=a.filePath,h.info("deleteOldLog, file path=",s+", interval=",u),appService.deleteFile(s));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("moduleInit start"),e.prev=1,t=window.getZipLogPath(),e.next=5,appService.deleteFileDir(t);case 5:return e.next=8,appService.deleteFileDir(t.replace("outputFile","log_for_send"));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),h.error("moduleInit error=",e.t0);case 13:case"end":return e.stop()}},e,void 0,[[1,10]])}));return function(){return e.apply(this,arguments)}}();window.CLIENTCONFIG.ENABLE_IT_MEETING||_();var b=t.getCrashLogPath=function(){return window.LOG_PATH+"/fr_exception/Local"},L=function(e){var t=!1;return f.LOG_SUFFIX_LIST.forEach(function(r){-1!==e.indexOf(r)&&(t=!0)}),t},F=function(){var e=(0,s.default)(i.default.mark(function e(t,r,n){var a,o,u,c,s,f,l,d,p,g,x;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=28;break}return e.prev=1,e.next=4,window.getDirEntries(t);case 4:a=e.sent,o=0;case 6:if(!(o<a.length)){e.next=21;break}if(u=a[o],c=u.toURL(),c=decodeURIComponent(c),s=getFileName(c),f=t+"/"+s,!u.isDirectory){e.next=17;break}return e.next=15,F(f,r,n);case 15:e.next=18;break;case 17:!0===L(s)?r.push(f):(h.info("filterFileSuffix find invalid suffix, filename=",s),n.push(f));case 18:o++,e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(1),h.error("filterFileSuffix error=",e.t0);case 26:e.next=54;break;case 28:return e.next=30,v.readDir(t);case 30:if(!1!==(l=e.sent)){e.next=34;break}return h.info("filterFileSuffix readdir failed, return"),e.abrupt("return");case 34:d=0;case 35:if(!(d<l.length)){e.next=54;break}return p=l[d],g=t+"/"+p,e.next=40,v.stat(g);case 40:if(!1!==(x=e.sent)){e.next=45;break}h.info("filterFileSuffix stat failed"),e.next=51;break;case 45:if(!x.isDirectory()){e.next=50;break}return e.next=48,F(g,r,n);case 48:e.next=51;break;case 50:!0===L(p)?r.push(g):(h.info("filterFileSuffix invalid, filename=",p),n.push(g));case 51:d++,e.next=35;break;case 54:case"end":return e.stop()}},e,void 0,[[1,23]])}));return function(t,r,n){return e.apply(this,arguments)}}(),m=t.getLogListBeforeZip=function(){var e=(0,s.default)(i.default.mark(function e(){var t,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=3;break}return e.next=3,k();case 3:return e.next=5,(0,l.getCrashLogMac)();case 5:return t=[],r=[],e.next=9,F(window.LOG_PATH,t,r);case 9:if(!(r.length>0&&t.length>0)){e.next=12;break}return h.info("collectLogs list length =",t.length),e.abrupt("return",t);case 12:return e.abrupt("return",[window.LOG_PATH]);case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),y=t.collectLogs=function(){var e=(0,s.default)(i.default.mark(function e(t){var r,n,a,o,c,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("collectLogs start, isOpen=",t),e.next=3,m();case 3:return r=e.sent,n=(new Date).format("yyyyMMdd_hhmmss"),a="logFull_win_"+n+".zip",o=window.getZipLogPath(),c=o+"/"+a,t&&(c=c.replace("outputFile","log_for_send")),s=new u.default(function(e,n){(0,d.dealZip)(r,c).then(function(r){t&&appService.openFolder(r),h.info("collectLogs zip log success"),e(r)},function(){h.info("collectLogs zip log failed"),n()})}),e.abrupt("return",s);case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),E=(t.collectLogsAndOpen=function(){h.info("collectLogsAndOpen start"),window.alert(""+language.LOG_COMPRESS_PROMPT),y(!0).then(function(){window.clearDialogQueue&&window.clearDialogQueue()},function(){window.clearDialogQueue&&window.clearDialogQueue(),window.ToastNew(language.FAILED_TO_COLLECT_LOGS,2)})},function(e){var t=!1;return f.LOG_CUT_LIST.forEach(function(r){0===e.indexOf(r)&&(t=!0)}),t}),A=function(){var e=(0,s.default)(i.default.mark(function e(t,r){var n,a,o,u,c,s,f,l,d,p;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=void 0,!window.CLIENTCONFIG.ISMOBILE){e.next=23;break}return e.next=4,window.getDirEntries(t);case 4:n=e.sent,a=0;case 6:if(!(a<n.length)){e.next=21;break}if(o=n[a],u=o.toURL(),u=decodeURIComponent(u),c=getFileName(u),s=t+"/"+c,!o.isDirectory){e.next=17;break}return e.next=15,A(s,r);case 15:e.next=18;break;case 17:E(c)&&r.push(s);case 18:a++,e.next=6;break;case 21:e.next=49;break;case 23:return e.next=25,v.readDir(t);case 25:if(!1!==(n=e.sent)){e.next=29;break}return h.info("getCutList readdir failed"),e.abrupt("return");case 29:f=0;case 30:if(!(f<n.length)){e.next=49;break}return l=n[f],d=t+"/"+l,e.next=35,v.stat(d);case 35:if(!1!==(p=e.sent)){e.next=40;break}h.info("getCutList stats failed"),e.next=46;break;case 40:if(!p.isDirectory()){e.next=45;break}return e.next=43,A(d,r);case 43:e.next=46;break;case 45:E(l)&&r.push(d);case 46:f++,e.next=30;break;case 49:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),O=function(e){if(e.length>0){for(var t=0;t<e.length-1;t++)for(var r=t+1;r<e.length;r++)if(e[t].time<e[r].time){var n=e[t];e[t]=e[r],e[r]=n}return e}return[]},M=function(){var e=(0,s.default)(i.default.mark(function e(t){var r,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("sortLogFileByEditTime, path=",t),r=[],e.next=4,w(t,r);case 4:return n=O(r),e.abrupt("return",n);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),D=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].filePath,a=getFileName(n);0!==a.indexOf("dataconf")&&0!==a.indexOf("HuaweiMeeting_")||0===a.indexOf("dataconf_oper_0.log")||0===a.indexOf("dataconf_agent_0.log")||t.push(e[r])}return t},C=function(){var e=(0,s.default)(i.default.mark(function e(t,r){var n,a,o,u,c,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("getDataConfLogCutList start, limit=",t),n=window.LOG_PATH+"/dataconf",e.next=4,M(n);case 4:for(a=e.sent,o=D(a),u=o.length>t?t:o.length,c=0;c<u;c++)s=o[c].filePath,r.push(s);case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),P=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].filePath;getFileName(n).indexOf(".zip")>=0&&t.push(e[r])}return t},T=function(){var e=(0,s.default)(i.default.mark(function e(t,r){var n,a,o,u,c,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("getCrashLogCutList start, limit=",t),""===(n=b())){e.next=9;break}return e.next=5,M(n);case 5:for(a=e.sent,o=P(a),u=o.length>t?t:o.length,c=0;c<u;c++)s=o[c].filePath,r.push(s);case 9:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),S=t.getLogCutsListBeforeZip=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=3;break}return e.next=3,k();case 3:return e.next=5,(0,l.getCrashLogMac)();case 5:return t=[],e.next=8,A(window.LOG_PATH,t);case 8:return e.next=10,C(1,t);case 10:return e.next=13,T(2,t);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.collectLogCuts=function(){var e=(0,s.default)(i.default.mark(function e(t){var r,n,a;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(r=(new Date).format("yyyyMMdd_hhmmss"),t="logMini_win_"+r+".zip"),h.info("collectLogCuts start, logName=",t),e.next=4,S();case 4:return n=e.sent,a=new u.default(function(e,r){var a=window.getZipLogPath(),i=a+"/"+t;n.length>0?(0,d.dealZip)(n,i).then(function(t){h.info("collectLogCuts zip log success"),e(t)},function(){h.info("collectLogCuts zip log failed"),r()}):(h.info("collectLogCuts no cut file"),r())}),e.abrupt("return",a);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.deleteCrashLog=function(){var e=(0,s.default)(i.default.mark(function e(){var t,r,n,a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""===(t=b())){e.next=24;break}e.next=22;break;case 5:r=e.sent,n=0;case 7:if(!(n<r.length)){e.next=20;break}if(a=r[n],o=a.toURL(),!a.isDirectory){e.next=15;break}return e.next=13,appService.deleteFileDir(o);case 13:e.next=17;break;case 15:return e.next=17,appService.deleteFile(o);case 17:n++,e.next=7;break;case 20:e.next=24;break;case 22:return e.next=24,appService.deleteFileDir(t);case 24:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},724:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CRASH_FILE_TIME_LIMIT=2592e5,t.LOG_FEEDBACK_ZIP_FILE_NAME="feedback.zip",t.LOG_CUT_LIST=["CloudLink.log","CloudLink_1.log","____cloudlink_time.txt","Setup Log 20","debugInfo_","nativewnd.log","nativewnd_1.log","fr_trace.log","fr_fun.log","version.ini","dataconf_oper_0.log","Status.log","db.log","db_1.log","tup_audio.log","tup_audio_1.log","tup_bfcpservice.log","tup_bfcpservice_1.log","tup_call.log","tup_call_1.log","tup_confctrl.log","tup_confctrl_1.log","tup_cui.log","tup_cui_1.log","tup_eaddr.log","tup_eaddr_1.log","tup_http.log","tup_http_1.log","tup_im_service.log","tup_im_service_1.log","tup_login.log","tup_login_1.log","tup_mediaservice.log","tup_mediaservice_1.log","tup_offlinefile.log","tup_offlinefile_1.log","tup_video.log","tup_video_1.log","tupService.log","tupService_1.log","HME_MediaEngine1.log","HME_Audev1.log","HME_Audev1.log_bak"],t.LOG_SUFFIX_LIST=[".log",".log_bak",".txt",".ini",".zip",".dmp",".exc",".idx","keystore","keystoreBak"],t.HISTORY_SETUP_LOG_NUM=3},725:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.mkDir=t.readFile=t.stat=t.readDir=void 0;var a=r(69),i=n(a),o=r(3),u=n(o),c=coreLogger.getLogger("log")("zip");t.readDir=function(e){return new u.default(function(t,r){window.fs.readdir(e,function(e,r){e?(-1!==(0,i.default)(e).indexOf("Error: ENOENT: no such file or directory")?c.error("readDir dir not exist"):c.error("readDir error=",e),t(!1)):t(r)})})},t.stat=function(e){return new u.default(function(t,r){window.fs.stat(e,function(e,r){e?(c.error("stat error=",e),t(!1)):t(r)})})},t.readFile=function(e){return new u.default(function(t,r){window.fs.readFile(e,function(e,r){e?(c.error("readFile error=",e),t(!1)):t(r)})})},t.mkDir=function(e){return new u.default(function(t,r){window.fs.mkdir(e,{recursive:!0},function(e){e?-1!==(0,i.default)(e).indexOf("Error: EEXIST: file already exists")?(c.info("mkdir dir already exists"),t(!0)):(c.error("mkdir error=",e),t(!1)):t(!0)})})}},889:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return p.info("dealZipMobile list =",e),new o.default(function(r,n){var a=getFileName(t),i=t.replace(a,"");window.comPressDirOrFile(e,i,a,function(e){isNullOrEmpty(e)||isNullOrEmpty(e.zipPath)||!e.result?(p.info("dealZipMobile: compress files failed"),n()):(p.info("dealZipMobile: compress files success"),r(e.zipPath))})})}Object.defineProperty(t,"__esModule",{value:!0}),t.dealZip=void 0;var i=r(3),o=n(i),u=r(1),c=n(u),s=r(2),f=n(s),l=r(725),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),p=coreLogger.getLogger("log")("zip"),g=function(){var e=(0,f.default)(c.default.mark(function e(t,r){var n,a,i,o,u,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.readDir(r);case 2:if(!1!==(n=e.sent)){e.next=6;break}return p.info("addDirFilesToArchiver readdir failed, dir=",r),e.abrupt("return");case 6:a=0;case 7:if(!(a<n.length)){e.next=30;break}return i=n[a],o=r+"/"+i,e.next=12,d.stat(o);case 12:if(!1!==(u=e.sent)){e.next=17;break}p.info("addDirFilesToArchiver stat failed, path=",o),e.next=27;break;case 17:if(!u.isFile()){e.next=24;break}return e.next=20,d.readFile(o);case 20:s=e.sent,!1===s?p.info("addDirFilesToArchiver readFile failed, file=",i):t.append(s,{name:i}),e.next=27;break;case 24:if(!u.isDirectory()){e.next=27;break}return e.next=27,g(t,o);case 27:a++,e.next=7;break;case 30:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,f.default)(c.default.mark(function e(t){var r,n,a,i,o,u,s,f,l;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.readDir(t);case 3:if(!1!==(r=e.sent)){e.next=7;break}throw n="checkDirFiles readdir failed";case 7:a=0;case 8:if(!(a<r.length)){e.next=32;break}return i=r[a],o=t+"/"+i,e.next=13,d.stat(o);case 13:if(!1!==(u=e.sent)){e.next=17;break}throw s="checkDirFiles stat failed";case 17:if(!u.isFile()){e.next=26;break}return e.next=20,d.readFile(o);case 20:if(!1!==(f=e.sent)){e.next=24;break}throw l="checkDirFiles readFile failed";case 24:e.next=29;break;case 26:if(!u.isDirectory()){e.next=29;break}return e.next=29,v(o);case 29:a++,e.next=8;break;case 32:e.next=37;break;case 34:throw e.prev=34,e.t0=e.catch(0),e.t0;case 37:case"end":return e.stop()}},e,void 0,[[0,34]])}));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=(0,f.default)(c.default.mark(function e(t,r){var n,a,i,o,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<r.length)){e.next=33;break}return a=r[n],e.next=5,d.stat(a);case 5:if(!1!==(i=e.sent)){e.next=10;break}p.info("addItemsToArchiver stat failed, item=",a),e.next=30;break;case 10:if(!i.isDirectory()){e.next=24;break}return e.prev=11,e.next=14,v(a);case 14:t.directory(a,getFileName(a)),e.next=22;break;case 17:return e.prev=17,e.t0=e.catch(11),p.error("addItemsToArchiver checkDirFiles throw error= ",e.t0),e.next=22,g(t,a);case 22:e.next=30;break;case 24:if(!i.isFile()){e.next=30;break}return o=getFileName(a),e.next=28,d.readFile(a);case 28:u=e.sent,!1===u?p.info("addItemsToArchiver readFile failed, item=",a):t.append(u,{name:o});case 30:n++,e.next=1;break;case 33:case"end":return e.stop()}},e,void 0,[[11,17]])}));return function(t,r){return e.apply(this,arguments)}}(),x=function(e,t){return new o.default(function(){var r=(0,f.default)(c.default.mark(function r(n,a){var i,o,u,s,f,l,g;return c.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=getFileName(t),o=t.replace(i,""),r.next=4,d.mkDir(o);case 4:u=r.sent,!1===u&&(s="dealZipPc mkDir output path failed, outPath="+o,a(s)),f=setTimeout(function(){a("dealZipPc zip timeout")},1e5),l=window.require(window.__dirname+"/../node_extends/archiver")("zip",{zlib:{level:9}}),g=void 0;try{g=window.fs.createWriteStream(t)}catch(e){p.error("dealZipPc createWriteStream err=",e),a(e)}return l.on("error",function(e){p.error("dealZipPc, err=",e),a(e)}),l.on("finish",function(){p.info("dealZipPc zip success")}),g.on("close",function(){f&&clearTimeout(f),p.info("dealZipPc file descriptor closed, size = "+l.pointer()+" bytes"),n(t)}),l.pipe(g),r.next=16,h(l,e);case 16:l.finalize(),p.info("dealZipPc start zipLog");case 18:case"end":return r.stop()}},r,this)}));return function(e,t){return r.apply(this,arguments)}}())};t.dealZip=function(e,t){return window.CLIENTCONFIG.ISMOBILE?a(e,t):x(e,t)}},890:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.cleanHistorySetUpLog=void 0;var a=r(1),i=n(a),o=r(2),u=n(o),c=r(723),s=r(724),f=coreLogger.getLogger("log")("crashClean"),l=(t.cleanHistorySetUpLog=function(){var e=(0,u.default)(i.default.mark(function e(){var t,r,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("win"===window.CLIENTCONFIG.PLATFORM){e.next=2;break}return e.abrupt("return");case 2:return t=[],r=[],n=[],e.next=7,(0,c.getAllFilesPathAndMTimeInDir)(window.LOG_PATH+"\\setup",t);case 7:t.forEach(function(e){-1!==e.filePath.indexOf("Setup Log 20")&&r.push(e)}),f.info("cleanHistorySetUpLog   number of set up log: ",r.length),r.sort(l("time",!1)),n=r.slice(s.HISTORY_SETUP_LOG_NUM),n.forEach(function(e){appService.deleteFile(e.filePath)});case 12:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e,t){return function(r,n){return t?r[e]-n[e]:n[e]-r[e]}})}});