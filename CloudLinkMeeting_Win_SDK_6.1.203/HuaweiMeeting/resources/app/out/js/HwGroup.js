webpackJsonp([14],{112:function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function u(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.HwContactSdk=void 0;var o=t(135),a=u(o),i=t(4),s=u(i),c=t(1872),p=t(1889),f=n(p),d=t(1890),l=n(d);r.HwContactSdk=function e(){(0,s.default)(this,e),this.getGroupApi=c.getGroupApi,(0,a.default)(this,(0,c.getGroupApi)().getApiList()),(0,a.default)(this,f),(0,a.default)(this,l)}},131:function(e,r,t){e.exports={default:t(151),__esModule:!0}},132:function(e,r,t){e.exports=t(0)(45)},133:function(e,r,t){e.exports=t(0)(47)},135:function(e,r,t){e.exports=t(0)(562)},139:function(e,r,t){e.exports=t(0)(57)},141:function(e,r,t){e.exports=t(0)(238)},142:function(e,r,t){"use strict";r.__esModule=!0;var n=t(159),u=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return(0,u.default)(e)}},143:function(e,r,t){e.exports=t(0)(620)},146:function(e,r,t){var n=t(10),u=t(8),o=t(148);e.exports=function(e,r){var t=(u.Object||{})[e]||Object[e],a={};a[e]=r(t),n(n.S+n.F*o(function(){t(1)}),"Object",a)}},148:function(e,r,t){e.exports=t(0)(59)},151:function(e,r,t){t(152),e.exports=t(8).Object.getPrototypeOf},152:function(e,r,t){var n=t(141),u=t(153);t(146)("getPrototypeOf",function(){return function(e){return u(n(e))}})},153:function(e,r,t){e.exports=t(0)(585)},159:function(e,r,t){e.exports={default:t(173),__esModule:!0}},166:function(e,r,t){var n=t(15);e.exports=function(e,r){if(!n(e)||e._t!==r)throw TypeError("Incompatible receiver, "+r+" required!");return e}},173:function(e,r,t){t(22),t(174),e.exports=t(8).Array.from},174:function(e,r,t){"use strict";var n=t(11),u=t(10),o=t(141),a=t(31),i=t(32),s=t(27),c=t(175),p=t(26);u(u.S+u.F*!t(33)(function(e){Array.from(e)}),"Array",{from:function(e){var r,t,u,f,d=o(e),l="function"==typeof this?this:Array,m=arguments.length,g=m>1?arguments[1]:void 0,_=void 0!==g,v=0,G=p(d);if(_&&(g=n(g,m>2?arguments[2]:void 0,2)),void 0==G||l==Array&&i(G))for(r=s(d.length),t=new l(r);r>v;v++)c(t,v,_?g(d[v],v):d[v]);else for(f=G.call(d),t=new l;!(u=f.next()).done;v++)c(t,v,_?a(f,g,[u.value,v],!0):u.value);return t.length=v,t}})},175:function(e,r,t){"use strict";var n=t(25),u=t(176);e.exports=function(e,r,t){r in e?n.f(e,r,u(0,t)):e[r]=t}},176:function(e,r,t){e.exports=t(0)(79)},177:function(e,r,t){e.exports=t(0)(593)},1872:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.GroupImpl=r.getGroupApi=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(131),c=n(s),p=t(4),f=n(p),d=t(132),l=n(d),m=t(133),g=n(m),_=t(1873),v=n(_),G=t(821),y=n(G),x=t(972),h=t(1876),b=t(270),I=t(1877),M=t(1878),w=t(227),k=t(973),D=t(974),O=t(1879),S=t(243),E=t(975),N=t(1880),T=t(1881),A=t(976),L=t(1882),F=t(1883),C=t(1884),P=t(1885),R=t(1886),B=t(1887),U=t(1888),j=t(243),q=coreLogger.getLogger("group")("groupImpl"),$=void 0,J=(r.getGroupApi=function(){return isNullOrEmpty($)&&($=new J),$},r.GroupImpl=function(e){function r(){var e=this;(0,f.default)(this,r);var t=(0,l.default)(this,(r.__proto__||(0,c.default)(r)).call(this));return t.addGroupPhoneMemberService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("addGroupPhoneMemberService"),e.next=3,(0,w.addGroupPhoneMemberService)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.createDiscussGroupName=function(e){return q.info("createDiscussGroupName"),(0,k.createDiscussGroupName)(e)},t.isStringOverLength=function(e){return q.info("isStringOverLength"),(0,D.isStringOverLength)(e)},t.createDiscussionGroup=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("createDiscussionGroup add in queue"),n=!isNullOrEmpty(t.isTeam)&&t.isTeam,u=new PromiseObject,a=function(e){u.resolve(e)},i=coreCommon.TaskQueue.getInstance("groupServiceQueue"),s=coreCommon.TaskOptions.defaultOptions(),i.addTask(A.createDiscussionGroup,s,a,t.list,n),e.next=9,u;case 9:return c=e.sent,e.abrupt("return",c);case 11:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.addGroupMemberService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("addGroupMemberService"),e.next=3,(0,w.addGroupMemberService)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.calGroupAndMemberListData=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("calGroupAndMemberListData add in queue"),n=new PromiseObject,u=function(e){n.resolve(e)},a=coreCommon.TaskQueue.getInstance("groupServiceQueue"),i=coreCommon.TaskOptions.defaultOptions(),a.addTask(h.calGroupAndMemberListData,i,u,t),e.next=8,n;case 8:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.openGroupDetailById=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("openGroupDetailById"),e.next=3,(0,O.openGroupDetailById)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.initGroupAnnounceInfo=function(){return q.info("initGroupAnnounceInfo"),(0,N.initGroupAnnounceInfo)()},t.getGroupDetailInfo=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("getGroupDetailInfo"),e.next=3,(0,S.getGroupDetailInfo)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.setDisGroupPolicy=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("setDisGroupPolicy add in queue"),n=new PromiseObject,u=function(e){n.resolve(e)},a=coreCommon.TaskQueue.getInstance("groupServiceQueue"),i=coreCommon.TaskOptions.defaultOptions(),a.addTask(F.setDisGroupPolicy,i,u,t.groupId,t.fixDiscuss),e.next=8,n;case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.modifyDisGroupInfo=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("modifyDisGroupInfo"),e.next=3,(0,E.modifyDisGroupInfo)(t.oldGroupInfo,t.newGroupInfo);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.getMemberListByGroupIdInQueue=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("getMemberListByGroupIdInQueue"),e.next=3,(0,b.getMemberListByGroupIdInQueue)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.sortGroupMember=function(e){return q.info("sortGroupMember"),(0,b.sortGroupMember)(e.groupMemberInfo,e.groupInfoNew)},t.searchFixedGroupsLogic=function(){var r=(0,i.default)(o.default.mark(function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("searchFixedGroupsLogic"),e.next=3,(0,C.searchFixedGroupsLogic)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(){return r.apply(this,arguments)}}(),t.dealFixedGroupAnnouncementChange=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("dealFixedGroupAnnouncementChange add in queue"),n=new PromiseObject,u=function(e){n.resolve(e)},a=coreCommon.TaskQueue.getInstance("groupServiceQueue"),i=coreCommon.TaskOptions.defaultOptions(),a.addTask(R.dealFixedGroupAnnouncementChange,i,u,t),e.next=8,n;case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.toggleGetGroupMemberList=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("toggleGetGroupMemberList"),e.next=3,(0,x.toggleGetGroupMemberList)(t);case 3:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.mModifyDisGroupAnnounce=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("mModifyDisGroupAnnounce"),e.next=3,(0,U.mModifyDisGroupAnnounce)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.setGroupAnnounceText=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("setGroupAnnounceText"),e.next=3,(0,N.setGroupAnnounceText)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.changeGroupType=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("changeGroupType"),n=new PromiseObject,u=function(e){n.resolve(e)},a=coreCommon.TaskQueue.getInstance("groupServiceQueue"),i=coreCommon.TaskOptions.defaultOptions(),a.addTask(T.changeGroupType,i,u,t),e.next=8,n;case 8:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.exitOrDeleteGroup=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("exitOrDeleteGroup"),n=isNullOrEmpty(t.groupInfoNew)?null:t.groupInfoNew,u=isNullOrEmpty(t.contactInfoNew)?null:t.contactInfoNew,e.next=5,(0,L.exitOrDeleteGroup)(t.type,t.groupId,t.groupType,n,u);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.deleteGroupMemberLogic=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("deleteGroupMemberLogic"),e.next=3,(0,I.deleteGroupMemberLogic)(t.groupInfo,t.member);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.mSetGroupName=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("mSetGroupName"),e.next=3,(0,U.mSetGroupName)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.joinFlagChg=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("joinFlagChg"),e.next=3,(0,S.joinFlagChg)(t.groupInfo,t.flag);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.modifyDisGroupAnnounce=function(){var r=(0,i.default)(o.default.mark(function r(t){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("modifyDisGroupAnnounce"),n=isNullOrEmpty(t.groupInfo)?{}:t.groupInfo,e.next=4,(0,N.modifyDisGroupAnnounce)(t.manifesto,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.checkFixedGroupApply=function(){var r=(0,i.default)(o.default.mark(function r(t){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("checkFixedGroupApply"),n=isNullOrEmpty(t.display_name)?"":t.display_name,e.next=4,(0,R.checkFixedGroupApply)(t.agree_join,t.message,t.member_account,n,t.account);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.delDiscussionGroupMemberLogic=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("delDiscussionGroupMemberLogic"),e.next=3,(0,I.delDiscussionGroupMemberLogic)(t.groupInfoNew,t.account);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.editGroupAnnounce=function(){return q.info("editGroupAnnounce"),(0,N.editGroupAnnounce)()},t.getOnlineCount=function(e){return q.debug("getOnlineCount"),(0,b.getOnlineCount)(e.currentGroupMemberList,e.groupId,e.contact_status_map)},t.getAnnounceLength=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("getAnnounceLength"),e.next=3,(0,N.getAnnounceLength)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.transferDiscussionGroupService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("transferDiscussionGroupService"),e.next=3,(0,w.transferDiscussionGroupService)(t.groupId,t.account);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.transferFixedGroupService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("transferFixedGroupService"),e.next=3,(0,w.transferFixedGroupService)(t.groupId,t.account);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.addGroupMemberLogic=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("addGroupMemberLogic"),e.next=3,(0,M.addGroupMemberLogic)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.setmGroupTempName=function(e){return q.info("setmGroupTempName"),(0,U.setmGroupTempName)(e)},t.createTeamFromSelectBox=(0,i.default)(o.default.mark(function r(){var t,n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("createTeamFromSelectBox add in queue"),t=new PromiseObject,n=function(e){t.resolve(e)},u=coreCommon.TaskQueue.getInstance("groupServiceQueue"),a=coreCommon.TaskOptions.defaultOptions(),u.addTask(N.createTeamFromSelectBox,a,n),e.next=8,t;case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}},r,e)})),t.setMarkDeleteGroupNotify=function(e){return q.info("setMarkDeleteGroupNotify"),y.default.setMarkDeleteGroupNotify(e)},t.setMarkExitGroupNotify=function(e){return q.info("setMarkExitGroupNotify"),y.default.setMarkExitGroupNotify(e.groupId,e.isExit)},t.clearMarkExitGroupNotify=function(){return q.info("clearMarkExitGroupNotify"),y.default.clearMarkExitGroupNotify()},t.modifyGroupMsgPolicyType=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("modifyGroupMsgPolicyType add in queue"),n=new PromiseObject,u=function(e){n.resolve(e)},a=coreCommon.TaskQueue.getInstance("groupServiceQueue"),i=coreCommon.TaskOptions.defaultOptions(),a.addTask(E.modifyGroupMsgPolicyType,i,u,t.groupId,t.type),e.next=8,n;case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.clearMarkDeleteGroupNotify=function(){return q.info("clearMarkDeleteGroupNotify"),y.default.clearMarkDeleteGroupNotify()},t.setGroupNotify=(0,i.default)(o.default.mark(function r(){var t,n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("setGroupNotify"),e.next=3,coreTup.getIMInstance();case 3:return t=e.sent,n=coreCommon.TaskQueue.getInstance("groupServiceQueue"),u=coreCommon.TaskOptions.defaultOptions(),e.next=8,t.setGroupImEvent({onApplyJoinFixedGroupResult:function(e){q.info("dealApplyJoinFixedGroupResult add in queue"),n.addTask(R.dealApplyJoinFixedGroupResult,u,null,e)},onFixedGroupLeaveResult:function(e){q.info("dealFixedGroupLeaveResult add in queue"),n.addTask(R.dealFixedGroupLeaveResult,u,null,e)},onFixedGroupMemberAdd:function(e){q.info("dealFixedGroupMemberAdd add in queue"),n.addTask(R.dealFixedGroupMemberAdd,u,null,e)},onFixedGroupWasAddedToGroup:function(e){q.info("dealFixedGroupWasAddedToGroup add in queue"),n.addTask(R.dealFixedGroupWasAddedToGroup,u,null,e)},onDiscussGroupAddMember:function(e){q.info("dealDiscussGroupAddMember add in queue"),n.addTask(B.dealDiscussGroupAddMember,u,null,e)},onDiscussGroupWasAddToGroup:function(e){q.info("dealDiscussGroupWasAddToGroup add in queue"),n.addTask(B.dealDiscussGroupWasAddToGroup,u,null,e)},onFixedGroupMemberDel:function(e){q.info("dealFixedGroupMemberDel add in queue"),n.addTask(R.dealFixedGroupMemberDel,u,null,e)},onFixedGroupKickout:function(e){q.info("dealFixedGroupKickout add in queue"),n.addTask(R.dealFixedGroupKickout,u,null,e)},onFixedGroupInfoChg:function(e){q.info("dealFixedGroupInfoChg add in queue"),n.addTask(R.dealFixedGroupInfoChg,u,null,e)},onDiscussGroupInfoChg:function(e){q.info("dealDiscussGroupInfoChg add in queue"),n.addTask(B.dealDiscussGroupInfoChg,u,null,e)},onFixedGroupOwnerChg:function(e){q.info("dealFixedGroupOwnerChg add in queue"),n.addTask(R.dealFixedGroupOwnerChg,u,null,e)},onDiscussGroupOwnerChange:function(e){q.info("dealDiscussGroupOwnerChange add in queue"),n.addTask(B.dealDiscussGroupOwnerChange,u,null,e)},onFixedGroupDismiss:function(e){q.info("dealFixedGroupDismiss add in queue"),n.addTask(R.dealFixedGroupDismiss,u,null,e)},onDiscussGroupDismiss:function(e){q.info("dealDiscussGroupDismiss add in queue"),n.addTask(B.dealDiscussGroupDismiss,u,null,e)},onReceiveInviteToFixedGroup:function(e){q.info("dealReceiveInviteToFixedGroup add in queue"),n.addTask(R.dealReceiveInviteToFixedGroup,u,null,e)},onReceiveInviteJoinFixedGroup:function(e){q.info("dealReceiveInviteJoinFixedGroup add in queue"),n.addTask(R.dealReceiveInviteJoinFixedGroup,u,null,e)},onFixedGroupOwnerInviteResult:function(e){q.info("dealFixedGroupOwnerInviteResult add in queue"),n.addTask(R.dealFixedGroupOwnerInviteResult,u,null,e)},onDiscussGroupDelMember:function(e){q.info("dealDiscussGroupDelMember add in queue"),n.addTask(B.dealDiscussGroupDelMember,u,null,e)},onDiscussGroupBroadcast:function(e){q.info("dealDiscussGroupBroadcast add in queue"),n.addTask(B.dealDiscussGroupBroadcast,u,null,e)}});case 8:case"end":return e.stop()}},r,e)})),t.addDiscussGroup=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("addDiscussGroup"),e.next=3,(0,w.addDiscussGroup)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.addDiscussGroupMember=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("addDiscussGroupMember"),e.next=3,(0,w.addDiscussGroupMember)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.applyToJoinFixedGroupLogic=function(){var r=(0,i.default)(o.default.mark(function r(t){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("applyToJoinFixedGroupLogic"),n=isNullOrEmpty(t.displayName)?"":t.displayName,e.next=4,(0,P.applyToJoinFixedGroupLogic)(t.groupInfo,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.setTeamNotifyRead=function(){var r=(0,i.default)(o.default.mark(function r(t){var n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("setTeamNotifyRead add in queue"),n=new PromiseObject,u=function(e){n.resolve(e)},a=coreCommon.TaskQueue.getInstance("groupServiceQueue"),i=coreCommon.TaskOptions.defaultOptions(),a.addTask(S.setTeamNotifyRead,i,u,t),e.next=8,n;case 8:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.getGroupInfoFromDB=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("getGroupInfoFromDB groupId = "+t),e.next=3,(0,S.getGroupInfoFromDB)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.queryGroupBySearchText=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("queryGroupBySearchText"),e.next=3,coreDb.queryGroupList({searchtext:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.queryGroupByMemberSearch=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("queryGroupByMemberSearch"),e.next=3,(0,j.getGroupByMemberSearch)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.queryGroupListByIdList=function(){var r=(0,i.default)(o.default.mark(function r(t){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=3;break}return q.error("queryGroupListByIdList query groupId list is null"),e.abrupt("return",[]);case 3:return q.info("queryGroupListByIdList query groupId list = "+t),e.next=6,coreDb.queryGroupList({all:"",groupidlist:t});case 6:return n=e.sent,isNullOrEmpty(n)?q.error("queryGroupListByIdList db return groupId list is null"):q.info("queryGroupListByIdList db return groupId list is = "+n.getKeyArr("group_id")),e.abrupt("return",n);case 9:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.deleteGroupService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("deleteGroupService"),e.next=3,(0,w.deleteGroupService)(t.groupId,t.groupType);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.exitGroupService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("exitGroupService"),e.next=3,(0,w.exitGroupService)(t.groupId,t.groupType);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.bulkDelGroupMemberService=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("bulkDelGroupMemberService"),e.next=3,(0,w.bulkDelGroupMemberService)(t.list,t.selectGroupInfo);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.getGroupInfoFromServer=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("getGroupInfoFromServer"),e.next=3,(0,w.getGroupInfoFromServer)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t.createTeamSpace=function(){var r=(0,i.default)(o.default.mark(function r(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q.info("createTeamSpace"),e.next=3,(0,P.createTeamSpace)(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r,e)}));return function(e){return r.apply(this,arguments)}}(),t}return(0,g.default)(r,e),r}(v.default))},1873:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(131),c=n(s),p=t(4),f=n(p),d=t(132),l=n(d),m=t(133),g=n(m),_=function(e){function r(){var e,t,n,u,a=this;(0,f.default)(this,r);for(var s=arguments.length,p=Array(s),d=0;d<s;d++)p[d]=arguments[d];return t=n=(0,l.default)(this,(e=r.__proto__||(0,c.default)(r)).call.apply(e,[this].concat(p))),n.addGroupPhoneMemberService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.createDiscussGroupName=function(e){},n.createDiscussionGroup=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.addGroupMemberService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.calGroupAndMemberListData=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.openGroupDetailById=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.initGroupAnnounceInfo=function(){},n.getGroupDetailInfo=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.setDisGroupPolicy=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.modifyDisGroupInfo=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.getMemberListByGroupIdInQueue=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.sortGroupMember=function(e){},n.searchFixedGroupsLogic=function(){var e=(0,i.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(){return e.apply(this,arguments)}}(),n.dealFixedGroupAnnouncementChange=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.toggleGetGroupMemberList=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.mModifyDisGroupAnnounce=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.setGroupAnnounceText=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.changeGroupType=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.exitOrDeleteGroup=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.deleteGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.mSetGroupName=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.joinFlagChg=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.modifyDisGroupAnnounce=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.checkFixedGroupApply=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.delDiscussionGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.editGroupAnnounce=function(){},n.getOnlineCount=function(e){},n.getAnnounceLength=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.transferDiscussionGroupService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.transferFixedGroupService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.addGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.setmGroupTempName=function(e){},n.createTeamFromSelectBox=(0,i.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)})),n.setMarkDeleteGroupNotify=function(e){},n.setMarkExitGroupNotify=function(e){},n.clearMarkExitGroupNotify=function(){},n.modifyGroupMsgPolicyType=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.clearMarkDeleteGroupNotify=function(){},n.setGroupNotify=(0,i.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)})),n.addDiscussGroup=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.addDiscussGroupMember=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.applyToJoinFixedGroupLogic=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.setTeamNotifyRead=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.getGroupInfoFromDB=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.queryGroupBySearchText=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.queryGroupByMemberSearch=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.queryGroupListByIdList=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.deleteGroupService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.exitGroupService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.bulkDelGroupMemberService=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.getGroupInfoFromServer=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),n.createTeamSpace=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,a)}));return function(r){return e.apply(this,arguments)}}(),u=t,(0,l.default)(n,u)}return(0,g.default)(r,e),r}(coreCommon.Interface);r.default=_},1874:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.reloadGroupInfoNew=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=coreLogger.getLogger("group")("detail");r.reloadGroupInfoNew=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i,c,p,f,d,l,m;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=$getState(),n=t.myInfo.account,u=r.owner===n,a=t.contactGroups,i=a.sliderContent,c=a.sliderGroupInfo,p=a.detailContent,f=a.groupId,d=a.mGroupDetailShow,l=a.mGroupInfoNew,m=a.selectGroupInfo,"Group"===i&&c.group_id===r.group_id&&$dispatch(coreUi.updateSliderGroupInfo(r,u)),m.group_id===r.group_id&&coreUi.setSelectGroupInfo(r),"group"===p&&f===r.group_id&&$dispatch(coreUi.updateGroupInfoNew(r,u)),window.CLIENTCONFIG.ISMOBILE&&d&&l.group_id&&l.group_id===r.group_id&&$dispatch(coreUi.updateMGroupInfoNew(r,u)),s.info("刷新群组详情")}catch(e){s.error("reloadGroupInfoNew",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()},1875:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.queryAllFixGroupDiscuss=r.reloadGroupListData=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(243),c=coreLogger.getLogger("group")("list"),p=(r.reloadGroupListData=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t,n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=void 0,e.next=4,p();case 4:return t=e.sent,t=t.sort(function(e,r){return e.name.localeCompare(r.name)}),e.next=8,(0,s.queryAllGroup)();case 8:if(n=e.sent,$dispatch(coreUi.updataAllGroupList(n)),r=t.length>0,!(u=$getState().contactGroups.deletedGroupId)){e.next=21;break}a=0;case 14:if(!(a<t.length)){e.next=21;break}if(u!==t[a].group_id){e.next=18;break}return t.splice(a,1),e.abrupt("break",21);case 18:a++,e.next=14;break;case 21:i={hasGroup:r,groupList:t},$dispatch(coreUi.updateGroupListData(i)),c.info("刷新群组groupList","success"),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),c.error("reloadGroupListData",e.t0);case 29:case"end":return e.stop()}},e,void 0,[[0,26]])}));return function(){return e.apply(this,arguments)}}(),r.queryAllFixGroupDiscuss=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t,n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.info("get fixGroups and collected groups from local DB, query server group owner_name and save groupOwnerInfo to DB"),e.next=3,(0,s.queryAllGroup)();case 3:return r=e.sent,t=[],n=[],r.map(function(e){n.push(e.owner)}),c.info("need to query server, all groupOwner account list length: ",n&&n.length),e.next=10,coreContact.getContactListByAccountList(n,!0);case 10:return u=e.sent,c.info("all groupOwnerInfo from server, length :",u&&u.length),r.map(function(e,r){e.owner_name=u[r].name,e.group_type!==constant.GROUP_TYPE.FIXED_GROUP&&e.fix_discuss!==constant.FIX_DISCUSS.YES||t.push(e)}),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}())},1876:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.calGroupAndMemberListData=void 0;var u=t(69),o=n(u),a=t(142),i=n(a),s=t(3),c=n(s),p=t(139),f=n(p),d=t(1),l=n(d),m=t(2),g=n(m),_=t(243),v=t(287),G=t(972),y=t(595),x=coreLogger.getLogger("group")("increment"),h=(r.calGroupAndMemberListData=function(){var e=(0,g.default)(l.default.mark(function e(r){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=9;break}return e.next=3,h(r.im_group_list);case 3:return e.next=5,b(r.mem_updated_group_id_list);case 5:return e.next=7,(0,G.dealGroupMemberIncrement)(r.im_group_user_info_list,r.user_info_list,r.time_stamp);case 7:e.next=10;break;case 9:x.error("calGroupAndMemberListData info is null");case 10:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),function(){var e=(0,g.default)(l.default.mark(function e(r){var t,n,u,o,a,s,p,d,m,g;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,_.queryAllGroup)();case 3:return t=e.sent,r=r||[],n=[],u=r.length>0,o=[],a=[],x.info("calGroupListData","hasGroup:"+u),u&&(s=w(r),s.forEach(function(e){if(e.state===constant.CONTACT_GROUP_STATE.DELETE)x.info("calGroupListData delete group_id = "+e.id),o.push((0,v.deleteGroupInfoInDB)(e.id,!1)),o.push((0,y.deleteGroupAllMemberFromDB)(e.id)),a.push(coreIm.dealRecentByDeleteGroup(e.id));else{var r=t.query({group_id:e.id});e.sync_member_time="",isNullOrEmpty(r)?(x.info("calGroupListData add group_id = "+e.id),isNullOrEmpty(coreIm.getLocalRecent({owner:e.id}))||a.push(coreIm.dealRecentByAddGroup(e.id))):(x.info("calGroupListData update group_id = "+e.id),e.sync_member_time=r.sync_member_time,e.team_notify_is_read=r.team_notify_is_read,a.push(coreIm.dealRecentByAddGroup(e.id))),e.group_id=e.id,e.auto_join_flag=e.joint_flag,delete e.id,delete e.joint_flag,n.push((0,f.default)({},e))}})),e.next=12,c.default.all(o);case 12:return e.next=14,c.default.all(a);case 14:return e.next=16,(0,_.queryAllGroup)();case 16:return t=e.sent,p=[].concat((0,i.default)(t)).update(["group_id"],n),e.next=20,(0,v.saveGroupInfoList)(n);case 20:d=0;case 21:if(!(d<n.length)){e.next=32;break}return e.next=24,coreIm.getLocalRecent({owner:n[d].group_id});case 24:return m=e.sent,e.next=27,(0,_.getGroupInfoFromDB)(n[d].group_id);case 27:g=e.sent,isNullOrEmpty(g)?x.error("calGroupListData get group from DB fail, group_id = "+n[d].group_id):(m.group=g,m.is_disable=!1,coreIm.updateRecent(m));case 29:d++,e.next=21;break;case 32:return e.next=34,I(p);case 34:return e.abrupt("return",p);case 37:return e.prev=37,e.t0=e.catch(0),x.error("calGroupListData",e.t0),e.abrupt("return",[]);case 41:case"end":return e.stop()}},e,void 0,[[0,37]])}));return function(r){return e.apply(this,arguments)}}()),b=function(){var e=(0,g.default)(l.default.mark(function e(r){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x.info("saveMemebeUpdateGroupList mem_updated_group_id_list = "+(0,o.default)(r)),isNullOrEmpty(r)){e.next=4;break}return e.next=4,c.default.all(r.map(function(){var e=(0,g.default)(l.default.mark(function e(r){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.updateSyncMemberTimeOfGroupInfo)(r.group_id,"overdue");case 2:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),I=function(){var e=(0,g.default)(l.default.mark(function e(r){var t,n,u;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x.info("dealAllFixGroupDiscuss get fixed&fix_discuss groupList from allGroupList"),t=[],n=[],r.map(function(e){n.push(e.owner)}),e.next=6,coreContact.getContactListByAccountList(n,!0);case 6:return u=e.sent,r.map(function(e,r){e.owner_name=u[r].name,e.group_type!==constant.GROUP_TYPE.FIXED_GROUP&&e.fix_discuss!==constant.FIX_DISCUSS.YES||t.push(e)}),x.info("login init render groupList length : ",t.length),x.info("login init render allGroupList length : ",r.length),t=t.sort(function(e,r){return e.name.localeCompare(r.name)}),$dispatch(coreUi.updateGroupListData({groupList:t,allGroupList:r})),M(t),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),M=function(e){try{x.debug("dealSpecialGroups 筛选特别关注群组");var r=[];return e&&e.length>0&&e.forEach(function(e){e.isSpecial&&r.push(e)}),x.info("dealSpecialGroups","success"),$dispatch(coreUi.updateSpecialGroupListData(r)),r}catch(e){x.error("dealSpecialGroups",e)}},w=function(e){var r=[];return isNullOrEmpty(e)?(x.info("delGroupOperationRecord groupList empty!"),[]):(e.forEach(function(t){var n=e.queryList({id:t.id});if(1===n.length)r.push(t);else{for(var u=n[0],o=1;o<n.length;o++){var a=n[o];a.state===constant.CONTACT_GROUP_STATE.ADD&&(u=a)}isNullOrEmpty(r.query({id:t.id}))&&r.push(u)}}),r)}},1877:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.delGroupMemberLogic=r.deleteGroupMemberLogic=r.delDiscussionGroupMemberLogic=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=coreLogger.getLogger("group")("common");r.delDiscussionGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.isEserverOnline){e.next=4;break}return c.info("delDiscussionGroupMemberLogic, eserver is not login, return"),e.abrupt("return");case 4:return c.info("delDiscussionGroupMemberLogic","success"),e.next=7,(0,s.delMembers)(r,t);case 7:n=e.sent,u=n.result,0===u?coreGroup.setMarkDeleteGroupNotify({group_id:r.group_id,account:t,is_delete:!0}):1===u&&window.alert(language.FAILED_TO_DELETE),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),c.error("delDiscussionGroupMemberLogic",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(r,t){return e.apply(this,arguments)}}(),r.deleteGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.account,e.next=4,(0,s.delMembers)(r,n);case 4:u=e.sent,a=u.result,0!==a&&window.alert(language.FAILED_TO_DELETE),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),c.error("deleteGroupMember",e.t0);case 12:case"end":return e.stop()}},e,void 0,[[0,9]])}));return function(r,t){return e.apply(this,arguments)}}(),r.delGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t,n,u,a,i,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=$getState(),t=r.contactGroups.mGroupMemberList,n=r.contactGroups.mGroupMemberInfo,u=r.contactGroups.mGroupInfoNew,a=[],t.map(function(e,r){if(e.isSelected){a.push(e);var t=n.findIndex(function(r){return r.account===e.account});-1!==t&&n.splice(t,1)}}),i=t.findIndex(function(e){return!0===e.isSelected}),-1!==i&&t.splice(i,1),p=[],a.map(function(e){p.push(e.native_name)}),p.join(","),e.next=14,(0,s.bulkDelGroupMemberService)(a,u);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),c.error("delGroupMemberLogic",e.t0);case 19:case"end":return e.stop()}},e,void 0,[[0,16]])}));return function(){return e.apply(this,arguments)}}()},1878:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.addGroupMemberLogic=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=t(243),p=t(822),f=coreLogger.getLogger("group")("member");r.addGroupMemberLogic=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i,d,l,m,g,_,v,G,y,x,h,b,I;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEserverOnline("addGroupMemberLogic")){e.next=3;break}return e.abrupt("return");case 3:return f.info("addGroupMemberLogic groupId = "+r),t=$getState(),n=void 0,n=t.selectBox.selectBox_tempSelectedList,u=t.contactGroups.isShowGroupSlider,a=void 0,i=void 0,window.CLIENTCONFIG.ISMOBILE?(a=t.contactGroups.mGroupInfoNew,i=t.contactGroups.mGroupMemberInfo,(isNullOrEmpty(a)||isNullOrEmpty(i))&&(a=t.contactGroups.selectGroupInfo,i=t.contactGroups.selectGroupMember)):u?(a=t.contactGroups.selectGroupInfo,i=t.contactGroups.selectGroupMember):(a=t.contactGroups.groupInfoNew,i=t.contactGroups.groupMemberInfo,isNullOrEmpty(a)&&t.recent.currentRecentInfo.group&&(a=t.recent.currentRecentInfo.group,i=t.recent.currentGroupMemberList)),e.next=11,(0,c.getGroupInfoFromDB)(a.group_id);case 11:if(d=e.sent,isNullOrEmpty(d)&&f.error("addGroupMemberLogic get group from DB fail"),l=d.capacity,m=[],g=[],isNullOrEmpty(n)||(m=n.filter(function(e){if(isNullOrEmpty(e.account))return!1;var r=i.findIndex(function(r){return r.account===e.account});return-1===r||(g.push(i[r]),!1)})),0!==g.length&&(_=[],g.map(function(e){_.push(e.name)}),_.length>1&&(_=_.join(";")),v=language.EXIST_THIS_GROUP.format(_),(0,p.sendNotifyMessage)([{account:"",name:""}],a.group_id,v)),G=i.length,y=m.length,!(G+y>l)){e.next=22;break}return d.group_type===constant.GROUP_TYPE.FIXED_GROUP?alert(language.MEMBER_NUM_MAX):alert(language.MEMBER_NUM_MAX_DISCUSS_GROUP),e.abrupt("return");case 22:if(0===m.length){e.next=35;break}x=[],h=m.splitByNum(20),b=0;case 26:if(!(b<h.length)){e.next=34;break}return e.next=29,(0,s.bulkAddGroupMemberService)(h[b],a);case 29:I=e.sent,x=x.concat(I);case 31:b++,e.next=26;break;case 34:x&&x.length>0&&alert(x+language.FAILED_TO_BE_ADDED);case 35:f.info("addGroupMemberLogic","success"),e.next=41;break;case 38:e.prev=38,e.t0=e.catch(0),f.error("addGroupMemberLogic",e.t0);case 41:case"end":return e.stop()}},e,void 0,[[0,38]])}));return function(r){return e.apply(this,arguments)}}()},1879:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.openGroupDetailById=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(243),c=t(270),p=t(270),f=coreLogger.getLogger("group")("detail");r.openGroupDetailById=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("openGroupDetailById, group_id = "+r),coreCall.checkHasCall(),coreUi.showSearchPanel(!1),e.next=5,(0,s.getGroupInfoFromDB)(r);case 5:if(t=e.sent,!isNullOrEmpty(t)){e.next=9;break}return f.warn("openGroupDetailById get group from DB fail, need get from server"),e.abrupt("return");case 9:return f.info("openGroupDetailById getGroupById group_id = "+(isNullOrEmpty(t)?"isNullOrEmpty":t.group_id)),coreUi.setSelectGroupInfo(t),coreUi.setShowGroupSlider(!0),e.next=14,(0,c.getMemberListByGroupIdInQueue)(r);case 14:return n=e.sent,f.info("openGroupDetailById getMemberListByGroupIdInQueue  memberInfo.length= "+(isNullOrEmpty(n)?"isNullOrEmpty":n.length)),e.next=18,(0,c.sortGroupMember)(n,t);case 18:u=e.sent,f.info("openGroupDetailById sortGroupMember  groupMemberInfo.length= "+(isNullOrEmpty(u)?"isNullOrEmpty":u.length)),(0,p.createGroupMemberChangeEvent)(r,t.owner,u);case 21:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()},1880:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.createTeamFromSelectBox=r.changeMsgPolicyType=r.setGroupAnnounceText=r.modifyDisGroupAnnounce=r.getAnnounceLength=r.editGroupAnnounce=r.initGroupAnnounceInfo=void 0;var u=t(139),o=n(u),a=t(1),i=n(a),s=t(2),c=n(s),p=t(976),f=coreLogger.getLogger("group")("common");r.initGroupAnnounceInfo=function(){try{var e=$getState(),r=e.contactGroups.sliderDetailShow,t=void 0,n=void 0;r?(t=e.contactGroups.sliderGroupInfo.manifesto,n=isNullOrEmpty(t)?0:t.length,$dispatch(coreUi.initSliderGroupInfo(t,n))):(t=e.contactGroups.groupInfoNew.manifesto,n=isNullOrEmpty(t)?0:t.length,$dispatch(coreUi.initGroupInfo(t,n))),f.info("initGroupAnnounceInfo")}catch(e){f.error("initGroupAnnounceInfo",e.toJSON())}},r.editGroupAnnounce=function(){try{$getState().contactGroups.sliderDetailShow?$dispatch(coreUi.toSliderEditGroupAnnounce()):$dispatch(coreUi.toEditGroupAnnounce()),f.info("编辑群公告","success")}catch(e){f.error("editGroupAnnounce",e.toJSON())}},r.getAnnounceLength=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=r.length,!(n=$getState().contactGroups.sliderDetailShow)){e.next=8;break}return e.next=6,$dispatch(coreUi.getSliderGroupAnnounceLength(t));case 6:e.next=10;break;case 8:return e.next=10,$dispatch(coreUi.getGroupAnnounceLength(t));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),f.error("getAnnounceLength",e.t0.toJSON());case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(r){return e.apply(this,arguments)}}(),r.modifyDisGroupAnnounce=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,a,s,c,p,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.isEserverOnline){e.next=4;break}return f.info("modifyDisGroupAnnounce, eserver is not login, return"),e.abrupt("return");case 4:return t=$getState().contactGroups,n=t.isShowGroupSlider,u=t.selectGroupInfo,a=$getState().recent.currentRecentInfo,s=void 0,r=coreCommon.filterSensitiveWord(r),s=n?u:a.group,isNullOrEmpty(d)||(s=(0,o.default)({},d)),e.next=12,coreGroup.modifyDisGroupInfo({oldGroupInfo:s,newGroupInfo:{manifesto:r}});case 12:c=e.sent,c?(f.info("PC send group announcement message"),p={html:r,mediaType:constant.MEDIA_TYPE.TEXT,text:r,sub_msg_type:constant.MSGSUBFLAG.ANNOUNCEMENT},isNullOrEmpty(r.trim())||(window.CLIENTCONFIG.ISMOBILE?coreIm.sendMobileTextMessage(p):coreIm.sendNormalMessage(p))):window.alert(language.MODIFY_ANNOUNCEMENT_FAIL),f.info("update team notice"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),f.error("modifyDisGroupAnnounce",e.t0.toJSON());case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(r){return e.apply(this,arguments)}}(),r.setGroupAnnounceText=function(){var e=(0,c.default)(i.default.mark(function e(r){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.isEserverOnline){e.next=4;break}return f.info("setGroupAnnounceText, eserver is not login, return"),e.abrupt("return");case 4:if(!(t=$getState().contactGroups.sliderDetailShow)){e.next=10;break}return e.next=8,$dispatch(coreUi.setSliderGroupAnnounce(r));case 8:e.next=12;break;case 10:return e.next=12,$dispatch(coreUi.setGroupAnnounce(r));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),f.error("setGroupAnnounceText",e.t0.toJSON());case 17:case"end":return e.stop()}},e,void 0,[[0,14]])}));return function(r){return e.apply(this,arguments)}}(),r.changeMsgPolicyType=function(){var e=(0,c.default)(i.default.mark(function e(r,t){var n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreGroup.modifyGroupMsgPolicyType({groupId:r,type:t});case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),f.error("changeMsgPolicyType",e.t0.toJSON());case 10:case"end":return e.stop()}},e,void 0,[[0,7]])}));return function(r,t){return e.apply(this,arguments)}}(),r.createTeamFromSelectBox=function(){var e=(0,c.default)(i.default.mark(function e(){var r,t,n,u,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(f.info("createTeamFromSelectBox"),coreIm.checkEserverOnline("createTeamFromSelectBox")){e.next=3;break}return e.abrupt("return");case 3:return r=$getState().selectBox.selectBox_tempSelectedList,t=$getState().myInfo,n=r.findIndex(function(e){return e.account===t.account}),u=!0,-1!==n&&r.splice(n,1),e.next=10,(0,p.createDiscussionGroup)(r,u);case 10:if(!((o=e.sent)instanceof Object)){e.next=20;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=17;break}return e.next=15,coreCommon.switchNav("recent");case 15:return e.next=17,coreIm.openGroupConversation({group_id:o.group_id});case 17:return e.abrupt("return",o);case 20:e.t0=o,e.next=1===e.t0?23:32===e.t0?25:35===e.t0?27:29;break;case 23:return window.alert(language.CREAT_FAIL),e.abrupt("break",30);case 25:return window.alert(language.CREATE_GROUP_MAXNUM),e.abrupt("break",30);case 27:return window.alert(language.CREATE_DISCUSS_MAXNUM),e.abrupt("break",30);case 29:return e.abrupt("break",30);case 30:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},1881:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.changeGroupType=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=coreLogger.getLogger("group")("common");r.changeGroupType=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t,n,u,a,i,p,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.info("userClick  upgrade to fixedgroup"),e.prev=1,coreIm.checkEserverOnline("changeGroupType")){e.next=4;break}return e.abrupt("return");case 4:return r=$getState(),t=r.contactGroups.sliderDetailShow,n=void 0,!1===t&&(n=r.contactGroups.groupInfoNew,isNullOrEmpty(n)&&r.recent.currentRecentInfo.group&&(n=r.recent.currentRecentInfo.group)),t&&(n=r.contactGroups.sliderGroupInfo),window.CLIENTCONFIG.ISMOBILE&&(n=r.contactGroups.mGroupInfoNew),isNullOrEmpty(f)||(n=f),u=n.group_id,a=n.group_type,i=void 0,i=0===a?1:0,e.next=17,(0,s.changeGroupTypeService)(u,i);case 17:if(p=e.sent,1!==p.result){e.next=24;break}return p.param&&37===p.param.reason?alert(language.FIX_DISCUSS_FAIL_MEMBER_MAXNUM):alert(language.FIX_DISCUSS_FAIL_MAXUM),c.info("changeGroupType fail, reason = "+p.reason),e.abrupt("return");case 24:c.info("讨论组转固定群成功！"),window.ToastNew(language.ALREADY_UPGRADE_TO_FIXEDGROUP,2,!1);case 26:c.info("changeGroupType"),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(1),c.error("changeGroupType",e.t0);case 32:case"end":return e.stop()}},e,void 0,[[1,29]])}));return function(){return e.apply(this,arguments)}}()},1882:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.exitOrDeleteGroup=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=coreLogger.getLogger("group")("common");r.exitOrDeleteGroup=function(){var e=(0,i.default)(o.default.mark(function e(r,t,n){var u,a,i,p,f,d,l,m,g,_=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,v=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.isEserverOnline){e.next=4;break}return c.info("exitOrDeleteGroup, eserver is not login, return"),e.abrupt("return");case 4:if(u=$getState(),a=void 0,i=_||$getState().contactGroups.selectGroupInfo,r!==constant.EXIT_OR_DISSOLUTION_GROUP.EXIT_GROUP){e.next=23;break}if(p=$getState().recent.currentGroupMemberList,f=v||(p.length>1?p[0].account===$getState().myInfo.account?p[1]:p[0]:""),!(d=i.owner===$getState().myInfo.account)||isNullOrEmpty(f)){e.next=17;break}return e.next=14,coreUi.transferGroupOwner(i,i.group_id,f.account)();case 14:if(!1!==(l=e.sent)){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,(0,s.exitGroupService)(t,n);case 19:a=e.sent,a?a&&coreUi.updateDeletedGroupId(i.group_id):window.alert(language.EXIT_GROUP_FAIL),e.next=28;break;case 23:if(r!==constant.EXIT_OR_DISSOLUTION_GROUP.DISSOLUTION_GROUP){e.next=28;break}return e.next=26,(0,s.deleteGroupService)(t,n);case 26:a=e.sent,a||window.alert(language.DISMISS_GROUP_FAIL);case 28:if(!a){e.next=35;break}return m=u.conf.groupId,m===t&&$dispatch(coreUi.changeGroupId("")),e.next=33,coreIm.getLocalRecent({owner:t});case 33:g=e.sent,g.stick_on_top&&coreIm.fixGroupToTop(i);case 35:c.info("退出/解散群组"),e.next=41;break;case 38:e.prev=38,e.t0=e.catch(0),c.error("exitOrDeleteGroup",e.t0);case 41:case"end":return e.stop()}},e,void 0,[[0,38]])}));return function(r,t,n){return e.apply(this,arguments)}}()},1883:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.setDisGroupPolicy=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=t(243),p=t(287),f=coreLogger.getLogger("logic")("group/setDisGroupPolicy");r.setDisGroupPolicy=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.isEserverOnline){e.next=4;break}return f.info("setDisGroupPolicy 当前处于离线状态"),e.abrupt("return");case 4:return f.info("userClick  setDisGroupPolicy 固化讨论组",t),n=void 0,n=t?1:0,e.next=9,(0,s.setDisgroupPolicy)(r,n);case 9:if(u=e.sent,0!==u.result){e.next=24;break}return e.next=13,(0,c.getGroupInfoFromDB)(r);case 13:if(a=e.sent,!isNullOrEmpty(a)){e.next=18;break}f.error("setDisGroupPolicy get group from DB fail,need get from server"),e.next=22;break;case 18:return a.fix_discuss=n,f.info("setDisGroupPolicy save groupInfo"),e.next=22,(0,p.saveGroupInfo)(a);case 22:e.next=25;break;case 24:t?window.alert(language.DISCUSS_SAVE_LOCAL_FAILED):window.alert(language.DISCUSS_CANCEL_SAVE_LOCAL_FAILED);case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),f.error("setDisGroupPolicy",e.t0.toString());case 30:case"end":return e.stop()}},e,void 0,[[0,27]])}));return function(r,t){return e.apply(this,arguments)}}()},1884:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.searchFixedGroupsLogic=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=coreLogger.getLogger("logic")("searchFixedGroup"),p=(r.searchFixedGroupsLogic=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c.info("searchFixedGroupsLogic 查询固定群"),window.isEserverOnline){e.next=5;break}return c.info("searchFixedGroupsLogic  you are offline"),e.abrupt("return");case 5:return e.next=7,(0,s.searchFixedGroups)(n);case 7:if(!(r=e.sent)||r.result!==constant.ERROR_IM_GROUP_CODE.RESULT_IMGROUP_SUCCESS){e.next=13;break}return t=f(r.param.group_list),e.abrupt("return",{count:r.param.count,group_list:t,offset:r.param.offset,record_amount:r.param.record_amount});case 13:return c.error("searchFixedGroupsLogic 查询固定群失败",r&&r.result),e.abrupt("return",{result:r.result});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),c.error("searchFixedGroupsLogic",{error:e.t0.toJSON()});case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(){return e.apply(this,arguments)}}(),function(e){return isNullOrEmpty(e)?{}:{capacity:e.capacity,desc:e.desc,fix_discuss:e.fix_discuss,group_type:e.group_type,group_id:e.id,is_init_group_name:e.is_init_group_name,auto_join_flag:e.joint_flag,manifesto:e.manifesto,msg_policy_type:e.msg_policy_type,name:e.name,owner:e.owner,single_file_space:e.single_file_space,state:e.state}}),f=function(e){if(isNullOrEmpty(e))return[];var r=[];return e.forEach(function(e){var t=p(e);isNullOrEmpty(t)||r.push(t)}),r}},1885:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.createTeamSpace=r.applyToJoinFixedGroupLogic=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=t(270),p=t(287),f=coreLogger.getLogger("group")("fixedGroup");r.applyToJoinFixedGroupLogic=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i,p,d,l,m,g,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEserverOnline("applyToJoinFixedGroupLogic")){e.next=3;break}return e.abrupt("return");case 3:return f.info("applyToJoinFixedGroupLogic 申请加入固定群"),t=r.group_id,n=r.group_name,u=r.name,a=r.owner,e.next=7,(0,c.getMemberListByGroupIdInQueue)(t);case 7:i=e.sent,p=i.length,d=0;case 10:if(!(d<p)){e.next=18;break}if(i[d].account!==_){e.next=15;break}return d=p,alert(language.JOINED_GROUP),e.abrupt("return");case 15:d++,e.next=10;break;case 18:return e.next=20,coreGroup.searchFixedGroupsLogic({is_need_amount:1,offset:1,count:1,query_key:t,query_type:1});case 20:if(l=e.sent,l.record_amount){e.next=24;break}return alert(language.GROUP_ALREADY_DISMISS),e.abrupt("return");case 24:return m=void 0===n?u:n,e.next=27,(0,s.applyToJoinFixedGroup)(t,m,_);case 27:if(g=e.sent,g.result!==constant.ERROR_IM_GROUP_CODE.RESULT_IMGROUP_SUCCESS){e.next=33;break}return f.info("applyToJoinFixedGroupLogic 申请加入固定群成功"),e.abrupt("return","success");case 33:if(g.result!==constant.ERROR_IM_GROUP_CODE.RESULT_IMGROUP_WAITVERIFY){e.next=38;break}return f.info("applyToJoinFixedGroupLogic 申请加入固定群等待群主验证"),e.abrupt("return","waiting");case 38:return f.error("applyToJoinFixedGroupLogic 申请加入固定群失败"),e.abrupt("return","fail");case 40:e.next=45;break;case 42:e.prev=42,e.t0=e.catch(0),f.error("applyToJoinFixedGroupLogic",e.t0.toJSON());case 45:case"end":return e.stop()}},e,void 0,[[0,42]])}));return function(r){return e.apply(this,arguments)}}(),r.createTeamSpace=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("createTeamSpace"),t=r.group_id,n=r.group_type,u=r.name,a=r.owner,e.next=4,(0,s.openGroupSpace)({id:t,group_type:n,group_space_name:u,owner:a});case 4:if(!(i=e.sent)||0!==i.result){e.next=12;break}return r.group_space_id=i.param.group_space_id,e.next=9,(0,p.saveGroupInfo)(r);case 9:return e.abrupt("return",r);case 12:return f.error("createTeamSpace error.. ",i),e.abrupt("return",{});case 14:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()},1886:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.checkFixedGroupApply=r.dealApplyJoinFixedGroupResult=r.dealFixedGroupLeaveResult=r.dealFixedGroupOwnerInviteResult=r.dealReceiveInviteToFixedGroup=r.dealReceiveInviteJoinFixedGroup=r.dealFixedGroupAnnouncementChange=r.dealFixedGroupInfoChg=r.dealFixedGroupDismiss=r.dealFixedGroupOwnerChg=r.dealFixedGroupKickout=r.dealFixedGroupWasAddedToGroup=r.dealFixedGroupMemberAdd=r.dealFixedGroupMemberDel=void 0;var u=t(142),o=n(u),a=t(1),i=n(a),s=t(2),c=n(s),p=t(821),f=n(p),d=t(227),l=t(243),m=t(287),g=t(270),_=t(595),v=t(822),G=t(977),y=t(975),x=coreLogger.getLogger("group")("tupNotify");r.dealFixedGroupMemberDel=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,y,h,b,I,M,w,k,D,O,S,E,N,T,A,L,F;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.server_msg_id_str,o=t.member_account,a=t.admin_account,s=t.time_stamp,c=t.is_offline_msg,x.info("dealFixedGroupMemberDel group_id = "+n+",server_msg_id_str = "+u+",member_account = "+handleAccountPrint(o)+",admin_account = "+handleAccountPrint(a)+",time_stamp = "+s+",is_offline_msg = "+c),e.next=5,coreAccount.getLoginModel();case 5:return p=e.sent,y=p.isSupportAS,!isNullOrEmpty(s)&&"0"!==s&&y||(x.info("dealFixedGroupMemberDel time_stamp 0 or isNullOrEmpty",s),s=coreIm.localTimeService.getLocalTime()),h=$getState(),b=h.myInfo.account,I=o===b,e.next=13,(0,l.getGroupInfoFromDB)(n);case 13:if(M=e.sent,!isNullOrEmpty(M)){e.next=19;break}return x.warn("dealFixedGroupMemberDel get group from DB fail, need get from server, isSelf = "+I),e.next=18,(0,d.getGroupInfoFromServer)(n);case 18:M=e.sent;case 19:if(w=M.owner,k=f.default.getMarkExitGroupNotify(n),D=f.default.getMarkDeleteGroupNotify(n,o),!I){e.next=44;break}if(O=h.contactGroups,S=O.detailContent,E=O.groupId,N=O.sliderDetailShow,T=O.sliderContent,A=O.sliderGroupInfo,"group"===S&&E===n&&(coreUi.updateSelectedItemKey(-1),coreUi.updateContactGroupDetailShow("noContent")),!N||"Group"!==T||A.group_id!==n){e.next=28;break}return e.next=28,coreUi.updateSliderDetailShow(!1);case 28:if(!k){e.next=33;break}return e.next=31,(0,v.sendNotifyMessage)([{account:"",name:""}],n,"YOU_EXIT_TEAM_GROUP_CHAT",s);case 31:e.next=35;break;case 33:return e.next=35,(0,v.sendNotifyMessage)([{account:a,name:""}],n,"OTHER_MOVE_YOU_TEAM_CHAT",s);case 35:if(1===c){e.next=42;break}return e.next=38,(0,_.deleteGroupAllMemberFromDB)(n);case 38:return e.next=40,(0,m.deleteGroupInfoInDB)(n);case 40:L=h.conf.groupId,L===n&&coreConf.changeGroupId("");case 42:e.next=53;break;case 44:return F=void 0,F=D&&w===b?"YOU_MOVE_OTHER_TEAM_CHAT":"EXIT_TEAM_GROUP_CHAT",e.next=48,(0,v.sendNotifyMessage)([{account:o,name:""}],n,F,s);case 48:if(1===c){e.next=53;break}if(isNullOrEmpty(M&&M.sync_member_time)||-1!==M.sync_member_time.indexOf("overdue")){e.next=53;break}return x.info("dealFixedGroupMemberDel get group member already sync"),e.next=53,(0,_.deleteGroupMemberFromDB)(n,o);case 53:1!==c&&(0,g.createGroupMemberChangeEvent)(n,w),(0,G.loadGroupAvatarMembersByGroupId)(n),"0"!==u&&coreCommon.setGroupNotifyRead(u,n),e.next=62;break;case 58:e.prev=58,e.t0=e.catch(0),x.error("dealFixedGroupMemberDel",e.t0.toString()),x.debug("dealFixedGroupMemberDel",e.t0);case 62:case"end":return e.stop()}},e,void 0,[[0,58]])}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupMemberAdd=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,a,s,c,p,f,d,m,y,h,b,I,M,w,k;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=r.param,n=t.group_id,u=t.member_account,a=t.updatedGroupMembers,s=t.init_invite_account,c=t.server_msg_id_str,p=t.time_stamp,f=t.is_offline_msg,x.info("dealFixedGroupMemberAdd,group_id = "+n+",updatedGroupMembers length = "+(a&&a.length)+",member_account = "+handleAccountPrint(u)+",admin_account = "+handleAccountPrint(r.param.admin_account)+",init_invite_account = "+handleAccountPrint(s)+",server_msg_id_str = "+c+",time_stamp = "+p+",is_offline_msg = "+f),d=$getState(),m=d.myInfo.account,y=isNullOrEmpty(a)?u:a[0].account,h=y===m,b=[],!isNullOrEmpty(a)){e.next=16;break}return x.info("dealFixedGroupMemberAdd the member list is null!"),e.next=12,coreContact.getContactListByAccountList([u]);case 12:I=e.sent,b=[{account:u,name:isNullOrEmpty(I)?"":I[0].name}],e.next=17;break;case 16:b=[].concat((0,o.default)(a));case 17:if(!h){e.next=20;break}e.next=45;break;case 20:if(1===f){e.next=32;break}return e.next=23,(0,l.getGroupInfoFromDB)(n);case 23:if(M=e.sent,!isNullOrEmpty(M)){e.next=27;break}return x.error("dealFixedGroupMemberAdd get group from DB fail,so return"),e.abrupt("return");case 27:if(isNullOrEmpty(M&&M.sync_member_time)||-1!==M.sync_member_time.indexOf("overdue")){e.next=31;break}return x.info("dealFixedGroupMemberAdd group already sync member"),e.next=31,(0,_.saveGroupMemberToDB)(n,b);case 31:(0,g.createGroupMemberChangeEvent)(n,M.owner);case 32:return e.next=34,coreAccount.getLoginModel();case 34:if(w=e.sent,k=w.isSupportAS,!isNullOrEmpty(p)&&"0"!==p&&k||(x.info("dealFixedGroupMemberAdd time_stamp 0 or isNullOrEmpty",p),p=coreIm.localTimeService.getLocalTime()),s!==m){e.next=42;break}return e.next=40,(0,v.sendNotifyMessage)(b,n,"TEAM_MY_INVITE",p);case 40:e.next=45;break;case 42:return x.info("dealFixedGroupMemberAdd  init_invite_account"),e.next=45,(0,v.sendNotifyMessage)(b,n,"TEAM_MEMBER_INVITE_OTHER",p);case 45:(0,G.loadGroupAvatarMembersByGroupId)(n),"0"!==c&&coreCommon.setGroupNotifyRead(c,n),e.next=52;break;case 49:e.prev=49,e.t0=e.catch(0),x.error("dealFixedGroupMemberAdd",e.t0);case 52:case"end":return e.stop()}},e,void 0,[[0,49]])}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupWasAddedToGroup=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,_,y;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.updatedGroupMembers,o=t.server_msg_id_str,a=t.time_stamp,s=t.is_offline_msg,x.info("dealFixedGroupWasAddedToGroup group_id = "+n+",updatedGroupMembers length = "+(u&&u.length)+",server_msg_id_str = "+o+",time_stamp = "+a+",is_offline_msg = "+s),e.next=5,coreAccount.getLoginModel();case 5:if(c=e.sent,p=c.isSupportAS,!isNullOrEmpty(a)&&"0"!==a&&p||(x.info("dealFixedGroupWasAddedToGroup time_stamp 0 or isNullOrEmpty",a),a=coreIm.localTimeService.getLocalTime()),1===s){e.next=28;break}return e.next=11,(0,l.getGroupInfoFromDB)(n);case 11:if(f=e.sent,!isNullOrEmpty(f)){e.next=20;break}return x.info("dealFixedGroupWasAddedToGroup get group from db fail,need get from server"),e.next=16,(0,d.getGroupInfoFromServer)(n);case 16:return f=e.sent,x.info("dealFixedGroupWasAddedToGroup save groupInfo"),e.next=20,(0,m.saveGroupInfo)(f);case 20:return e.next=22,(0,g.getMemberListByGroupIdInQueue)(n);case 22:return _=e.sent,(0,g.createGroupMemberChangeEvent)(n,f.owner),y=$getState().recent.currentRecentInfo,isNullOrEmpty(y)||isNullOrEmpty(y.group)||!y.group.group_id||n!==y.group.group_id||(y.group=f,coreUi.freshImExtMemberList(_),$dispatch(coreUi.selectRecentItem(y))),e.next=28,coreIm.dealRecentByAddGroup(n);case 28:(0,v.sendNotifyMessage)(u,n,"JOINED_GROUP",a),(0,G.loadGroupAvatarMembersByGroupId)(n),"0"!==o&&coreCommon.setGroupNotifyRead(o,n),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(0),x.error("dealFixedGroupWasAddedToGroup",e.t0);case 36:case"end":return e.stop()}},e,void 0,[[0,33]])}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupKickout=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,d,v,y,h,b,I,M;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=r.param,n=t.group_id,u=t.server_msg_id_str,o=t.member_account,a=t.is_offline_msg,x.info("dealFixedGroupKickout group_id = "+n+",server_msg_id_str = "+u+",member_account = "+handleAccountPrint(o)+",is_offline_msg = "+a),s=$getState(),c=s.myInfo.account,p=s.conf.groupId,!(f=o===c)){e.next=19;break}if(d=s.contactGroups,v=d.detailContent,y=d.groupId,h=d.sliderDetailShow,b=d.sliderContent,I=d.sliderGroupInfo,"group"===v&&y===n&&(coreUi.updateSelectedItemKey(-1),coreUi.updateContactGroupDetailShow("noContent")),!h||"Group"!==b||I.group_id!==n){e.next=13;break}return e.next=13,coreUi.updateSliderDetailShow(!1);case 13:if(1===a){e.next=17;break}return e.next=16,(0,m.deleteGroupInfoInDB)(n);case 16:p===n&&coreConf.changeGroupId("");case 17:e.next=28;break;case 19:if(1===a){e.next=28;break}return e.next=22,(0,l.getGroupInfoFromDB)(n);case 22:if(M=e.sent,isNullOrEmpty(M&&M.sync_member_time)||-1!==M.sync_member_time.indexOf("overdue")){e.next=27;break}return x.info("dealFixedGroupKickout get group member already sync"),e.next=27,(0,_.deleteGroupMemberFromDB)(n,o);case 27:(0,g.createGroupMemberChangeEvent)(n);case 28:(0,G.loadGroupAvatarMembersByGroupId)(n),"0"!==u&&coreCommon.setGroupNotifyRead(u,n),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(0),x.error("dealFixedGroupKickout",e.t0);case 35:case"end":return e.stop()}},e,void 0,[[0,32]])}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupOwnerChg=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,_,G,y,h,b;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.admin_account,u=t.group_id,o=t.server_msg_id_str,a=t.time_stamp,s=t.is_offline_msg,x.info("dealFixedGroupOwnerChg group_id = "+u+",admin_account = "+handleAccountPrint(n)+",server_msg_id_str = "+o+",time_stamp = "+a+",is_offline_msg = "+s),e.next=5,coreAccount.getLoginModel();case 5:return c=e.sent,p=c.isSupportAS,!isNullOrEmpty(a)&&"0"!==a&&p||(x.info("dealDiscussGroupDelMember time_stamp 0 or isNullOrEmpty",a),a=coreIm.localTimeService.getLocalTime()),f=$getState(),_=f.myInfo.account,G=n===_,e.next=13,coreDb.queryMessageList({recent_owner:u});case 13:if(y=e.sent,y.filter(function(e){return x.info("message.is_dealed_apply",e.is_dealed_apply),e.media_type===constant.MEDIA_TYPE.APPLY_JOIN_FIXED_GROUP_NOTIFY&&e.is_dealed_apply===constant.IS_DEALED_APPLY.NO}).map(function(e){e.is_dealed_apply=constant.IS_DEALED_APPLY.YES,coreIm.updateMessageList(e),coreDb.saveMessage(e)}),G?(0,v.sendNotifyMessage)([{account:"",name:""}],u,"YOU_BECOME_TEAM_OWNER",a,constant.MEDIA_TYPE.GROUP_NAME_CHANGE):(0,v.sendNotifyMessage)([{account:n,name:""}],u,"SOMEONE_BECOME_TEAM_OWNER",a,constant.MEDIA_TYPE.GROUP_NAME_CHANGE),1===s){e.next=30;break}return e.next=19,(0,l.getGroupInfoFromDB)(u);case 19:if(h=e.sent,!isNullOrEmpty(h)){e.next=23;break}return x.error("dealFixedGroupOwnerChg get group from DB fail, so return"),e.abrupt("return");case 23:return h.owner=n,x.info("dealFixedGroupOwnerChg save groupInfo"),e.next=27,(0,m.saveGroupInfo)(h);case 27:(0,g.createGroupMemberChangeEvent)(u,n),b=f.contactGroups.isExitGroup,b&&((0,d.exitGroupService)(h.group_id,h.group_type),coreUi.updateIsExitGroup(!1),window.goRoute("conversation"));case 30:"0"!==o&&coreCommon.setGroupNotifyRead(o,u),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(0),x.error("dealGroupOwnerChg",e.t0);case 36:case"end":return e.stop()}},e,void 0,[[0,33]])}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupDismiss=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,d,l,g,_,G,y,h,b,I,M;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.param,n=t.admin_account,u=t.group_id,o=t.server_msg_id_str,a=t.time_stamp,s=t.is_offline_msg,x.info("dealFixedGroupDismiss group_id = "+u+",admin_account = "+handleAccountPrint(n)+",server_msg_id_str = "+o+",time_stamp = "+a+",is_offline_msg = "+s),e.next=4,coreAccount.getLoginModel();case 4:if(c=e.sent,p=c.isSupportAS,!isNullOrEmpty(a)&&"0"!==a&&p||(x.info("dealDiscussGroupDelMember time_stamp 0 or isNullOrEmpty",a),a=coreIm.localTimeService.getLocalTime()),f=$getState(),d=f.myInfo.account,l=n===d,1===s){e.next=18;break}if(g=f.contactGroups,_=g.detailContent,G=g.groupId,y=g.sliderGroupInfo,h=g.sliderContent,b=g.sliderDetailShow,"group"===_&&G===u&&(coreUi.updateSelectedItemKey(-1),coreUi.updateContactGroupDetailShow("noContent")),!b||"Group"!==h||y.group_id!==u){e.next=16;break}return e.next=16,coreUi.updateSliderDetailShow(!1);case 16:I=f.conf.groupId,I===u&&coreConf.changeGroupId("");case 18:if(!l){e.next=29;break}return coreIm.deleteUnReadApplyGroupNotifyNumMap(u),e.next=22,(0,v.sendNotifyMessage)([{account:"",name:""}],u,"DISMISS_GROUP_CHAT",a);case 22:return e.next=24,coreDb.queryMessageList({recent_owner:u});case 24:M=e.sent,M.filter(function(e){return x.info("message.is_dealed_apply",e.is_dealed_apply),e.media_type===constant.MEDIA_TYPE.APPLY_JOIN_FIXED_GROUP_NOTIFY&&e.is_dealed_apply===constant.IS_DEALED_APPLY.NO}).map(function(e){e.is_dealed_apply=constant.IS_DEALED_APPLY.YES,coreIm.updateMessageList(e),coreDb.saveMessage(e)}),x.info("dealFixedGroupDismiss  解散群组后取消对入群验证的审批"),e.next=31;break;case 29:return e.next=31,(0,v.sendNotifyMessage)([{account:n,name:""}],u,"WAS_DISMISS_GROUP_CHAT",a);case 31:if(1===s){e.next=34;break}return e.next=34,(0,m.deleteGroupInfoInDB)(u);case 34:"0"!==o&&coreCommon.setGroupNotifyRead(o,u);case 35:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupInfoChg=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,g,_,G,h,b,I,M,w,k,D,O,S,E,N,T;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.server_msg_id_str,o=t.admin_account,a=t.group_name,s=t.time_stamp,c=t.is_offline_msg,p=t.modified_group_properties,x.info("dealFixedGroupInfoChg,group_id = "+n+",time_stamp = "+s+"\n      ,server_msg_id_str = "+u+",admin_account = "+handleAccountPrint(o)+"\n      ,is_offline_msg = "+c+",group_name = "+(a&&a.length)),e.next=5,coreAccount.getLoginModel();case 5:if(f=e.sent,g=f.isSupportAS,!isNullOrEmpty(s)&&"0"!==s&&g){e.next=12;break}return x.info("dealFixedGroupInfoChg time_stamp 0 or isNullOrEmpty",s),e.next=11,coreIm.localTimeService.getLocalTime();case 11:s=e.sent;case 12:if(c){e.next=49;break}return e.next=15,(0,l.getGroupInfoFromDB)(n);case 15:return _=e.sent,isNullOrEmpty(_)&&x.warn("dealFixedGroupInfoChg get group from db fail"),G=_.group_type,h=_.name,b=_.auto_join_flag,I=_.manifesto,e.next=20,(0,d.getGroupInfoFromServer)(n);case 20:if(M=e.sent,isNullOrEmpty(M)&&x.warn("dealFixedGroupInfoChg get group from server fail"),w=M.group_type,k=M.auto_join_flag,D=M.manifesto,x.info("dealFixedGroupInfoChg old_auto_join_flag,new_auto_join_flag,old_group_type,new_group_type",b,"-",k,"-",G,"-",w),I!==D?(O=$getState().myInfo.account,M.team_notify_is_read=o===O?constant.IS_READ.NO:_.team_notify_is_read,x.info("dealFixedGroupInfoChg, team_notify_is_read modified = "+M.team_notify_is_read)):(M.team_notify_is_read=_.team_notify_is_read,x.info("dealFixedGroupInfoChg, keep last team_notify_is_read value = "+M.team_notify_is_read)),G===w){e.next=34;break}if(x.info("群信息修改前后群组类型改变"),1!==G||0!==w){e.next=32;break}return a=h,M.name=h,e.next=32,(0,y.modifyDisGroupInfo)(M,{name:a});case 32:return e.next=34,(0,v.sendNotifyMessage)([{account:"",name:a}],n,"GROUP_UPGRADE_NOTIFY",s,constant.MEDIA_TYPE.UPGRADE_TO_FIXED_GROUP_NOTIFY);case 34:if(b===k){e.next=38;break}return x.info("群信息修改前后入群验证改变"),e.next=38,(0,v.sendNotifyMessage)([{account:"",name:""}],n,k?"NEED_ADMIN_COMMIT_INFO":"NEED_NOT_ADMIN_COMMIT_INFO",s);case 38:if(h===a){e.next=43;break}if(isNullOrEmpty(o)&&isNullOrEmpty(a)){e.next=43;break}return x.info("team group name has change"),e.next=43,(0,v.sendNotifyMessage)([{account:o,name:""},{account:"",name:a}],n,"CHANGE_TEAM_NAME_AS",s,constant.MEDIA_TYPE.GROUP_NAME_CHANGE);case 43:return x.info("dealFixedGroupInfoChg save groupInfo"),M.sync_member_time=_.sync_member_time,e.next=47,(0,m.saveGroupInfo)(M);case 47:e.next=63;break;case 49:if(!isNullOrEmpty(p)){e.next=52;break}return x.info("dealFixedGroupInfoChg, group_id = "+n+", no data"),e.abrupt("return");case 52:S=p[0],E=S.new_value,N=S.operator,T=S.property,e.t0=T,e.next=e.t0===constant.FIXED_GROUP_PROPERTY.GROUP_NAME?56:e.t0===constant.FIXED_GROUP_PROPERTY.GROUP_TYPE?58:e.t0===constant.FIXED_GROUP_PROPERTY.GROUP_VERIFICATION?60:62;break;case 56:return(0,v.sendNotifyMessage)([{account:o,name:""},{account:"",name:E}],n,"CHANGE_TEAM_NAME_AS",s,constant.MEDIA_TYPE.GROUP_NAME_CHANGE),e.abrupt("break",63);case 58:return(0,v.sendNotifyMessage)([{account:"",name:a}],n,"GROUP_UPGRADE_NOTIFY",s,constant.MEDIA_TYPE.UPGRADE_TO_FIXED_GROUP_NOTIFY),e.abrupt("break",63);case 60:return(0,v.sendNotifyMessage)([{account:"",name:""}],n,"0"===E?"NEED_NOT_ADMIN_COMMIT_INFO":"NEED_ADMIN_COMMIT_INFO",s),e.abrupt("break",63);case 62:return e.abrupt("break",63);case 63:"0"!==u&&coreCommon.setGroupNotifyRead(u,n),e.next=69;break;case 66:e.prev=66,e.t1=e.catch(0),x.error("dealFixedGroupInfoChg",e.t1);case 69:case"end":return e.stop()}},e,void 0,[[0,66]])}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupAnnouncementChange=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x.info("dealFixedGroupAnnouncementChange,group_id = "+r.group_id),t=r.group_id,e.next=5,(0,l.getGroupInfoFromDB)(t);case 5:if(n=e.sent,!isNullOrEmpty(n)){e.next=9;break}return x.error("dealFixedGroupAnnouncementChange get group from DB fail, so return"),e.abrupt("return");case 9:return e.next=11,(0,d.getGroupInfoFromServer)(t);case 11:return u=e.sent,isNullOrEmpty(u)||isNullOrEmpty(u.manifesto)?x.warn("dealFixedGroupAnnouncementChange get group from server fail"):n.manifesto=u.manifesto,n.team_notify_is_read=constant.IS_READ.NO,x.info("dealFixedGroupAnnouncementChange save groupInfo"),e.next=17,(0,m.saveGroupInfo)(n);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),x.error("dealFixedGroupAnnouncementChange",e.t0);case 22:case"end":return e.stop()}},e,void 0,[[0,19]])}));return function(r){return e.apply(this,arguments)}}(),r.dealReceiveInviteJoinFixedGroup=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.server_msg_id_str,o=t.member_account,a=t.time_stamp,x.info("dealReceiveInviteJoinFixedGroup group_id = "+n+",server_msg_id_str = "+u+",member_account = "+handleAccountPrint(o)+",time_stamp = "+a),e.next=5,coreAccount.getLoginModel();case 5:return s=e.sent,c=s.isSupportAS,!isNullOrEmpty(a)&&"0"!==a&&c||(x.info("dealReceiveInviteJoinFixedGroup time_stamp 0 or isNullOrEmpty",a),a=coreIm.localTimeService.getLocalTime()),e.next=10,(0,v.sendNotifyMessage)([{account:o,name:""}],n,"OTHER_APPLY_JOIN_GROUP",a,constant.MEDIA_TYPE.APPLY_JOIN_FIXED_GROUP_NOTIFY);case 10:"0"!==u&&coreCommon.setGroupNotifyRead(u,n),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),x.error("dealReceiveJoinGroup",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(r){return e.apply(this,arguments)}}(),r.dealReceiveInviteToFixedGroup=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=r.param,n=t.group_id,u=t.admin_account,o=t.group_name,a=t.server_msg_id_str,s=t.admin_name,x.info("dealReceiveInviteToFixedGroup group_id = "+n+",admin_account = "+handleAccountPrint(u)+",group_name length = "+(o&&o.length)+",server_msg_id_str = "+a+",admin_name length = "+(s&&s.length)),(0,d.confirmFixedGroupInvite)(1,{group_id:n,group_name:o,member_account:u,display_name:s}),"0"!==a&&coreCommon.setGroupNotifyRead(a,n)}catch(e){x.error("dealReceiveInviteToFixedGroup",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupOwnerInviteResult=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=r.param,n=t.group_id,u=t.server_msg_id_str,x.info("dealFixedGroupOwnerInviteResult group_id = "+n+",server_msg_id_str = "+u),"0"!==u&&coreCommon.setGroupNotifyRead(u,n)}catch(e){x.error("dealFixedGroupOwnerInviteResult",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.dealFixedGroupLeaveResult=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=r.param,n=t.group_id,u=t.server_msg_id_str,x.info("dealFixedGroupLeaveResult group_id = "+n+",server_msg_id_str = "+u)}catch(e){x.error("dealFixedGroupLeaveResult",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.dealApplyJoinFixedGroupResult=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,_,G,y,h;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.group_name,o=t.server_msg_id_str,a=t.agree_join,s=t.admin_account,c=t.time_stamp,p=t.is_offline_msg,x.info("dealApplyJoinFixedGroupResult group_id = "+n+",server_msg_id_str = "+o+",agree_join = "+a+",admin_account = "+handleAccountPrint(s)+",time_stamp = "+c+",is_offline_msg = "+p),e.next=5,coreAccount.getLoginModel();case 5:if(f=e.sent,_=f.isSupportAS,!isNullOrEmpty(c)&&"0"!==c&&_||(x.info("dealApplyJoinFixedGroupResult time_stamp 0 or isNullOrEmpty",c),c=coreIm.localTimeService.getLocalTime()),!a){e.next=32;break}if((0,v.sendNotifyMessage)([{account:"",name:""}],n,"JOINED_GROUP",c),1===p){e.next=30;break}return e.next=13,coreIm.dealRecentByAddGroup(n);case 13:return e.next=15,(0,l.getGroupInfoFromDB)(n);case 15:if(G=e.sent,!isNullOrEmpty(G)){e.next=24;break}return x.warn("dealApplyJoinFixedGroupResult get group from db fail,need get from server"),e.next=20,(0,d.getGroupInfoFromServer)(n);case 20:return G=e.sent,x.info("dealApplyJoinFixedGroupResult save groupInfo"),e.next=24,(0,m.saveGroupInfo)(G);case 24:return e.next=26,(0,g.getMemberListByGroupIdInQueue)(n);case 26:y=e.sent,(0,g.createGroupMemberChangeEvent)(n,s),h=$getState().recent.currentRecentInfo,isNullOrEmpty(h)||isNullOrEmpty(h.group)||!h.group.group_id||n!==h.group.group_id||(h.group=G,coreUi.freshImExtMemberList(y),$dispatch(coreUi.selectRecentItem(h)));case 30:e.next=35;break;case 32:if(!window.CLIENTCONFIG.ISMOBILE){e.next=35;break}return window.Banner(language.MOBILE_REFUSED_INFO.format(u),8),e.abrupt("return");case 35:"0"!==o&&coreCommon.setGroupNotifyRead(o,n),e.next=41;break;case 38:e.prev=38,e.t0=e.catch(0),x.error("dealApplyJoinFixedGroupResult",e.t0);case 41:case"end":return e.stop()}},e,void 0,[[0,38]])}));return function(r){return e.apply(this,arguments)}}(),r.checkFixedGroupApply=function(){var e=(0,c.default)(i.default.mark(function e(r,t,n){var u,o,a,s,c,p,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments[4];return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,x.info("checkFixedGroupApply","开始审批联系人加入群组请求"),u=t.group_id,o=t.group_name,a=t.time_stamp,(isNullOrEmpty(a)||"0"===a)&&(x.info("checkFixedGroupApply message time_stamp 0 or isNullOrEmpty",s),s=coreIm.localTimeService.getLocalTime()),coreIm.checkEserverOnline("checkFixedGroupApply")){e.next=7;break}return coreUi.hideModal(),e.abrupt("return");case 7:return e.next=9,(0,d.dealFixedGroupApply)({agree_join:r,group_id:u,group_name:o,member_account:n,display_name:f});case 9:return c=e.sent,t.is_dealed_apply=constant.IS_DEALED_APPLY.YES,x.info("message.is_dealed_apply",t.is_dealed_apply),coreIm.updateMessageListByClientId(t),coreUi.hideModal(),p=coreIm.getUnReadApplyGroupNotifyNumMap()[u],coreIm.updateUnReadApplyGroupNotifyNumMap(u,p-1),coreDb.saveMessage(t),0===c.result?(x.info("审批联系人加入请求操作成功"),r?(0,v.sendNotifyMessage)([{account:l,name:""}],u,"AGREE_APPLY",a):(0,v.sendNotifyMessage)([{account:l,name:""}],u,"REJECT_APPLY",a)):(x.info("审批联系人加入请求操作失败"),(0,v.sendNotifyMessage)([{account:l,name:""}],u,"FIAL_DEAL_APPLY",a)),e.abrupt("return",c);case 21:e.prev=21,e.t0=e.catch(0),x.error("error",e.t0);case 24:case"end":return e.stop()}},e,void 0,[[0,21]])}));return function(r,t,n){return e.apply(this,arguments)}}()},1887:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.dealDiscussGroupBroadcast=r.dealDiscussGroupInfoChg=r.dealDiscussGroupDismiss=r.dealDiscussGroupOwnerChange=r.dealDiscussGroupWasAddToGroup=r.dealDiscussGroupAddMember=r.dealDiscussGroupDelMember=void 0;var u=t(142),o=n(u),a=t(1),i=n(a),s=t(2),c=n(s),p=t(821),f=n(p),d=t(243),l=t(287),m=t(227),g=t(973),_=t(270),v=t(595),G=t(822),y=t(977),x=coreLogger.getLogger("group")("tupNotify");r.dealDiscussGroupDelMember=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,h,b,I,M,w,k,D,O,S,E,N,T,A,L,F;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.server_msg_id_str,o=t.member_account,a=t.time_stamp,x.info("dealDiscussGroupDelMember group_id = "+n+",server_msg_id_str = "+u+",member_account = "+handleAccountPrint(o)+",time_stamp = "+a),e.next=5,coreAccount.getLoginModel();case 5:return s=e.sent,c=s.isSupportAS,!isNullOrEmpty(a)&&"0"!==a&&c||(x.info("dealDiscussGroupDelMember time_stamp 0 or isNullOrEmpty",a),a=coreIm.localTimeService.getLocalTime()),(0,y.loadGroupAvatarMembersByGroupId)(n),x.info("dealDiscussGroupDelMember",handlePhoneNumber(o),o.length),p=$getState(),h=p.conf.groupId,b=p.myInfo.account,I=o===b,e.next=16,(0,d.getGroupInfoFromDB)(n);case 16:if(M=e.sent,!isNullOrEmpty(M)){e.next=22;break}return x.info("dealDiscussGroupDelMember get group from DB fail,need get from server"),e.next=21,(0,m.getGroupInfoFromServer)(n);case 21:M=e.sent;case 22:if(w=M.owner,k=f.default.getMarkExitGroupNotify(n),D=f.default.getMarkDeleteGroupNotify(n,o),!I){e.next=45;break}if(O=p.contactGroups,S=O.detailContent,E=O.groupId,N=O.sliderDetailShow,T=O.sliderContent,A=O.sliderGroupInfo,"group"===S&&E===n&&(coreUi.updateSelectedItemKey(-1),coreUi.updateContactGroupDetailShow("noContent")),h===n&&coreConf.changeGroupId(""),!N||"Group"!==T||A.group_id!==n){e.next=32;break}return e.next=32,coreUi.updateSliderDetailShow(!1);case 32:return e.next=34,(0,v.deleteGroupAllMemberFromDB)(n);case 34:if(!k){e.next=39;break}return e.next=37,(0,G.sendNotifyMessage)([{account:"",name:""}],n,"YOU_EXIT_DISCUSS_GROUP_CHAT",a);case 37:e.next=41;break;case 39:return e.next=41,(0,G.sendNotifyMessage)([{account:w,name:""}],n,"OTHER_MOVE_YOU_DISCUSS_CHAT",a);case 41:return e.next=43,(0,l.deleteGroupInfoInDB)(n);case 43:e.next=59;break;case 45:return L=void 0,L=D&&w===b?"YOU_MOVE_OTHER_DISCUSS_CHAT":"EXIT_DISCUSS_GROUP_CHAT",e.next=49,(0,G.sendNotifyMessage)([{account:o,name:""}],n,L,a);case 49:if(isNullOrEmpty(M&&M.sync_member_time)||-1!==M.sync_member_time.indexOf("overdue")){e.next=53;break}return x.info("dealDiscussGroupDelMember group member already sync member"),e.next=53,(0,v.deleteGroupMemberFromDB)(n,o);case 53:return e.next=55,(0,g.modifyGroupNameByMember)(M);case 55:return F=e.sent,x.info("dealDiscussGroupDelMember save groupInfo"),e.next=59,(0,l.saveGroupInfo)(F);case 59:(0,_.createGroupMemberChangeEvent)(n,w),e.next=65;break;case 62:e.prev=62,e.t0=e.catch(0),x.error("dealDiscussGroupDelMember",e.t0.toString());case 65:case"end":return e.stop()}},e,void 0,[[0,62]])}));return function(r){return e.apply(this,arguments)}}(),r.dealDiscussGroupAddMember=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,a,s,c,p,f,m,h,b,I,M;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.updatedGroupMembers,a=t.member_account,s=t.init_invite_account,c=t.server_msg_id_str,p=t.time_stamp,x.info("dealDiscussGroupAddMember,group_id = "+n+",updatedGroupMembers length = "+(u&&u.length)+",member_account = "+handleAccountPrint(a)+",init_invite_account = "+handleAccountPrint(s)+",server_msg_id_str = "+c+",time_stamp = "+p),e.next=5,coreAccount.getLoginModel();case 5:return f=e.sent,m=f.isSupportAS,!isNullOrEmpty(p)&&"0"!==p&&m||(x.info("dealDiscussGroupAddMember time_stamp 0 or isNullOrEmpty",p),p=coreIm.localTimeService.getLocalTime()),(0,y.loadGroupAvatarMembersByGroupId)(n),h=$getState(),b=h.myInfo.account,I=[],isNullOrEmpty(u)?(x.info("dealDiscussGroupAddMember the member list is null!"),I=[{account:a,name:""}]):I=[].concat((0,o.default)(u)),e.next=15,(0,d.getGroupInfoFromDB)(n);case 15:if(M=e.sent,!isNullOrEmpty(M)){e.next=19;break}return x.error("dealDiscussGroupAddMember get group from DB fail,so return"),e.abrupt("return");case 19:if(isNullOrEmpty(M&&M.sync_member_time)||-1!==M.sync_member_time.indexOf("overdue")){e.next=23;break}return x.info("dealDiscussGroupAddMember group already sync member"),e.next=23,(0,v.saveGroupMemberToDB)(n,I);case 23:return e.next=25,(0,g.modifyGroupNameByMember)(M);case 25:return M=e.sent,x.info("dealDiscussGroupAddMember save groupInfo"),e.next=29,(0,l.saveGroupInfo)(M);case 29:if(M=e.sent,(0,_.createGroupMemberChangeEvent)(n,M.owner),s!==b){e.next=36;break}return e.next=34,(0,G.sendNotifyMessage)(I,n,"DISCUSS_MY_INVITE",p);case 34:e.next=39;break;case 36:return I.unshift({account:s,name:""}),e.next=39,(0,G.sendNotifyMessage)(I,n,"DISCUSS_MEMBER_INVITE_OTHER",p);case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(0),x.error("dealDiscussGroupAddMember",e.t0);case 44:case"end":return e.stop()}},e,void 0,[[0,41]])}));return function(r){return e.apply(this,arguments)}}(),r.dealDiscussGroupWasAddToGroup=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,v,h,b,I,M,w,k;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.updatedGroupMembers,o=t.member_account,a=t.server_msg_id_str,s=t.admin_account,c=t.time_stamp,x.info("dealDiscussGroupWasAddToGroup,group_id = "+n+",updatedGroupMembers length = "+(u&&u.length)+",member_account = "+handleAccountPrint(o)+",server_msg_id_str = "+a+",admin_account = "+handleAccountPrint(s)+",time_stamp = "+c),p=$getState(),f=p.myInfo.account,e.next=7,(0,d.getGroupInfoFromDB)(n);case 7:if(v=e.sent,!isNullOrEmpty(v)){e.next=15;break}return x.info("dealDiscussGroupWasAddToGroup group is not in db, need get from server"),e.next=12,(0,m.getGroupInfoFromServer)(n);case 12:return v=e.sent,e.next=15,(0,l.saveGroupInfo)(v);case 15:return e.next=17,(0,_.getMemberListByGroupIdInQueue)(n);case 17:return h=e.sent,e.next=20,(0,g.modifyGroupNameByMember)(v,h);case 20:return b=e.sent,x.info("dealDiscussGroupWasAddToGroup save groupInfo"),e.next=24,(0,l.saveGroupInfo)(b);case 24:return b=e.sent,(0,y.loadGroupAvatarMembersByGroupId)(n),I=$getState().recent.currentRecentInfo,isNullOrEmpty(I)||isNullOrEmpty(I.group)||!I.group.group_id||n!==I.group.group_id||(I.group=b,coreUi.freshImExtMemberList(h),$dispatch(coreUi.selectRecentItem(I))),e.next=30,coreIm.getLocalRecent({owner:n});case 30:if(M=e.sent,isNullOrEmpty(M)||(M.group=b,M.is_disable=!1,coreDb.saveRecent(M),coreIm.updateRecent(M)),(0,_.createGroupMemberChangeEvent)(n,b.owner),s===f){e.next=40;break}return e.next=36,coreAccount.getLoginModel();case 36:w=e.sent,k=w.isSupportAS,!isNullOrEmpty(c)&&"0"!==c&&k||(x.info("dealDiscussGroupWasAddToGroup time_stamp 0 or isNullOrEmpty",c),c=coreIm.localTimeService.getLocalTime()),(0,G.sendNotifyMessage)(h,n,"GROUP_MEMBER_INVITE_ME_TWO",c);case 40:e.next=45;break;case 42:e.prev=42,e.t0=e.catch(0),x.error("dealDiscussGroupWasAddToGroup",e.t0);case 45:case"end":return e.stop()}},e,void 0,[[0,42]])}));return function(r){return e.apply(this,arguments)}}(),r.dealDiscussGroupOwnerChange=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.admin_account,u=t.group_id,o=t.server_msg_id_str,x.info("dealFixedGroupOwnerChg group_id = "+u+",admin_account = "+handleAccountPrint(n)+",server_msg_id_str = "+o),(0,y.loadGroupAvatarMembersByGroupId)(u),e.next=6,(0,d.getGroupInfoFromDB)(u);case 6:if(a=e.sent,!isNullOrEmpty(a)){e.next=10;break}return x.error("dealFixedGroupOwnerChg get group from DB fail,so return"),e.abrupt("return");case 10:return a.owner=n,x.info("dealFixedGroupOwnerChg save groupInfo"),e.next=14,(0,l.saveGroupInfo)(a);case 14:(0,_.createGroupMemberChangeEvent)(u,n),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),x.error("dealGroupOwnerChg",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(r){return e.apply(this,arguments)}}(),r.dealDiscussGroupDismiss=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,g,_,v,h,b,I,M,w;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.server_msg_id_str,o=t.time_stamp,x.info("dealDiscussGroupDismiss,group_id = "+n+",server_msg_id_str = "+u+",time_stamp = "+o),e.next=5,coreAccount.getLoginModel();case 5:return a=e.sent,s=a.isSupportAS,!isNullOrEmpty(o)&&"0"!==o&&s||(x.info("dealDiscussGroupDismiss time_stamp 0 or isNullOrEmpty",o),o=coreIm.localTimeService.getLocalTime()),(0,y.loadGroupAvatarMembersByGroupId)(n),c=$getState(),p=c.contactGroups,f=p.detailContent,g=p.groupId,_=p.sliderGroupInfo,v=p.sliderContent,h=p.sliderDetailShow,b=c.myInfo.account,e.next=14,(0,d.getGroupInfoFromDB)(n);case 14:if(I=e.sent,!isNullOrEmpty(I)){e.next=20;break}return x.warn("dealDiscussGroupDismiss get group from DB fail, need get from server"),e.next=19,(0,m.getGroupInfoFromServer)(n);case 19:I=e.sent;case 20:if(M=I.owner,"group"===f&&g===n&&(coreUi.updateSelectedItemKey(-1),coreUi.updateContactGroupDetailShow("noContent")),!h||"Group"!==v||_.group_id!==n){e.next=25;break}return e.next=25,coreUi.updateSliderDetailShow(!1);case 25:if(w=c.conf.groupId,w===n&&coreConf.changeGroupId(""),M!==b){e.next=32;break}return e.next=30,(0,G.sendNotifyMessage)([{account:"",name:""}],n,"DISMISS_DISCUSS_CHAT",o);case 30:e.next=34;break;case 32:return e.next=34,(0,G.sendNotifyMessage)([{account:M,name:""}],n,"WAS_DISMISS_DISCUSS_CHAT",o);case 34:return e.next=36,(0,l.deleteGroupInfoInDB)(n);case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(0),x.error("dealFixedGroupDimissNotify",e.t0);case 41:case"end":return e.stop()}},e,void 0,[[0,38]])}));return function(r){return e.apply(this,arguments)}}(),r.dealDiscussGroupInfoChg=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u,o,a,s,c,p,f,g,_;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.param,n=t.group_id,u=t.init_invite_account,o=t.server_msg_id_str,a=t.time_stamp,x.info("dealDiscussGroupInfoChg, group_id = "+n+",time_stamp = "+a+",init_invite_account = "+handleAccountPrint(u)+",server_msg_id_str = "+o),e.next=5,(0,d.getGroupInfoFromDB)(n);case 5:return s=e.sent,isNullOrEmpty(s)&&x.warn("dealDiscussGroupInfoChg get group from db fail"),e.next=9,(0,m.getGroupInfoFromServer)(n);case 9:return c=e.sent,c.sync_member_time=s.sync_member_time,c.team_notify_is_read=s.team_notify_is_read,x.info("dealDiscussGroupInfoChg save groupInfo"),e.next=15,(0,l.saveGroupInfo)(c);case 15:if(p=s.name,f=c.name,p===f){e.next=25;break}return x.info("discuss group name has change!"),e.next=21,coreAccount.getLoginModel();case 21:g=e.sent,_=g.isSupportAS,!isNullOrEmpty(a)&&"0"!==a&&_||(x.info("dealDiscussGroupInfoChg time_stamp 0 or isNullOrEmpty",a),a=coreIm.localTimeService.getLocalTime()),(0,G.sendNotifyMessage)([{account:u,name:""},{account:"",name:f}],n,"CHANGE_DISCUSS_NAME_AS",a,constant.MEDIA_TYPE.GROUP_NAME_CHANGE);case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),x.error("dealDiscussGroupInfoChg",e.t0);case 30:case"end":return e.stop()}},e,void 0,[[0,27]])}));return function(r){return e.apply(this,arguments)}}(),r.dealDiscussGroupBroadcast=function(){var e=(0,c.default)(i.default.mark(function e(r){var t,n,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=r.param,n=t.group_id,u=t.server_msg_id_str,x.info("dealDiscussGroupInfoChg group_id = "+n+",server_msg_id_str = "+u)}catch(e){x.error("dealDiscussGroupInfoChg",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()},1888:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.setDeleteSearchMenu=r.setDeleteSearchText=r.setDeleteSearchGroupMember=r.setmGroupTempName=r.mSetGroupName=r.mModifyDisGroupAnnounce=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=coreLogger.getLogger("group")("uiController");r.mModifyDisGroupAnnounce=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState(),n=t.contactGroups.mGroupInfoNew,e.next=4,coreGroup.modifyDisGroupInfo({oldGroupInfo:n,newGroupInfo:{manifesto:r}});case 4:u=e.sent,u?(s.info("Mobile send group announcement message"),a={html:""+r,mediaType:0,text:""+r,sub_msg_type:constant.MSGSUBFLAG.ANNOUNCEMENT},coreIm.sendNormalMessage(a)):window.alert(language.MODIFY_ANNOUNCEMENT_FAIL);case 6:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.mSetGroupName=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),n=t.contactGroups.mGroupInfoNew,u=r.trim(),0!==u.length){e.next=5;break}return e.abrupt("return");case 5:if(n.name===u){e.next=10;break}return e.next=8,coreGroup.modifyDisGroupInfo({oldGroupInfo:n,newGroupInfo:{name:u}});case 8:a=e.sent,a||window.alert(language.MODIFY_GROUP_NAME_FAIL);case 10:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.setmGroupTempName=function(e){try{$dispatch(coreUi.setGroupName(e))}catch(e){s.error("error",e)}},r.setDeleteSearchGroupMember=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t,n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=$getState(),t=r.contactGroups.mGroupMemberList,n=r.contactGroups.searchDeleteName,u=[],t.forEach(function(e){(e.name.includes(n)||e.account.includes(n))&&u.push(e)}),e.next=8,$dispatch(coreUi.setDeleteSearchGroupMember(u));case 8:isNullOrEmpty(n)&&$dispatch(coreUi.setDeleteNotSearchMenu()),s.info("searchGroupMemberList"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),s.error("searchGroupMemberList",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),r.setDeleteSearchText=function(e){return $dispatch(coreUi.setDeleteSearchText(e))},r.setDeleteSearchMenu=function(){return $dispatch(coreUi.setDeleteSearchMenu())}},1889:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dispatchToggleMuteNotify=r.dispatchSliderIsMuteNotify=r.dispatchIsMuteNotify=r.checkIsMuteNotify=void 0;var n=t(69),u=function(e){return e&&e.__esModule?e:{default:e}}(n),o=r.checkIsMuteNotify=function(e){var r=$getState().myInfo.account,t=coreCommon.sfLocalStorage(r),n=t.getItem("isMuteNotifyList");if(isNullOrEmpty(n)){var o=[];return o.unshift({account:e}),t.setItem("isMuteNotifyList",(0,u.default)(o)),!1}return a(e)},a=function(e){var r=$getState().myInfo.account,t=coreCommon.sfLocalStorage(r),n=t.getItem("isMuteNotifyList"),o=JSON.parse(n);for(var a in o)if(o[a].account===e){var i=o[a].isMuteNotify;return void 0!==i&&!1!==i}return o.unshift({account:e}),t.setItem("isMuteNotifyList",(0,u.default)(o)),!1},i=function(e){var r=$getState().myInfo.account,t=coreCommon.sfLocalStorage(r),n=o(e),a=t.getItem("isMuteNotifyList"),i=JSON.parse(a),c=s(i,e);return i.splice(c,1,{account:e,isMuteNotify:!n}),t.setItem("isMuteNotifyList",(0,u.default)(i)),!n},s=function(e,r){for(var t in e)if(e[t].account===r)return t};r.dispatchIsMuteNotify=function(e){var r=o(e);$dispatch(coreUi.updateIsMuteNotify(r))},r.dispatchSliderIsMuteNotify=function(e){var r=o(e);$dispatch(coreUi.updateSliderGroupIsMuteNotify(r))},r.dispatchToggleMuteNotify=function(e,r){var t=i(e);r?$dispatch(coreUi.updateSliderGroupIsMuteNotify(t)):$dispatch(coreUi.updateIsMuteNotify(t))}},1890:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var u=t(1),o=n(u),a=t(2),i=n(a),s=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.event,e.next="clearState"===e.t0?3:9;break;case 3:return t=coreCommon.TaskQueue.getInstance("groupServiceQueue"),t.clear(),n=coreCommon.TaskQueue.getInstance("groupMemberServiceQueue"),n.clear(),c.info("logout clear group queue task"),e.abrupt("break",10);case 9:return e.abrupt("break",10);case 10:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),c=coreLogger.getLogger("group")("moduleMessager");coreCommon.registeModuleListener("logout",s)},191:function(e,r,t){"use strict";var n=t(25).f,u=t(204),o=t(29),a=t(11),i=t(28),s=t(24),c=t(205),p=t(206),f=t(37),d=t(30),l=t(177).fastKey,m=t(166),g=d?"_s":"size",_=function(e,r){var t,n=l(r);if("F"!==n)return e._i[n];for(t=e._f;t;t=t.n)if(t.k==r)return t};e.exports={getConstructor:function(e,r,t,c){var p=e(function(e,n){i(e,p,r,"_i"),e._t=r,e._i=u(null),e._f=void 0,e._l=void 0,e[g]=0,void 0!=n&&s(n,t,e[c],e)});return o(p.prototype,{clear:function(){for(var e=m(this,r),t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var t=m(this,r),n=_(t,e);if(n){var u=n.n,o=n.p;delete t._i[n.i],n.r=!0,o&&(o.n=u),u&&(u.p=o),t._f==n&&(t._f=u),t._l==n&&(t._l=o),t[g]--}return!!n},forEach:function(e){m(this,r);for(var t,n=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!_(m(this,r),e)}}),d&&n(p.prototype,"size",{get:function(){return m(this,r)[g]}}),p},def:function(e,r,t){var n,u,o=_(e,r);return o?o.v=t:(e._l=o={i:u=l(r,!0),k:r,v:t,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[g]++,"F"!==u&&(e._i[u]=o)),e},getEntry:_,setStrong:function(e,r,t){c(e,r,function(e,t){this._t=m(e,r),this._k=t,this._l=void 0},function(){for(var e=this,r=e._k,t=e._l;t&&t.r;)t=t.p;return e._t&&(e._l=t=t?t.n:e._t._f)?"keys"==r?p(0,t.k):"values"==r?p(0,t.v):p(0,[t.k,t.v]):(e._t=void 0,p(1))},t?"entries":"values",!t,!0),f(r)}}},192:function(e,r,t){"use strict";var n=t(7),u=t(10),o=t(177),a=t(148),i=t(35),s=t(29),c=t(24),p=t(28),f=t(15),d=t(36),l=t(25).f,m=t(207)(0),g=t(30);e.exports=function(e,r,t,_,v,G){var y=n[e],x=y,h=v?"set":"add",b=x&&x.prototype,I={};return g&&"function"==typeof x&&(G||b.forEach&&!a(function(){(new x).entries().next()}))?(x=r(function(r,t){p(r,x,e,"_c"),r._c=new y,void 0!=t&&c(t,v,r[h],r)}),m("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var r="add"==e||"set"==e;e in b&&(!G||"clear"!=e)&&i(x.prototype,e,function(t,n){if(p(this,x,e),!r&&G&&!f(t))return"get"==e&&void 0;var u=this._c[e](0===t?0:t,n);return r?this:u})}),G||l(x.prototype,"size",{get:function(){return this._c.size}})):(x=_.getConstructor(r,e,v,h),s(x.prototype,t),o.NEED=!0),d(x,e),I[e]=x,u(u.G+u.W+u.F,I),G||_.setStrong(x,e,v),x}},193:function(e,r,t){var n=t(16),u=t(212);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return u(this)}}},194:function(e,r,t){"use strict";var n=t(10);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return new this(r)}})}},195:function(e,r,t){"use strict";var n=t(10),u=t(12),o=t(11),a=t(24);e.exports=function(e){n(n.S,e,{from:function(e){var r,t,n,i,s=arguments[1];return u(this),r=void 0!==s,r&&u(s),void 0==e?new this:(t=[],r?(n=0,i=o(s,arguments[2],2),a(e,!1,function(e){t.push(i(e,n++))})):a(e,!1,t.push,t),new this(t))}})}},201:function(e,r,t){e.exports={default:t(273),__esModule:!0}},204:function(e,r,t){e.exports=t(0)(133)},205:function(e,r,t){e.exports=t(0)(241)},206:function(e,r,t){e.exports=t(0)(589)},207:function(e,r,t){var n=t(11),u=t(208),o=t(141),a=t(27),i=t(209);e.exports=function(e,r){var t=1==e,s=2==e,c=3==e,p=4==e,f=6==e,d=5==e||f,l=r||i;return function(r,i,m){for(var g,_,v=o(r),G=u(v),y=n(i,m,3),x=a(G.length),h=0,b=t?l(r,x):s?l(r,0):void 0;x>h;h++)if((d||h in G)&&(g=G[h],_=y(g,h,v),e))if(t)b[h]=_;else if(_)switch(e){case 3:return!0;case 5:return g;case 6:return h;case 2:b.push(g)}else if(p)return!1;return f?-1:c||p?p:b}}},208:function(e,r,t){e.exports=t(0)(236)},209:function(e,r,t){var n=t(210);e.exports=function(e,r){return new(n(e))(r)}},210:function(e,r,t){var n=t(15),u=t(211),o=t(6)("species");e.exports=function(e){var r;return u(e)&&(r=e.constructor,"function"!=typeof r||r!==Array&&!u(r.prototype)||(r=void 0),n(r)&&null===(r=r[o])&&(r=void 0)),void 0===r?Array:r}},211:function(e,r,t){e.exports=t(0)(595)},212:function(e,r,t){var n=t(24);e.exports=function(e,r){var t=[];return n(e,!1,t.push,t,r),t}},227:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.openGroupSpace=r.addDiscussGroupMember=r.addDiscussGroup=r.dealFixedGroupApply=r.setGroupMsgPolicyType=r.transferFixedGroupService=r.transferDiscussionGroupService=r.fixedGroupChangeService=r.bulkAddGroupMember=r.addGroupPhoneMemberService=r.addGroupMemberService=r.bulkDelGroupMemberService=r.searchFixedGroups=r.joinFlagChgService=r.modifyFixedGroupInfoService=r.modifyDisGroupInfoService=r.deleteGroupService=r.exitGroupService=r.setDisgroupPolicy=r.bulkAddGroupMemberService=r.delMembers=r.changeGroupTypeService=r.confirmFixedGroupInvite=r.createDiscussGroup=r.createFixedGroup=r.applyToJoinFixedGroup=r.getGroupInfoFromServer=r.getGroupMemberList=void 0;var u=t(142),o=n(u),a=t(3),i=n(a),s=t(139),c=n(s),p=t(1),f=n(p),d=t(69),l=n(d),m=t(2),g=n(m),_=t(287),v=t(243),G=coreLogger.getLogger("group")("interface"),y=(r.getGroupMemberList=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n,u,o,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEServerOnlineNoToast("getGroupMemberList")){e.next=4;break}return G.info("tup_im_getfixedgroupmembers eserver offline, group_id = "+r),e.abrupt("return",{memberList:[],time_stamp:""});case 4:if(!isNullOrEmpty(r)){e.next=7;break}return G.error("tup_im_getfixedgroupmembers input group_id is null"),e.abrupt("return",{memberList:[],time_stamp:""});case 7:return G.info("tup_im_getfixedgroupmembers group_id = "+r+",time_stamp = "+i),e.next=10,coreTup.getIMInstance();case 10:return t=e.sent,e.next=13,t.getfixedgroupmembers({is_sync_all:isNullOrEmpty(i)?1:0,group_id:r||"",time_stamp:i});case 13:if(n=e.sent,n.result===constant.RESULT.SUCCESS){e.next=17;break}return G.error("tup_im_getfixedgroupmembers get failed,result",n.result),e.abrupt("return",{memberList:[],time_stamp:""});case 17:if(u=[],o=[],!n||!n.param||isNullOrEmpty(n.param.member_info)){e.next=26;break}return a=n.param.time_stamp,n.param.member_info.forEach(function(e){e.group_id=r,u.push(e),o.push(handleAccountPrint(e.account))}),G.info("tup_im_getfixedgroupmembers return member list = "+(0,l.default)(o)),e.abrupt("return",{memberList:u,time_stamp:a});case 26:if(!isNullOrEmpty(i)){e.next=31;break}return G.error("tup_im_getfixedgroupmembers no result",r),e.abrupt("return",{memberList:[],time_stamp:""});case 31:return G.warn("tup_im_getfixedgroupmembers no increment",r),e.abrupt("return",{memberList:[],time_stamp:i});case 33:e.next=39;break;case 35:return e.prev=35,e.t0=e.catch(0),G.error("tup_im_getfixedgroupmembers",e.t0.toString()),e.abrupt("return",{memberList:[],time_stamp:""});case 39:case"end":return e.stop()}},e,void 0,[[0,35]])}));return function(r){return e.apply(this,arguments)}}(),r.getGroupInfoFromServer=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n,u,o,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)){e.next=3;break}return G.error("tup_im_getfixedgroupdetail group_id is null"),e.abrupt("return",{});case 3:return G.info("tup_im_getfixedgroupdetail, group_id = "+r),e.next=6,coreTup.getIMInstance();case 6:return t=e.sent,e.next=9,t.getfixedgroupdetail({group_id:r});case 9:if(n=e.sent,!isNullOrEmpty(n)){e.next=13;break}return G.error("tup_im_getfixedgroupdetail return data is null, group_id  = "+r),e.abrupt("return",{});case 13:if(u=n.param,(o=n.result)!==constant.RESULT.SUCCESS){e.next=23;break}if(G.info("tup_im_getfixedgroupdetail suc,group_id = "+u.id+",auto_join_flag = "+u.joint_flag+",capacity = "+u.capacity+",desc = "+(u.desc&&u.desc.length)+",fix_discuss = "+u.fix_discuss+",group_space_id = "+u.group_space_id+",group_space_name = "+(u.group_space_name&&u.group_space_name.length)+",group_type = "+u.group_type+",is_init_group_name = "+u.is_init_group_name+",manifesto = "+(u.manifesto&&u.manifesto.length)+",msg_policy_type = "+u.msg_policy_type+",owner = "+handleAccountPrint(u.owner)+",single_file_space = "+u.single_file_space+",state = "+u.state+",name length = "+(u.name&&u.name.length)),a=(0,c.default)({},u),!u.id){e.next=23;break}return delete a.id,delete a.joint_flag,a.group_id=u.id,a.auto_join_flag=u.joint_flag,e.abrupt("return",a);case 23:return G.error("tup_im_getfixedgroupdetail failed,group_id = "+r+",errorcode = "+o),e.abrupt("return",{});case 25:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.applyToJoinFixedGroup=function(){var e=(0,g.default)(f.default.mark(function e(){var r,t,n,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("applyToJoinFixedGroup 用户申请加入固定群",u),e.next=4,coreTup.getIMInstance();case 4:return r=e.sent,t={group_id:u,group_name:o,display_name:a},e.next=8,r.joinfixedgroup(t);case 8:return n=e.sent,e.abrupt("return",n);case 12:e.prev=12,e.t0=e.catch(0),G.error("applyToJoinFixedGroup",{error:e.t0.toJSON()});case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),r.createFixedGroup=function(){var e=(0,g.default)(f.default.mark(function e(r){var t;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:return t=e.sent,e.next=5,t.addfixedgroup(r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.createDiscussGroup=function(){var e=(0,g.default)(f.default.mark(function e(r){var t;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:return t=e.sent,e.next=5,t.adddiscussiongroup(r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.confirmFixedGroupInvite=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o,a,i,s,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.group_id,u=t.group_name,o=t.member_account,a=t.display_name,G.info("confirmFixedGroupInvite 用户同意固定群邀请",r),e.next=5,coreTup.getIMInstance();case 5:return i=e.sent,s={agree_join:r,group_id:n,group_name:u,member_account:o,display_name:a},e.next=9,i.confirmfixedgroupinvite(s);case 9:return c=e.sent,e.abrupt("return",c);case 13:e.prev=13,e.t0=e.catch(0),G.error("error",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(r,t){return e.apply(this,arguments)}}(),r.changeGroupTypeService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(r)&&!isNullOrEmpty(t)){e.next=4;break}return G.error("tup_im_modify_group_type groupId or groupType is null"),e.abrupt("return",{});case 4:return G.info("tup_im_modify_group_type,group_id = "+r+",groupType = "+t),e.next=7,coreTup.getIMInstance();case 7:return n=e.sent,u={id:r,group_type:t},e.next=11,n.modifyGroupType(u);case 11:return o=e.sent,e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(0),G.error("error",e.t0);case 18:case"end":return e.stop()}},e,void 0,[[0,15]])}));return function(r,t){return e.apply(this,arguments)}}(),r.delMembers=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:if(n=e.sent,u=r.group_type,o=r.group_id,a=void 0,0!==u){e.next=12;break}return G.info("tup_im_delfixedgroupmember group_id = "+(r&&r.group_id)+",group_type = "+(r&&r.group_type)+",account = "+handleAccountPrint(t)),e.next=9,n.delfixedgroupmember({group_id:o,account:t});case 9:a=e.sent,e.next=20;break;case 12:if(1!==u){e.next=19;break}return G.info("tup_im_deldiscussiongroupmember group_id = "+(r&&r.group_id)+",group_type = "+(r&&r.group_type)+",account = "+handleAccountPrint(t)),e.next=16,n.deldiscussiongroupmember({group_id:o,account:t});case 16:a=e.sent,e.next=20;break;case 19:G.error("delMembers error group_type = "+(r&&r.group_type));case 20:return e.abrupt("return",a);case 21:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.bulkAddGroupMemberService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o,a,i,s,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)){e.next=3;break}return G.info("bulkAddGroupMemberService list is empty!"),e.abrupt("return",[]);case 3:return G.info("bulkAddGroupMemberService begin~ list length = "+r.length),e.next=6,coreTup.getIMInstance();case 6:if(n=e.sent,u=t.group_type,o=t.group_id,a=t.name,i=void 0,s=void 0,c=void 0,i=r.getKeyArr("account").join(";"),s={group_id:o,account:i,group_name:a,display_name:a},0!==u){e.next=17;break}return e.next=14,n.addfixedgroupmember(s);case 14:c=e.sent,e.next=21;break;case 17:if(1!==u){e.next=21;break}return e.next=20,n.adddiscussiongroupmember(s);case 20:c=e.sent;case 21:if(null!==c){e.next=24;break}return G.error("addGroupMember request timeout"),e.abrupt("return",[]);case 24:return c.result!==constant.RESULT.SUCCESS&&(G.error("addGroupMember fail"),coreGroup.clearMarkDeleteGroupNotify()),G.info("批量添加群组成员"),e.abrupt("return",[]);case 27:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.setDisgroupPolicy=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:return n=e.sent,e.next=5,n.setDisgroupPolicy({group_id:r,policy:t});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.exitGroupService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)&&!isNullOrEmpty(t)){e.next=3;break}return G.error("exitGroupService group_id or groupType is null"),e.abrupt("return",!1);case 3:return G.info("exitGroupService group_id = "+r+",groupType = "+t),e.next=6,coreTup.getIMInstance();case 6:if(n=e.sent,u=void 0,0!==t){e.next=14;break}return e.next=11,n.leavefixedgroup({arg:r});case 11:u=e.sent,e.next=17;break;case 14:return e.next=16,n.leavediscussiongroup({group_id:r});case 16:u=e.sent;case 17:return 0===u.result?coreGroup.setMarkExitGroupNotify({groupId:r,isExit:!0}):coreGroup.clearMarkExitGroupNotify(),e.abrupt("return",0===u.result);case 19:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.deleteGroupService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)&&!isNullOrEmpty(t)){e.next=3;break}return G.error("deleteGroupService group_id or groupType is null"),e.abrupt("return",!1);case 3:return G.info("deleteGroupService group_id = "+r+",groupType = "+t),e.next=6,coreTup.getIMInstance();case 6:if(n=e.sent,u=void 0,0!==t){e.next=14;break}return e.next=11,n.delfixedgroup(r);case 11:u=e.sent,e.next=17;break;case 14:return e.next=16,n.deldiscussiongroup(r);case 16:u=e.sent;case 17:return e.abrupt("return",0===u.result);case 18:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.modifyDisGroupInfoService=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||0!==r.group_type){e.next=2;break}return e.abrupt("return",y(r));case 2:return e.next=4,coreTup.getIMInstance();case 4:return t=e.sent,e.next=7,t.moddiscussiongroup(r);case 7:return n=e.sent,e.abrupt("return",0===n.result);case 9:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.modifyFixedGroupInfoService=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:return t=e.sent,e.next=5,t.modfixedgroup(r);case 5:return n=e.sent,e.abrupt("return",0===n.result);case 7:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}());r.joinFlagChgService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:return n=e.sent,e.next=5,n.modfixedgroup({id:r.group_id,name:r.name,capacity:r.capacity,manifesto:r.manifesto,desc:r.desc,owner:r.owner,auto_join_flag:t,msg_policy_type:r.msg_policy_type,group_type:r.group_type,fix_discuss:r.fix_discuss,state:r.state});case 5:return u=e.sent,o=0===u.result,e.abrupt("return",o);case 8:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.searchFixedGroups=function(){var e=(0,g.default)(f.default.mark(function e(){var r,t,n,u,o,a,i,s,c,p,d,l,m,g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("searchFixedGroups 查询固定群"),r=g.is_need_amount,t=void 0===r?1:r,n=g.offset,u=void 0===n?0:n,o=g.count,a=void 0===o?20:o,i=g.query_key,s=void 0===i?"":i,c=g.query_type,p=void 0===c?2:c,e.next=5,coreTup.getIMInstance();case 5:return d=e.sent,l={is_need_amount:t,offset:u,count:a,query_key:s,query_type:p},e.next=9,d.getfixedgroups(l);case 9:return m=e.sent,e.abrupt("return",m);case 13:e.prev=13,e.t0=e.catch(0),G.error("searchFixedGroups",{error:e.t0.toJSON()});case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(){return e.apply(this,arguments)}}(),r.bulkDelGroupMemberService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o,a,s,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:return n=e.sent,u=t.group_type,o=t.group_id,a=t.name,s=[],e.next=7,r.forEach(function(e){var r={group_id:o,account:e.account,group_name:a,display_name:a},t=void 0;t=0===u?n.delfixedgroupmember(r):n.deldiscussiongroupmember(r),s.push(t)});case 7:return e.next=9,i.default.all(s);case 9:c=e.sent,c.forEach(function(e){e.result===constant.ERROR_CODE.Success?G.info("删除成功"):G.info("删除失败")}),G.info("info");case 12:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.addGroupMemberService=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n,u,o,a,i,s;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.groupType,n=r.groupId,u=r.account,o=r.groupName,a=r.displayName,i={group_id:n,account:u,group_name:o,display_name:a},e.next=5,coreTup.getIMInstance();case 5:if(s=e.sent,0!==t){e.next=11;break}return G.info("addGroupMemberService","addfixedgroupmember"),e.next=10,s.addfixedgroupmember(i);case 10:return e.abrupt("return",e.sent);case 11:return G.info("addGroupMemberService","adddiscussiongroupmember"),e.next=14,s.adddiscussiongroupmember(i);case 14:return e.abrupt("return",e.sent);case 17:e.prev=17,e.t0=e.catch(0),G.error("error",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(r){return e.apply(this,arguments)}}(),r.addGroupPhoneMemberService=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n,u,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.groupId,n=r.phoneList,u={group_id:t,phone_list:[].concat((0,o.default)(n))},G.info("add phone to group"),e.next=6,coreTup.getIMInstance();case 6:return a=e.sent,e.next=9,a.adddiscussiongroupphonemember(u);case 9:return e.abrupt("return",e.sent);case 12:e.prev=12,e.t0=e.catch(0),G.error("error",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(r){return e.apply(this,arguments)}}(),r.bulkAddGroupMember=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o,a,i,s,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreTup.getIMInstance();case 2:n=e.sent,u=t.group_type,o=t.group_id,a=t.name,i=t.displayName,s=void 0,c=[],1===r.length?s={group_id:o,account:r[0].account,group_name:a,display_name:a}:r.length>1&&(r.forEach(function(e){c.push(e.account)}),c=c.join(";"),s={group_id:o,accounts:c,group_name:a,display_name:a}),0===u&&n.addfixedgroupmember(s),1===u&&n.adddiscussiongroupmember(s),G.info("info","批量添加群组成员success:");case 9:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.fixedGroupChangeService=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,1===r.group_type?t=0:0===r.group_type&&(t=1),e.next=4,coreTup.getIMInstance();case 4:return n=e.sent,e.next=7,n.modfixedgroup({id:r.group_id,name:r.name,capacity:r.capacity,manifesto:r.manifesto,desc:r.desc,owner:r.owner,auto_join_flag:r.auto_join_flag,msg_policy_type:r.msg_policy_type,group_type:1,fix_discuss:r.fix_discuss,state:r.state});case 7:return u=e.sent,o=0===u.result,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.transferDiscussionGroupService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("transferDiscussionGroupService "),e.next=4,coreTup.getIMInstance();case 4:return n=e.sent,e.next=7,n.transferdiscussiongroup({group_id:r,account:t});case 7:return u=e.sent,o=0===u.result,e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),G.error(e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(r,t){return e.apply(this,arguments)}}(),r.transferFixedGroupService=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("transferFixedGroupService "),e.next=4,coreTup.getIMInstance();case 4:return n=e.sent,e.next=7,n.transferfixedgroup({group_id:r,account:t});case 7:return u=e.sent,u&&u.result===constant.ERROR_IM_GROUP_CODE.RESULT_IMGROUP_MAXNUM&&(G.info("transferFixedGroupService 对方拥有的固定群超上限"),window.CLIENTCONFIG.ISMOBILE||window.alert(language.TRANSFER_FIXEDGROUP_FAIL_MAXUM)),o=0===u.result,e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(0),G.error("transferFixedGroupService error",e.t0.toJSON());case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(r,t){return e.apply(this,arguments)}}(),r.setGroupMsgPolicyType=function(){var e=(0,g.default)(f.default.mark(function e(r,t){var n,u,o,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("setGroupMsgPolicyType groud_id = "+r+",type = "+t),e.next=4,coreTup.getIMInstance();case 4:return n=e.sent,e.next=7,n.setgroupmsgpolicy({group_id:r,msg_policy_type:t});case 7:if(u=e.sent,1!==u.param.ack_result||0!==u.result){e.next=23;break}return G.info("setGroupMsgPolicyType setgroupmsgpolicy suc"),e.next=12,(0,v.getGroupInfoFromDB)(r);case 12:if(o=e.sent,!isNullOrEmpty(o)){e.next=17;break}G.error("setGroupMsgPolicyType get group from DB fail,need get from server"),e.next=21;break;case 17:return o.msg_policy_type=t,G.info("setGroupMsgPolicyType save groupInfo"),e.next=21,(0,_.saveGroupInfo)(o);case 21:e.next=24;break;case 23:G.error("setGroupMsgPolicyType setgroupmsgpolicy fail, result = "+(0,l.default)(u));case 24:return a=0===u.result,e.abrupt("return",a);case 28:e.prev=28,e.t0=e.catch(0),G.error("setGroupMsgPolicyType error",e.t0.toJSON());case 31:case"end":return e.stop()}},e,void 0,[[0,28]])}));return function(r,t){return e.apply(this,arguments)}}(),r.dealFixedGroupApply=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("dealFixedGroupApply"),e.next=4,coreTup.getIMInstance();case 4:return t=e.sent,e.next=7,t.confirmfixedgroupapply(r);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),G.error("dealFixedGroupApply",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(r){return e.apply(this,arguments)}}(),r.addDiscussGroup=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("addDiscussGroup"),e.next=4,coreTup.getIMInstance();case 4:return t=e.sent,e.next=7,t.adddiscussiongroup(r);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),G.error("addDiscussGroup",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(r){return e.apply(this,arguments)}}(),r.addDiscussGroupMember=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("addDiscussGroupMember"),e.next=4,coreTup.getIMInstance();case 4:return t=e.sent,e.next=7,t.adddiscussiongroupmember(r);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),G.error("addDiscussGroupMember",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(r){return e.apply(this,arguments)}}(),r.openGroupSpace=function(){var e=(0,g.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,G.info("openGroupSpace"),e.next=4,coreTup.getIMInstance();case 4:return t=e.sent,e.next=7,t.opengroupspace(r);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),G.error("openGroupSpace",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(r){return e.apply(this,arguments)}}()},243:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.getGroupByMemberSearch=r.setTeamNotifyRead=r.joinFlagChg=r.queryAllGroup=r.getGroupInfoFromDB=r.getGroupDetailInfo=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=t(287),p=t(270),f=coreLogger.getLogger("group")("detail"),d=(r.getGroupDetailInfo=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(r);case 3:if(t=e.sent,!isNullOrEmpty(t)){e.next=7;break}return f.warn("getGroupDetailInfo get group from DB fail"),e.abrupt("return",{});case 7:return e.next=9,(0,p.getMemberListByGroupIdInQueue)(r);case 9:return n=e.sent,e.next=12,coreGroup.sortGroupMember({groupMemberInfo:n,groupInfoNew:t});case 12:return u=e.sent,e.abrupt("return",{groupInfo:t,groupMemberInfo:u});case 16:e.prev=16,e.t0=e.catch(0),f.error("getGroupDetailInfo",e.t0.toString());case 19:case"end":return e.stop()}},e,void 0,[[0,16]])}));return function(r){return e.apply(this,arguments)}}(),r.getGroupInfoFromDB=function(){var e=(0,i.default)(o.default.mark(function e(r){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)){e.next=3;break}return f.error("getGroupInfoFromDB group_id is null, so return"),e.abrupt("return",{});case 3:return f.info("getGroupInfoFromDB, group_id = "+r),e.next=6,coreDb.queryGroup({group_id:r});case 6:if(t=e.sent,!isNullOrEmpty(t.id)){e.next=12;break}return f.warn("getGroupInfoFromDB not in db, group_id = "+r),e.abrupt("return",{});case 12:return f.info("getGroupInfoFromDB suc,group_id = "+t.group_id+",auto_join_flag = "+t.auto_join_flag+",capacity = "+t.capacity+",desc = "+(t.desc&&t.desc.length)+",fix_discuss = "+t.fix_discuss+",group_space_id = "+t.group_space_id+",group_space_name = "+(t.group_space_name&&t.group_space_name.length)+",group_type = "+t.group_type+",is_init_group_name = "+t.is_init_group_name+",manifesto = "+(t.manifesto&&t.manifesto.length)+",msg_policy_type = "+t.msg_policy_type+",owner = "+handleAccountPrint(t.owner)+",single_file_space = "+t.single_file_space+",name length = "+(t.name&&t.name.length)+",state = "+t.state+",sync_member_time = "+t.sync_member_time),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()),l=r.queryAllGroup=function(){var e=(0,i.default)(o.default.mark(function e(){var r,t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("queryAllGroup"),e.next=3,coreDb.queryGroupList({all:""});case 3:return r=e.sent,isNullOrEmpty(r)?f.warn("queryAllGroup is null"):(t=r.getKeyArr("group_id"),f.info("queryAllGroup group_id list = "+t)),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();r.joinFlagChg=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.isEserverOnline){e.next=4;break}return f.info("joinFlagChg, eserver is not login, return"),e.abrupt("return");case 4:return f.info("joinFlagChg group_id = "+r.group_id+",flag = "+t),n=void 0,n=t?0:1,e.next=9,(0,s.joinFlagChgService)(r,n);case 9:return u=e.sent,u?f.info("joinFlagChg  joinFlagChgService suc"):f.info("joinFlagChg joinFlagChgService fail"),e.abrupt("return",u);case 14:e.prev=14,e.t0=e.catch(0),f.error("joinFlagChg",e.t0);case 17:case"end":return e.stop()}},e,void 0,[[0,14]])}));return function(r,t){return e.apply(this,arguments)}}(),r.setTeamNotifyRead=function(){var e=(0,i.default)(o.default.mark(function e(r){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("setTeamNotifyRead groupId = "+r),e.next=3,d(r);case 3:if(t=e.sent,!isNullOrEmpty(t)){e.next=8;break}f.error("setTeamNotifyRead get group from DB fail"),e.next=12;break;case 8:return t.team_notify_is_read=constant.IS_READ.YES,f.info("setTeamNotifyRead save groupInfo"),e.next=12,(0,c.saveGroupInfo)(t);case 12:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.getGroupByMemberSearch=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("getGroupByMemberSearch searchtext length = "+r.length),e.next=3,coreAccount.getMyInfo();case 3:if(t=e.sent,n=t.show_account.toUpperCase(),u=t.name.toUpperCase(),a=window.pinyinUtil.getPinyin(t.name).toUpperCase(),i=r.toUpperCase(),-1===n.indexOf(i)&&-1===u.indexOf(i)&&-1===a.indexOf(i)){e.next=12;break}return e.next=11,l();case 11:return e.abrupt("return",e.sent);case 12:return e.next=14,coreDb.queryGroupListBySearchTextContactUnion(r);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()},270:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.sortGroupMember=r.getOnlineCount=r.getMemberListByGroupId=r.getMemberListByGroupIdInQueue=r.createGroupMemberChangeEvent=void 0;var u=t(3),o=n(u),a=t(69),i=n(a),s=t(1),c=n(s),p=t(2),f=n(p),d=t(227),l=t(595),m=t(287),g=t(243),_=coreLogger.getLogger("group")("member"),v=(r.createGroupMemberChangeEvent=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_.info("createGroupMemberChangeEvent",e);var n=new Event("groupMemberChange");n.data={groupId:e,groupOwner:r,memberList:t},window.dispatchEvent(n)},r.getMemberListByGroupIdInQueue=function(){var e=(0,f.default)(c.default.mark(function e(r){var t,n,u,o,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:coreCommon.TASK_PRIORITY.HIGH;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _.info("getMemberListByGroupIdInQueue group_id = "+r+",priority = "+i),t=new PromiseObject,n=function(e){t.resolve(e)},u=coreCommon.TaskQueue.getInstance("groupMemberServiceQueue"),o=coreCommon.TaskOptions.defaultOptions(),o.priority=i,u.addTask(v,o,n,r),e.next=9,t;case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.getMemberListByGroupId=function(){var e=(0,f.default)(c.default.mark(function e(r){var t,n,u,o,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _.info("getMemberListByGroupId group_id = "+r),t=[],e.next=4,(0,g.getGroupInfoFromDB)(r);case 4:if(n=e.sent,u=n.sync_member_time,o=n.owner,isNullOrEmpty(n)||isNullOrEmpty(u)||-1!==u.indexOf("overdue")){e.next=12;break}return _.info("getMemberListByGroupId group member already sync member, get from db, group_id = "+r),e.next=11,G(r,o);case 11:t=e.sent;case 12:if(!isNullOrEmpty(t)||isNullOrEmpty(n)){e.next=19;break}return _.info("getMemberListByGroupId get group member from db fail, need from server, group_id = "+r),e.next=16,y(r,u);case 16:return e.next=18,G(r,o);case 18:t=e.sent;case 19:return a=[],isNullOrEmpty(t)||(a=t.map(function(e){return handleAccountPrint(e.account)})),_.info("getMemberListByGroupId, memberlist = "+a+",group_id = "+r),e.abrupt("return",t);case 23:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()),G=function(){var e=(0,f.default)(c.default.mark(function e(r,t){var n,u,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _.info("getGroupMemberListFromDb group_id = "+r+",owner = "+handleAccountPrint(t)),n=void 0,e.next=4,coreDb.queryGroupMemberList({group_id:r,owner:t});case 4:if(n=e.sent,!isNullOrEmpty(n)){e.next=8;break}return _.error("getGroupMemberListFromDb from db fail, group_id = "+r),e.abrupt("return",[]);case 8:return e.next=10,coreAccount.getLoginModel();case 10:if(u=e.sent,!u.isSupportAS){e.next=18;break}return o=n.getKeyArr("account"),e.next=15,coreContact.getContactListByAccountList(o);case 15:return n=e.sent,e.next=18,coreContact.saveContactInfoList(n);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),y=function(){var e=(0,f.default)(c.default.mark(function e(r,t){var n,u,a,s,p,f,g,v;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_.info("getGroupMemberListFromServerAndSaveDB groupId = "+r+",sync_member_time = "+t),isNullOrEmpty(t)||-1===t.indexOf("overdue")){e.next=25;break}return n=t.indexOf("overdue"),u=t.substr(0,n),e.next=6,(0,d.getGroupMemberList)(r,u);case 6:if(a=e.sent,!isNullOrEmpty(a)&&!isNullOrEmpty(a.memberList)){e.next=14;break}if(_.error("getGroupMemberListFromServerAndSaveDB Increment from server fail,res = "+(0,i.default)(a)),isNullOrEmpty(a&&a.time_stamp)){e.next=12;break}return e.next=12,(0,m.updateSyncMemberTimeOfGroupInfo)(r,a.time_stamp);case 12:e.next=23;break;case 14:return s=[],p=[],f=a.memberList,f.map(function(e){e.group_member_state===constant.CONTACT_GROUP_STATE.DELETE?(_.info("getGroupMemberListFromServerAndSaveDB need to delete member in group_id = "+e.group_id+",account = "+handleAccountPrint(e.account)),s.push((0,l.deleteGroupMemberFromDB)(e.group_id,e.account))):(p.push(e),_.info("getGroupMemberListFromServerAndSaveDB need to add member in group_id = "+e.group_id+",account = "+handleAccountPrint(e.account)))}),s.push(coreDb.bulkPutGroupMember(p)),e.next=21,o.default.all(s);case 21:return e.next=23,(0,m.updateSyncMemberTimeOfGroupInfo)(r,a.time_stamp);case 23:e.next=39;break;case 25:return e.next=27,(0,d.getGroupMemberList)(r);case 27:if(g=e.sent,!isNullOrEmpty(g)&&!isNullOrEmpty(g.memberList)){e.next=32;break}_.error("getGroupMemberListFromServerAndSaveDB Total from server fail,res = "+(0,i.default)(g)),e.next=39;break;case 32:return e.next=34,(0,l.deleteGroupAllMemberFromDB)(r);case 34:return v=g.memberList,e.next=37,(0,l.saveGroupMemberToDB)(r,v);case 37:return e.next=39,(0,m.updateSyncMemberTimeOfGroupInfo)(r,g.time_stamp);case 39:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}();r.getOnlineCount=function(e,r,t){if(isNullOrEmpty(e))return{};var n=0,u=e.length;return e.forEach(function(e){(t[e.account]&&t[e.account].status)===constant.ONLINE_STATUS.OFFLINE||isNullOrEmpty(t[e.account])||n++}),{countNum:n,length:u}},r.sortGroupMember=function(e,r){try{if(0!==e.length){var t=e.findIndex(function(e){if(e.account===r.owner)return!0}),n=e.splice(t,1);e.unshift(n[0])}return e}catch(e){_.error("sortGroupMember",e)}}},273:function(e,r,t){t(34),t(22),t(23),t(274),t(275),t(276),t(277),e.exports=t(8).Set},274:function(e,r,t){"use strict";var n=t(191),u=t(166);e.exports=t(192)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(u(this,"Set"),e=0===e?0:e,e)}},n)},275:function(e,r,t){var n=t(10);n(n.P+n.R,"Set",{toJSON:t(193)("Set")})},276:function(e,r,t){t(194)("Set")},277:function(e,r,t){t(195)("Set")},287:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.deleteGroupInfoInDB=r.updateSyncMemberTimeOfGroupInfo=r.updateGroupInfo=r.saveGroupInfo=r.saveGroupInfoList=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(1874),c=t(1875),p=t(243),f=coreLogger.getLogger("group")("detail"),d=(r.saveGroupInfoList=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(r)){e.next=4;break}return f.error("saveGroupInfoList group_id list is null"),e.abrupt("return");case 4:return e.next=6,coreDb.bulkPutGroup(r);case 6:r.map(function(e){return f.info("saveGroupInfoList,group_id = "+e.group_id+",auto_join_flag = "+e.auto_join_flag+",capacity = "+e.capacity+",desc = "+(e.desc&&e.desc.length)+",fix_discuss = "+e.fix_discuss+",group_space_id = "+e.group_space_id+",group_space_name = "+(e.group_space_name&&e.group_space_name.length)+",group_type = "+e.group_type+",is_init_group_name = "+e.is_init_group_name+",manifesto = "+(e.manifesto&&e.manifesto.length)+",msg_policy_type = "+e.msg_policy_type+",owner = "+handleAccountPrint(e.owner)+",single_file_space = "+e.single_file_space+",state = "+e.state+",sync_member_time = "+e.sync_member_time+",name = "+(e.name&&e.name.length)),e.group_id}),coreCommon.dispatchModuleEvent("group",{event:"groupInfoChange",data:r}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),f.error("saveGroupInfoList ",e.t0.toString());case 13:case"end":return e.stop()}},e,void 0,[[0,10]])}));return function(r){return e.apply(this,arguments)}}(),r.saveGroupInfo=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(r)&&!isNullOrEmpty(r.group_id)){e.next=4;break}return f.error("saveGroupInfo group or groupid is null"),e.abrupt("return",{});case 4:return f.info("saveGroup,group_id = "+r.group_id+",auto_join_flag = "+r.auto_join_flag+",capacity = "+r.capacity+",desc = "+(r.desc&&r.desc.length)+",fix_discuss = "+r.fix_discuss+",group_space_id = "+r.group_space_id+",group_space_name = "+(r.group_space_name&&r.group_space_name.length)+",group_type = "+r.group_type+",is_init_group_name = "+r.is_init_group_name+",manifesto = "+(r.manifesto&&r.manifesto.length)+",msg_policy_type = "+r.msg_policy_type+",owner = "+handleAccountPrint(r.owner)+",single_file_space = "+r.single_file_space+",state = "+r.state+",sync_member_time = "+r.sync_member_time+",name = "+(r.name&&r.name.length)+",isNeedUpdateUI = "+n),e.next=7,coreDb.saveGroup(r);case 7:return t=e.sent,n&&(coreCommon.dispatchModuleEvent("group",{event:"groupInfoChange",data:[r]}),(0,s.reloadGroupInfoNew)(t),(0,c.reloadGroupListData)()),e.abrupt("return",t);case 12:e.prev=12,e.t0=e.catch(0),f.error("saveGroup ",e.t0.toString());case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(r){return e.apply(this,arguments)}}());r.updateGroupInfo=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)&&!isNullOrEmpty(t)){e.next=3;break}return f.error("updateGroupInfo groupId or updateKeyValues is null"),e.abrupt("return",{});case 3:return e.next=5,coreDb.updateGroup({groupId:r,updateKeyValues:t});case 5:n&&(0,c.reloadGroupListData)();case 6:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.updateSyncMemberTimeOfGroupInfo=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("updateSyncMemberTimeOfGroupInfo groupId = "+r+",time_stamp = "+t),e.next=3,(0,p.getGroupInfoFromDB)(r);case 3:if(n=e.sent,isNullOrEmpty(n)){e.next=8;break}return"overdue"===t?(u=n.sync_member_time,isNullOrEmpty(u)||-1!==u.indexOf("overdue")||(a=n.sync_member_time+t,n.sync_member_time=a)):n.sync_member_time=t,e.next=8,d(n,!1);case 8:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.deleteGroupInfoInDB=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)){e.next=3;break}return f.error("deleteGroupInfoInDB groupId is null, so return"),e.abrupt("return",{});case 3:return coreCommon.dispatchModuleEvent("group",{event:"groupInfoDelete",data:r}),f.info("deleteGroupInfoInDB, groupId = "+r+",isNeedUpdateUI = "+n),e.next=7,coreDb.deleteGroup({group_id:r});case 7:t=e.sent,f.info("deleteGroupInfoInDB result = "+t),n&&(0,c.reloadGroupListData)();case 10:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()},595:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.saveGroupMemberToDB=r.deleteGroupAllMemberFromDB=r.deleteGroupMemberFromDB=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=coreLogger.getLogger("group")("member");r.deleteGroupMemberFromDB=function(){var e=(0,i.default)(o.default.mark(function e(r,t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s.info("deleteGroupMemberFromDB group_id = "+r+",member_account = "+handleAccountPrint(t)),e.next=4,coreDb.deleteGroupMember({account:t,group_id:r});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),s.error("deleteGroupMemberFromDB",e.t0.toString());case 9:case"end":return e.stop()}},e,void 0,[[0,6]])}));return function(r,t){return e.apply(this,arguments)}}(),r.deleteGroupAllMemberFromDB=function(){var e=(0,i.default)(o.default.mark(function e(r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.info("deleteGroupAllMemberFromDB group_id = "+r),e.next=3,coreDb.deleteGroupMember({group_id:r});case 3:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.saveGroupMemberToDB=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)&&!isNullOrEmpty(t)){e.next=3;break}return s.error("saveGroupMemberToDB group_id is null or memberList is null"),e.abrupt("return");case 3:return n=[],u=[],t.map(function(e){var t={account:e.account,group_id:r,name:e.name,staffid:e.staff_id,q_pin_yin:e.q_pin_yin};u.push(t),n.push(handleAccountPrint(e.account))}),s.info("saveGroupMemberToDB group_id = "+r+",member acc list = "+n),e.next=9,coreDb.bulkPutGroupMember(u);case 9:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}()},69:function(e,r,t){e.exports={default:t(70),__esModule:!0}},70:function(e,r,t){var n=t(8),u=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return u.stringify.apply(u,arguments)}},821:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(143),u=function(e){return e&&e.__esModule?e:{default:e}}(n);coreLogger.getLogger("group")("service");r.default=function(){var e={},r={},t=function(){};return t.prototype={setMarkExitGroupNotify:function(r,t){e=(0,u.default)({},r,t)},getMarkExitGroupNotify:function(r){var t=e[r]||!1;return t||(e={}),t},clearMarkExitGroupNotify:function(){e={}},setMarkDeleteGroupNotify:function(e){r=e||{}},getMarkDeleteGroupNotify:function(e,t){var n=!1;return e&&e===r.group_id&&t===r.account?n=r.is_delete||!1:r={},n},clearMarkDeleteGroupNotify:function(){r={}}},new t}()},822:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.sendNotifyMessage=void 0;var u=t(1),o=n(u),a=t(69),i=n(a),s=t(2),c=n(s),p=coreLogger.getLogger("group")("tupNotify");r.sendNotifyMessage=function(){var e=(0,c.default)(o.default.mark(function e(){var r,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=arguments[1],a=arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:constant.MEDIA_TYPE.GROUP_MEMBERCHG_NOTIFY;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,n){e.next=3;break}return e.abrupt("return");case 3:return p.info("coreGroup.sendNotifyMessage  list",n.length),"array"===Object.type(n)&&(r=n.map(function(e){return{account:e.account||"",name:e.name||""}})),t=(0,i.default)({contacts:r,languageKey:a}),e.next=8,coreIm.dealGroupNotify(u,t,c,parseInt(s));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},972:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.dealGroupMemberIncrement=r.toggleGetGroupMemberList=void 0;var u=t(201),o=n(u),a=t(159),i=n(a),s=t(3),c=n(s),p=t(1),f=n(p),d=t(2),l=n(d),m=t(270),g=t(243),_=t(595),v=coreLogger.getLogger("group")("member/increment");r.toggleGetGroupMemberList=function(){var e=(0,l.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(r)&&!isNullOrEmpty(r.group_id)){e.next=3;break}return v.error("toggleGetGroupMemberList group or group_id is null"),e.abrupt("return");case 3:return t=r.group_id,v.info("toggleGetGroupMemberList group_id = "+t),e.next=7,(0,m.getMemberListByGroupIdInQueue)(t,coreCommon.TASK_PRIORITY.DEFAULT);case 7:n=e.sent,isNullOrEmpty(n)?v.error("toggleGetGroupMemberList get group memberlist fail"):(0,m.createGroupMemberChangeEvent)(t,r.owner,n);case 9:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),r.dealGroupMemberIncrement=function(){var e=(0,l.default)(f.default.mark(function e(r,t,n){var u,a,s,p;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v.info("dealGroupMemberIncrement im_group_user_info_list length = "+(r&&r.length)),!r){e.next=15;break}return u=[],a=[],s=[],p={},t&&t.map(function(e){p[e.account]=e}),r.map(function(e){if(e.state===constant.CONTACT_GROUP_STATE.DELETE)v.info("dealGroupMemberIncrement need to delete member in group_id = "+e.group_id+",account = "+handleAccountPrint(e.account)),s.push((0,_.deleteGroupMemberFromDB)(e.group_id,e.account));else{var r=p[e.account],t={account:e.account,group_id:e.group_id,name:isNullOrEmpty(r)?getContactName(e):getContactName(r),staffid:isNullOrEmpty(r)?e.staff_id:r.staff_id,q_pin_yin:isNullOrEmpty(r)?"":r.q_pin_yin};u.push(t),v.info("dealGroupMemberIncrement need to add member in group_id = "+e.group_id+",account = "+handleAccountPrint(e.account))}a.push(e.group_id)}),s.push(coreDb.bulkPutGroupMember(u)),e.next=10,c.default.all(s);case 10:if(!a.length){e.next=15;break}return a=(0,i.default)(new o.default(a)),v.info("dealGroupMemberIncrement Refresh groups with member changes, shouldSaveGroupList = "+a),e.next=15,c.default.all(a.map(function(){var e=(0,l.default)(f.default.mark(function e(r){var t;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.getGroupInfoFromDB)(r);case 2:t=e.sent,isNullOrEmpty(t)?v.error("dealGroupMemberIncrement get group from db fail"):(0,m.createGroupMemberChangeEvent)(t.group_id,t.owner);case 4:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}()));case 15:case"end":return e.stop()}},e,void 0)}));return function(r,t,n){return e.apply(this,arguments)}}()},973:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.createDiscussGroupName=r.modifyGroupNameByMember=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(974),c=t(270),p=coreLogger.getLogger("group")("discussGroup"),f=(r.modifyGroupNameByMember=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u,a,i,f,d,l,m;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.info("modifyGroupNameByMember group_id = "+r.group_id+",memberlist length = "+(t&&t.length)),e.next=3,coreContact.getContactByAccount(r.owner);case 3:if(n=e.sent,u=void 0,1!==r.is_init_group_name){e.next=27;break}if(p.info("modifyGroupNameByMember is_init_group_name = 1"),a=[],!t||1===t.length){e.next=13;break}for(i=0;i<t.length;i++)t[i].account!==r.owner&&a.push(t[i]);u=(0,s.createGroupName)(a,n),e.next=19;break;case 13:return e.next=15,(0,c.getMemberListByGroupIdInQueue)(r.group_id);case 15:for(f=e.sent,d=[],l=0;l<f.length;l++)f[l].account!==r.owner&&d.push(f[l]);u=(0,s.createGroupName)(d,n);case 19:return r.name=u,e.next=22,coreIm.getLocalRecent({owner:r.group_id});case 22:return m=e.sent,isNullOrEmpty(m)||(m.group=r,coreIm.updateRecent(m)),e.abrupt("return",r);case 27:return p.info("modifyGroupNameByMember is_init_group_name = 0"),e.abrupt("return",r);case 29:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}(),r.createDiscussGroupName=function(e){var r=$getState(),t=r.myInfo,n=void 0,u=void 0;n=getContactName(t);var o=window.CLIENTCONFIG.GROUP_NAME_NUM_LIMIT;u=f(n)?n.substr(0,o):n;for(var a=0;a<3;a++){var i=e[a];if(!i)break;var s=u+","+getContactName(i);u=f(s)?s.substr(0,o):s}return e.length>3&&(u+=""),u},function(e){var r=window.CLIENTCONFIG.GROUP_NAME_NUM_LIMIT;return e.length>r})},974:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(coreLogger.getLogger("group")("detail"),r.createGroupName=function(e,r){var t=void 0,u=void 0;t=getContactName(r);var o=window.CLIENTCONFIG.GROUP_NAME_NUM_LIMIT;u=n(t)?t.substr(0,o):t;for(var a=0;a<3;a++){var i=e[a];if(!i)break;var s=u+","+getContactName(i);u=n(s)?s.substr(0,o):s}return e.length>3&&(u+=""),u},r.isStringOverLength=function(e){var r=window.CLIENTCONFIG.GROUP_NAME_NUM_LIMIT;return e.length>r})},975:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.modifyGroupMsgPolicyType=r.modifyDisGroupInfo=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=coreLogger.getLogger("group")("detail");r.modifyDisGroupInfo=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u,a,i,p,f,d,l,m,g,_,v,G,y,x;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEServerOnlineNoToast("modifyDisGroupInfo")){e.next=4;break}return c.info("modifyDisGroupInfo, eserver is not login, return"),e.abrupt("return");case 4:return n=r.id,u=r.group_id,a=r.name,i=r.capacity,p=r.manifesto,f=r.desc,d=r.owner,l=r.auto_join_flag,m=r.msg_policy_type,g=r.group_type,_=r.fix_discuss,v=r.state,G=r.is_init_group_name,c.info("modifyDisGroupInfo"),y={id:u,name:t.name||a,capacity:i,manifesto:t.manifesto||p||" ",desc:t.desc||f,owner:d,auto_join_flag:t.auto_join_flag||l,msg_policy_type:m,group_type:g,fix_discuss:_,state:v,is_init_group_name:G},e.next=9,(0,s.modifyDisGroupInfoService)(y);case 9:return x=e.sent,e.abrupt("return",x);case 13:e.prev=13,e.t0=e.catch(0),c.error("modifyDisGroupInfo error",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(r,t){return e.apply(this,arguments)}}(),r.modifyGroupMsgPolicyType=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEserverOnline("modifyGroupMsgPolicyType")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,s.setGroupMsgPolicyType)(r,t);case 5:return n=e.sent,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(0),c.error("modifyDisGroupInfo error",e.t0);case 12:case"end":return e.stop()}},e,void 0,[[0,9]])}));return function(r,t){return e.apply(this,arguments)}}()},976:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.createDiscussionGroup=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(227),c=t(227),p=t(287),f=coreLogger.getLogger("group")("common"),d=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i,c,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=$getState(),n=t.myInfo.account,u=r.groupName,a=r.capacity,i=r.groupType,f.info("createGroupTup capacity = "+a+",groupType = "+i+",owner acc = "+handleAccountPrint(n)),c={id:"",name:u,capacity:a,manifesto:" ",desc:"",owner:n,auto_join_flag:0,msg_policy_type:1,group_type:i,fix_discuss:1,state:"",is_init_group_name:1},p=void 0,1!==i){e.next=12;break}return e.next=9,(0,s.createDiscussGroup)(c);case 9:p=e.sent,e.next=16;break;case 12:if(0!==i){e.next=16;break}return e.next=15,(0,s.createFixedGroup)(c);case 15:p=e.sent;case 16:if(!isNullOrEmpty(p)&&!isNullOrEmpty(p.param)){e.next=19;break}return f.error("createGroupTup fail, tup return data is null"),e.abrupt("return",{});case 19:return f.info("createGroupTup suc, tup return groupId = "+p.param.id+",reason = "+p.param.reason),e.abrupt("return",p);case 23:e.prev=23,e.t0=e.catch(0),f.error("createGroupTup",e.t0);case 26:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(r){return e.apply(this,arguments)}}(),l=function(){var e=(0,i.default)(o.default.mark(function e(r,t){var n,u,a,i,c,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=r.capacity,f.info("addGroupMember capacityLimit = "+n+",list length = "+t.length+",groupId = "+r.group_id),u={group_type:1,group_id:r.group_id,name:r.name,displayName:r.name},a=[],i=t.splitByNum(20),c=0;case 6:if(!(c<i.length)){e.next=14;break}return e.next=9,(0,s.bulkAddGroupMemberService)(i[c],u);case 9:p=e.sent,a=a.concat(p);case 11:c++,e.next=6;break;case 14:a&&a.length>0&&alert(a+language.FAILED_TO_BE_ADDED),t.length+1<=n?f.info("addGroupMember success"):(r.group_type===constant.GROUP_TYPE.FIXED_GROUP?alert(language.ADD_MEMBER_EXCEED_GROUP_LIMIT):alert(language.ADD_MEMBER_EXCEED_DISCUSS_GROUP_LIMIT),f.error("addGroupMember fail, list cnt > capacityLimit"));case 16:case"end":return e.stop()}},e,void 0)}));return function(r,t){return e.apply(this,arguments)}}();r.createDiscussionGroup=function(){var e=(0,i.default)(o.default.mark(function e(r){var t,n,u,a,i,s,m,g=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f.info("createDiscussionGroup isTeam = "+g),t=g?coreCommon.filterSensitiveWord($getState().contactGroups.addNewName):coreGroup.createDiscussGroupName(r),n=g?0:1,e.next=6,d({groupName:t,capacity:1e3,groupType:n});case 6:if(u=e.sent,a=u.param,i=a.id,s=a.reason,coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_IM_CREATE_GROUP_CHAT,params:[n,i,r.length]}),0===s){e.next=14;break}return f.error("createDiscussionGroup fail,reason = "+s),e.abrupt("return",s);case 14:return e.next=16,(0,c.getGroupInfoFromServer)(i);case 16:return m=e.sent,f.info("createDiscussionGroup, save groupInfo"),e.next=20,(0,p.saveGroupInfo)(m);case 20:return m=e.sent,l(m,r),f.info("createDiscussionGroup suc, groupId = "+m.group_id),e.abrupt("return",m);case 26:e.prev=26,e.t0=e.catch(0),f.error("createDiscussionGroup error = ",e.t0);case 29:case"end":return e.stop()}},e,void 0,[[0,26]])}));return function(r){return e.apply(this,arguments)}}()},977:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.loadGroupAvatarMembersByGroupId=void 0;var u=t(1),o=n(u),a=t(2),i=n(a),s=t(270),c=coreLogger.getLogger("group")("member");r.loadGroupAvatarMembersByGroupId=function(){var e=(0,i.default)(o.default.mark(function e(r){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.getMemberListByGroupIdInQueue)(r);case 3:t=e.sent,coreUi.setGroupMemberAvatarList(r,t),c.info("刷新群组"+r+"头像成员","success"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),c.error("刷新群组"+r+"头像成员",e.t0);case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(r){return e.apply(this,arguments)}}()}});