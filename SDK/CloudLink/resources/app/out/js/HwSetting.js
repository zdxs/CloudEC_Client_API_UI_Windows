webpackJsonp([17],{1030:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkAutoLeave=t.AutoLeaveSetting=void 0;var r=n(1860),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(r);t.AutoLeaveSetting=a.AutoLeaveSetting,t.checkAutoLeave=a.checkAutoLeave},1031:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPhotoHole=t.drawCorner=t.drawDashLine=void 0;var r=n(141),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=coreLogger.getLogger("logic")("setting/canvas"),o=t.drawDashLine=function(e,t,n){var r=(0,a.default)(t,2),o=r[0],s=r[1],u=(0,a.default)(n,2),c=u[0],l=u[1],f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;try{for(var d=c-o,p=l-s,v=Math.floor(Math.sqrt(d*d+p*p)/f),g=d/v,h=p/v,m=0;m<v;m++)m%2==0?e.moveTo(o,s):e.lineTo(o,s),o+=g,s+=h;e.lineTo(c,l)}catch(e){i.error("canvas drawDashLine error",e)}},s=t.drawCorner=function(e,t){try{var n=t.x||0,r=t.y||0,a=t.lineWidth||3,o=t.height||20,s=t.direction||"topLeft";switch(e.fillStyle="white",s){case"topLeft":e.fillRect(n-a,r-a,a,o),e.fillRect(n-a,r-a,o,a);break;case"topRight":e.fillRect(n-o+a,r-a,o,a),e.fillRect(n,r,a,o-a);break;case"bottomLeft":e.fillRect(n-a,r+a-o,a,o),e.fillRect(n,r,o-a,a);break;case"bottomRight":e.fillRect(n-o+a,r,o,a),e.fillRect(n,r+a-o,a,o-a)}}catch(e){i.error("canvas drawCorner error",e)}};t.drawPhotoHole=function(e,t){try{for(var n=t.x||0,r=t.y||0,a=t.holeSize||170,u=t.lineWidth||3,c=t.height||20,l=["topLeft","topRight","bottomLeft","bottomRight"],f={x:0,y:0,lineWidth:u,height:c,direction:"topLeft"},d=r,p=r+a,v=n,g=n+a,h=[{x:v,y:d},{x:g,y:d},{x:v,y:p},{x:g,y:p}],m=0;m<l.length;m++)f.x=h[m].x,f.y=h[m].y,f.direction=l[m],s(e,f);e.beginPath();var w=a/3,y=2*a/3;e.strokeStyle="rgba(0,0,0,0.5)";for(var S=[{start:[n+w,r],end:[n+w,r+a]},{start:[n+y,r],end:[n+y,r+a]},{start:[n,r+w],end:[n+a,r+w]},{start:[n,r+y],end:[n+a,r+y]}],C=0;C<S.length;C++)o(e,S[C].start,S[C].end)}catch(e){i.error("canvas drawPhotoHole error",e)}}},1032:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return-1===e.indexOf("file://")?"file://"+e:e}function i(e){try{return window.require("fs").existsSync(e)}catch(e){C.error("checkFileHas error",e)}}function o(e){var t=document.createElement("canvas");return t.width=e,t.height=e,t.getContext?t:(C.error("createCanvas canvas-unsupported"),!1)}function s(e,t){return new f.default(function(n){var r=o(t),a=r.getContext("2d"),i=new Image;i.src=e,i.onload=function(){i.width=t,i.height=t,a.drawImage(i,0,0,i.width,i.height),n(r)}})}function u(){var e=c();return Object.type(e.FILE_TYPE)!==Object.type.STRING?(C.info("getFemaleBgColor FILE_TYPE=",constant.AppConfig.DEFAULT_AVATAR_CONFIG.FILE_TYPE),constant.AppConfig.DEFAULT_AVATAR_CONFIG.FILE_TYPE):(C.info("getFemaleBgColor FILE_TYPE=",e.FILE_TYPE),e.FILE_TYPE)}function c(){return window.CLIENTCONFIG.DEFAULT_AVATAR_CONFIG||constant.AppConfig.DEFAULT_AVATAR_CONFIG}Object.defineProperty(t,"__esModule",{value:!0}),t.queryAvatarLeaderStatus=t.hideAvatarLeader=t.saveAndSendAvatar=t.clipPhoneImage=t.clipImage=t.trunImage=t.drawImg=t.standardDraw=t.selectImageHistory=t.saveDefaultAvatarToLocal=t.querySelectedImg=t.saveSelectedImg=t.loadImageHistory=t.delImageHistory=t.getPhoneImg=t.chooseImg=void 0;var l=n(3),f=r(l),d=n(69),p=r(d),v=n(1),g=r(v),h=n(2),m=r(h),w=function(){var e=(0,m.default)(g.default.mark(function e(t){var n,r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C.info("saveAllTypeAvatar begin!"),n=[52,120,320],r=[],n.forEach(function(e){r.push(y(t,e))}),e.next=7,f.default.all(r);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),C.error("saveAllTypeAvatar!",e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,m.default)(g.default.mark(function e(t,n){var r,a;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s(t,n);case 3:return r=e.sent,a=coreCommon.getSelfAccount(),e.next=7,S(r,a,n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),C.error("saveOneTypeAvatar",e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(t,n){return e.apply(this,arguments)}}(),S=function(){var e=(0,m.default)(g.default.mark(function e(t,n,r){var a,i,o,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.toDataURL("image/png",1),e.next=4,appService.getTempAvatarPath(coreCommon.getSelfAccount());case 4:return i=e.sent,o=i+n+r+u(),e.next=8,appService.saveBase64Img(a,o);case 8:s=e.sent,s?C.info("saveLocalAvatar save success!"):C.info("saveLocalAvatar save failed!"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),C.error("saveLocalAvatar error",e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(t,n,r){return e.apply(this,arguments)}}(),C=coreLogger.getLogger("logic")("setting/setAvatar"),I=(t.chooseImg=function(){var e={filters:[{name:"Images",extensions:["jpg","png","gif","bmp"]}],properties:["openFile"]};if(coreCommon.isPc()){var t=window.require("fs");window.electron.remote.dialog.showOpenDialog(win,e,function(e){if(isNullOrEmpty(e))C.info("setAvatar choose img is empty!");else{var n=e[0],r=t.statSync(n);r&&r.size&&r.size<constant.SET_AVATAR_NUMBER.MAX_IMAGE_FILE_SIZE?($dispatch(coreUi.setChooseImgSrc(n)),I(n)):window.alert("您选择的文件不正确或超出10M,请重新选择!")}})}},t.getPhoneImg=function(){var e=(0,m.default)(g.default.mark(function e(t){var n,r,i,o,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!coreCommon.isPc()){e.next=6;break}return C.info("getPhoneImg error: is not phone client!"),e.abrupt("return");case 6:if(!isNullOrEmpty(t)&&!isNullOrEmpty(t.media)){e.next=9;break}return C.info("getPhoneImg error: jsonObj is empty!"),e.abrupt("return");case 9:if(n=t.media,r=n[0].filepath,isNullOrEmpty(r)){e.next=17;break}return i=a(r),e.next=15,appService.readLocalImgFile(i);case 15:o=e.sent,0===o.result?(C.info("getPhoneImg sucess!"),s=0,coreCommon.isAndroid()&&(s=window.webView.getPictureDegree(r),C.info("getPhoneImg getPictureDegree",s)),$dispatch(coreUi.setChooseImgSrc(o.file,s)),window.goRoute("SetAvatar")):C.error("getPhoneImg faile",o.error);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),C.error("getPhoneImg error",e.t0);case 22:case"end":return e.stop()}},e,void 0,[[0,19]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,m.default)(g.default.mark(function e(t){var n,r,a,i,o,s,u,c,l,f,d,v,h,m;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C.info("saveImageHistory begin"),n=window.require("fs"),r=[],a=1,i=t.lastIndexOf("."),o=t.length,s=t.substring(i,o),e.next=10,coreDb.queryUserConfig({key:"setAvatarHistory"});case 10:if(!(u=e.sent)||!u.value){e.next=27;break}if(r=JSON.parse(u.value),!(r.length>=constant.SET_AVATAR_NUMBER.MAX_HISTORY_NUM)){e.next=19;break}c=r.pop(),l=c.lastIndexOf("."),a=parseInt(c.substring(l-1,l)),e.next=27;break;case 19:f=0;case 20:if(!(f<=constant.SET_AVATAR_NUMBER.MAX_HISTORY_NUM)){e.next=27;break}if(-1!==u.value.indexOf("AvatarHistory"+(f+1))){e.next=24;break}return a=f+1,e.abrupt("break",27);case 24:f++,e.next=20;break;case 27:return d=new Date,e.next=30,appService.getHistoryAvatarPath(coreCommon.getSelfAccount());case 30:v=e.sent,h=v+"t"+d.getMilliseconds()+"AvatarHistory"+a+s,m=n.readFileSync(t),n.writeFile(h,m,function(e){if(e)throw e;C.info("saveImageHistory copy file success"),r.unshift(h),k(h),coreDb.saveUserConfig({key:"setAvatarHistory",value:(0,p.default)(r)}),$dispatch(coreUi.saveAvatarHistory(r)),m=null}),e.next=39;break;case 36:e.prev=36,e.t0=e.catch(0),C.error("saveImageHistory error",e.t0);case 39:case"end":return e.stop()}},e,void 0,[[0,36]])}));return function(t){return e.apply(this,arguments)}}()),k=(t.delImageHistory=function(){var e=(0,m.default)(g.default.mark(function e(t){var n,r,a,i,o;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C.info("delImageHistory begin"),e.next=4,coreDb.queryUserConfig({key:"setAvatarHistory"});case 4:if(!(n=e.sent)||!n.value){e.next=20;break}r=JSON.parse(n.value),a=0;case 8:if(!(a<r.length)){e.next=18;break}if(i=r[a],o=i.substring(i.length-12),-1===t.indexOf(o)){e.next=15;break}return window.fs.existsSync(i)&&window.fs.unlinkSync(i),r.splice(a,1),e.abrupt("break",18);case 15:a++,e.next=8;break;case 18:coreDb.saveUserConfig({key:"setAvatarHistory",value:(0,p.default)(r)}),$dispatch(coreUi.saveAvatarHistory(r));case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),C.error("delImageHistory error",e.t0);case 25:case"end":return e.stop()}},e,void 0,[[0,22]])}));return function(t){return e.apply(this,arguments)}}(),t.loadImageHistory=function(){var e=(0,m.default)(g.default.mark(function e(){var t,n,r,a,o,s,c,l,f;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C.info("loadImageHistory begin"),e.next=4,coreDb.queryUserConfig({key:"setAvatarHistory"});case 4:if(t=e.sent,n=coreCommon.getSelfAccount(),!t||isNullOrEmpty(t.value)||"[]"===t.value){e.next=11;break}r=JSON.parse(t.value),isNullOrEmpty(r)||($dispatch(coreUi.saveAvatarHistory(r)),x().then(function(e){e||$dispatch(coreUi.setChooseImgSrc(r[0]))})),e.next=38;break;case 11:return e.next=13,appService.getAvatarPath(n);case 13:return a=e.sent,o=a+""+n+".png",s=a+""+n+u(),c=a+""+n+".jpg",e.next=19,appService.getHistoryAvatarPath(coreCommon.getSelfAccount());case 19:if(!i(o)){e.next=23;break}I(o),e.next=38;break;case 23:if(!i(c)){e.next=27;break}I(c),e.next=38;break;case 27:if(!i(s)){e.next=31;break}I(s),e.next=38;break;case 31:return e.next=33,A();case 33:return e.next=35,appService.getAvatarPath(n);case 35:l=e.sent,f=l+""+n+u(),I(f);case 38:e.next=43;break;case 40:e.prev=40,e.t0=e.catch(0),C.error("loadImageHistory error",e.t0);case 43:case"end":return e.stop()}},e,void 0,[[0,40]])}));return function(){return e.apply(this,arguments)}}(),t.saveSelectedImg=function(){var e=(0,m.default)(g.default.mark(function e(t){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(t)){e.next=4;break}return C.error("saveSelectedImg fileName is empty!"),e.abrupt("return");case 4:$dispatch(coreUi.saveSelectAvatar(t)),coreDb.saveUserConfig({key:"setCurrentAvatar",value:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C.error("saveSelectedImg error",e.t0);case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}()),x=t.querySelectedImg=function(){var e=(0,m.default)(g.default.mark(function e(){var t,n;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreDb.queryUserConfig({key:"setCurrentAvatar"});case 3:if(t=e.sent,n=t&&t.value,isNullOrEmpty(n)){e.next=11;break}return $dispatch(coreUi.saveSelectAvatar(n)),$dispatch(coreUi.setChooseImgSrc(n)),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(0),C.error("saveSelectedImg error",e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}},e,void 0,[[0,14]])}));return function(){return e.apply(this,arguments)}}(),A=t.saveDefaultAvatarToLocal=function(){var e=(0,m.default)(g.default.mark(function e(){var t,n,r,a,i;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=$getState(),n=t.myInfo,r=n.account,a=n.name,i=n.gender,e.abrupt("return",coreUi.createDefaultAvatar(r,a,i));case 6:e.prev=6,e.t0=e.catch(0),C.error("saveDefaultAvatarToLocal error",e.t0);case 9:case"end":return e.stop()}},e,void 0,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),b=(t.selectImageHistory=function(e){try{C.info("selectImageHistory begin"),$dispatch(coreUi.setChooseImgSrc(e)),k(e)}catch(e){C.error("selectImageHistory error",e)}},t.standardDraw=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(isNullOrEmpty(e))return C.info("standardDraw canvas container is null!"),!1;var r=n.height||180,a=n.width||342,i=n.imgNextX||0,o=n.imgNextY||0,s=n.imgNextScale||1,u=n.nextRotation||0,c=s*t.height,l=s*t.width;e.save(),e.clearRect(0,0,a,r),e.globalCompositeOperation="destination-over";var f=o-.5*(l*Math.sin(u)-c+c*Math.cos(u)),d=i+.5*(l-l*Math.cos(u)+c*Math.sin(u));e.translate(d,f),e.rotate(u),e.scale(s,s);var p=$getState().setting.chooseImgDegree;p&&(e.translate(t.width/2,t.height/2),e.rotate(p*Math.PI/180),e.translate(-t.width/2,-t.height/2),window._ctx=e),e.drawImage(t,0,0,t.width,t.height),e.imageSmoothingEnabled=!0,e.webkitImageSmoothingEnabled=!0,e.restore(),coreCommon.isPc()&&L(e)}),L=(t.drawImg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],n=arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(""===e||isNullOrEmpty(t))return C.info("drawImg image url or canvas container is null!"),!1;var a=r.height||180,i=r.width||342;n.onload=function(){var e=n.width/n.height,o=i/a,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0;f=e>=o?i/n.width:a/n.height;var d=$getState().setting.chooseImgDegree;90!==d&&270!==d||(o=a/i,f=e<=o?i/n.width:a/n.height),c=n.width*f,l=n.height*f,s=.5*(i-c),u=.5*(a-l),r.imgNextX=s,r.imgNextY=u,r.imgNextScale=f,r.nextRotation=0,b(t,n,r)},n.src=e},t.trunImage=function(e){var t=new Event("turnImage"),n=$getState().setting.imageNewStatus.nextRotation,r=n+e;(r>=6.28||r<=-6.28)&&(r=0),t.degree=r,window.dispatchEvent(t)},t.clipImage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:170,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:86,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;try{var a=o(t),i=a.getContext("2d"),s=e.getImageData(n,r,t,t);i.putImageData(s,0,0);var u=a.toDataURL(),c=new Event("setAvatarData");c.imgData=u,window.dispatchEvent(c)}catch(e){C.error("clipImage error:",e)}}),E=(t.clipPhoneImage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:170,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:86,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;try{C.info("clipPhoneImage",{avatarSize:t,startX:n,startY:r}),coreUi.changeIsShowAvatarLoading(!0),window.history.back();var a=o(t),i=a.getContext("2d"),s=e.getImageData(n,r,t,t);i.putImageData(s,0,0);var u=a.toDataURL("image/jpeg");return E(u)}catch(e){C.error("clipImage error:",e)}},t.saveAndSendAvatar=function(){var e=(0,m.default)(g.default.mark(function e(){var t,n,r,a,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,""===o){e.next=15;break}return e.next=4,w(o);case 4:return t=coreCommon.getSelfAccount(),e.next=7,appService.getTempAvatarPath(t);case 7:return n=e.sent,r=u(),a={SmallIconFilePath:""+n+t+"52"+r,MediumIconFilePath:""+n+t+"120"+r,LargeIconFilePath:""+n+t+"320"+r},i="",".jpg"===r?i="image/jpeg":".png"===r?i="image/png":C.info("saveAndSendAvatar,select avatar type is "+r),e.abrupt("return",coreContact.uploadAvatar({param:a,contentType:i,imgBase64:o}));case 15:C.info("saveAndSendAvatar imgBase64 is empty!");case 16:e.next=23;break;case 18:e.prev=18,e.t0=e.catch(0),C.error("saveAndSendAvatar error:",e.t0),coreUi.changeIsShowAvatarLoading(!1),window.alert(language.SET_AVATAR_FAILED);case 23:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(){return e.apply(this,arguments)}}());t.hideAvatarLeader=function(){var e=(0,m.default)(g.default.mark(function e(){var t;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreDb.saveLoginSetting({key:"isShowAvatarLeader",value:!1});case 3:t=e.sent,t?C.info("hideAvatarLeader success, result:",t):C.info("hideAvatarLeader faile, result:",t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),C.error("hideAvatarLeader error",e.t0);case 10:case"end":return e.stop()}},e,void 0,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),t.queryAvatarLeaderStatus=function(){var e=(0,m.default)(g.default.mark(function e(){var t;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreDb.queryLoginSetting({key:"isShowAvatarLeader"});case 3:if(!(t=e.sent)||"isShowAvatarLeader"!==t.key){e.next=9;break}return C.info("queryAvatarLeaderStatus success, result:",t),e.abrupt("return","true"===t.value);case 9:return C.info("queryAvatarLeaderStatus faile, result:",t),e.abrupt("return",!0);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),C.error("hideAvatarLeader error",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(){return e.apply(this,arguments)}}()},1033:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.initialAutoResponseConf=t.updateAutoResponseConf=void 0;var a=n(1),i=r(a),o=n(2),s=r(o),u=n(640),c=coreLogger.getLogger("model")("logger");t.updateAutoResponseConf=function(){var e=(0,s.default)(i.default.mark(function e(){var t,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().myInfo.isAutoResponseConf,c.info("get state isAutoResponseConf="+t),t=!t,n=[{key:"isAutoResponseConf",value:t.toString()}],c.info("userClick  change auto response conf state=",t),e.next=7,$dispatch(coreUi.changeAutoResponseConf(t));case 7:return e.next=9,coreDb.saveUserConfig(n);case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.initialAutoResponseConf=function(){coreDb.queryUserConfigList({all:""}).then(function(e){var t="";if(t=e.find(function(e){return"isAutoResponseConf"===e.key}),c.info("query isResponse=="+t),t){var n=(0,u.stringToBoolean)(t.value);$dispatch(coreUi.changeAutoResponseConf(n)),window.CLIENTCONFIG.ISMOBILE||appService.initMainTray()}})}},1034:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaSettingFromDB=t.getValidCamDeviceSerialNum=t.getValidSpkDeviceSerialNum=t.getDefaultSpkDevice=t.setAndSaveCamDevice=t.setAndSaveSpkDevice=t.setAndSaveMicDevice=t.getInsertDeviceById=t.getInsertDeviceByName=t.clearMicPreviewLevel=t.getMicPreviewLevel=t.stopMicPreview=t.startMicPreview=t.stopSpkTestFile=t.startSpkTestFile=t.setSpkGainValue=t.setMicGainValue=t.setMicAgc=t.setSvcSendLevel=t.setSpkGainEnable=t.setMicGainEnable=t.setMasterSpkValue=t.setMasterMicValue=t.refreshMediaIndex=t.setVideoIndex=t.getVideoIndex=t.setSpkIndex=t.getSpkIndex=t.setMicIndex=t.getMicIndex=t.initMasterVoiceValue=t.MediaSetTUP=t.initMediaDevice=t.initialMediaSetting=void 0;var a=n(69),i=r(a),o=n(1),s=r(o),u=n(2),c=r(u),l=n(640),f=coreLogger.getLogger("logic")("setting/SettingMedia"),d=(t.initialMediaSetting=function(e){var t=e.find(function(e){return"micGainEnable"===e.key});if(t){var n=(0,l.stringToBoolean)(t.value);$dispatch(coreUi.changeMicGainEnable(n))}var r=e.find(function(e){return"spkGainEnable"===e.key});if(r){var a=(0,l.stringToBoolean)(r.value);$dispatch(coreUi.changeSpkGainEnable(a))}var i=e.find(function(e){return"micGain"===e.key});if(i){var o=Number(i.value);$dispatch(coreUi.changeMicGainValue(o))}var s=e.find(function(e){return"spkGain"===e.key});if(s){var u=Number(s.value);$dispatch(coreUi.changeSpkGainValue(u))}var c=e.find(function(e){return"micAgc"===e.key});if(c){var f=(0,l.stringToBoolean)(c.value);$dispatch(coreUi.changeMicAgc(f))}var p=e.find(function(e){return"MicNameKey"===e.key});p&&$dispatch(coreUi.changeMicDevice(p.value));var v=e.find(function(e){return"SpkNameKey"===e.key});v&&$dispatch(coreUi.changeSpkDevice(v.value));var g=e.find(function(e){return"CamNameKey"===e.key});if(g){var h=Number(g.value);$dispatch(coreUi.changeCamDevice(h))}if(window.fs)return d()},t.initMediaDevice=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("enter initMediaDevice"),t=0,n=0,e.next=5,coreCall.getALLDevices();case 5:if(window.CLIENTCONFIG.ISMOBILE){e.next=30;break}if(r=$getState().call.cameraDevicesList,a=E(r),0===r.length){e.next=12;break}return e.next=11,y(r[a].index);case 11:n=r[a].index;case 12:return e.next=14,g(0);case 14:if(i=$getState().call.spkDevicesList,a=window.CLIENTCONFIG.ISBIGWIN?b(i):L(i),0===i.length){e.next=20;break}return e.next=19,m(i[a].index);case 19:t=i[a].index;case 20:if(!window.CLIENTCONFIG.ISBIGWIN){e.next=28;break}return e.next=23,coreAccount.set({key:"cameraDevicesList",value:r,isPublic:!0});case 23:return e.next=25,coreAccount.set({key:"spkDevicesList",value:i,isPublic:!0});case 25:return e.next=27,coreAccount.set({key:"micDevicesList",value:$getState().call.micDevicesList,isPublic:!0});case 27:window.anonymousJoinConf&&coreConf.NotifyDeviceListReady();case 28:return e.next=30,N(t,n);case 30:f.info("leave initMediaDevice");case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.MediaSetTUP=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a,i,o,u,c,l,d;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("start init media setting"),t=$getState().call.micValue,n=$getState().call.voiceValue,r=$getState().setting.micGainEnable,a=$getState().setting.spkGainEnable,i=$getState().setting.micGain,o=$getState().setting.spkGain,u=$getState().setting.micAgc,r&&(window.CLIENTCONFIG.MIC_GAIN=i),a&&(window.CLIENTCONFIG.SPK_GAIN=o),e.next=12,p();case 12:return e.next=14,coreCall.setMicVol(t);case 14:return e.next=16,coreCall.setSpkVol(n);case 16:if(window.CLIENTCONFIG.ISMOBILE){e.next=37;break}if(c=$getState().setting.micDevice,l=$getState().call.micDevicesList,d=-1,window.CLIENTCONFIG.ISBIGWIN){e.next=31;break}if(-1===(d=k(c,l))){e.next=25;break}return e.next=25,g(l[d].index);case 25:if(c=$getState().setting.spkDevice,l=$getState().call.spkDevicesList,-1===(d=k(c,l))){e.next=31;break}return e.next=31,m(l[d].index);case 31:if(c=$getState().setting.camDevice,l=$getState().call.cameraDevicesList,-1===(d=x(c,l))){e.next=37;break}return e.next=37,y(l[d].index);case 37:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),p=t.initMasterVoiceValue=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.getMicDeviceVol();case 2:return t=e.sent,0===t.result?$dispatch(coreUi.changeMasterMicValue(t.param.volume)):f.info("initMasterVoiceValue mic failed, res=",(0,i.default)(t)),e.next=6,coreCall.getSpkDeviceVol();case 6:n=e.sent,0===n.result?$dispatch(coreUi.changeMasterSpkValue(n.param.volume)):f.info("initMasterVoiceValue spk failed, res=",(0,i.default)(n));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),v=t.getMicIndex=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.getMicIndex();case 2:t=e.sent,0===t.result?f.info("get mic index success, data= ",(0,i.default)(t)):f.info("get mic index failed, res=",t.result);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),g=t.setMicIndex=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.setMicIndex(t);case 2:return n=e.sent,0===n.result?($dispatch(coreUi.changeMicIndex(t)),f.info("set mic index success")):f.info("set mic index failed, ret=",n.result),e.abrupt("return",n.result);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),h=t.getSpkIndex=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.getSpkIndex();case 2:t=e.sent,0===t.result?f.info("get spk index success, data= ",(0,i.default)(t)):f.info("get spk index failed, ret=",t.result);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),m=t.setSpkIndex=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.setSpkIndex(t);case 2:return n=e.sent,0===n.result?($dispatch(coreUi.changeSpkIndex(t)),f.info("set spk index success")):f.info("set spk index failed, ret=",n.result),e.abrupt("return",n.result);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),w=t.getVideoIndex=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.getVideoIndex();case 2:t=e.sent,0===t.result?f.info("get video index success, data= ",(0,i.default)(t)):f.info("get video index failed, ret=",t.result);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),y=t.setVideoIndex=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.setVideoIndex(t);case 2:return n=e.sent,0===n.result?($dispatch(coreUi.changeCamIndex(t)),f.info("set video index success")):f.info("set video index failed, ret=",n.result),e.abrupt("return",n.result);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),S=(t.refreshMediaIndex=function(){var e=(0,c.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:return e.next=4,h();case 4:return e.next=6,w();case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setMasterMicValue=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.setMicDeviceVol(0,t);case 2:n=e.sent,0===n.result?($dispatch(coreUi.changeMasterMicValue(t)),f.info("userClick to set mic device voice success, value= ",t)):f.info("userClick to set mic device voice failed, res= ",n.result);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setMasterSpkValue=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.setSpkDeviceVol(0,t);case 2:n=e.sent,0===n.result?($dispatch(coreUi.changeMasterSpkValue(t)),f.info("userClick to set spk device voice success, value= ",t)):f.info("userClick to set spk device voice failed, res= ",n.result);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setMicGainEnable=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a,i,o,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!$getState().setting.micGainEnable,$dispatch(coreUi.changeMicGainEnable(n)),r=[{key:"micGainEnable",value:n.toString()}],e.next=5,coreDb.saveUserConfig(r);case 5:if(f.info("userClick to change mic gain enable = ",n),a=document.getElementById(t),!n){e.next=18;break}return a.disabled=!1,a.style.color="#3c4053",i=$getState().setting.micGain,o=$getState().call.micValue,window.CLIENTCONFIG.MIC_GAIN=i,e.next=15,coreCall.setMicVol(o);case 15:f.info("userClick to enable mic gain, set client gain = ",window.CLIENTCONFIG.MIC_GAIN),e.next=25;break;case 18:return a.disabled=!0,a.style.color="#D3D3D3",window.CLIENTCONFIG.MIC_GAIN=1,u=$getState().call.micValue,e.next=24,coreCall.setMicVol(u);case 24:f.info("userClick to disable mic gain, set client gain = ",window.CLIENTCONFIG.MIC_GAIN);case 25:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setSpkGainEnable=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a,i,o,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!$getState().setting.spkGainEnable,$dispatch(coreUi.changeSpkGainEnable(n)),r=[{key:"spkGainEnable",value:n.toString()}],e.next=5,coreDb.saveUserConfig(r);case 5:if(f.info("userClick to change spk gain enable = ",n),a=document.getElementById(t),!n){e.next=18;break}return a.disabled=!1,a.style.color="#3c4053",i=$getState().setting.spkGain,o=$getState().call.voiceValue,window.CLIENTCONFIG.SPK_GAIN=i,e.next=15,coreCall.setSpkVol(o);case 15:f.info("userClick to enable spk gain, set gain = ",window.CLIENTCONFIG.SPK_GAIN),e.next=25;break;case 18:return a.disabled=!0,a.style.color="#D3D3D3",window.CLIENTCONFIG.SPK_GAIN=1,u=$getState().call.voiceValue,e.next=24,coreCall.setSpkVol(u);case 24:f.info("userClick to disable spk gain, set gain = ",window.CLIENTCONFIG.SPK_GAIN);case 25:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setSvcSendLevel=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t<0||t>=3)&&(t=0),window.svc_video_level_tbl_id=t,window.localStorage.setItem("svc_video_level_tbl_id",t),n={media:{svc_resolution_table:constant.SvcResolutionPCTable[t]}},f.info((0,i.default)(n)),e.next=7,coreTup.getCallInstance();case 7:return r=e.sent,e.next=10,r.config(n);case 10:a=e.sent,0===a.result?f.info("setSvcResTable success"):f.info("setSvcResTable failed, result = "+a.result);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Number(t),r={audio:{audio_agc:n}},e.next=4,coreTup.getCallInstance();case 4:return a=e.sent,e.next=7,a.config(r);case 7:i=e.sent,0!==i.result&&f.info("config mic agc to call failed, result= ",i.result);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),C=(t.setMicAgc=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!$getState().setting.micAgc,$dispatch(coreUi.changeMicAgc(t)),f.info("userClick to change mic agc enable= ",t),e.next=5,S(t);case 5:return n=[{key:"micAgc",value:t.toString()}],e.next=8,coreDb.saveUserConfig(n);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setMicGainValue=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.CLIENTCONFIG.MIC_GAIN=t,$dispatch(coreUi.changeMicGainValue(t)),n=[{key:"micGain",value:t.toString()}],e.next=5,coreDb.saveUserConfig(n);case 5:return r=$getState().call.micValue,e.next=8,coreCall.setMicVol(r);case 8:f.info("userClick to change mic gain value = ",window.CLIENTCONFIG.MIC_GAIN);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setSpkGainValue=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.CLIENTCONFIG.SPK_GAIN=t,$dispatch(coreUi.changeSpkGainValue(t)),n=[{key:"spkGain",value:t.toString()}],e.next=5,coreDb.saveUserConfig(n);case 5:return r=$getState().call.voiceValue,e.next=8,coreCall.setSpkVol(r);case 8:f.info("userClick to change spk gain value = ",window.CLIENTCONFIG.SPK_GAIN);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),-1),I=(t.startSpkTestFile=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===C){e.next=2;break}return e.abrupt("return");case 2:return t=window.path.join(window.RING_PATH,"SoundTest.wav"),e.next=5,coreCall.startPlayMediaFile(t);case 5:n=e.sent,0===n.result?(C=n.param.play_handle,f.info("userClick to start spk test file success, res = "+(0,i.default)(n))):f.info("userClick to start spk test file failed, res = ",n.result);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.stopSpkTestFile=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==C){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,coreCall.stopPlayMediaFile(C);case 4:t=e.sent,0===t.result?(C=-1,f.info("stop spk test file success")):f.info("stop spk test file failed, res = ",t.result);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startMicPreview=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("userClick to start mic preview"),e.next=3,coreCall.openAudioPreview();case 3:t=e.sent,0!==t.result&&f.info("userClick to start mic preview failed, result = ",t.result);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.stopMicPreview=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info("userClick to stop mic preview"),e.next=3,coreCall.closeAudioPreview();case 3:t=e.sent,0!==t.result&&f.info("userClick to stop mic preview failed, result = ",t.result);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicPreviewLevel=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCall.getMicLevel();case 2:if(t=e.sent,0!==t.result)f.info("get mic preview level failed, result = ",t.result);else for(n=t.param.level,r=parseInt(n/10*35),a=0;a<35;a++)i="micItem"+a.toString(),document.getElementById(i).style.backgroundColor=a<r?"#4874d3":"#c0c0c0";case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.clearMicPreviewLevel=function(){for(var e=0;e<35;e++){var t="micItem"+e.toString();document.getElementById(t).style.backgroundColor="#c0c0c0"}},t.getInsertDeviceByName=function(e,t){f.info("start to find new device, old list = ",e);for(var n=0;n<t.length;n++){for(var r=!1,a=0;a<e.length;a++)if(t[n].name===e[a].name){r=!0;break}if(!1===r)return f.info("find new device success, name = ",t[n].name),n}return-1},t.getInsertDeviceById=function(e,t){f.info("start to find new device, old list = ",e);for(var n=0;n<t.length;n++){for(var r=!1,a=0;a<e.length;a++)if(t[n].device_id===e[a].device_id){r=!0;break}if(!1===r)return f.info("find new device success, id="+t[n].device_id+", name="+t[n].name),n}return-1},function(){var e=(0,c.default)(s.default.mark(function e(t,n){var r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[{key:t,value:n.toString()}],e.next=3,coreDb.saveUserConfig(r);case 3:f.info("save media device, describe="+t+", device="+n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),k=(t.setAndSaveMicDevice=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.micDevicesList,!(t<n.length)){e.next=10;break}return r=n[t],e.next=5,g(r.index);case 5:if(0!==(a=e.sent)){e.next=10;break}return i=r.name,e.next=10,I("MicNameKey",i);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setAndSaveSpkDevice=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.spkDevicesList,!(t<n.length)){e.next=10;break}return r=n[t],e.next=5,m(r.index);case 5:if(0!==(a=e.sent)){e.next=10;break}return i=r.name,e.next=10,I("SpkNameKey",i);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setAndSaveCamDevice=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.cameraDevicesList,!(t<n.length)){e.next=9;break}return r=n[t],e.next=5,y(r.index);case 5:if(0!==(a=e.sent)){e.next=9;break}return e.next=9,I("CamNameKey",r.name);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(e,t){if(""!==e&&0!==t.length){f.info("start to find device by name, name=",e);for(var n=0;n<t.length;n++){var r=t[n].name;if((r=A(r))===e)return n}}return-1}),x=function(e,t){if(0!==e&&0!==t.length){f.info("start to find device by id, id=",e);for(var n=0;n<t.length;n++)if(t[n].device_id===e)return n}return-1},A=function(e){return 0===e.indexOf("default: ")&&(e=e.slice(9)),e},b=t.getDefaultSpkDevice=function(e){for(var t=e.length,n=0;n<t;n++){var r=e[n].name;if(0===r.indexOf("default: ")){if(-1===r.indexOf("Stereo"))return f.info("getDefaultSpkDevice:"+n),n;break}}var a=L(e);return f.info("getValidSpkDeviceSerialNum:"+a),a},L=t.getValidSpkDeviceSerialNum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.length;if(0===n)return f.info("spk device list is null, return defaule 0"),0;if(-1!==t&&t<n){var r=e[t].name;if(f.info("start to check appointed spk device, name=",r),-1===r.indexOf("Stereo"))return t;r=A(r);var a=r.replace("Stereo","Hands-Free");f.info("appointed spk device mode is Stereo, device="+t+", start to find paired Hands-Free mode spk device, name="+a);var i=k(a,e);if(-1!==i)return f.info("find paired Hands-Free mode spk device success, serial number=",i),i}if(f.info("start to find first valid spk device"),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){for(var o=0;o<n;o++)if(-1===e[o].strname.indexOf("Stereo"))return f.info("[IT-Meeting] find first valid spk device success, index=",o),o}else for(var s=0;s<n;s++)if(-1===e[s].name.indexOf("Stereo"))return f.info("find first valid spk device success, index=",s),s;return f.info("there is no valid spk device finded, return defaule 0"),0},E=t.getValidCamDeviceSerialNum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===e.length)return f.info("camera device list null, return defaule 0"),0;if(-1!==t&&t<e.length){var r=e[t].name;f.info("start to check appointed camera device, name=",r);e[t];if(-1===r.indexOf("IR Camera"))return t}if(0!==n){f.info("start to find original camera device, device id= ",n);var a=x(n,e);if(-1!==a)return f.info("find original camera device success, serial number =",a),a}f.info("start to find first no IR camera device");for(var i=0;i<e.length;i++)if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){if(-1===e[i].strname.indexOf("IR Camera"))return f.info(" [IT-Meeting] get no IR camera serial number = ",i),i}else if(-1===e[i].name.indexOf("IR Camera"))return f.info("get no IR camera serial number = ",i),i;return f.info("there is no valid camera device finded, return defaule 0"),0},N=t.getMediaSettingFromDB=function(){var e=(0,c.default)(s.default.mark(function e(t,n){var r,a,i,o,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=$getState(),a=r.call,i=a.micDevicesList,o=a.spkDevicesList,u=a.cameraDevicesList,coreDb.queryUserConfig({key:"MicNameKey"}).then(function(e){var t=0;if(!isNullOrEmpty(e)&&!isNullOrEmpty(e.key)&&!isNullOrEmpty(e.value)){var n=e.value;f.info("get MicName setting from db",n),t=i.findIndex(function(e){return e.name===n}),t=t>0&&t<i.length?t:0}g(t)}),coreDb.queryUserConfig({key:"SpkNameKey"}).then(function(e){var n=0;if(!isNullOrEmpty(e)&&!isNullOrEmpty(e.key)&&!isNullOrEmpty(e.value)){var r=e.value;f.info("get SpkName setting from db",r),n=o.findIndex(function(e){return e.name===r}),n=n>0&&n<o.length?n:t}m(n)}),coreDb.queryUserConfig({key:"CamNameKey"}).then(function(e){var t=0;if(!isNullOrEmpty(e)&&!isNullOrEmpty(e.key)&&!isNullOrEmpty(e.value)){var r=e.value;f.info("get CamName setting from db",r),t=u.findIndex(function(e){return e.name===r}),t=t>0&&t<u.length?t:n}y(t)});case 4:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()},1035:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.queryDoubleScreen=t.updateDoubleScreen=t.updateAutoAcceptConf=t.queryDbAutoLeave=t.updateAutoLeave=t.queryDbAutoLeaveTime=t.choseTime=t.saveMessageNotifyConfig=t.updateIsMobileMessageNotify=t.updateIsMessageNotify=t.queryMessageNotifyConfig=t.updateIsMessageCommingShock=t.updateIsMessageCommingRing=t.updateIsCallCommingRing=t.updateIsIMRecieveRing=t.updateIsOpenShock=void 0;var a=n(69),i=r(a),o=n(1),s=r(o),u=n(2),c=r(u),l=n(1030),f=n(640),d=coreLogger.getLogger("logic/setting")("settingConfig"),p=(t.updateIsOpenShock=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().setting.isOpenShock,t?d.info("userClick  shock and now is closed"):d.info("userClick  shock and now is open"),t=!t,e.next=5,$dispatch(coreUi.bOpenShock(t));case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateIsIMRecieveRing=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().setting.isIMRecieveRing,t=!t,e.next=4,$dispatch(coreUi.bIMRecieveRing(t));case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateIsCallCommingRing=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().setting.isCallCommingRing,t=!t,t?d.info("userClick  CallCommingRing  and now is open"):d.info("userClick  CallCommingRing  and now is closed"),e.next=5,$dispatch(coreUi.bCallCommingRing(t));case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateIsMessageCommingRing=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().setting.isMessageNotifyRing,t=!t,t?d.info("userClick  MessageCommingRing  and now is open"):d.info("userClick  MessageCommingRing  and now is closed"),e.next=5,$dispatch(coreUi.bMessageNotifyRing(t));case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateIsMessageCommingShock=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().setting.isMessageNotifyShock,t=!t,t?d.info("userClick  MessageCommingShock  and now is open"):d.info("userClick  MessageCommingShock  and now is closed"),e.next=5,$dispatch(coreUi.bMessageNotifyShock(t));case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.queryMessageNotifyConfig=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("queryMessageNotifyConfig beggin!"),e.next=3,coreDb.queryUserConfig({key:"isMessageNotifyRing"});case 3:return t=e.sent,n="false"!==t.value,e.next=7,coreDb.queryUserConfig({key:"isMessageNotifyShock"});case 7:r=e.sent,a="false"!==r.value,$dispatch(coreUi.bMessageNotifyRing(n)),$dispatch(coreUi.bMessageNotifyShock(a));case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateIsMessageNotify=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=$getState().setting.hasOpenPush)){e.next=6;break}return e.next=4,coreAccount.unRegisterPush({isOperate:!0});case 4:e.next=7;break;case 6:window.initMobileNative();case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateIsMobileMessageNotify=function(){var e=(0,c.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreIm.setMuteForMobile();case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.saveMessageNotifyConfig=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a,i,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().setting.isOpenShock,n=$getState().setting.isIMRecieveRing,r=$getState().setting.isCallCommingRing,a=$getState().setting.isMessageNotifyRing,i=$getState().setting.isMessageNotifyShock,o=[{key:"isOpenShock",value:t.toString()},{key:"isIMRecieveRing",value:n.toString()},{key:"isCallCommingRing",value:r.toString()},{key:"isMessageNotifyRing",value:a.toString()},{key:"isMessageNotifyShock",value:i.toString()}],e.next=8,coreDb.saveUserConfigList(o);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.choseTime=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return isNullOrEmpty(t)&&(t=constant.AUTO_LIVE_TIME.MINUTES_5),e.next=3,coreDb.saveUserConfig({key:"autoLeaveTime",value:t});case 3:$dispatch(coreUi.changeAtuoLeaveTime(t)),n=new l.AutoLeaveSetting,n.startTime();case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),v=t.queryDbAutoLeaveTime=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryUserConfig({key:"autoLeaveTime"});case 2:t=e.sent,n=t&&t.value,d.info("query atuo leave time from DB is",n),isNullOrEmpty(n)&&(n=constant.AUTO_LIVE_TIME.MINUTES_5),$dispatch(coreUi.changeAtuoLeaveTime(n));case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),g=t.updateAutoLeave=function(){var e=(0,c.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=$getState().myInfo.isAutoLeave,d.info("get state isAutoLeave="+n),n=void 0!==t?t:!n,e.next=5,coreDb.saveUserConfig({key:"isAutoLeave",value:n.toString()});case 5:$dispatch(coreUi.changeAutoLeave(n)),new l.AutoLeaveSetting;case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),h=(t.queryDbAutoLeave=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryUserConfig({key:"isAutoLeave"});case 2:t=e.sent,isNullOrEmpty(t)?(g(!0),p()):(n=(0,f.stringToBoolean)(t.value),d.info("query atuo leave from DB is",n),v(),$dispatch(coreUi.changeAutoLeave(n)));case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateAutoAcceptConf=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreAccount.getMyInfo();case 2:return t=e.sent,n=t.isAutoAcceptConf,d.info("get state isAutoAcceptConf="+n),n=!n,r=[{key:"isAutoAcceptConf",value:n.toString()}],n?d.info("userClick  autoAcceptConf and now is open"):d.info("userClick  autoAcceptConf and now is closed"),d.info("change auto accept conf state=",n),t.isAutoAcceptConf=n,e.next=12,coreDb.saveUserConfig(r);case 12:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateDoubleScreen=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("userClick  change double screen enable state=",t),$dispatch(coreUi.changeEnableDoubleScreen(t)),n=[{key:"enableDoubleScreen",value:t.toString()}],d.info("user save double screen enable state="+(0,i.default)(n)),r={enableDoubleScreen:t},coreConf.getSvcAtdManager().setParam(r),e.next=8,coreDb.saveUserConfig(n);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());t.queryDoubleScreen=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryUserConfig({key:"enableDoubleScreen"});case 2:t=e.sent,isNullOrEmpty(t)?h(!1):(n=(0,f.stringToBoolean)(t.value),d.info("query double screen enable state from DB is",n),$dispatch(coreUi.changeEnableDoubleScreen(n)));case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},1036:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.choiceAutoResponse=t.addAutoResponseList=t.delAutoResponseList=t.addDefaultAutoResponseList=void 0;var a=n(1),i=r(a),o=n(69),s=r(o),u=n(2),c=r(u),l=coreLogger.getLogger("model")("logger"),f=(t.addDefaultAutoResponseList=function(){var e=(0,c.default)(i.default.mark(function e(){var t,n,r,a,o,u,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=void 0,e.next=4,coreDb.queryUserConfigList({key:"firstGetAutoResponseList"});case 4:if(r=e.sent,0!==r.length){e.next=15;break}l.info("第一次查询初始化默认自动回复语句"),coreDb.saveUserConfigList({key:"firstGetAutoResponseList",value:"isNotFirst"}),t.push({responseType:"default",defaultResponseId:"DEFAULT_RESPONSE",name:language.DEFAULT_RESPONSE}),n={responseType:"default",defaultResponseId:"DEFAULT_RESPONSE",name:language.DEFAULT_RESPONSE},coreDb.saveUserConfigList({key:"defaultAutoResponseIdList",value:"DEFAULT_RESPONSE"}),coreDb.saveUserConfigList({key:"defaultAutoResponseList",value:(0,s.default)(n)}),l.info("defaultAutoResponseList",n),e.next=29;break;case 15:return l.info("查询自动回复语句"),e.next=18,coreDb.queryUserConfigList({key:"customAutoResponseList"});case 18:return a=e.sent,e.next=21,coreDb.queryUserConfigList({key:"defaultAutoResponseIdList"});case 21:return o=e.sent,e.next=24,coreDb.queryUserConfigList({key:"defaultAutoResponseList"});case 24:u=e.sent,l.info("defaultAutoReplyPreview",u),o.length>0&&t.push({responseType:"default",defaultResponseId:"DEFAULT_RESPONSE",name:language.DEFAULT_RESPONSE});try{a.length>0&&(c=JSON.parse(a[0].value),c.map(function(e,n){t.unshift({responseType:"custom",defaultResponseId:"no",name:e.customValue})}))}catch(e){l.error("addDefaultAutoResponseList error",e)}if(u.length>0){l.info("defaultAutoResponseList true");try{n=JSON.parse(u[0].value)}catch(e){l.error("defaultAutoResponseList exception: "+e.toString()),n={responseType:"default",defaultResponseId:"DEFAULT_RESPONSE",name:language.DEFAULT_RESPONSE}}}else l.info("defaultAutoResponseList false"),n="";case 29:l.info("defaultAutoResponseList",n),$dispatch(coreUi.changeAutoReplyListConf(t)),$dispatch(coreUi.changeAutoReplyPreConf(n));case 32:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.delAutoResponseList=function(){var e=(0,c.default)(i.default.mark(function e(t,n,r){var a,o,u,c,l,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=$getState().setting.autoReplyList,o="",u=[],c=0;case 4:if(!(c<a.length)){e.next=28;break}if(!r){e.next=21;break}if("default"!==a[c].responseType){e.next=15;break}if(n!==d){e.next=9;break}return e.abrupt("break",28);case 9:return a.splice(c,1),a.push({responseType:"custom",defaultResponseId:"no",name:d}),language[p.defaultResponseId]===n&&f({responseType:"custom",defaultResponseId:"no",name:d}),e.abrupt("break",28);case 15:if(a[c].name!==n){e.next=19;break}return a[c].name=d,p.name===n&&f({responseType:"custom",defaultResponseId:"no",name:d}),e.abrupt("break",28);case 19:e.next=25;break;case 21:if(a[c].name!==n&&language[a[c].defaultResponseId]!==n){e.next=25;break}return a.splice(c,1),p.name!==n&&language[p.defaultResponseId]!==n||(0===a.length?(coreDb.deleteUserConfig({key:"defaultAutoResponseList"}),$dispatch(coreUi.changeAutoReplyPreConf(""))):f(a[0])),e.abrupt("break",28);case 25:c++,e.next=4;break;case 28:$dispatch(coreUi.changeAutoReplyListConf(a)),a.map(function(e,t){"default"===a[t].responseType?o=e.defaultResponseId:u.unshift({customValue:e.name})}),""===o?coreDb.deleteUserConfig({key:"defaultAutoResponseIdList"}):(l={responseType:"default",defaultResponseId:"DEFAULT_RESPONSE",name:language.DEFAULT_RESPONSE},coreDb.saveUserConfigList({key:"defaultAutoResponseIdList",value:(0,s.default)(l)})),coreDb.saveUserConfigList({key:"customAutoResponseList",value:(0,s.default)(u)});case 32:case"end":return e.stop()}},e,void 0)}));return function(t,n,r){return e.apply(this,arguments)}}(),t.addAutoResponseList=function(){var e=(0,c.default)(i.default.mark(function e(t){var n,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState().setting.autoReplyList,r=[],0===n.length&&f({responseType:"custom",defaultResponseId:"no",name:t}),n.length<10&&(n.unshift({responseType:"custom",defaultResponseId:"no",name:t}),n.map(function(e,t){"custom"===e.responseType&&r.unshift({customValue:e.name})}),$dispatch(coreUi.changeAutoReplyListConf(n)),coreDb.saveUserConfigList({key:"customAutoResponseList",value:(0,s.default)(r)}));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.choiceAutoResponse=function(){var e=(0,c.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:coreDb.saveUserConfigList({key:"defaultAutoResponseList",value:(0,s.default)(t)}),$dispatch(coreUi.changeAutoReplyPreConf(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())},109:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwSettingSdk=void 0;var i=n(123),o=a(i),s=n(4),u=a(s),c=n(1856),l=r(c),f=n(1857),d=r(f),p=n(1858),v=r(p),g=n(1859),h=r(g),m=n(1031),w=r(m),y=n(1861),S=r(y),C=n(1032),I=r(C),k=n(1033),x=r(k),A=n(1862),b=r(A),L=n(1035),E=r(L),N=n(640),T=r(N),_=n(1034),M=r(_),O=n(1036),R=r(O),D=n(1863),U=r(D),P=n(1864),$=r(P);t.HwSettingSdk=function e(){(0,u.default)(this,e),(0,o.default)(this,l),(0,o.default)(this,d),(0,o.default)(this,v),(0,o.default)(this,h),(0,o.default)(this,w),(0,o.default)(this,S),(0,o.default)(this,I),(0,o.default)(this,x),(0,o.default)(this,b),(0,o.default)(this,E),(0,o.default)(this,T),(0,o.default)(this,M),(0,o.default)(this,R),(0,o.default)(this,U),(0,o.default)(this,$)}},118:function(e,t,n){e.exports=n(0)(0)},123:function(e,t,n){e.exports=n(0)(562)},129:function(e,t,n){"use strict";t.__esModule=!0;var r=n(143),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,a.default)(e)}},130:function(e,t,n){e.exports=n(0)(238)},135:function(e,t,n){e.exports={default:n(150),__esModule:!0}},141:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=n(170),i=r(a),o=n(135),s=r(o);t.default=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=(0,s.default)(e);!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,i.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},143:function(e,t,n){e.exports={default:n(158),__esModule:!0}},150:function(e,t,n){n(23),n(22),e.exports=n(151)},151:function(e,t,n){var r=n(9),a=n(26);e.exports=n(8).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},158:function(e,t,n){n(22),n(159),e.exports=n(8).Array.from},159:function(e,t,n){"use strict";var r=n(11),a=n(10),i=n(130),o=n(32),s=n(33),u=n(27),c=n(160),l=n(26);a(a.S+a.F*!n(34)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,a,f,d=i(e),p="function"==typeof this?this:Array,v=arguments.length,g=v>1?arguments[1]:void 0,h=void 0!==g,m=0,w=l(d);if(h&&(g=r(g,v>2?arguments[2]:void 0,2)),void 0==w||p==Array&&s(w))for(t=u(d.length),n=new p(t);t>m;m++)c(n,m,h?g(d[m],m):d[m]);else for(f=w.call(d),n=new p;!(a=f.next()).done;m++)c(n,m,h?o(f,g,[a.value,m],!0):a.value);return n.length=m,n}})},160:function(e,t,n){"use strict";var r=n(25),a=n(161);e.exports=function(e,t,n){t in e?r.f(e,t,a(0,n)):e[t]=n}},161:function(e,t,n){e.exports=n(0)(79)},170:function(e,t,n){e.exports={default:n(171),__esModule:!0}},171:function(e,t,n){n(23),n(22),e.exports=n(172)},172:function(e,t,n){var r=n(16),a=n(6)("iterator"),i=n(17);e.exports=n(8).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||i.hasOwnProperty(r(t))}},1856:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=coreLogger.getLogger("logic/setting")("changeFeedback");t.showFeedback=function(){r.info("userClick  system feedback"),$dispatch(coreUi.changeShowFeedback(!0))},t.hideFeedback=function(){$dispatch(coreUi.changeShowFeedback(!1))}},1857:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=coreLogger.getLogger("logic/setting")("changePassword");t.showChangePassword=function(e){if(e){if("login"!==window.getRoute()&&$getState().myInfo.status===constant.ONLINE_STATUS.OFFLINE)return r.info("showChangePassword  Offline not allow"),void window.ToastNew(language.OFFLINE_STATUS);r.info("userClick  show system setting change xx window")}e||r.info("userClick  close system setting change xx window"),$dispatch(coreUi.changeShowChangePassword(e))}},1858:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setCurrentCode=function(e){$dispatch(coreUi.setCode(e))},t.changeShowEquipmentPairing=function(e){$dispatch(coreUi.changeEquipmentPairingShow(e))},t.changeTipsVisible=function(e){$dispatch(coreUi.changeTips(e))},t.setTipsInfo=function(e){$dispatch(coreUi.changeTipsInfo(e))},t.setIsResultVisible=function(e){$dispatch(coreUi.changeIsResultVisible(e))}},1859:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkAutoLeave=t.AutoLeaveSetting=void 0;var r=n(123),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n(1030),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),s=(t.AutoLeaveSetting=o.AutoLeaveSetting,t.checkAutoLeave=o.checkAutoLeave,coreLogger.getLogger("Setting")("logic"));window.inAppOpenPage=function(e){var t={};if(isNullOrEmpty(e))return new Error("parameter require!");if(Object.type(e)===Object.type.STRING)t.url=e;else{if(Object.type(e)!==Object.type.OBJECT)return new Error("parameter error!");if(t=e,isNullOrEmpty(t.url)||!/(https|http):\/\//gi.test(t.url))return new Error("parameter url error!")}var n=t.title||language.SCAN_CODE_MEMBERSHIP,r=t.loadingTimeout||15e3,i=t.isHideHead||!1;window.dispatchEvent((0,a.default)(new Event("loadingOutSidePage"),{loadingTimeout:r})),void 0!==window.openBrowerTimer&&clearTimeout(window.openBrowerTimer),window.openBrowerTimer=setTimeout(function(){window.dispatchEvent(new Event("closeOutSidePage")),window.inAppBrowserRef&&window.inAppBrowserRef.close(),alert(language.LOGIN_RESUME_NETWORK_ERROR)},r),window.inAppBrowserRef=cordova.InAppBrowser.open(t.url,"_blank","location=no,toolbar=no,EnableViewPortScale=no,hidden=yes"),window.inAppBrowserRef.addEventListener("loadstart",function(e){/.*inappbrowserref_close_url.*/.test(e.url)&&(window.dispatchEvent(new Event("closeOutSidePage")),window.inAppClosePage())}),window.inAppBrowserRef.addEventListener("loadstop",function(){if(window.inAppBrowserRef){window.inAppBrowserRef.executeScript({code:"document.getElementById('joinMeetingAlert').previousElementSibling.style.display = 'none'"});var e='var divObj= document.createElement("div");var title ="'+n+'";var topBarHtml = `<div style="height:7.5vh"></div><div style="position: fixed; top: 0; height:7.5vh; width:100%; z-index:999999;"><div style="text-align: left;background-color: #FBFBFB;height:7.5vh;border-bottom: 1px solid #cccccc"><a href="http://inappbrowserref_close_url"><amenu id="menuAccount" style="width: 4.5vh;height: 4.5vh; margin: 1.5vh 2.25vh 1.8vh 3vh; background: url(https://bcloudec.huaweicloud.com/uPortal/portal/resources/password/images/back.svg) left center no-repeat; float: left"></amenu></a><span style="border-left: 1px solid #ddd;padding-left:3vh;font-size: 2.8vh;background-color: #FBFBFB; height:7.5vh; line-height:7.5vh">${title}</span></div></div>`;divObj.innerHTML = topBarHtml;divObj.className = "cloudLinkTop";var first=document.body.firstChild;document.body.insertBefore(divObj, first);';!i&&window.inAppBrowserRef.executeScript({code:e}),window.inAppBrowserRef.show()}window.setTimeout(function(){return window.dispatchEvent(new Event("closeOutSidePage"))},500),clearTimeout(window.openBrowerTimer)}),window.inAppBrowserRef.addEventListener("loaderror",function(){window.inAppClosePage()})},window.inAppClosePage=function(){s.info("window inAppClosePage start"),window.inAppBrowserRef&&(window.inAppBrowserRef.close(),s.info("window inAppBrowserRef close"),window.inAppBrowserRef=null),s.info("window inAppClosePage end")}},1860:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkAutoLeave=t.AutoLeaveSetting=void 0;var r=n(4),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=coreLogger.getLogger("logic")("setting/autoLeaveSetting"),o=coreCommon.isWin(),s=t.AutoLeaveSetting=function e(){var t=this;(0,a.default)(this,e),this.checkStatus=function(){var e=$getState().myInfo.status,t=coreConf.isInConf()||coreCall.getCallCount()>0;return i.info("AutoLeaveSetting checkStatus",t,e),!(e!==constant.ONLINE_STATUS.ONLINE||t)},this.checkOfflineStatus=function(){var e=$getState().myInfo.status;return e!==constant.ONLINE_STATUS.ONLINE&&e!==constant.ONLINE_STATUS.BUSY&&e!==constant.ONLINE_STATUS.DO_NOT_DISTURB&&e!==constant.ONLINE_STATUS.HIDDEN&&e!==constant.ONLINE_STATUS.LEAVE&&e!==constant.ONLINE_STATUS.MOBILE_ONLINE},this.startTime=function(){if(o){i.debug("AutoLeaveSetting startTime delay time is:",t.leaveTime);var e=60*parseInt(t.leaveTime,10)*1e3;t.checkStatus()&&t.isAuto&&u(e)}},this.stopTime=function(){i.debug("AutoLeaveSetting stopTime"),coreConf.initTimer({isStartTimer:constant.AUTO_LEAVE_TIMER.STOP,timeInterval:10})},this.start=function(){i.info("AutoLeaveSetting start leave delay time is:",t.leaveTime);var e=coreConf.isInConf()||coreCall.getCallCount()>0;if(t.checkOfflineStatus())return i.error("AutoLeaveSetting start status is offline"),t.stopTime();if(t.isAuto){if(e)return t.isLeave=!0,$dispatch(coreUi.changeOldStatus(constant.ONLINE_STATUS.LEAVE,""));t.isLeave=!0,coreAccount.publishStatus({status:constant.ONLINE_STATUS.LEAVE})}},this.stop=function(){i.info("AutoLeaveSetting stop leave"),t.isLeave=!1;var e=coreConf.isInConf()||coreCall.getCallCount()>0;return t.checkOfflineStatus()?(i.error("AutoLeaveSetting stop status is offline"),t.stopTime()):e?$dispatch(coreUi.changeOldStatus(constant.ONLINE_STATUS.ONLINE,"")):void coreAccount.publishStatus({status:constant.ONLINE_STATUS.ONLINE})},this.getSetting=function(){return i.info("AutoLeaveSetting is isAuto:",t.isAuto,"leaveTime:",t.leaveTime),{isAuto:t.isAuto,leaveTime:t.leaveTime}};var n=$getState(),r=n.myInfo.isAutoLeave,s=n.setting.autoLeaveTime;if(e.autoLeaveModel)return i.info("AutoLeaveSetting.autoLeaveModel isAuto leaveTime",r,s),e.autoLeaveModel.isAuto=r,e.autoLeaveModel.leaveTime=s,e.autoLeaveModel;this.isAuto=r,this.leaveTime=s,this.isLeave=!1,e.autoLeaveModel=this},u=(t.checkAutoLeave=function(e){if(o){var t=new s,n=coreConf.isInConf()||coreCall.getCallCount()>0;e===constant.ONLINE_STATUS.ONLINE?t.startTime():(!n&&!t.isLeave||t.checkOfflineStatus())&&t.stopTime()}},function(e){var t=$getState().myInfo.status;(coreConf.isInConf()||coreCall.getCallCount()>0||t===constant.ONLINE_STATUS.ONLINE)&&(coreConf.initTimer({isStartTimer:constant.AUTO_LEAVE_TIMER.STOP,timeInterval:10}),window.setTimeout(function(){coreConf.initTimer({isStartTimer:constant.AUTO_LEAVE_TIMER.START,timeInterval:e})},1e3))})},1861:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.drawPhotoHole=t.queryAvatarLeaderStatus=t.hideAvatarLeader=t.trunImage=t.selectImageHistory=t.loadImageHistory=t.delImageHistory=t.saveAndSendAvatar=t.drawImg=t.standardDraw=t.clipPhoneImage=t.getPhoneImg=t.chooseImg=void 0;var a=n(1032),i=r(a),o=n(1031),s=r(o);t.chooseImg=i.chooseImg,t.getPhoneImg=i.getPhoneImg,t.clipPhoneImage=i.clipPhoneImage,t.standardDraw=i.standardDraw,t.drawImg=i.drawImg,t.saveAndSendAvatar=i.saveAndSendAvatar,t.delImageHistory=i.delImageHistory,t.loadImageHistory=i.loadImageHistory,t.selectImageHistory=i.selectImageHistory,t.trunImage=i.trunImage,t.hideAvatarLeader=i.hideAvatarLeader,t.queryAvatarLeaderStatus=i.queryAvatarLeaderStatus,t.drawPhotoHole=s.drawPhotoHole},1862:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.macAutoStart=t.updateAutoStart=void 0;var a=n(1),i=r(a),o=n(2),s=r(o),u=coreLogger.getLogger("logic")("setting/SettingAutoStart");t.updateAutoStart=function(){var e=(0,s.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().myInfo.isAutoStart,u.info("get state isAutoStart="+t),t=!t,u.info("userClick  change auto start state=",t),e.next=6,$dispatch(coreUi.changeAutoStart(t));case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.macAutoStart=function(){new(window.require(window.__dirname+"/../node_extends/auto-launch"))({name:"CloudLink",path:"/Applications/CloudLink.app"}).isEnabled().then(function(e){u.info("mac auto start : "+e),window.isAutoLauncher=e,$dispatch(coreUi.changeAutoStart(e))})}},1863:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setHasAllowCollectLogsState=t.saveAndissuedChrConfig=t.initChrUpload=t.issuedTerminalConfig=t.issuedChrConfigToCall=t.saveChrUploadState=t.packageChrConfigValue=t.getChrEnableValue=void 0;var a=n(69),i=r(a),o=n(1),s=r(o),u=n(2),c=r(u),l=n(118),f=r(l),d=coreLogger.getLogger("logic")("setting/SettingUpload"),p=t.getChrEnableValue=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,e.next=3,coreAccount.getMyInfo();case 3:return r=e.sent,a=r.isAutoCollectLogs,n=!0===a?t:0,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),v=t.packageChrConfigValue=function(e,t,n){var r=p(e),a=window.APP_DATA_PATH+"/chrFile";window.fs&&(a=window.path.join(window.APP_DATA_PATH,"/chrFile"));var o={enable:r,report_dur:parseInt(t),media_collect_dur:parseInt(n),max_bak_file_num:20,filepath:a},s={call:{cfg_chr:o}};return d.info("pakage chr config value=",(0,i.default)(s)),s},g=t.saveChrUploadState=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r,a,o,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[{key:"isAutoCollectLogs",value:t.toString()}],d.info("user saveChrUploadState="+(0,i.default)(n)),e.next=4,coreDb.saveUserConfig(n);case 4:return e.next=6,coreAccount.getMyInfo();case 6:r=e.sent,r.isAutoCollectLogs=t,!1===t&&w(!1),a="TRUE"===window.CLIENTCONFIG["Device.ComCfg.CHR.enableCHR"]?1:0,o=p(a),u={oprEvent:constant.OPR_EVENT_TYPE.CHR,chrtype:!!o},coreAccount.recordPrivacy(u);case 13:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),h=t.issuedChrConfigToCall=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="TRUE"===window.CLIENTCONFIG["Device.ComCfg.CHR.enableCHR"]?1:0,n=window.CLIENTCONFIG["Device.ComCfg.CHR.CHRPer"],r=window.CLIENTCONFIG["Device.ComCfg.CHR.CHRColPer"],a=v(t,n,r),e.next=6,coreTup.getCallInstance();case 6:return i=e.sent,e.next=9,i.config(a);case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),m=(t.issuedTerminalConfig=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n,r,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",n="win","android"===n?t="Android":"ios"===n?t="iOS":"win"===n||"bigwin"===n?t="Windows":"mac"===n&&(t="Mac"),r={network:{terminal_info:{type:t,version:window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE}}},d.info("config terminal info for chr:"+(0,i.default)(r)),e.next=7,coreTup.getCallInstance();case 7:return a=e.sent,e.next=10,a.config(r);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.initChrUpload=function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t="",coreDb.queryUserConfigList({all:""}).then(function(e){t=e.find(function(e){return"isAutoCollectLogs"===e.key});var n=$getState().displayInfo.showCHRCollectPrompt,r=!t&&n;if(d.info("initChrUpload flag=",r),r&&!window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.CLIENTCONFIG.ISMOBILE&&!window.isPluginEnv)return window.confirm(f.default.createElement("div",{className:"chr-alert"},f.default.createElement("div",{className:"chr-alert-title"}," ",language.ALLOW_COLLECT_AUDIO_VIDEO_TITLE," "),f.default.createElement("div",{className:"chr-alert-text"}," ",language.ALLOW_COLLECT_AUDIO_VIDEO," ")),{leftButton:language.COLLECT_AUDIO_VIDEO_NOT_OPEN_BTN,rightButton:language.ALLOW_COLLECT_AUDIO_VIDEO_BTN}).then(function(e){e.ret?(m(!0),d.info("allow collect CHR")):(m(!1),d.info("cancel set CHR"))})});case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.saveAndissuedChrConfig=function(){var e=(0,c.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("userClick to change chr enable = "+t),e.next=3,g(t);case 3:return e.next=5,h();case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),w=t.setHasAllowCollectLogsState=function(){var e=(0,c.default)(s.default.mark(function e(t){var n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[{key:"hasAllowCollectLogs",value:t.toString()}],d.info("setHasAllowCollectLogsState="+(0,i.default)(n)),e.next=4,coreAccount.getMyInfo();case 4:return r=e.sent,r.hasAllowCollectLogs=t,e.next=8,coreDb.saveUserConfig(n);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},1864:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a=n(1),i=r(a),o=n(2),s=r(o),u=function(){var e=(0,s.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0===t.code&&"total"===t.event&&(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ENABLE_IT_MEETING||(0,l.initialAutoResponseConf)(),window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ENABLE_IT_MEETING?(0,f.loadUserSystemConfig)():((0,f.loadUserSystemConfig)(),(0,d.addDefaultAutoResponseList)(),(0,p.queryDbAutoLeave)()));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,s.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),l=n(1033),f=n(640),d=n(1036),p=n(1035);coreLogger.getLogger("setting")("moduleMessager");coreCommon.registeModuleListener("login",u),coreCommon.registeModuleListener("logout",c)},640:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.showShortcutNotifyFuc=t.showPrivacyDes=t.showCopyrightDes=t.stringToBoolean=t.loadUserSystemConfig=t.setAdvanceSetting=t.showSystemSettings=void 0;var a=n(129),i=r(a),o=n(1),s=r(o),u=n(2),c=r(u),l=n(1034),f=n(118),d=r(f),p=coreLogger.getLogger("common")("common/callNotify");t.showSystemSettings=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"personal";if(p.info("userClick  show system menu system setting",e),e){var n=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getSystemSetting});coreUi.showModal(d.default.createElement(n,{currentPage:t}))}else coreUi.hideModal();$dispatch(coreUi.changeShowSetting(e))},t.setAdvanceSetting=function(){var e=(0,c.default)(s.default.mark(function e(t,n){var r,a,i,o,u,c,l;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[{key:"SRTPMode",value:t.SRTPMode.toString()},{key:"isMKIEnable",value:t.isMKIEnable.toString()},{key:"presentationTransferMode",value:t.presentationTransferMode.toString()},{key:"isCallHeartbeatEnable",value:t.isCallHeartbeatEnable.toString()},{key:"isNoStreamHangUp",value:t.isNoStreamHangUp.toString()},{key:"isBandwidthLimitEnable",value:t.isBandwidthLimitEnable.toString()}],e.next=3,coreDb.saveUserConfig(r);case 3:return e.next=5,$dispatch(coreUi.updateAdvanceSetting(t));case 5:return e.next=7,coreTup.getCallInstance();case 7:if(a=e.sent,i=void 0,o=void 0,u=void 0,c=void 0,l=void 0,!(n.indexOf("SRTP")>=0)){e.next=19;break}return e.next=16,coreAccount.configRTP();case 16:return i=e.sent,e.next=19,a.config(i);case 19:if(!(n.indexOf("MKI")>=0)){e.next=25;break}return e.next=22,coreAccount.configMKI();case 22:return u=e.sent,e.next=25,a.config(u);case 25:if(!(n.indexOf("BFCP")>=0)){e.next=31;break}return e.next=28,coreAccount.configBFCP();case 28:return o=e.sent,e.next=31,a.config(o);case 31:if(!(n.indexOf("Heartbeat")>=0)){e.next=37;break}return e.next=34,coreAccount.configSessionTimer();case 34:return c=e.sent,e.next=37,a.config(c);case 37:if(!(n.indexOf("Limit")>=0)){e.next=43;break}return e.next=40,coreAccount.configBandwidthLimit();case 40:return l=e.sent,e.next=43,a.config(l);case 43:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.loadUserSystemConfig=function(){var e=(0,c.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=3;break}return p.info("[IT-Meeting] no need to loadUserSystemConfig"),e.abrupt("return");case 3:return e.next=5,coreDb.queryUserConfigList({all:""});case 5:return t=e.sent,e.next=8,(0,l.initialMediaSetting)([].concat((0,i.default)(t)));case 8:if(window.CLIENTCONFIG.ISBIGWIN){e.next=14;break}return coreCommon.initialUserSetting([].concat((0,i.default)(t))),e.next=12,coreAccount.getLoginModel();case 12:n=e.sent,n.isSupportAS?coreCall.initCallBackNumAS():coreCall.initCallBackNum();case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.stringToBoolean=function(e){return"true"===e},t.showCopyrightDes=delegate(function(){var e=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getCopyright});coreUi.showModal(d.default.createElement(e,null))},"showCopyright"),t.showPrivacyDes=delegate(function(){var e=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getPrivacyState});coreUi.showModal(d.default.createElement(e,null))},"showPrivacy"),t.showShortcutNotifyFuc=function(e){var t=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getShortcutNotify});coreUi.showModal(d.default.createElement(t,{registerFailKey:e}))}},69:function(e,t,n){e.exports={default:n(70),__esModule:!0}},70:function(e,t,n){var r=n(8),a=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}}});