webpackJsonp([16],{1068:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.preQueryUserListEaddr=t.deleteContactPreSave=t.getUserInfo=void 0;var a=r(3),o=n(a),u=r(1),c=n(u),i=r(120),s=n(i),d=r(2),p=n(d),f=window.Logger("contactInterface")("corporateDirectory"),l=(t.getUserInfo=function(){var e=(0,p.default)(c.default.mark(function e(t,r,n){var a,o,u,i,d;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreUi.getContactAvatar(t),a={},!r){e.next=7;break}return e.next=5,l(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:if(o={},u={},isNullOrEmpty(n)){e.next=15;break}return e.next=12,coreContact.queryServerContact(n);case 12:u=e.sent,e.next=19;break;case 15:return e.next=17,coreContact.queryUserListFromEaddr([{username:t,etag:"fffff"}]);case 17:i=e.sent,!isNullOrEmpty(i)&&i.entry&&(u={param:i.entry[0],result:i.result});case 19:if(!window.CLIENTCONFIG.USE_IM){e.next=23;break}return e.next=22,l(t);case 22:a=e.sent;case 23:return d={image_sync_time:"",modify_time:"",q_pin_yin:"",signature:"",staff_id:"",state:"",age:"",birthday:"",dept_id:"",desc:"",ip_phone:"",is_security:0,old_account:"",other_mobiles:"",voip:""},isNullOrEmpty(a)||isNullOrEmpty(a.param)||(d={image_sync_time:a.param.image_sync_time,modify_time:a.param.modify_time,q_pin_yin:a.param.q_pin_yin,signature:a.param.signature,staff_id:a.param.staff_id,state:a.param.state,age:a.param.age,birthday:a.param.birthday,dept_id:a.param.dept_id,desc:a.param.desc,ip_phone:a.param.ip_phone,is_security:a.param.is_security,old_account:a.param.old_account,other_mobiles:a.param.other_mobiles,voip:a.param.voip}),o=isNullOrEmpty(u)||isNullOrEmpty(u.param)||u.param.result_code!==constant.EADDR_CONTACT_RESULT_CODE.SUCCESS?isNullOrEmpty(a)||isNullOrEmpty(a.param)?(0,s.default)({},{param:{},result:1}):(0,s.default)({},a):(0,s.default)({},u,{param:(0,s.default)({},u.param,d)}),e.abrupt("return",o);case 27:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),function(){var e=(0,p.default)(c.default.mark(function e(t){var r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isEserverOnline){e.next=3;break}return f.info("queryEServerFuc eServer is offline:",window.isEserverOnline),e.abrupt("return",{param:{}});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return r=e.sent,e.next=8,r.getuserinfo({account:t});case 8:if(!(n=e.sent)||!n.param||0!==n.result){e.next=13;break}return e.abrupt("return",{param:n.param,result:n.result});case 13:return f.error("queryEServerFuc search user info failed"),e.abrupt("return",{param:{}});case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());t.deleteContactPreSave=function(){var e=(0,p.default)(c.default.mark(function e(t){var r,n,a,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(t)){e.next=4;break}return f.info("deleteContactPreSave account is empty"),e.abrupt("return");case 4:return e.next=6,coreDb.queryContactList({all:"",accountlist:t});case 6:if(r=e.sent,n=[],!isNullOrEmpty(r)){e.next=11;break}return f.info("deleteContactPreSave dbResult is empty"),e.abrupt("return");case 11:for(a=0;a<r.length;a++)u=r[a],n.push(coreDb.deleteContact({id:u.id}));return e.next=14,o.default.all(n);case 14:f.info("deleteContactPreSave success,has delete",r.length),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),f.error("deleteContactPreSave"+{error:e.t0.toJSON()});case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),t.preQueryUserListEaddr=function(){var e=(0,p.default)(c.default.mark(function e(t){var r,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(t)){e.next=3;break}return e.abrupt("return",[]);case 3:if(r=[],!isNullOrEmpty(a)){e.next=9;break}return n=t.getKeyArr("account").join(","),e.next=8,coreDb.queryContactList({all:"",accountlist:n});case 8:a=e.sent;case 9:return t.forEach(function(e){var t=a.query({account:e.account})||{},n={username:e.account,etag:isNullOrEmpty(t.etag)?"fffff":t.etag},o=r.query({username:n.username});isNullOrEmpty(o)&&r.push(n)}),e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),f.error("preQueryUserListEaddr error"+{error:e.t0.toJSON()}),e.abrupt("return",[]);case 17:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()},115:function(e,t,r){e.exports={default:r(165),__esModule:!0}},116:function(e,t,r){e.exports=r(0)(43)},117:function(e,t,r){e.exports=r(0)(45)},120:function(e,t,r){e.exports=r(0)(277)},1211:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.coverUserList=t.queryUsersIncrementFromEaddr=t.queryAllfromList=t.deleteContactFromDB=t.getLocalContactAndGroupInfo=t.loadContactAndGroupListAtomic=t.loadContactAndGroupList=void 0;var a=r(196),o=n(a),u=r(157),c=n(u),i=r(146),s=n(i),d=r(130),p=n(d),f=r(149),l=n(f),v=r(120),m=n(v),h=r(1),g=n(h),C=r(3),b=n(C),x=r(2),y=n(x),_=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r,n,a,o,u;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A.info("uc get contactList and groupList from eserver"),e.next=3,O.getContactList();case 3:if(!(t=e.sent)||t.result!==constant.ERROR_CODE.Success){e.next=8;break}return r=t.param,n=r.im_group_list,a=r.im_group_user_info_list,o=r.user_info_list,u=r.time_stamp,e.next=8,b.default.all([R(t.param),coreGroup.calGroupListData(n),V(a,o,u)]);case 8:return coreIm.dealServerRecentList(),e.abrupt("return",coreCommon.ATOMIC_ACTION_RESULT.SUCCESS);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),w=function(){var e=(0,y.default)(g.default.mark(function e(){var t;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A.debug("loadContactAndGroupList TE模式 获取联系人和群组"),e.next=3,U();case 3:return t=e.sent,I(t&&t.contactUserList),e.abrupt("return",coreCommon.ATOMIC_ACTION_RESULT.SUCCESS);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u,c,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,A.info("updataTeContactInfo begin!"),!isNullOrEmpty(t)){e.next=5;break}return A.error("updataTeContactInfo contactList is empty!"),e.abrupt("return");case 5:return r=[],n=t.getKeyArr("account"),coreUi.getContactListAvatar(n),a=t.map(function(e){if(""!==e.account)return{username:e.account,etag:""===e.etag?"fffff":e.etag}}),o=[],a.splitByNum(20).forEach(function(e){r.push(coreContact.queryUserListFromEaddr(e))}),e.next=13,b.default.all(r).then(function(e){e.forEach(function(e){0===e.result&&e.entry.forEach(function(e){e.result_code===constant.EADDR_CONTACT_RESULT_CODE.SUCCESS&&o.push(e)})})});case 13:if(!isNullOrEmpty(o)){e.next=16;break}return A.info("updataTeContactInfo contact info already newest!"),e.abrupt("return");case 16:if(u=t.map(function(e){var t=o.query({account:e.account});return isNullOrEmpty(t)?e:(0,m.default)({},e,t)}),coreContact.saveContactInfoList(u),$dispatch(coreUi.updateContactListData({contactUserList:u})),!window.CLIENTCONFIG.ISMOBILE){e.next=26;break}return e.next=22,(0,G.sortMUserList)(u);case 22:c=e.sent,i=c.mList,s=c.enList,$dispatch(coreUi.updateMobileContactList(i,s));case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),A.error("updataTeContactInfo error",e.t0);case 31:case"end":return e.stop()}},e,this,[[0,28]])}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,y.default)(g.default.mark(function e(t,r){var n,a,o,u,c,i,s,d,p,f;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(A.info("好友列表 begin"),!isNullOrEmpty(t)){e.next=4;break}return A.info("dealContactInfo recordList is empty"),e.abrupt("return",[]);case 4:
//! 操作记录去重
return n=[],a=[],o=q(t),e.next=9,S(o);case 9:if(u=e.sent,c=H(u,r),i=c.getKeyArr("account"),s=i.join(","),i.splitByNum(20).forEach(function(e){coreUi.getContactListAvatar(e)}),isNullOrEmpty(s)){e.next=21;break}return e.next=17,coreDb.queryContactList({all:"",accountlist:s});case 17:return d=e.sent,d.forEach(function(e){n.push(coreDb.deleteContact({id:""+e.id}))}),e.next=21,b.default.all(n);case 21:return e.next=23,j(c);case 23:return p=e.sent,f=W(c,p),f.forEach(function(e){e.state===constant.CONTACT_STATE.ADD&&(e.contact_id=e.id),delete e.id,a.push(e)}),A.info("dealContactInfo success! data length:"+a.length),e.abrupt("return",a);case 28:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),S=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r,n,a,o,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(u)){e.next=3;break}return A.info("dealCustomContact contactList is empty"),e.abrupt("return",[]);case 3:t=[],r=[],n=0;case 6:if(!(n<u.length)){e.next=23;break}if(a=u[n],!isNullOrEmpty(a.account)||a.state!==constant.CONTACT_STATE.ADD){e.next=12;break}t.push(a),e.next=20;break;case 12:if(!isNullOrEmpty(a.account)||a.state!==constant.CONTACT_STATE.DELETE){e.next=19;break}return e.next=15,coreDb.queryContactByContactId(a.id);case 15:o=e.sent,!isNullOrEmpty(o)&&r.push(coreDb.deleteContact({id:o.id})),e.next=20;break;case 19:t.push(a);case 20:n++,e.next=6;break;case 23:return e.next=25,b.default.all(r);case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A.info("dealContactGroupInfo"),t=t||[],r=[],n=[],a=0;case 5:if(!(a<t.length)){e.next=23;break}if(o=t[a],o.state!==constant.CONTACT_STATE.ADD){e.next=18;break}if("Group"!==o.name){e.next=13;break}return e.next=11,coreDb.queryAllContactGroupList();case 11:u=e.sent,u.forEach(function(e){"Group"===e.name&&(n.push(coreDb.deleteContactGroup({group_id:e.group_id})),n.push(coreDb.deleteContactMemberGroup({group_id:e.group_id})))});case 13:o.group_id=o.id,delete o.id,r.push(o),e.next=20;break;case 18:n.push(coreDb.deleteContactGroup({group_id:o.id})),n.push(coreDb.deleteContactMemberGroup({group_id:o.id}));case 20:a++,e.next=5;break;case 23:return e.next=25,b.default.all(n);case 25:return r=P(r),e.abrupt("return",r);case 27:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A.debug("dealContactGroupMemberList"),t=t||[],r=[],n=[],t.forEach(function(e){e.state===constant.CONTACT_STATE.ADD?r.push(e):n.push(coreDb.deleteContactMemberGroup({group_id:e.group_id,contact_id:e.contact_id}))}),e.next=7,b.default.all(n);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L=r(995),O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(L),G=r(996),T=r(1068),M=r(1212),A=window.Logger("logic")("contactGroup/联系人群组增量处理"),D=t.loadContactAndGroupList=function(){window.CLIENTCONFIG.USE_IM?_():w()},U=(t.loadContactAndGroupListAtomic=new coreCommon.AtomicAction("loadContactAndGroupList",D),t.getLocalContactAndGroupInfo=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r,n,a,o,u,c,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=2;break}return e.abrupt("return");case 2:return A.debug("getLocalContactAndGroupInfo"),e.next=5,b.default.all([coreDb.queryAllContact(),coreDb.queryAllContactGroupList(),coreDb.queryAllContactMemberGroupList()]);case 5:if(t=e.sent,r=(0,l.default)(t,3),n=r[0],a=r[1],o=r[2],u={hasContact:n.length>0,contactUserList:n,contactGroup:a,contactMemberGroup:o},$dispatch(coreUi.updateContactListData(u)),F(n),!window.CLIENTCONFIG.ISMOBILE){e.next=20;break}return e.next=16,(0,G.sortMUserList)(n);case 16:c=e.sent,i=c.mList,s=c.enList,$dispatch(coreUi.updateMobileContactList(i,s));case 20:return $(),e.abrupt("return",u);case 22:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),R=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u,c,i,s,d;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A.info("calcContactListData deal contactList"),r=t.contact_list,n=t.user_list,a=t.user_group_list,o=t.user_group_member_list,e.next=5,b.default.all([k(r,n),E(a),N(o)]);case 5:return u=e.sent,c=(0,l.default)(u,3),i=c[0],s=c[1],d=c[2],A.info("整理联系人列表数据","success"),e.next=13,b.default.all([coreContact.saveContactInfoList(i),coreDb.bulkPutContactGroup(s),coreDb.bulkPutContactMemberGroup(d)]);case 13:return e.next=15,U();case 15:return e.abrupt("return",e.sent);case 18:e.prev=18,e.t0=e.catch(0),A.error("calcContactListData",e.t0);case 21:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(t){return e.apply(this,arguments)}}(),P=function(e){return e=e||[],e.sort(function(e,t){return e.group_id>t.group_id})},F=function(e){A.debug("dealSpecialContacts 筛选特别关注联系人");var t=[];e&&e.length>0&&e.forEach(function(e){e.isSpecial&&t.push(e)}),$dispatch(coreUi.updateSpecialContactListData(t))},$=function(){try{A.debug("loadContactTypeOpen 加载与刷新联系人分组折叠对应表");var e=$getState(),t=e.contactGroups.contactGroup,r=e.contactGroups.contactTypeOpen,n=[].concat((0,p.default)(t)),a=[].concat((0,p.default)(r));if(0===r.length)n.forEach(function(e){a.push({group:e.group_id,open:!1})});else{var o=[],u=[];a.forEach(function(e){u.push(e.group)}),n.forEach(function(e){a.forEach(function(t){e.group_id===t.group?o.push({group:e.group_id,open:t.open}):-1===u.indexOf(e.group_id)&&o.push({group:e.group_id,open:!1})})}),a=[].concat(o)}A.info("loadContactTypeOpen 加载刷新联系人分组折叠表","success"),$dispatch(coreUi.updateContactTypeOpen(a))}catch(e){A.error("loadContactTypeOpen",e)}},B=(t.deleteContactFromDB=function(){var e=(0,y.default)(g.default.mark(function e(t){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=3;break}return A.debug("deleteContact data null"),e.abrupt("return",{});case 3:if(!t.id){e.next=9;break}return e.next=6,coreDb.deleteContact({id:t.id});case 6:""!==t.account&&coreContact.saveContactInfo(t),e.next=9;break;case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r="",n=[],isNullOrEmpty(t)){e.next=15;break}return r=t.getKeyArr("account").join(","),e.next=7,coreDb.queryContactList({all:"",accountlist:r});case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=[];case 10:return a=e.t0,t.forEach(function(e){for(var t=B(a,{account:e.account}),r=0;r<t.length;r++){var o=t[r];n.push(coreDb.deleteContact({id:""+o.id}))}}),e.next=14,b.default.all(n);case 14:A.info("delDbContactList success");case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(0),A.error("delDbContactList fail",{error:e.t1.toJSON()});case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}))}(),t.queryAllfromList=function(e,t){try{var r=function(){var r=[];for(var n in t)!function(n){e.forEach(function(e){t[n]===e[n]&&r.push(e)})}(n);return{v:r}}();if("object"===(void 0===r?"undefined":(0,s.default)(r)))return r.v}catch(e){return A.info("queryAllfromList fail",e.toString()),[]}}),q=function(e){var t=[];return isNullOrEmpty(e)?(A.info("delContactOperationRecord contactList empty!"),[]):(e.forEach(function(r){if(0===r.staff_id)return r.gender=2,t.push(r),!1;var n=e.queryList({staff_id:r.staff_id});if(!isNullOrEmpty(n))if(1===n.length)t.push(r);else{for(var a=n[0],o=1;o<n.length;o++){var u=n[o];u.id>a.id&&(a=u)}isNullOrEmpty(t.query(a))&&t.push(a)}}),t)},H=function(e,t){try{var r=[];return e.forEach(function(e){""===e.name&&(0,m.default)(e,t.query({staff_id:e.staff_id}),{state:e.state}),r.push(e)}),r}catch(e){return A.error("delCoverEserverList",{error:e.toJSON()}),[]}},j=t.queryUsersIncrementFromEaddr=function(){var e=(0,y.default)(g.default.mark(function e(t,r){var n,a,o,u,c,i,s,d;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[],a=[],e.next=5,(0,T.preQueryUserListEaddr)(t,r);case 5:o=e.sent,u=o.splitByNum(20),c=0;case 8:if(!(c<u.length)){e.next=17;break}return i=u[c],e.next=12,coreContact.queryUserListFromEaddr(i);case 12:s=e.sent,!isNullOrEmpty(s)&&s.entry&&n.push.apply(n,(0,p.default)(s.entry));case 14:c++,e.next=8;break;case 17:if(d=[],!isNullOrEmpty(n)){e.next=21;break}return A.error("queryUsersIncrementFromEaddr willCoverList is empty"),e.abrupt("return",[]);case 21:return n.forEach(function(e){if(e.result_code===constant.EADDR_CONTACT_RESULT_CODE.NO_CHANGE){var t=r.query({etag:e.etag});isNullOrEmpty(t)||(delete t.id,delete t.contact_id,d.push(t))}else e.result_code===constant.EADDR_CONTACT_RESULT_CODE.SUCCESS&&d.push(e)}),e.abrupt("return",d);case 25:return e.prev=25,e.t0=e.catch(0),A.error("queryUsersIncrementFromEaddr",{error:e.t0.toJSON()}),e.abrupt("return",[]);case 29:case"end":return e.stop()}},e,void 0,[[0,25]])}));return function(t,r){return e.apply(this,arguments)}}(),W=t.coverUserList=function(e,t){if(isNullOrEmpty(e)&&isNullOrEmpty(t))return A.info("coverUserList all empty"),[];if(isNullOrEmpty(e))return A.info("coverUserList eSerList empty"),t;if(isNullOrEmpty(t))return A.info("coverUserList eaddrList empty"),e;var r=[];return e.length<t.length?t.forEach(function(t){var n=e.query({account:t.account}),a=K(n,t);r.push(a)}):e.forEach(function(e){if(isNullOrEmpty(e.account))r.push(e);else{var n=t.query({account:e.account}),a=K(e,n);r.push(a)}}),r},K=function(e,t){if(isNullOrEmpty(e)&&isNullOrEmpty(t))return A.info("coverUserInfo all empty"),{};if(isNullOrEmpty(e))return A.debug("coverUserInfo eserverInfo empty"),t;if(isNullOrEmpty(t))return A.debug("coverUserInfo eaddrInfo empty"),e;if(e.account!==t.account)return A.debug("coverUserInfo two info is not one person!"),{};var r={staff_id:e.staff_id,account:e.account,etag:t.etag,state:e.state,name:t.name,q_pin_yin:e.q_pin_yin,gender:t.gender,mobile:t.mobile,office_phone:t.office_phone,office_phone2:t.office_phone2,other_phone:t.other_phone,fax:t.fax,email:t.email,address:t.address,title:t.title,image_id:t.image_id,signature:e.signature,website:t.website,bind_no:t.bind_no,native_name:t.native_name,home_phone:t.home_phone,other_phone2:t.other_phone2,staff_no:t.staff_no,dept_id:e.dept_id,dept_name_cn:t.dept_name_cn,dept_name_en:t.dept_name_en,desc:e.desc,image_sync_time:e.image_sync_time,ip_phone:e.ip_phone,is_security:e.is_security,old_account:e.old_account,short_phone:t.short_phone,voip:e.voip,modify_time:e.modify_time,espacenumber:t.espacenumber};return void 0!==e.id&&(r.id=e.id),r},V=function(){var e=(0,y.default)(g.default.mark(function e(t,r,n){var a,u,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A.info("Deal with changed members about increment, count:",t&&t.length),t&&(a=[],u=[],i=[],s={},r&&r.map(function(e){s[e.account]=e}),t.map(function(e){if(e.state===constant.GROUP_STATE.DELETE)u.push(e),u.map(function(e){return coreDb.deleteGroupMember({account:e.account,group_id:e.group_id})});else{var t=s[e.account];a.push(t),a.splitByNum(50).map(function(e){return coreDb.bulkPutGroupMember((0,M.formatContactGroupMemberList)(e))})}i.push(e.group_id)}),i.length&&(i=(0,c.default)(new o.default(i)),A.info("Refresh groups with member changes, count:",i.length),i.map(function(){var e=(0,y.default)(g.default.mark(function e(t){var r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryGroup({group_id:t});case 2:r=e.sent,r.sync_member_time=n,coreGroup.saveGroupInfo(r),coreGroup.createGroupMemberChangeEvent(t,r.owner);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())));case 2:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},1212:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatContactGroupMemberList=t.setUnMergeServerGroup=t.isMergeServerGroupList=t.initIncrementData=void 0;var a=r(124),o=n(a),u=r(130),c=n(u),i=r(3),s=n(i),d=r(1),p=n(d),f=r(2),l=n(f),v=r(160),m={},h=[],g=[],C={},b=!1,x=window.Logger("group")("member/increment"),y=(t.initIncrementData=function(e){x.info("initIncrementData ",e),m={},h=[],g=[],C={},b=!1},t.isMergeServerGroupList=function(e){return x.info("isMergeServerGroupList ",e),g.includes(e)}),_=(t.setUnMergeServerGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];h.includes(e.group_id)||C.group_id===e.group_id||y(e.group_id)||(t?(x.info("setUnMergeServerGroup unshift",e.group_id),h.unshift(e.group_id)):(x.info("setUnMergeServerGroup push",e.group_id),h.push(e.group_id)),m[e.group_id]=e,b||_())},function(){var e=(0,l.default)(p.default.mark(function e(){var t,r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b=!0,C={},0!==h.length){e.next=5;break}return b=!1,e.abrupt("return");case 5:if(window.isEserverOnline){e.next=12;break}return x.info("queueDealMergeServerGroupMember eserver is not login, sleep 500 ms"),e.next=9,sleep(500);case 9:return e.next=11,_();case 11:return e.abrupt("return",e.sent);case 12:return t=h.shift(),r=m[t],delete m[t],C=r,e.next=18,w(r);case 18:return e.next=20,sleep(20);case 20:return e.next=22,_();case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),w=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o,u,i,d,f,l,m;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=t.sync_member_time,n=t.group_id,a=t.owner,!r){e.next=4;break}return e.abrupt("return");case 4:return x.info("mergeServerGroupMember",n,r),e.next=7,(0,v.getGroupMemberList)(n);case 7:return o=e.sent,u=o.memberList,i=o.time_stamp,d=[],f=[],t.sync_member_time=i,l=[],m=[],isNullOrEmpty(u)||u.forEach(function(e){e.group_id=n,e.state===constant.GROUP_STATE.DELETE?m.push(e):l.push(e)}),d=l.splitByNum(50).map(function(e){return coreDb.bulkPutGroupMember(I(e))}),f=m.map(function(e){return coreDb.deleteGroupMember({account:e.account,group_id:n})}),isNullOrEmpty(t.id)||delete t.id,e.next=18,s.default.all([].concat((0,c.default)(d),(0,c.default)(f),[coreGroup.saveGroupInfo(t)]));case 18:coreGroup.createGroupMemberChangeEvent(n,a),g.push(n),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),x.error("mergeServerGroupMember",e.t0.toString());case 25:case"end":return e.stop()}},e,void 0,[[0,22]])}));return function(t){return e.apply(this,arguments)}}(),I=t.formatContactGroupMemberList=function(e){return e.map(function(e){return{account:e.account,group_id:e.group_id,name:getContactName(e),staffid:e.staff_id}})};!function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,u,c,i,d,f;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x.info("dealMemberList 群成员列表开始处理！"),e.prev=1,r=[],n="",a=0,u=[],isNullOrEmpty(t)){e.next=22;break}return c=t.getKeyArr("account"),n=c.join(","),e.next=11,coreDb.queryContactList({all:"",accountlist:n});case 11:return i=e.sent,e.next=14,coreContact.queryUsersIncrementFromEaddr(t,i);case 14:if(d=e.sent,f=coreContact.coverUserList(t,d),c.splitByNum(20).forEach(function(e){coreUi.getContactListAvatar(e)}),!isNullOrEmpty(i)){e.next=19;break}return e.abrupt("return",f);case 19:return f.forEach(function(e){var t=i.queryList({account:e.account}),n=(0,o.default)({},e);t.length>1?(x.info("dealMemberList find more about one person:"+t.length),t.forEach(function(t){t.contact_id>a&&(a=t.contact_id),u.push(coreDb.deleteContact({id:""+e.id}))}),n.contact_id=a,a=0,r.push(n)):(isNullOrEmpty(t)||0===t[0].contact_id)&&r.push(e)}),e.next=22,s.default.all(u);case 22:return e.abrupt("return",r);case 25:return e.prev=25,e.t0=e.catch(1),x.error("dealMemberList fail",{error:e.t0.toJSON()}),e.abrupt("return",[]);case 29:case"end":return e.stop()}},e,void 0,[[1,25]])}))}()},1213:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.uploadAvatar=t.setSign=t.removeEventListenerDealKeyBoard=t.addEventListenerDealKeyBoard=t.modifyCustomContact=t.openEditCustomPage=t.checkIsChange=t.updataEditStatus=t.checkEmailInput=t.mHandleChangeCustomResult=t.updataCustomDucks=t.searchContactByNum=t.addCustomContact=t.getRecentContactList=t.getFriendList=t.dealContactGroupInfo=t.addContactToContactGroup=t.saveContactInfoList=t.saveContactInfo=void 0;var a=r(1751);Object.defineProperty(t,"setSign",{enumerable:!0,get:function(){return a.setSign}}),Object.defineProperty(t,"uploadAvatar",{enumerable:!0,get:function(){return a.uploadAvatar}});var o=r(1335),u=n(o),c=r(1336),i=n(c),s=r(1337),d=n(s),p=r(1752),f=r(1338),l=n(f);t.saveContactInfo=p.saveContactInfo,t.saveContactInfoList=p.saveContactInfoList;t.addContactToContactGroup=i.addContactToContactGroup,t.dealContactGroupInfo=i.dealContactGroupInfo,t.getFriendList=u.getFriendList,t.getRecentContactList=u.getRecentContactList,t.addCustomContact=d.addCustomContact,t.searchContactByNum=d.searchContactByNum,t.updataCustomDucks=d.updataCustomDucks,t.mHandleChangeCustomResult=d.mHandleChangeCustomResult,t.checkEmailInput=d.checkEmailInput,t.updataEditStatus=d.updataEditStatus,t.checkIsChange=d.checkIsChange,t.openEditCustomPage=d.openEditCustomPage,t.modifyCustomContact=d.modifyCustomContact,t.addEventListenerDealKeyBoard=l.addEventListenerDealKeyBoard,t.removeEventListenerDealKeyBoard=l.removeEventListenerDealKeyBoard},123:function(e,t,r){e.exports={default:r(155),__esModule:!0}},124:function(e,t,r){e.exports=r(0)(49)},130:function(e,t,r){"use strict";t.__esModule=!0;var n=r(157),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,a.default)(e)}},132:function(e,t,r){e.exports={default:r(192),__esModule:!0}},1334:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.goBackLastInfo=t.clickAddCustomContact=t.clickCorporateMenu=t.loadSliderDetailInfo=t.toggleSliderDetailContent=t.toggleSliderDetailShow=t.clickMenuItem=t.toggleSubMenuOpen=t.toggleSpecialMenuOpen=t.toggleMainMenuOpen=t.updateContactGroupDetailShow=t.updateSelectedItemKey=t.getLocalContactAndGroupInfo=t.loadContactAndGroupList=void 0;var o=r(120),u=a(o),c=r(1),i=a(c),s=r(130),d=a(s),p=r(2),f=a(p),l=r(890),v=r(1211),m=n(v),h=r(1213),g=(n(h),window.Logger("logic")("contactGroups/index")),C=(t.loadContactAndGroupList=m.loadContactAndGroupList,t.getLocalContactAndGroupInfo=m.getLocalContactAndGroupInfo,t.updateSelectedItemKey=function(e){$dispatch(coreUi.updateSelectedItemKey(e))},t.updateContactGroupDetailShow=function(e){$dispatch(coreUi.updateContactGroupDetailShow(e))}),b=(t.toggleMainMenuOpen=function(){var e=(0,f.default)(i.default.mark(function e(t,r){var n,a,o,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=$getState(),a=n.contactGroups.contactMenu,o=[].concat((0,d.default)(a)),u=0;case 5:if(!(u<o.length)){e.next=12;break}if(o[u].menu_name!==t){e.next=9;break}return o[u].menu_open=r,e.abrupt("break",12);case 9:u++,e.next=5;break;case 12:return e.next=14,$dispatch(coreUi.updateContactMenuOpen(o));case 14:g.info("toggleMainMenuOpen"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),g.error("toggleMainMenuOpen",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t,r){return e.apply(this,arguments)}}(),t.toggleSpecialMenuOpen=function(){var e=(0,f.default)(i.default.mark(function e(t,r){var n,a,o,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState(),a=n.contactGroups.specialFocusMenu,o=[].concat((0,d.default)(a)),u=0;case 4:if(!(u<o.length)){e.next=11;break}if(o[u].id!==t){e.next=8;break}return o[u].sf_menu_open=r,e.abrupt("break",11);case 8:u++,e.next=4;break;case 11:return e.next=13,$dispatch(coreUi.updateSpecialMenuOpen(o));case 13:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),x=(t.toggleSubMenuOpen=function(){var e=(0,f.default)(i.default.mark(function e(t,r,n){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t!==language.SPECIAL_FOCUS){e.next=6;break}return e.next=4,b(r,n);case 4:e.next=9;break;case 6:if(t!==language.CONTACTS){e.next=9;break}return e.next=9,(0,l.toggleContactTypeOpen)(r,n);case 9:g.info("切换联系人群组副目录列表折叠展开"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),g.error("toggleSubMenuOpen",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r,n){return e.apply(this,arguments)}}(),t.clickMenuItem=function(){var e=(0,f.default)(i.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.contact_id){e.next=7;break}return e.next=3,(0,l.clickContact)(t);case 3:coreUi.getContactAvatar(t.account),C("contact"),e.next=11;break;case 7:if(!t.group_id){e.next=11;break}return e.next=10,coreGroup.openGroupDetailById(t.group_id);case 10:C("group");case 11:$dispatch(coreUi.updateSubmenuId(r)),$dispatch(coreUi.updateLastInfo({menuItem:t,submenuId:r})),coreGroup.initGroupAnnounceInfo();case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.toggleSliderDetailShow=function(e){$dispatch(coreUi.updateSliderDetailShow(e))}),y=t.toggleSliderDetailContent=function(){var e=(0,f.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.updateSliderDetailContent(t)),e.next=3,$dispatch(coreUi.updateSliderDetailLoading(!1));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),_=(t.loadSliderDetailInfo=function(){var e=(0,f.default)(i.default.mark(function e(t){var r,n,a,o,c,s,d,p,f,v,m,h,C;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=$getState(),n=r.contactGroups.sliderDetailShow,e.next=5,_();case 5:return e.next=7,$dispatch(coreUi.updateSliderDetailLoading(!0));case 7:if(isNullOrEmpty(t.group_id)||!isNullOrEmpty(t.account)){e.next=36;break}if(!isNullOrEmpty(t.recent)){e.next=28;break}return e.next=11,coreGroup.getGroupDetailInfo(t);case 11:return a=e.sent,o=a.groupId,c=a.groupInfoNew,s=a.groupMemberInfo,d=a.isOwner,p=a.groupSetting,e.next=19,$dispatch(coreUi.updateSliderGroupDetail(c,s,p,d));case 19:return e.next=21,y(constant.SLIDER_DETAIL_TYPE.group);case 21:return e.next=23,coreGroup.initGroupAnnounceInfo();case 23:if(n){e.next=26;break}return e.next=26,x(!0);case 26:e.next=34;break;case 28:return e.next=30,x(!1);case 30:return coreIm.toggleRecent(t.recent),coreUi.openGroupDetail(t.recent.group),e.next=34,$dispatch(coreUi.updateSliderDetailLoading(!1));case 34:e.next=64;break;case 36:return f=isNullOrEmpty(t.account),e.next=39,$dispatch(coreUi.updateSliderContactDetail(t,f));case 39:return e.next=41,y(constant.SLIDER_DETAIL_TYPE.contact);case 41:if(n){e.next=44;break}return e.next=44,x(!0);case 44:return e.next=46,(0,l.getContactDetailInfo)(t,!0);case 46:if(v=e.sent,m=v.userInfo,h=v.customContact,!0!==m.isNotServerInfo){e.next=61;break}if($getState().login.deployMode!==constant.MEETING_NET_TYPE.SMC_MEETING){e.next=58;break}return g.info("user not found,search by sip"),e.next=54,coreContact.queryServerContact(t.account);case 54:C=e.sent,isNullOrEmpty(C)||isNullOrEmpty(C.param)?m=(0,u.default)({},t,{isNotServerInfo:!0}):(g.info("search userInfo by sip success"),m=C.param),e.next=59;break;case 58:m=(0,u.default)({},t,{isNotServerInfo:!0});case 59:e.next=62;break;case 61:m.isNotServerInfo=!1;case 62:return e.next=64,$dispatch(coreUi.updateSliderContactDetail(m,h));case 64:g.info("加载弹窗联系人或群组详情"),e.next=70;break;case 67:e.prev=67,e.t0=e.catch(0),g.error("loadSliderDetailInfo",e.t0);case 70:case"end":return e.stop()}},e,void 0,[[0,67]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,f.default)(i.default.mark(function e(){var t,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),!(r=t.call.callStatus)){e.next=5;break}return g.info("toggle call page when open detail"),e.next=5,coreCall.setNoMoveTrue();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());t.clickCorporateMenu=function(){var e=(0,f.default)(i.default.mark(function e(t,r){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:C(t),$dispatch(coreUi.updateSubmenuId(r)),$dispatch(coreUi.updateLastInfo({menuItem:t,submenuId:r}));case 3:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.clickAddCustomContact=function(){var e=(0,f.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:C(t);case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.goBackLastInfo=function(){var e=(0,f.default)(i.default.mark(function e(){var t,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().contactGroups.lastContactGroupInfo,r=void 0===t?{}:t,!r.menuItem.contact_id){e.next=7;break}return e.next=4,(0,l.clickContact)(r.menuItem);case 4:C("contact"),e.next=14;break;case 7:if(!r.menuItem.group_id){e.next=13;break}return e.next=10,coreGroup.openGroupDetailById(r.menuItem.group_id);case 10:C("group"),e.next=14;break;case 13:C(r.menuItem);case 14:$dispatch(coreUi.updateSubmenuId(r.submenuId));case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},1335:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.Logger("logic")("contactGroup/contact/dealData");t.getRecentContactList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=$getState(),r=t.myInfo,a=t.recent.recentList,o=e.filterContacts,u=void 0===o?[]:o;return n.info("getRecentContactList"),a.filter(function(e){return!coreIm.isGroup(e.chat_type)&&!isNullOrEmpty(e.contact)&&e.contact.account!==r.account&&isNullOrEmpty(u.query({account:e.account}))}).map(function(e){return e.contact})}catch(e){n.error("getRecentContactList",e)}},t.getFriendList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=$getState(),r=t.myInfo,a=t.contactGroups.contactUserList,o=e.filterContacts,u=void 0===o?[]:o;return n.info("getFriendList"),a.filter(function(e){return e.account!==r.account&&isNullOrEmpty(u.query({account:e.account}))})}catch(e){n.error("getFriendList",e)}}},1336:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=$getState(),t=e.contactGroups.contactUserList,r=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]);if(isNaN(r))return window.alert(window.language.UN_KNOW_ERROR),C.error("checkNowFriendNum esight下发参数错误"),!1;var n=t?t.length:0;return n>=r?(window.alert(window.language.ADD_TO_MAX),!1):n<r}Object.defineProperty(t,"__esModule",{value:!0}),t.dealContactGroupInfo=t.normalAddContactToContactGroup=t.addContactToContactGroup=void 0;var o=r(146),u=n(o),c=r(1),i=n(c),s=r(2),d=n(s),p=(t.addContactToContactGroup=function(){var e=(0,d.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C.info("addContactToContactGroup add a contact as a friend"),t&&t.account){e.next=5;break}if(!window.CLIENTCONFIG.USE_IM){e.next=5;break}return C.info("addContactToContactGroup contact information has a problem or no account"),e.abrupt("return");case 5:if(a()){e.next=7;break}return e.abrupt("return");case 7:return e.abrupt("return",window.CLIENTCONFIG.USE_IM?b(t):p(t));case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(i.default.mark(function e(t){var r,n=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(i.default.mark(function e(){var r,a,o,u,c,s,d,p,f,v,h,b,x;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("teAddContactToContactGroup add a contact as a friend"),e.next=3,l();case 3:if(r=e.sent,t.id){e.next=9;break}return e.next=7,coreDb.queryContact({account:t.account});case 7:a=e.sent,isNullOrEmpty(a)||(t=a);case 9:for(o=$getState(),u=o.contactGroups.contactUserList,c=1;-1!==u.findIndex(function(e){return e.contact_id===c});)c++;return t.contact_id=c,e.next=16,coreContact.saveContactInfo(t);case 16:return t=e.sent,s={contact_id:t.contact_id,group_id:r.group_id,state:constant.CONTACT_STATE.ADD},e.next=20,coreDb.saveContactMemberGroup(s);case 20:return e.next=22,(0,g.reloadContactListData)();case 22:if(d=o.contactGroups,p=d.detailContent,f=d.contactInfo,v=d.sliderDetailShow,h=d.sliderContent,b=d.sliderContactInfo,!v||"Contact"!==h||b.account!==t.account){e.next=26;break}return e.next=26,$dispatch(coreUi.updateSliderContactDetail(t,!1));case 26:if("contact"!==p||f.account!==t.account&&f.contact_id!==t.contact_id||$dispatch(coreUi.updateContactDetail(t,!1)),!window.CLIENTCONFIG.ISMOBILE){e.next=35;break}if($dispatch(coreUi.updateMobileContactDetail(t,!1)),window.Toast(language.ADDED_FRIEND,2,!1),window.CLIENTCONFIG.USE_IM){e.next=32;break}return e.abrupt("return",{v:void 0});case 32:return x={account:t.account,contact_id:t.contact_id},e.next=35,(0,m.tapContact)(x);case 35:case"end":return e.stop()}},e,n)})(),"t0",2);case 2:if(r=e.t0,"object"!==(void 0===r?"undefined":(0,u.default)(r))){e.next=5;break}return e.abrupt("return",r.v);case 5:e.next=10;break;case 7:e.prev=7,e.t1=e.catch(0),C.error("teAddContactToContactGroup",e.t1.toJSON);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()),f=t.dealContactGroupInfo=function(){var e=(0,d.default)(i.default.mark(function e(){var t,r,n,a,o,u,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=void 0,n=t.contactGroups.contactGroup,a="Group",-1!==(o=n.findIndex(function(e){return e.name===a}))){e.next=14;break}return e.next=7,(0,v.addContactGroupService)(a,n.length);case 7:return u=e.sent,c={group_id:u.param.id,index:n.length,name:a,state:0},e.next=11,coreDb.saveContactGroup(c);case 11:r={group_id:u.param.id,index:n.length},e.next=15;break;case 14:r={group_id:n[o].group_id,index:o};case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=(0,d.default)(i.default.mark(function e(){var t,r,n,a,o,u=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=void 0,n=t.contactGroups.contactGroup,a="Group",-1!==(o=n.findIndex(function(e){return e.name===a}))){e.next=8;break}return e.delegateYield(i.default.mark(function e(){var t,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=1;-1!==n.findIndex(function(e){return e.group_id===t});)t++;return o={group_id:t,index:n.length,name:a,state:0},e.next=5,coreDb.saveContactGroup(o);case 5:r={group_id:t,index:n.length};case 6:case"end":return e.stop()}},e,u)})(),"t0",6);case 6:e.next=9;break;case 8:r={group_id:n[o].group_id,index:o};case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),v=r(995),m=r(996),h=r(1068),g=r(890),C=window.Logger("logic")("contact"),b=t.normalAddContactToContactGroup=function(){var e=(0,d.default)(i.default.mark(function e(t){var r,n,a,o,u,c,s,d,p,l,b,x,y,_;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C.info("normalAddContactToContactGroup add a contact as a friend"),e.next=4,f();case 4:return r=e.sent,n={account:t.account,group_id:r.group_id,display_name:""},e.next=8,(0,v.addContactService)(n);case 8:if(a=e.sent,a.result!==constant.ERROR_CODE.Success){e.next=47;break}if(t.id){e.next=15;break}return e.next=13,coreDb.queryContact({all:"",accountlist:t.account});case 13:o=e.sent,isNullOrEmpty(o)||(t=o);case 15:return t.contact_id=a.param.contact_id,e.next=18,(0,h.deleteContactPreSave)(t.account);case 18:return e.next=20,coreContact.saveContactInfo(t);case 20:return t=e.sent,u={contact_id:t.contact_id,group_id:r.group_id,state:constant.CONTACT_STATE.ADD},e.next=24,coreDb.saveContactMemberGroup(u);case 24:return e.next=26,(0,g.reloadContactListData)();case 26:if(c=$getState(),s=c.contactGroups,d=s.detailContent,p=s.contactInfo,l=s.sliderDetailShow,b=s.sliderContent,x=s.sliderContactInfo,!l||"Contact"!==b||x.account!==t.account){e.next=31;break}return e.next=31,$dispatch(coreUi.updateSliderContactDetail(t,!1));case 31:if("contact"!==d||p.account!==t.account&&p.contact_id!==t.contact_id||$dispatch(coreUi.updateContactDetail(t,!1)),!window.CLIENTCONFIG.ISMOBILE){e.next=37;break}return $dispatch(coreUi.updateMobileContactDetail(t,!1)),y={account:t.account,contact_id:t.contact_id},e.next=37,(0,m.tapContact)(y);case 37:return e.next=39,coreIm.getLocalRecent({owner:t.account});case 39:if(_=e.sent,isNullOrEmpty(_)){e.next=46;break}return _.contact=t,e.next=44,coreDb.saveRecent(_);case 44:_=e.sent,$dispatch(coreUi.updateRecent(_));case 46:return e.abrupt("return",a.result);case 47:e.next=52;break;case 49:e.prev=49,e.t0=e.catch(0),C.error("normalAddContactToContactGroup",e.t0.toJSON);case 52:case"end":return e.stop()}},e,void 0,[[0,49]])}));return function(t){return e.apply(this,arguments)}}()},1337:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=$getState(),t=e.contactGroups.contactUserList,r=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]);if(isNaN(r))return window.alert(window.language.UN_KNOW_ERROR),y.error("checkNowFriendNum esight下发参数错误"),!1;var n=t?t.length:0;return n>=r?(window.alert(window.language.ADD_TO_MAX),!1):n<r}Object.defineProperty(t,"__esModule",{value:!0}),t.searchContactByNum=t.checkIsChange=t.checkEmailInput=t.mHandleChangeCustomResult=t.openEditCustomPage=t.updataEditStatus=t.updataCustomDucks=t.delCustomContact=t.modifyCustomContact=t.addCustomContact=void 0;var o=r(132),u=n(o),c=r(120),i=n(c),s=r(146),d=n(s),p=r(1),f=n(p),l=r(2),v=n(l),m=function(){var e=(0,v.default)(f.default.mark(function e(){var t,r,n,a,o,u=this;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=void 0,n=t.contactGroups.contactGroup,a="Group",-1!==(o=n.findIndex(function(e){return e.name===a}))){e.next=8;break}return e.delegateYield(f.default.mark(function e(){var t,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=1;-1!==n.findIndex(function(e){return e.group_id===t});)t++;return o={group_id:t,index:n.length,name:a,state:0},e.next=5,coreDb.saveContactGroup(o);case 5:r={group_id:t,index:n.length};case 6:case"end":return e.stop()}},e,u)})(),"t0",6);case 6:e.next=9;break;case 8:r={group_id:n[o].group_id,index:o};case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),h=r(995),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),C=r(890),b=(r(996),r(1213)),x=r(1334),y=window.Logger("logic")("addCustom"),_=(t.addCustomContact=function(){var e=(0,v.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(y.info("addCustomContact add custom contact to contact group"),a()){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",window.CLIENTCONFIG.USE_IM?_(t):w(t));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(f.default.mark(function e(t){var r,n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,y.info("normalAddCustomContact begin"),!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}return e.next=5,(0,b.dealContactGroupInfo)();case 5:r=e.sent,t.group_id=r.group_id;case 7:return e.next=9,g.addCustomContactService(t);case 9:if(n=e.sent,n.result!==constant.RESULT.SUCCESS||1!==n.param.result){e.next=20;break}return t.contact_id=n.param.contact_id,e.next=14,coreContact.saveContactInfo(t);case 14:return t=e.sent,a={contact_id:t.contact_id,group_id:t.group_id,state:constant.CONTACT_STATE.ADD},e.next=18,coreDb.saveContactMemberGroup(a);case 18:return e.next=20,(0,C.reloadContactListData)();case 20:return e.abrupt("return",{result:n.result});case 23:return e.prev=23,e.t0=e.catch(0),y.error("normalAddCustomContact error",e.t0),e.abrupt("return",{result:1});case 27:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t){return e.apply(this,arguments)}}()),w=function(){var e=(0,v.default)(f.default.mark(function e(t){var r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(f.default.mark(function e(){var r,n,a,o,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y.info("TeAddCustomContact begin"),e.next=3,m();case 3:for(r=e.sent,n=$getState(),a=n.contactGroups.contactUserList,o=1;-1!==a.findIndex(function(e){return e.contact_id===o});)o++;return t.contact_id=o,t.gender=2,e.next=12,coreContact.saveContactInfo(t);case 12:return t=e.sent,u={contact_id:t.contact_id,group_id:r.group_id,state:constant.CONTACT_STATE.ADD},e.next=16,coreDb.saveContactMemberGroup(u);case 16:return e.next=18,(0,C.reloadContactListData)();case 18:return e.abrupt("return",{v:{result:0}});case 19:case"end":return e.stop()}},e,void 0)})(),"t0",2);case 2:if(r=e.t0,"object"!==(void 0===r?"undefined":(0,d.default)(r))){e.next=5;break}return e.abrupt("return",r.v);case 5:e.next=10;break;case 7:e.prev=7,e.t1=e.catch(0),y.error("TeAddCustomContact",e.t1.toJSON);case 10:case"end":return e.stop()}},e,void 0,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),I=(t.modifyCustomContact=function(){var e=(0,v.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y.info("modifyCustomContact modify custom info"),e.abrupt("return",window.CLIENTCONFIG.USE_IM?I(t):k(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(f.default.mark(function e(t){var r,n,a,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y.info("modifyCustomContact begin"),r=$getState().contactGroups.lastContactGroupInfo,n=void 0===r?{}:r,a={},e.next=6,g.modifyCustomContactService(t);case 6:if(o=e.sent,o.result!==constant.RESULT.SUCCESS||1!==o.param.result){e.next=15;break}return e.next=10,coreContact.saveContactInfo(t);case 10:return t=e.sent,e.next=13,(0,C.reloadContactListData)();case 13:$dispatch(coreUi.updateSliderContactDetail(t,!0)),!isNullOrEmpty(n)&&n.menuItem&&n.menuItem.contact_id===t.contact_id&&(a=(0,i.default)({},n,{menuItem:t}),$dispatch(coreUi.updateLastInfo(a)));case 15:return e.abrupt("return",{result:o.result});case 18:e.prev=18,e.t0=e.catch(0),y.error("normalModifyCustomContact error",e.t0);case 21:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(t){return e.apply(this,arguments)}}()),k=function(){var e=(0,v.default)(f.default.mark(function e(t){var r,n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y.info("TeModifyCustomContact begin"),r=$getState().contactGroups.lastContactGroupInfo,n=void 0===r?{}:r,a={},e.next=6,coreContact.saveContactInfo(t);case 6:return t=e.sent,e.next=9,(0,C.reloadContactListData)();case 9:return $dispatch(coreUi.updateSliderContactDetail(t,!0)),!isNullOrEmpty(n)&&n.menuItem&&n.menuItem.contact_id===t.contact_id&&(n.menuItem=t,a=(0,i.default)({},n,{menuItem:t}),$dispatch(coreUi.updateLastInfo(a))),e.abrupt("return",{result:0});case 14:e.prev=14,e.t0=e.catch(0),y.error("TeModifyCustomContact",e.t0.toJSON);case 17:case"end":return e.stop()}},e,void 0,[[0,14]])}));return function(t){return e.apply(this,arguments)}}(),S=(t.delCustomContact=function(){var e=(0,v.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.updataCustomDucks=function(e){$dispatch(coreUi.updateCustomInfo(e))});t.updataEditStatus=function(e){$dispatch(coreUi.changeCustomEditStatus(e))},t.openEditCustomPage=function(e){if(e.contact_id&&(e.isModify=!0),S(e),window.CLIENTCONFIG.ISMOBILE)return window.goRoute("newCustomContact"),void y.info("openEditCustomPage current client is mobile");window.goRoute("main/contactGroups"),(0,x.clickAddCustomContact)("addCustom")},t.mHandleChangeCustomResult=function(e){if(!window.CLIENTCONFIG.ISMOBILE)return void y.info("mHandleChangeCustomResult current client is pc");S({}),window.history.back(),$dispatch(coreUi.updateMobileContactDetail(e,isNullOrEmpty(e.account)))},t.checkEmailInput=function(e){var t=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return!!isNullOrEmpty(e)||t.test(e)},t.checkIsChange=function(e,t){if("object"!==Object.type(e)||"object"!==Object.type(t))return!1;var r=!1;return(0,u.default)(e).forEach(function(n){t.hasOwnProperty(n)?e[n]!==t[n]&&(r=!0):r=!0}),r},t.searchContactByNum=function(){var e=(0,v.default)(f.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,coreDb.queryContactByPhonenumberAccurate(a);case 3:if(r=e.sent,isNullOrEmpty(r)){e.next=10;break}y.info("searchContactByNum find constact in DB success"),t=r[0],r.length>1&&r.forEach(function(e){""===e.account&&(t=e)}),e.next=15;break;case 10:return y.info("searchContactByNum  not find in DB, query contact from server"),e.next=13,coreContact.queryServerContact(a);case 13:n=e.sent,n&&n.param&&(t=n.param);case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},1338:function(e,t,r){"use strict";function n(){coreCommon.isIos()&&(u.info("addEventListenerDealKeyBoard 添加键盘变化事件"),window.removeEventListener("keyBoardChange",o),window.addEventListener("keyBoardChange",o))}function a(){coreCommon.isIos()&&(u.info("removeEventListenerDealKeyBoard 去除键盘变化事件"),window.removeEventListener("keyBoardChange",o))}function o(e){try{u.debug("键盘Change");var t=e.data,r=t.kbWidth,n=t.changeHeight,a=t.kbHeight,o=document.querySelector(".mobile-add-custom-others");if(o){if(n-a==0)return u.info("键盘Change 键盘落下"),void(o.style.marginBottom=null);u.info("键盘Change 键盘不落下");o.style.marginBottom=a*window.innerWidth/r-0+"px"}}catch(e){u.error("键盘Change",e.toString())}}Object.defineProperty(t,"__esModule",{value:!0}),t.addEventListenerDealKeyBoard=n,t.removeEventListenerDealKeyBoard=a;var u=window.Logger("logic")("addCustom/dealIosKeyBoardChange")},134:function(e,t,r){e.exports=r(0)(155)},135:function(e,t,r){e.exports={default:r(183),__esModule:!0}},142:function(e,t,r){var n=r(10),a=r(8),o=r(144);e.exports=function(e,t){var r=(a.Object||{})[e]||Object[e],u={};u[e]=t(r),n(n.S+n.F*o(function(){r(1)}),"Object",u)}},144:function(e,t,r){e.exports=r(0)(51)},146:function(e,t,r){e.exports=r(0)(72)},149:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=r(368),o=n(a),u=r(135),c=n(u);t.default=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var u,i=(0,c.default)(e);!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},155:function(e,t,r){var n=r(8),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},157:function(e,t,r){e.exports={default:r(188),__esModule:!0}},160:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.transferFixedGroupService=t.transferDiscussionGroupService=t.fixedGroupChangeService=t.bulkAddGroupMember=t.addGroupPhoneMemberService=t.addGroupMemberService=t.bulkDelGroupMemberService=t.searchFixedGroups=t.joinFlagChgService=t.modifyFixedGroupInfoService=t.modifyDisGroupInfoService=t.deleteGroupService=t.exitGroupService=t.setDisgroupPolicy=t.bulkAddGroupMemberService=t.delMembers=t.changeGroupTypeService=t.confirmFixedGroupInvite=t.createDiscussGroup=t.createFixedGroup=t.getFixedGroupMembers=t.applyToJoinFixedGroup=t.getGroupInfo=t.getGroupMemberList=void 0;var a=r(130),o=n(a),u=r(3),c=n(u),i=r(124),s=n(i),d=r(1),p=n(d),f=r(2),l=n(f),v=window.Logger("group")("interface"),m=(t.getGroupMemberList=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return r=e.sent,e.next=6,r.getfixedgroupmembers({is_sync_all:1,group_id:t||"",time_stamp:""});case 6:if(n=e.sent,n.result===constant.RESULT.SUCCESS){e.next=10;break}return v.error("getGroupMembers get failed,result",n.result),e.abrupt("return",{memberList:[],time_stamp:""});case 10:if(a=[],!n||!n.param||isNullOrEmpty(n.param.member_info)){e.next=17;break}return o=n.param.time_stamp,n.param.member_info.forEach(function(e){e.group_id=t,a.push(e)}),e.abrupt("return",{memberList:a,time_stamp:o});case 17:return v.error("getGroupMembers no result",t),e.abrupt("return",{memberList:[],time_stamp:""});case 19:e.next=25;break;case 21:return e.prev=21,e.t0=e.catch(0),v.error("getGroupMembers",e.t0.toString()),e.abrupt("return",{memberList:[],time_stamp:""});case 25:case"end":return e.stop()}},e,void 0,[[0,21]])}));return function(t){return e.apply(this,arguments)}}(),t.getGroupInfo=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("getGroupInfo ",t),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.getfixedgroupdetail({group_id:t});case 7:if(n=e.sent,!isNullOrEmpty(n)){e.next=11;break}return v.info("getGroupInfo getfixedgroupdetail failed,return {}"),e.abrupt("return",{});case 11:if(a=n.param,(o=n.result)!==constant.RESULT.SUCCESS){e.next=22;break}if(u=(0,s.default)({},a),!a.id){e.next=22;break}return delete u.id,delete u.joint_flag,u.group_id=a.id,u.auto_join_flag=a.joint_flag,e.next=21,coreGroup.saveGroupInfo(u);case 21:return e.abrupt("return",e.sent);case 22:return v.info("getGroupInfo getfixedgroupdetail failed,return {},errorcode:",o),e.abrupt("return",{});case 26:return e.prev=26,e.t0=e.catch(0),v.error("getGroupInfo",e.t0),e.abrupt("return",{});case 30:case"end":return e.stop()}},e,void 0,[[0,26]])}));return function(t){return e.apply(this,arguments)}}(),t.applyToJoinFixedGroup=function(){var e=(0,l.default)(p.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("applyToJoinFixedGroup 用户申请加入固定群",a),e.next=4,new coreTup.HWTupIM;case 4:return t=e.sent,r={group_id:a,group_name:o,display_name:u},e.next=8,t.joinfixedgroup(r);case 8:return n=e.sent,e.abrupt("return",n);case 12:e.prev=12,e.t0=e.catch(0),v.error("applyToJoinFixedGroup",{error:e.t0.toJSON()});case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),t.getFixedGroupMembers=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return r=e.sent,n=isNullOrEmpty(o)?1:0,e.next=7,r.getfixedgroupmembers({is_sync_all:n,group_id:t||"",time_stamp:o});case 7:return a=e.sent,v.debug("getFixedGroupMembers",a),e.abrupt("return",a);case 12:return e.prev=12,e.t0=e.catch(0),v.error("getFixedGroupMembers",e.t0),e.abrupt("return",{});case 16:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),t.createFixedGroup=function(){var e=(0,l.default)(p.default.mark(function e(t){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.addfixedgroup(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.createDiscussGroup=function(){var e=(0,l.default)(p.default.mark(function e(t){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.adddiscussiongroup(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.confirmFixedGroupInvite=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o,u,c,i,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.group_id,a=r.group_name,o=r.member_account,u=r.display_name,v.info("confirmFixedGroupInvite 用户同意固定群邀请",t),e.next=5,new coreTup.HWTupIM;case 5:return c=e.sent,i={agree_join:t,group_id:n,group_name:a,member_account:o,display_name:u},e.next=9,c.confirmfixedgroupinvite(i);case 9:return s=e.sent,e.abrupt("return",s);case 13:e.prev=13,e.t0=e.catch(0),v.error("error",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t,r){return e.apply(this,arguments)}}(),t.changeGroupTypeService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return n=e.sent,a={id:t,group_type:r},e.next=7,n.modifyGroupType(a);case 7:return o=e.sent,v.info("固定群和讨论组互相转换"),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),v.error("error",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}(),t.delMembers=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:if(n=e.sent,a=t.group_type,o=t.group_id,u=void 0,0!==a){e.next=9;break}return e.next=8,n.delfixedgroupmember({group_id:o,account:r});case 8:u=e.sent;case 9:if(1!==a){e.next=13;break}return e.next=12,n.deldiscussiongroupmember({group_id:o,account:r});case 12:u=e.sent;case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.bulkAddGroupMemberService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o,u,c,i,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v.info("bulkAddGroupMemberService begin~"),!isNullOrEmpty(t)){e.next=4;break}return v.info("bulkAddGroupMemberService list is empty!"),e.abrupt("return");case 4:return e.next=6,new coreTup.HWTupIM;case 6:if(n=e.sent,a=r.group_type,o=r.group_id,u=r.name,c=void 0,i=void 0,s=void 0,c=t.getKeyArr("account").join(";"),i={group_id:o,account:c,group_name:u,display_name:u},0!==a){e.next=17;break}return e.next=14,n.addfixedgroupmember(i);case 14:s=e.sent,e.next=21;break;case 17:if(1!==a){e.next=21;break}return e.next=20,n.adddiscussiongroupmember(i);case 20:s=e.sent;case 21:if(null!==s){e.next=24;break}return v.info("批量加人请求超时"),e.abrupt("return",[]);case 24:return s.result!==constant.RESULT.SUCCESS&&(v.info("添加失败"),coreGroup.groupService.clearMarkDeleteGroupNotify()),v.info("批量添加群组成员"),e.abrupt("return",[]);case 27:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.setDisgroupPolicy=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return n=e.sent,e.next=5,n.setDisgroupPolicy({group_id:t,policy:r});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.exitGroupService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:if(n=e.sent,a=void 0,0!==r){e.next=10;break}return e.next=7,n.leavefixedgroup({arg:t});case 7:a=e.sent,e.next=13;break;case 10:return e.next=12,n.leaveDiscussionGroup({group_id:t});case 12:a=e.sent;case 13:return 0===a.result?coreGroup.groupService.setMarkExitGroupNotify(t,!0):coreGroup.groupService.clearMarkExitGroupNotify(),e.abrupt("return",0===a.result);case 15:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.deleteGroupService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:if(n=e.sent,a=void 0,0!==r){e.next=10;break}return e.next=7,n.delfixedgroup(t);case 7:a=e.sent,e.next=13;break;case 10:return e.next=12,n.deldiscussiongroup(t);case 12:a=e.sent;case 13:return e.abrupt("return",0===a.result);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.modifyDisGroupInfoService=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||0!==t.group_type){e.next=2;break}return e.abrupt("return",m(t));case 2:return e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.moddiscussiongroup(t);case 7:return n=e.sent,e.abrupt("return",0===n.result);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.modifyFixedGroupInfoService=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.modfixedgroup(t);case 5:return n=e.sent,e.abrupt("return",0===n.result);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());t.joinFlagChgService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return n=e.sent,e.next=5,n.modfixedgroup({id:t.group_id,name:t.name,capacity:t.capacity,manifesto:t.manifesto,desc:t.desc,owner:t.owner,auto_join_flag:r,msg_policy_type:t.msg_policy_type,group_type:t.group_type,fix_discuss:t.fix_discuss,state:t.state});case 5:return a=e.sent,o=0===a.result,e.abrupt("return",o);case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.searchFixedGroups=function(){var e=(0,l.default)(p.default.mark(function e(){var t,r,n,a,o,u,c,i,s,d,f,l,m,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("searchFixedGroups 查询固定群"),t=h.is_need_amount,r=void 0===t?1:t,n=h.offset,a=void 0===n?0:n,o=h.count,u=void 0===o?20:o,c=h.query_key,i=void 0===c?"":c,s=h.query_type,d=void 0===s?2:s,e.next=5,new coreTup.HWTupIM;case 5:return f=e.sent,l={is_need_amount:r,offset:a,count:u,query_key:i,query_type:d},e.next=9,f.getfixedgroups(l);case 9:return m=e.sent,e.abrupt("return",m);case 13:e.prev=13,e.t0=e.catch(0),v.error("searchFixedGroups",{error:e.t0.toJSON()});case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(){return e.apply(this,arguments)}}(),t.bulkDelGroupMemberService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o,u,i,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return n=e.sent,a=r.group_type,o=r.group_id,u=r.name,i=[],e.next=7,t.forEach(function(e){var t={group_id:o,account:e.account,group_name:u,display_name:u},r=void 0;r=0===a?n.delfixedgroupmember(t):n.deldiscussiongroupmember(t),i.push(r)});case 7:return e.next=9,c.default.all(i);case 9:s=e.sent,s.forEach(function(e){e.result===constant.ERROR_CODE.Success?v.info("删除成功"):v.info("删除失败")}),v.info("info");case 12:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.addGroupMemberService=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o,u,c,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.groupType,n=t.groupId,a=t.account,o=t.groupName,u=t.displayName,c={group_id:n,account:a,group_name:o,display_name:u},e.next=5,new coreTup.HWTupIM;case 5:if(i=e.sent,0!==r){e.next=11;break}return v.info("addGroupMemberService","addfixedgroupmember"),e.next=10,i.addfixedgroupmember(c);case 10:return e.abrupt("return",e.sent);case 11:return v.info("addGroupMemberService","adddiscussiongroupmember"),e.next=14,i.adddiscussiongroupmember(c);case 14:return e.abrupt("return",e.sent);case 17:e.prev=17,e.t0=e.catch(0),v.error("error",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),t.addGroupPhoneMemberService=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.groupId,n=t.phoneList,a={group_id:r,phone_list:[].concat((0,o.default)(n))},v.info("add phone to group"),e.next=6,new coreTup.HWTupIM;case 6:return u=e.sent,e.next=9,u.adddiscussiongroupphonemember(a);case 9:return e.abrupt("return",e.sent);case 12:e.prev=12,e.t0=e.catch(0),v.error("error",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),t.bulkAddGroupMember=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o,u,c,i,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:n=e.sent,a=r.group_type,o=r.group_id,u=r.name,c=r.displayName,i=void 0,s=[],1===t.length?i={group_id:o,account:t[0].account,group_name:u,display_name:u}:t.length>1&&(t.forEach(function(e){s.push(e.account)}),s=s.join(";"),i={group_id:o,accounts:s,group_name:u,display_name:u}),0===a&&n.addfixedgroupmember(i),1===a&&n.adddiscussiongroupmember(i),v.info("info","批量添加群组成员success:");case 9:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.fixedGroupChangeService=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,1===t.group_type?r=0:0===t.group_type&&(r=1),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.modfixedgroup({id:t.group_id,name:t.name,capacity:t.capacity,manifesto:t.manifesto,desc:t.desc,owner:t.owner,auto_join_flag:t.auto_join_flag,msg_policy_type:t.msg_policy_type,group_type:1,fix_discuss:t.fix_discuss,state:t.state});case 7:return a=e.sent,o=0===a.result,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.transferDiscussionGroupService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("transferDiscussionGroupService "),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.transferdiscussiongroup({group_id:t,account:r});case 7:return a=e.sent,o=0===a.result,e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),v.error(e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}(),t.transferFixedGroupService=function(){var e=(0,l.default)(p.default.mark(function e(t,r){var n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("transferFixedGroupService "),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.transferfixedgroup({group_id:t,account:r});case 7:return a=e.sent,a&&a.result===constant.ERROR_IM_GROUP_CODE.RESULT_IMGROUP_MAXNUM&&(v.info("transferFixedGroupService 对方拥有的固定群超上限"),window.CLIENTCONFIG.ISMOBILE||window.alert(language.TRANSFER_FIXEDGROUP_FAIL_MAXUM)),o=0===a.result,e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(0),v.error("transferFixedGroupService error",e.t0.toJSON());case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t,r){return e.apply(this,arguments)}}()},165:function(e,t,r){r(166),e.exports=r(8).Object.getPrototypeOf},166:function(e,t,r){var n=r(134),a=r(167);r(142)("getPrototypeOf",function(){return function(e){return a(n(e))}})},167:function(e,t,r){e.exports=r(0)(377)},169:function(e,t,r){var n=r(15);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},1751:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setSign=t.uploadAvatar=t.loginToItMcloud=void 0;var a=r(120),o=n(a),u=r(123),c=n(u),i=r(146),s=n(i),d=r(1),p=n(d),f=r(2),l=n(f),v=t.loginToItMcloud=function(){var e=(0,l.default)(p.default.mark(function e(){var t,r,n,a,o,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("loginToItMcloud"),h=coreAccount.getLoginModel(),t=h,r=t.itOAuthUrl,n=t.account,e.next=5,coreSecurity.PasswordManager.getPassword("password");case 5:return a=e.sent,o="loginName="+n+"&password="+a+"&publicKeyFlag=4",e.next=9,C(r,o,{"Content-Type":"application/x-www-form-urlencoded"});case 9:if(u=e.sent,0!==u.result||!u.data){e.next=13;break}return m.info("loginToItMcloud successfully"),e.abrupt("return",{result:0,data:u.data.crypt_token});case 13:return m.info("loginToItMcloud error"),e.abrupt("return",{result:1});case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),m=(t.uploadAvatar=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o,u=t.imageStr,c=t.fileName;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("itEab uploadAvatar"),e.next=3,v();case 3:if(r=e.sent,n=r.data){e.next=7;break}return e.abrupt("return",{result:1});case 7:return a=b(n),e.next=10,C(h.itUploadHeadImgUrl,{imageStr:u,fileName:c},a);case 10:return o=e.sent,m.info("itEab uploadAvatar result: ",o.result),e.abrupt("return",{result:0===o.result&&o.data.flag?0:1});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.setSign=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("itEab setSign"),e.next=3,v();case 3:if(r=e.sent,n=r.data){e.next=7;break}return e.abrupt("return",{result:1});case 7:return a=b(n),e.next=10,C(h.itSignedUrl,{signed:t,action:"sign"},a);case 10:return o=e.sent,m.info("itEab setSign result: ",o.result),e.abrupt("return",{result:0===o.result&&o.data.flag?0:1});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),window.Logger("logic")("itEab")),h=null,g=function(){var e=(0,l.default)(p.default.mark(function e(t){var r,n,a,o,u,c,i,s,d,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h||(h=coreAccount.getLoginModel()),e.next=3,new coreHttp.hwTupHttpTransSdk;case 3:return r=e.sent,n=h,a=n.proxyAddress,o=n.proxyPort,u=n.proxyAccount,c=n.isSupportProxy,e.next=7,coreSecurity.PasswordManager.getPassword("proxyPassword");case 7:return i=e.sent,c||(a="",o=0,u="",i=""),s={url:t,type:f.type,header:f.headers||"",body:f.body||"",proxyInfo:{proxyAddress:a,proxyPort:o,proxyAccount:u,proxyPassword:i},cipherlist:[50331695,50331701,50331708,50331709]},e.next=12,r.sendSyncRequest(s);case 12:if(d=e.sent,200!==d.param.resp_code){e.next=15;break}return e.abrupt("return",{result:0,data:JSON.parse(d.param.recv_body)});case 15:return e.abrupt("return",d);case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,l.default)(p.default.mark(function e(t,r,n){var a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t,{type:constant.REQUEST_TYPE.POST,headers:n,body:"object"===(void 0===r?"undefined":(0,s.default)(r))?(0,c.default)(r):r});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),b=function(e){return(0,o.default)({"Content-Type":"application/json"},{Cookie:"token="+e})}},1752:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.createGroupInfoChangeEvent=t.saveContactInfo=t.saveContactInfoList=void 0;var a=r(1),o=n(a),u=r(2),c=n(u),i=window.Logger("group")("detail"),s=(t.saveContactInfoList=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("saveContactInfoList "),e.next=4,coreDb.bulkPutContact(t);case 4:s(t.map(function(e){return e.account})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i.error("saveContactInfoList ",e.t0.toString());case 10:case"end":return e.stop()}},e,void 0,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),t.saveContactInfo=function(){var e=(0,c.default)(o.default.mark(function e(t){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("saveContactInfo "),e.next=4,coreDb.saveContact(t);case 4:return r=e.sent,s([t.account]),e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),i.error("saveContactInfo ",e.t0.toString());case 12:case"end":return e.stop()}},e,void 0,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),t.createGroupInfoChangeEvent=function(e){var t=new Event("contactInfoChange");t.data={accountList:e},window.dispatchEvent(t)})},1753:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getMoreDirectorySearchResult=t.getDirectorySearchResult=t.setDirectorySearchValue=t.getDirectoryMenuKeyScroll=t.loadMoreServerContact=t.loadServerContact=void 0;var a=r(1),o=n(a),u=r(123),c=n(u),i=r(130),s=n(i),d=r(2),p=n(d),f=r(890),l=window.Logger("contactGroup")("corporateDirectory");t.loadServerContact=function(){var e=(0,p.default)(o.default.mark(function e(t){var r,n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=3;break}return l.info("[IT-Meeting] no need to loadServerContact"),e.abrupt("return");case 3:return e.prev=3,l.debug("初始加载企业通讯录"),$dispatch(coreUi.toggleDirectoryInitLoading(!0)),e.next=8,coreContact.searchServerContact(t);case 8:return r=e.sent,n=r.userInformationList,a=r.recordAmount,isNullOrEmpty(n)||$dispatch(coreUi.getRecordInformation(a,n)),window.CLIENTCONFIG.ISMOBILE||isNullOrEmpty(n)||(0,f.detectContactStatus)([].concat((0,s.default)(n)).map(function(e){return{account:e.account}})),u=[],isNullOrEmpty(n)||(u=n.map(function(e){var t=e.account;return handlePhoneNumber(t.substring(0,t.length-4))})),$dispatch(coreUi.toggleDirectoryInitLoading(!1)),l.info("首次加载企业通讯录",u),e.abrupt("return",n);case 19:e.prev=19,e.t0=e.catch(3),l.error("首次加载企业通讯录",{error:(0,c.default)(e.t0)});case 22:case"end":return e.stop()}},e,void 0,[[3,19]])}));return function(t){return e.apply(this,arguments)}}(),t.loadMoreServerContact=function(){var e=(0,p.default)(o.default.mark(function e(t){var r,n,a,u,c,i,d,p,v,m;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.contactGroups.isRecordInformationLoading,a=r.contactGroups.userInformationList,u=r.contactGroups.recordAmount,l.info("loadMoreServerContact",n),a.length!==u){e.next=8;break}return e.abrupt("return");case 8:if(!n){e.next=11;break}return l.info("loadMoreServerContact 正在加载更多用户消息"),e.abrupt("return");case 11:return $dispatch(coreUi.setRecordInformationLoading()),c=$getState().contactGroups.userInformationList.length,e.next=15,coreContact.searchServerContact(t,c);case 15:return i=e.sent,d=i.userInformationList,p=i.recordAmount,isNullOrEmpty(d)||c<p&&$dispatch(coreUi.addRecordInformation(d)),window.CLIENTCONFIG.ISMOBILE||isNullOrEmpty(d)||(0,f.detectContactStatus)([].concat((0,s.default)(d)).map(function(e){return{account:e.account}})),$dispatch(coreUi.setRecordInformationNotLoading()),v=[],isNullOrEmpty(d)||(v=d.map(function(e){var t=e.account;return handlePhoneNumber(t.substring(0,t.length-4))})),l.info("加载更多企业通讯录",v),m=void 0,isNullOrEmpty(d)||(m=a.concat(d)),e.abrupt("return",m);case 28:e.prev=28,e.t0=e.catch(0),l.error("loadMoreServerContact 加载更多企业通讯录",{error:e.t0.toJSON()});case 31:case"end":return e.stop()}},e,void 0,[[0,28]])}));return function(t){return e.apply(this,arguments)}}(),t.getDirectoryMenuKeyScroll=function(){var e=(0,p.default)(o.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.getDirectoryMenuKeyScroll(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setDirectorySearchValue=function(e,t){$dispatch(coreUi.setDirectorySearchValue(e,t))},t.getDirectorySearchResult=function(e,t){window.isOffline&&window.CLIENTCONFIG.ISMOBILE&&window.Toast(language.THE_NETWORK_IS_ABNORMAL,1,!1),$dispatch(coreUi.getDirectorySearchResult(e,t))},t.getMoreDirectorySearchResult=function(){var e=(0,p.default)(o.default.mark(function e(){var t,r,n,a,u,c,i,s,d,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.info("加载更多搜索企业通讯录结果"),window.isOffline&&window.CLIENTCONFIG.ISMOBILE&&window.Toast(language.THE_NETWORK_IS_ABNORMAL,1,!1),t=$getState(),r=t.contactGroups,n=r.directorySearchList,a=r.directorySearchValue,u=r.searchRecordAmount,c=[],i=u,!n){e.next=15;break}return s=n.length,e.next=11,coreContact.searchServerContact(a,s);case 11:d=e.sent,p=d.userInformationList||[],i=d.recordAmount,c=n.concat(p);case 15:$dispatch(coreUi.getDirectorySearchResult(c,i)),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),l.error("getMoreDirectorySearchResult 加载更多搜索企业通讯录结果",{error:e.t0.toJSON()});case 21:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(){return e.apply(this,arguments)}}()},1754:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setDirectoryMenu=t.togglePageList=void 0;var a=r(1),o=n(a),u=r(2),c=n(u);t.togglePageList=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.updateMobileListContent(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setDirectoryMenu=function(e){$dispatch(coreUi.setDirectoryMenu(e))}},1755:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setPhoneAddrPageSearching=t.saveInitPhoneContactList=t.setPhoneAddrPageLoadIndex=t.setPhoneAddrPageLoading=t.searchPhoneContact=t.getPhoneContacts=void 0;var a=r(120),o=n(a),u=r(130),c=n(u),i=r(1),s=n(i),d=r(3),p=n(d),f=r(2),l=n(f),v=window.Logger("logic")("phoneContacts"),m=(t.getPhoneContacts=function(){var e=(0,l.default)(s.default.mark(function e(){var t,r,n,a,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v.info("user click phone address menu,try to access the phone's contacts"),v.info("begin get mobile contacts, bSelect: "+o),t=$getState(),r=t.contactGroups.isPhoneAddrLoading,!r){e.next=6;break}return v.warn("already loading"),e.abrupt("return");case 6:if(!o){e.next=11;break}if(n=$getState(),a=n.common.phoneAddr_ContactList,isNullOrEmpty(a)){e.next=11;break}return v.info("select phone address page, already has contact"),e.abrupt("return");case 11:return g(!0),e.abrupt("return",new p.default(function(e,t){var r=new ContactFindOptions;r.filter=u,r.multiple=!0,r.desiredFields=[navigator.contacts.fieldType.displayName,navigator.contacts.fieldType.phoneNumbers],r.hasPhoneNumber=!0;var n=["displayName","firstName","lastName","familyName","middleName","givenName","name","nickname","phoneNumbers"];navigator.contacts.find(n,function(t){v.info("get mobile contacts success");var r=h(t,o),n=r.mList,a=r.enList,u=window.getRoute();if("phoneAddrListPage"!==u&&"directorySearch"!==u&&"callMain"!==u&&"mConfMemberPage"!==u&&"selectPhoneContact"!==u&&!o)return v.warn("already return from phone contact page"),$dispatch(coreUi.setPhoneAddrLoading(!1)),void C(n,a);o?($dispatch(coreUi.togglePhoneAddrContactList(n)),C(n,a),e()):$dispatch(coreUi.updatePhoneContactList(n,a)),$dispatch(coreUi.setPhoneAddrLoading(!1))},function(e){v.info("get mobile contacts failed, ",e),$dispatch(coreUi.setPhoneAddrLoading(!1)),t(e)},r)}));case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.searchPhoneContact=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return v.info("begin search mobile contacts, "+t),t&&isNullOrEmpty(e)?($dispatch(coreUi.togglePhoneAddrSearchList([])),{}):(g(!0),new p.default(function(r,n){var a=new ContactFindOptions;a.filter=e,a.multiple=!0,a.desiredFields=[navigator.contacts.fieldType.displayName,navigator.contacts.fieldType.phoneNumbers],a.hasPhoneNumber=!0;var o=["displayName","firstName","lastName","familyName","middleName","givenName","name","nickname","phoneNumbers"];navigator.contacts.find(o,function(n){v.info("search mobile contacts success"),g(!1);var a=m(n,e,t),o=a,u=a.length;return r({recordAmount:u,userInformationList:o})},function(e){g(!1),v.info("search mobile contacts failed, ",e),r({})},a)}))},function(e,t,r){v.info("parseSearchContacts: "+e.length);for(var n=e.sort(function(){return function(e,t){var r=window.pinyinUtil.getPinyin(e.displayName),n=window.pinyinUtil.getPinyin(t.displayName);return r.localeCompare(n)}}()),a=[],u=0;u<n.length;u++)if(n[u].phoneNumbers){var i={displayName:n[u].displayName,phoneNumbers:[].concat((0,c.default)(n[u].phoneNumbers)),id:n[u].id};if(r){var s=b(i);(0,o.default)(i,{isSelected:!1,isExpanded:!1,numberInfo:s}),a.push({type:"charItem",item:i,itemKey:i.id})}else a.push({type:"charItem",item:i,itemKey:i.id})}return a}),h=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v.info("parseContacts: "+e.length);for(var r=e.sort(function(){return function(e,t){var r=window.pinyinUtil.getPinyin(e.displayName),n=window.pinyinUtil.getPinyin(t.displayName);return r.localeCompare(n)}}()),n=[],a=[],u=[],i=1,s=!1,d=0;d<r.length;d++)if(r[d].phoneNumbers&&0!==r[d].phoneNumbers.length){var p={displayName:r[d].displayName,phoneNumbers:[].concat((0,c.default)(r[d].phoneNumbers)),id:r[d].id,pinyin:r[d].displayName?window.pinyinUtil.getPinyin(r[d].displayName):""};if(t){var f=b(p);(0,o.default)(p,{isSelected:!1,isExpanded:!1,numberInfo:f})}var l=!0,m="",h="";p.displayName?(m=window.pinyinUtil.getPinyin(p.displayName.trim()).toLowerCase(),h=m.charAt(0)):l=!1;var g=/^[a-z]$/;l&&""!==h&&isNaN(parseInt(h))&&g.test(h)?(n.includes(h)||(n.push(h),a.push({type:"charTitle",char:h,char_index:i++})),a.push({type:"charItem",item:p,itemKey:p.id})):(s=!0,u.push({type:"charItem",item:p,itemKey:p.id}))}var C=[];return s&&(n.push("#"),C=u.sort(function(){return function(e,t){var r=e.item.displayName,n=t.item.displayName;return r&&n?r.localeCompare(n):!r&&n?(r=e.item.phoneNumbers[0].value,r?r.localeCompare(n):0):r&&!n?(n=t.item.phoneNumbers[0].value,n?r.localeCompare(n):0):r||n?0:(r=e.item.phoneNumbers[0].value,n=t.item.phoneNumbers[0].value,r&&n?r.localeCompare(n):0)}}()),C.unshift({type:"charTitle",char:"#",char_index:27})),a.push.apply(a,(0,c.default)(C)),{mList:a,enList:n}},g=t.setPhoneAddrPageLoading=function(e){$dispatch(coreUi.setPhoneAddrLoading(e))},C=(t.setPhoneAddrPageLoadIndex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;$dispatch(coreUi.setPhoneAddrLoadIndex(e))},t.saveInitPhoneContactList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[],n=[];if(isNullOrEmpty(e)||isNullOrEmpty(t)){var a=$getState().contactGroups,o=a.mPhoneContactList,u=a.mEnPhoneList;r=o.length>100?o.slice(0,100):o,n=u}else r=e.length>100?e.slice(0,100):e,n=t;$dispatch(coreUi.updatePhoneContactList(r,n))}),b=(t.setPhoneAddrPageSearching=function(e){$dispatch(coreUi.setPhoneAddrSearching(e))},function(e){for(var t={},r=0,n=0,a=0,u=0,c=0;c<e.phoneNumbers.length;c++){var i=e.phoneNumbers[c],s="";"mobile"===i.type||"移动"===i.type?(s="mobile"+(r?r.toString():""),r++):"home"===i.type?(s="home_phone"+(n?n.toString():""),n++):"work"===i.type?(s="office_phone"+(a?a.toString():""),a++):(s="other_phone"+(u?u.toString():""),u++);var d={};d[s]={number:i.value,isSelected:!1},(0,o.default)(t,d)}return t})},1756:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.Logger("service")("service/util/contactUtils"),t.getCallNumList=function(e){if(!e)return[];var t=[];return Object.forEach(constant.USER_INFO.CALL_INFO,function(r,n){isNullOrEmpty(e[r])||!isNullOrEmpty(e.bind_no)&&"espacenumber"===r||!isNullOrEmpty(e.short_phone)&&"office_phone2"===r||t.push({key:n,num:e[r]})}),t},t.getVideoNumList=function(e){if(!e)return[];var t=[];return Object.forEach(constant.USER_INFO.VIDEO_INFO,function(r,n){isNullOrEmpty(e[r])||!isNullOrEmpty(e.bind_no)&&"espacenumber"===r||!isNullOrEmpty(e.short_phone)&&"office_phone2"===r||t.push({key:n,num:e[r]})}),t}},1757:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.callClickFunc=t.videoClickFunc=t.playDialAudio=t.clickFunc=void 0;var a=r(1),o=n(a),u=r(124),c=n(u),i=r(2),s=n(i);window.Logger("contact")("recentcall"),t.clickFunc=function(){var e=(0,s.default)(o.default.mark(function e(t,r,n,a,u,i){var s,d,p,f,l,v;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.peeraccount,d=t.calleenumber,p=coreConf.showOrDisabledBtn()){e.next=4;break}return e.abrupt("return");case 4:if(!n||a||!i){e.next=6;break}return e.abrupt("return");case 6:return f=void 0,l=void 0,e.next=9,coreContact.getContactByAccount(s);case 9:if(v=e.sent,u&&u.contact_id&&!u.account?l=(0,c.default)({},u):isNullOrEmpty(v)?l=r===s?coreSearch.getTempCallUserInfo(s,language.VOICE_MAIL_BOX,!0):coreSearch.getTempCallUserInfo(s):(f=v.bind_no,l=v),!i){e.next=17;break}if(!window.SERVERCONFIG.HWUC){e.next=16;break}return e.abrupt("return",alert(language.COMMON_FUNCTION_IS_NOT_AVAILABLE));case 16:return e.abrupt("return",coreCall.CallOut(d,l,!0));case 17:if(isNullOrEmpty(f)||l.bind_no!==d||!window.SERVERCONFIG.HWUC){e.next=19;break}return e.abrupt("return",coreCall.CallOut("*"+d,l));case 19:return e.abrupt("return",coreCall.voiceCallPC(d,l));case 20:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,a,o,u){return e.apply(this,arguments)}}(),t.playDialAudio=function(e,t,r){var n=void 0;if(12===e&&(e=0),window.webView)window.webView.playRing(e+".wav",0);else if((void 0)[e]?(n=t[Number(e)+KEY_AUDIO_LEN],(void 0)[e]=!1):(n=t[e],(void 0)[e]=!0),coreCommon.isMobile()){var a=new Media(KEY_AUDIO_SRC+r[Number(e)],function(){window.log("audio load success.")},function(){window.log("audio load failed.")});a.play()}else n.currentTime=0,n.play()},t.videoClickFunc=function(){var e=(0,s.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreContact.searchServerContact(t);case 2:r=e.sent,n=r.userInformationList||[],0!==n.length?t.length>=7?coreCall.CallOut(t,n[0],!0):coreCall.CallOut(1===window.SERVERCONFIG.HWUC?"*"+t:t,n[0],!0):t.length>=7?coreCall.CallOut(t,coreSearch.getTempCallUserInfo(t),!0):coreCall.CallOut(1===window.SERVERCONFIG.HWUC?"*"+t:t,coreSearch.getTempCallUserInfo(t),!0);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.callClickFunc=function(){var e=(0,s.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreContact.searchServerContact(t,1,1);case 2:r=e.sent,n=r.userInformationList||[],0!==n.length?t.length>=7?coreCall.voiceCallPC(t,n[0]):coreCall.voiceCallPC(1===window.SERVERCONFIG.HWUC?"*"+t:t,n[0]):t.length>=7?coreCall.voiceCallPC(t,coreSearch.getTempCallUserInfo(t)):coreCall.voiceCallPC(1===window.SERVERCONFIG.HWUC?"*"+t:t,coreSearch.getTempCallUserInfo(t));case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},1758:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.euaserver=void 0;var a=r(130),o=n(a),u=r(115),c=n(u),i=r(4),s=n(i),d=r(116),p=n(d),f=r(117),l=n(f),v=r(1),m=n(v),h=r(2),g=n(h),C=r(1759),b=n(C),x=window.Logger("logic")("login/euaserver"),y=function(){var e=(0,g.default)(m.default.mark(function e(){var t,r,n,a,o,u,c,i,s,d,p,f,l,v,h,g,C,b,y,_,w;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k()){e.next=2;break}return e.abrupt("return");case 2:return coreUt.utEventStart(constant.EVENT_ID.UT_LOGIN,constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER,[constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER]),x.info(" start eabserverLogin"),e.next=6,new coreTup.HWTupEaddr;case 6:return t=e.sent,r=coreAccount.getLoginModel(),n=r.account,a=r.eabUri,o=r.groupServer,u=r.serverAddress,c=r.serverPort,i=r.serverUportalAddress,s=r.serverUportalPort,d=r.isSupportProxy,p=r.proxyAddress,f=r.proxyPort,l=r.proxyAccount,v=r.authToken,e.next=10,coreSecurity.PasswordManager.getPassword("proxyPassword");case 10:return h=e.sent,d||(p=null,f=null,l=null,h=null),g=window.CLIENTCONFIG.EAB_SEARCH_NUM||20,C={LogLevel:0,LogFileSize:10241024,LogPath:window.LOG_PATH},x.info(" eabserverLogin  eaddrSetLogPara "),e.next=17,t.eaddrSetLogPara(C);case 17:return x.info("eabserverLogin eaddrInit"),e.next=20,t.eaddrInit();case 20:return x.info(" eabserverLogin  eaddrConfig "),b=i||u,y=s||c,_={ServerType:3,HttpServerAddr:a||"https://"+b+":"+y+"/services",AvatarServerAddr:o||"https://"+b+":"+y+"/headportrait",PageCount:g,UserName:n,Token:v,AvatarFilePath:window.avatarPath,HttpsVerifyMode:0,HttpTimeOut:10,RCSType:1,CertFilePath:"",ProxyIpAddr:p,ProxyPort:parseInt(f),ProxyAuthUserName:l,ProxyAuthPassword:h},e.next=26,t.eaddrConfig(_);case 26:if(w=e.sent,0!==w.result){e.next=34;break}return x.info("eabserverLogin  success"),coreCommon.dispatchModuleEvent("login",{event:"eua",code:0}),coreUt.utEventFinish(constant.EVENT_ID.UT_LOGIN,constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER,[1],!0),e.abrupt("return",coreCommon.ATOMIC_ACTION_RESULT.SUCCESS);case 34:return x.error("eabserverLogin  failed"),coreCommon.dispatchModuleEvent("login",{event:"eua",code:w}),coreUt.utEventFinish(constant.EVENT_ID.UT_LOGIN,constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER,[0,w.result],!0),e.abrupt("return",coreCommon.ATOMIC_ACTION_RESULT.FAILED);case 38:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),_=new coreCommon.AtomicAction("eabserverLoginAtomic",y),w=function(e){var t=e&&e.result||e&&e.param&&e.param.result;if(!isNullOrEmpty(t))switch(t){case constant.ERROR_SEARCHINFO_CODE.EADDR_SUCCESS:return!0;case constant.ERROR_SEARCHINFO_CODE.EADDR_FAIL_AUTH:case constant.ERROR_SEARCHINFO_CODE.EADDR_FAIL_TOKEN:I()}return x.info("EUA request error, reason:",t),!1},I=function(){window.CLIENTCONFIG.ENABLE_IT_MEETING?window.refreshImToken():coreAccount.actionRefreshToken()},k=function(){return!(window.CLIENTCONFIG.ISBIGWIN||!coreAccount.getLoginModel().useEab)},S=function(){return!!k()||(x.warn("EUA module is not enabled"),!1)},E=function(e){function t(){var e,r,n,a,u=this;(0,s.default)(this,t);for(var i=arguments.length,d=Array(i),f=0;f<i;f++)d[f]=arguments[f];return r=n=(0,p.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),n.eaddrUnint=(0,g.default)(m.default.mark(function e(){var t;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,_.reset();case 4:return x.info("eabserverLogin eaddrUnint"),e.next=7,new coreTup.HWTupEaddr;case 7:return t=e.sent,e.abrupt("return",t.eaddrUninit());case 9:case"end":return e.stop()}},e,u)})),n.searchAvatar=function(){var e=(0,g.default)(m.default.mark(function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:constant.AVATAR_SIZE.BIG,a=arguments[2];return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,_.wait();case 4:return x.debug("searchAvatar",n),r={ServerType:constant.EADDR_SERVER_TYPE.RCS,ucaccount:t,IconSize:n},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.setNotifies({196611:a}),e.eaddrSearchAvatar(r).then(function(e){return x.debug("eaddrSearchAvatar"),w(e),e})}));case 7:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.searchAvatarList=function(){var e=(0,g.default)(m.default.mark(function e(t,r){var n;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,_.wait();case 4:return x.info("searchAvatarList begin"),n={ServerType:constant.EADDR_SERVER_TYPE.RCS,ucaccounts:t,IconSize:0},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.setNotifies({196616:r}),e.eaddrSearchAvatarList(n).then(function(e){return x.debug("searchAvatarList"),w(e),e})}));case 7:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.setAvatar=function(){var e=(0,g.default)(m.default.mark(function e(t,r){var n;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,_.wait();case 4:return n={ServerType:3,IconType:1,SmallIconFilePath:t.SmallIconFilePath,MediumIconFilePath:t.MediumIconFilePath,LargeIconFilePath:t.LargeIconFilePath},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.setEaddrBaseEvent({upLoadAvatar:function(e){w(e),r(e)}}),e.eaddrSetAvatar(n).then(function(e){return w(e),e})}));case 6:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.searchServerContact=function(){var e=(0,g.default)(m.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1],c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return",{});case 2:return e.next=4,_.wait();case 4:return x.debug("load ent first time"),a=encodeURIComponent(a),a=""===a?" ":a,t=window.CLIENTCONFIG.EAB_SEARCH_NUM||20,o=o||0,r=parseInt(o/t)+1,n={ServerType:3,condition:a,PageIndex:r,SearchType:c,Dept:""},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.eaddrSearchInfo(n).then(function(e){if(w(e)){var t=e.param.entry,r=e.param.TotalNum;return x.info("interface server all contacts search finish,count",r),{recordAmount:r,userInformationList:t}}return x.error("searchServerContact failed"),{}})}));case 12:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.queryServerContact=function(){var e=(0,g.default)(m.default.mark(function e(t){var r;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return",{param:{}});case 2:return e.next=4,_.wait();case 4:return r={ServerType:3,condition:t,PageIndex:1,SearchType:1,Dept:""},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.eaddrSearchInfo(r).then(function(e){return w(e)?{param:e.param.entry[0],result:e.param.result}:(x.error("queryServerContact failed"),{param:{}})})}));case 6:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.queryUserListFromEaddr=function(){var e=(0,g.default)(m.default.mark(function e(t){var r;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return");case 2:return _.wait(),r={users:[].concat((0,o.default)(t))},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.eaddrSearchUserList(r).then(function(e){return w(e)?e.param:(x.error("queryUserListFromEaddr failed"),{})})}));case 5:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.refreshTocken=(0,g.default)(m.default.mark(function e(){return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.reset());case 1:case"end":return e.stop()}},e,u)})),a=r,(0,p.default)(n,a)}return(0,l.default)(t,e),t}(b.default);t.euaserver=new E},1759:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(1),o=n(a),u=r(2),c=n(u),i=r(115),s=n(i),d=r(4),p=n(d),f=r(116),l=n(f),v=r(117),m=n(v),h=function(e){function t(){var e,r,n,a,u=this;(0,p.default)(this,t);for(var i=arguments.length,d=Array(i),f=0;f<i;f++)d[f]=arguments[f];return r=n=(0,l.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(d))),n.eaddrUnint=(0,c.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)})),n.searchAvatar=function(){var e=(0,c.default)(o.default.mark(function e(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:constant.AVATAR_SIZE.BIG,arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.searchAvatarList=function(){var e=(0,c.default)(o.default.mark(function e(t,r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.setAvatar=function(){var e=(0,c.default)(o.default.mark(function e(t,r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.searchServerContact=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.queryServerContact=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.queryUserListFromEaddr=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.refreshTocken=(0,c.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)})),a=r,(0,l.default)(n,a)}return(0,m.default)(t,e),t}(coreCommon.Interface);t.default=h},176:function(e,t,r){e.exports=r(0)(385)},1760:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=r(1),o=n(a),u=r(2),c=n(u),i=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.code){e.next=7;break}e.t0=t.event,e.next="total"===e.t0?4:6;break;case 4:return window.CLIENTCONFIG.ISBIGWIN||(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING,coreContact.loadServerContact(),coreContact.getDirectoryMenuKeyScroll()),e.abrupt("break",7);case 6:return e.abrupt("break",7);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();window.Logger("contact")("moduleMessager");coreCommon.registeModuleListener("login",i),coreCommon.registeModuleListener("logout",s)},179:function(e,t,r){e.exports=r(0)(63)},183:function(e,t,r){r(24),r(22),e.exports=r(184)},184:function(e,t,r){var n=r(9),a=r(26);e.exports=r(8).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},188:function(e,t,r){r(22),r(189),e.exports=r(8).Array.from},189:function(e,t,r){"use strict";var n=r(11),a=r(10),o=r(134),u=r(32),c=r(33),i=r(27),s=r(190),d=r(26);a(a.S+a.F*!r(34)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,a,p,f=o(e),l="function"==typeof this?this:Array,v=arguments.length,m=v>1?arguments[1]:void 0,h=void 0!==m,g=0,C=d(f);if(h&&(m=n(m,v>2?arguments[2]:void 0,2)),void 0==C||l==Array&&c(C))for(t=i(f.length),r=new l(t);t>g;g++)s(r,g,h?m(f[g],g):f[g]);else for(p=C.call(f),r=new l;!(a=p.next()).done;g++)s(r,g,h?u(p,m,[a.value,g],!0):a.value);return r.length=g,r}})},190:function(e,t,r){"use strict";var n=r(25),a=r(191);e.exports=function(e,t,r){t in e?n.f(e,t,a(0,r)):e[t]=r}},191:function(e,t,r){e.exports=r(0)(62)},192:function(e,t,r){r(193),e.exports=r(8).Object.keys},193:function(e,t,r){var n=r(134),a=r(179);r(142)("keys",function(){return function(e){return a(n(e))}})},196:function(e,t,r){e.exports={default:r(503),__esModule:!0}},353:function(e,t,r){"use strict";var n=r(25).f,a=r(374),o=r(29),u=r(11),c=r(28),i=r(23),s=r(375),d=r(376),p=r(37),f=r(30),l=r(176).fastKey,v=r(169),m=f?"_s":"size",h=function(e,t){var r,n=l(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,s){var d=e(function(e,n){c(e,d,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=n&&i(n,r,e[s],e)});return o(d.prototype,{clear:function(){for(var e=v(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var r=v(this,t),n=h(r,e);if(n){var a=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=a),a&&(a.p=o),r._f==n&&(r._f=a),r._l==n&&(r._l=o),r[m]--}return!!n},forEach:function(e){v(this,t);for(var r,n=u(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!h(v(this,t),e)}}),f&&n(d.prototype,"size",{get:function(){return v(this,t)[m]}}),d},def:function(e,t,r){var n,a,o=h(e,t);return o?o.v=r:(e._l=o={i:a=l(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[m]++,"F"!==a&&(e._i[a]=o)),e},getEntry:h,setStrong:function(e,t,r){s(e,t,function(e,r){this._t=v(e,t),this._k=r,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?d(0,r.k):"values"==t?d(0,r.v):d(0,[r.k,r.v]):(e._t=void 0,d(1))},r?"entries":"values",!r,!0),p(t)}}},354:function(e,t,r){"use strict";var n=r(7),a=r(10),o=r(176),u=r(144),c=r(35),i=r(29),s=r(23),d=r(28),p=r(15),f=r(36),l=r(25).f,v=r(377)(0),m=r(30);e.exports=function(e,t,r,h,g,C){var b=n[e],x=b,y=g?"set":"add",_=x&&x.prototype,w={};return m&&"function"==typeof x&&(C||_.forEach&&!u(function(){(new x).entries().next()}))?(x=t(function(t,r){d(t,x,e,"_c"),t._c=new b,void 0!=r&&s(r,g,t[y],t)}),v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in _&&(!C||"clear"!=e)&&c(x.prototype,e,function(r,n){if(d(this,x,e),!t&&C&&!p(r))return"get"==e&&void 0;var a=this._c[e](0===r?0:r,n);return t?this:a})}),C||l(x.prototype,"size",{get:function(){return this._c.size}})):(x=h.getConstructor(t,e,g,y),i(x.prototype,r),o.NEED=!0),f(x,e),w[e]=x,a(a.G+a.W+a.F,w),C||h.setStrong(x,e,g),x}},355:function(e,t,r){var n=r(16),a=r(382);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},356:function(e,t,r){"use strict";var n=r(10);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},357:function(e,t,r){"use strict";var n=r(10),a=r(12),o=r(11),u=r(23);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,c,i=arguments[1];return a(this),t=void 0!==i,t&&a(i),void 0==e?new this:(r=[],t?(n=0,c=o(i,arguments[2],2),u(e,!1,function(e){r.push(c(e,n++))})):u(e,!1,r.push,r),new this(r))}})}},368:function(e,t,r){e.exports={default:r(369),__esModule:!0}},369:function(e,t,r){r(24),r(22),e.exports=r(370)},370:function(e,t,r){var n=r(16),a=r(6)("iterator"),o=r(17);e.exports=r(8).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||o.hasOwnProperty(n(t))}},374:function(e,t,r){e.exports=r(0)(111)},375:function(e,t,r){e.exports=r(0)(184)},376:function(e,t,r){e.exports=r(0)(381)},377:function(e,t,r){var n=r(11),a=r(378),o=r(134),u=r(27),c=r(379);e.exports=function(e,t){var r=1==e,i=2==e,s=3==e,d=4==e,p=6==e,f=5==e||p,l=t||c;return function(t,c,v){for(var m,h,g=o(t),C=a(g),b=n(c,v,3),x=u(C.length),y=0,_=r?l(t,x):i?l(t,0):void 0;x>y;y++)if((f||y in C)&&(m=C[y],h=b(m,y,g),e))if(r)_[y]=h;else if(h)switch(e){case 3:return!0;case 5:return m;case 6:return y;case 2:_.push(m)}else if(d)return!1;return p?-1:s||d?d:_}}},378:function(e,t,r){e.exports=r(0)(153)},379:function(e,t,r){var n=r(380);e.exports=function(e,t){return new(n(e))(t)}},380:function(e,t,r){var n=r(15),a=r(381),o=r(6)("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},381:function(e,t,r){e.exports=r(0)(387)},382:function(e,t,r){var n=r(23);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},503:function(e,t,r){r(31),r(22),r(24),r(504),r(505),r(506),r(507),e.exports=r(8).Set},504:function(e,t,r){"use strict";var n=r(353),a=r(169);e.exports=r(354)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(a(this,"Set"),e=0===e?0:e,e)}},n)},505:function(e,t,r){var n=r(10);n(n.P+n.R,"Set",{toJSON:r(355)("Set")})},506:function(e,t,r){r(356)("Set")},507:function(e,t,r){r(357)("Set")},890:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=[];return e.forEach(function(e){isNullOrEmpty(t.query({account:e}))&&r.push({username:e,etag:"fffff"})}),r}function o(e,t){return e.map(function(e){return isNullOrEmpty(e)?{}:t[e]||{}})}function u(e){return e.replace(/(^\s*)|(\s*$)/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.addContactToGroups=t.autoCreateGroupName=t.changeGroupName=t.testGroupName=t.initContactGroupNameLogic=t.setContactGroupNameLogic=t.reLoadContactInfo=t.dealUserInfoChange=t.checkIsFriendByAccount=t.createContactOrGroupConversation=t.createConversation=t.createConversationLogic=t.selectAddContactList=t.changeContactGroupName=t.queryContactGroupByOpts=t.addContact=t.checkContactGroupName=t.setAddNewContactValueLogic=t.createNewContactGroup=t.createContactGroup=t.moveToOtherGroup=t.queryContactMemerGroupByOpts=t.deleteContactSubmenu=t.deleteContactFromAll=t.deleteContact=t.deleteContactLogic=t.checkIsFriendByQuery=t.reloadContactListData=t.toggleRemoveFromAll=t.openContactConversationByConf=t.openContactConversation=t.createContactConversation=t.clickContact=t.updateSignatureByRecent=t.updateSignatureFromEserver=t.getContactDetailInfo=t.hideGroupAddContacts=t.toggleContactTypeOpen=t.getContactListByAccountList=t.refreshContactInfo=t.getContactByAccount=t.getContactByCallNumber=t.subscribeContactStatus=t.detectContactStatus=t.toggleContactDetailTab=void 0;var c=r(146),i=n(c),s=r(149),d=n(s),p=r(132),f=n(p),l=r(3),v=n(l),m=r(120),h=n(m),g=r(130),C=n(g),b=r(1),x=n(b),y=r(2),_=n(y),w=function(){var e=(0,_.default)(x.default.mark(function e(t){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(O.length<1)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new coreTup.HWTupIM;case 4:r=e.sent,r.detectuserstatus({account_list:t});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=(0,_.default)(x.default.mark(function e(t){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(M.length<1)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new coreTup.HWTupIM;case 4:r=e.sent,r.subscribeuserstatus({account_list:t});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),k=(t.refreshContactInfo=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a,o;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.isOffline){e.next=4;break}return L.info("refreshContactInfo 当前尚处于离线状态，不查询服务器"),e.abrupt("return",{});case 4:return n={},e.next=7,(0,S.getUserInfo)(t);case 7:if(a=e.sent,o=a&&a.param,!a||a.result){e.next=15;break}n=(0,h.default)(n,o),coreContact.saveContactInfo(n),Y(n,r),e.next=17;break;case 15:return L.error("refreshContactInfo 用户已经不存在"),e.abrupt("return",{});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),L.error("refreshContactInfo",{error:e.t0.toJSON()});case 22:case"end":return e.stop()}},e,this,[[0,19]])}));return function(t,r){return e.apply(this,arguments)}}(),r(995)),S=r(1068),E=r(996),N=r(1211),L=window.Logger("logic")("contact"),O=(t.toggleContactDetailTab=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{r=$getState(),n=r.contactGroups.sliderDetailShow,n?$dispatch(coreUi.updateSliderContactDetailTab(t)):$dispatch(coreUi.updateContactDetailTab(t)),L.info("切换联系人详情tab页","sliderDetailShow:tab:"+t),L.info("切换联系人详情tab页")}catch(e){L.error("toggleContactDetailTab",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),[]),G=null,T=t.detectContactStatus=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.isEserverOnline){e.next=2;break}return e.abrupt("return");case 2:try{G&&clearInterval(G),r=Object.type(t),n=[],"string"===r?n=[{account:t}]:"array"===r?t.length>0&&(n=t[0].account?t:t.map(function(e){return{account:e}})):"object"===r&&(n=[t]),O=O.concat(n),O.length>20?(w([].concat((0,C.default)(O))),O=[]):G=setTimeout(function(){w([].concat((0,C.default)(O))),O=[]},200)}catch(e){L.error("detectContactStatus",e)}case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),M=[],A=null,D=(t.subscribeContactStatus=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.isOffline){e.next=2;break}return e.abrupt("return");case 2:try{A&&clearInterval(A),r=Object.type(t),n=[],"string"===r?n=[{account:t}]:"array"===r?t.length>0&&(n=t[0].account?t:t.map(function(e){return{account:e}})):"object"===r&&(n=[t]),M=M.concat(n),M.length>20?(I([].concat((0,C.default)(M))),M=[]):A=setTimeout(function(){I([].concat((0,C.default)(M))),M=[]},200)}catch(e){L.error("detectContactStatus",e)}case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getContactByCallNumber=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,L.info("getContactByCallNumber begin"),!isNullOrEmpty(t)){e.next=5;break}return L.error("getContactByCallNumber error: callNumber is empty!"),e.abrupt("return","");case 5:return e.next=7,coreDb.queryContactByPhonenumberAccurate(t);case 7:if(r=e.sent,isNullOrEmpty(r)){e.next=11;break}return L.info("getContactByCallNumber has fonded from db!"),e.abrupt("return",r.account);case 11:return e.next=13,coreContact.queryServerContact(t);case 13:if(n=e.sent,n.result!==constant.ERROR_SEARCHINFO_CODE.EADDR_SUCCESS){e.next=21;break}return a=n.param||{},coreUi.getContactAvatar(a.account),coreContact.saveContactInfo(a),e.abrupt("return",a.account);case 21:return e.abrupt("return","");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),L.error("getContactByCallNumber",e.t0);case 27:case"end":return e.stop()}},e,void 0,[[0,24]])}));return function(t){return e.apply(this,arguments)}}(),t.getContactByAccount=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.contactGroups.contactUserList,a=r.myInfo,T(t),t!==a.account){e.next=8;break}return s&&coreUi.getContactAvatar(t),e.abrupt("return",a);case 8:if(o=n.query({account:t}),isNullOrEmpty(o)||!o.contact_id){e.next=12;break}return s&&coreUi.getContactAvatar(t),e.abrupt("return",o);case 12:if(isNullOrEmpty(t)){e.next=16;break}return e.next=15,coreDb.queryContact({all:"",accountlist:t});case 15:o=e.sent;case 16:if(o.id&&!s){e.next=30;break}return e.next=19,(0,S.getUserInfo)(t);case 19:if(u=e.sent,c=u&&u.param,!u||u.result){e.next=28;break}return o=(0,h.default)(o,c),(i||s)&&coreContact.saveContactInfo(o),s&&Y(o,r),e.abrupt("return",o);case 28:return L.error("getContactByAccount 用户已经不存在"),e.abrupt("return",{});case 30:return L.info("通过account获取联系人信息","success"),e.abrupt("return",o);case 34:return e.prev=34,e.t0=e.catch(0),L.error("getContactByAccount",e.t0.toString()),e.abrupt("return",{});case 38:case"end":return e.stop()}},e,void 0,[[0,34]])}));return function(t){return e.apply(this,arguments)}}()),U=(t.getContactListByAccountList=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var r=PromiseObject();if(L.info("getContactListByAccountList 通过AccountList获取联系人List"),isNullOrEmpty(e))return L.info("getContactListByAccountList list is empty"),v.default.resolve([]);var n=$getState(),u={};e.forEach(function(e){u[e]||(u[e]=!1)});var c=n.contactGroups.contactUserList,i=n.myInfo,s=[],d=[];if((0,f.default)(u).forEach(function(e){if(isNullOrEmpty(e))u[e]={};else if(!u[e]){var t=void 0;e===i.account?u[e]=i:(t=c.query({account:e}),isNullOrEmpty(t)?s.push(e):u[e]=t,T(e))}}),isNullOrEmpty(s))r.resolve(o(e,u));else{L.info("getContactListByAccountList 查询数据库");var p=s.join(",");L.info("getContactListByAccountList should query from DB:"+s.length),coreDb.queryContactList({all:"",accountlist:p}).then(function(n){if(L.info("getContactListByAccountList DB 查到的联系人:"+n.length),n.forEach(function(e){u[e.account]=e}),n.length===s.length)r.resolve(o(e,u));else{L.info("getContactListByAccountList 查询服务器");a(s,n).splitByNum(20).forEach(function(e){d.push(coreContact.queryUserListFromEaddr(e))}),v.default.all(d).then(function(n){var a=[];n.forEach(function(e){0===e.result&&e.entry.forEach(function(e){e.result_code===constant.EADDR_CONTACT_RESULT_CODE.SUCCESS&&(a.push(e),u[e.account]=e)})}),t&&(L.info("getContactListByAccountList 保存服务器查到的联系人:"+a.length),coreContact.saveContactInfoList(a)),r.resolve(o(e,u))})}})}return r}catch(e){return L.error("getContactListByAccountList",{error:e.toJSON()}),v.default.resolve([])}},t.toggleContactTypeOpen=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a,o,u;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=$getState(),a=n.contactGroups.contactTypeOpen,o=[].concat((0,C.default)(a)),u=0;case 5:if(!(u<o.length)){e.next=12;break}if(o[u].group!==t){e.next=9;break}return o[u].open=r,e.abrupt("break",12);case 9:u++,e.next=5;break;case 12:return e.next=14,$dispatch(coreUi.updateContactTypeOpen(o));case 14:L.info("切换联系人分组折叠展开"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),L.error("toggleContactTypeOpen",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t,r){return e.apply(this,arguments)}}(),t.hideGroupAddContacts=function(){coreUi.hideModal()},t.getContactDetailInfo=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=!0,n={},a={},!isNullOrEmpty(t.account)){e.next=8;break}n=t,e.next=19;break;case 8:if(!t.account){e.next=16;break}return r=!1,o=t.account,e.next=13,D(o,u,u);case 13:a=e.sent,e.next=19;break;case 16:return e.next=18,coreDb.queryContact({contact_id:t.contact_id});case 18:a=e.sent;case 19:return n=isNullOrEmpty(a)?(0,h.default)({},t,{isNotServerInfo:!0}):(0,h.default)({},a,{isNotServerInfo:!1}),L.info("获取联系人详情页信息"),e.abrupt("return",{userInfo:n,customContact:r});case 24:e.prev=24,e.t0=e.catch(0),L.error("getContactDetailInfo",e.t0);case 27:case"end":return e.stop()}},e,void 0,[[0,24]])}));return function(t){return e.apply(this,arguments)}}()),R=(t.updateSignatureFromEserver=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(L.info("updateSignatureFromEserver"),(n=r===$getState().myInfo.account)||!isNullOrEmpty(t)&&!isNullOrEmpty(t.contact_id)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,(0,S.getUserInfo)(r,!0);case 6:return a=e.sent,t.signature=a.param.signature,n&&$dispatch(coreUi.updateMyInfo(t)),e.abrupt("return",t);case 10:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.updateSignatureByRecent=function(){var e=(0,_.default)(x.default.mark(function e(t){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t.contact)&&!isNullOrEmpty(t.contact.account)){e.next=3;break}return L.info("is not contact chat, do not query signature"),e.abrupt("return");case 3:if(L.info("updateSignatureByRecent"),!window.CLIENTCONFIG.ISMOBILE){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,(0,S.getUserInfo)(t.contact.account,!0);case 8:r=e.sent,r&&!r.result&&(t.contact.signature=r.param.signature,$dispatch(coreUi.selectRecentItem(t)));case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.clickContact=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.contact_id,e.next=4,U(t);case 4:n=e.sent,a=n.userInfo,o=n.customContact,L.info("点击联系人item"),$dispatch(coreUi.updateContactDetail(a,o,r)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),L.error("clickContact",e.t0);case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),t.createContactConversation=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreIm.createOrUpdateRecent({contact:t},null,n,a);case 3:return r=e.sent,L.info("创建联系人会话"),e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(0),L.error("createContactConversation",e.t0);case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}()),P=t.openContactConversation=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.myInfo.account,a=t.account,window.CLIENTCONFIG.USE_IM){e.next=6;break}return e.abrupt("return");case 6:if(!a){e.next=15;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=10;break}return e.next=10,coreCommon.switchNav("recent");case 10:return e.next=12,R(t);case 12:return o=e.sent,isNullOrEmpty(o)?L.error("openContactConversation recent is invalid:",o):(coreIm.openRecentConversation(o),L.info("openContactConversation")),e.abrupt("return",o);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),L.error("openContactConversation error:",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),F=(t.openContactConversationByConf=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=t.account)){e.next=16;break}if(n=$getState().myInfo.account,r===n){e.next=14;break}return e.next=7,R(t);case 7:if(!(a=e.sent)){e.next=14;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=12;break}return e.next=12,coreCommon.switchNav("recent");case 12:coreIm.toggleRecent(a,o),L.info("openContactConversationByConf 会议中打开联系人会话");case 14:e.next=17;break;case 16:L.info("account is null");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),L.error("openContactConversationByConf",e.t0);case 22:case"end":return e.stop()}},e,void 0,[[0,19]])}));return function(t){return e.apply(this,arguments)}}(),t.toggleRemoveFromAll=function(){var e=(0,_.default)(x.default.mark(function e(t){return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.updateRemoveFromAll(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.reloadContactListData=function(){var e=(0,_.default)(x.default.mark(function e(){var t,r,n,a,o,u,c,i,s,p;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.default.all([coreDb.queryAllContact(),coreDb.queryAllContactGroupList(),coreDb.queryAllContactMemberGroupList()]);case 3:if(t=e.sent,r=(0,d.default)(t,3),n=r[0],a=r[1],o=r[2],u=n.length>0,c={hasContact:u,contactUserList:n,contactGroup:a,contactMemberGroup:o},L.info("reloadContactListData","success"),$dispatch(coreUi.updateContactListData(c)),!window.CLIENTCONFIG.ISMOBILE){e.next=19;break}return e.next=15,(0,E.sortMUserList)(c.contactUserList);case 15:i=e.sent,s=i.mList,p=i.enList,$dispatch(coreUi.updateMobileContactList(s,p));case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),L.error("reloadContactListData",e.t0);case 24:case"end":return e.stop()}},e,void 0,[[0,21]])}));return function(){return e.apply(this,arguments)}}()),$=t.checkIsFriendByQuery=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L.info("checkIsFriendByQuery 查找联系人分组对应表"),e.next=4,coreDb.queryAllContactMemberGroupList();case 4:r=e.sent,n=!1,a=0;case 7:if(!(a<r.length)){e.next=15;break}if(o=r[a],o.contact_id!==t){e.next=12;break}return n=!0,e.abrupt("break",15);case 12:a++,e.next=7;break;case 15:return e.abrupt("return",n);case 18:return e.prev=18,e.t0=e.catch(0),L.error("checkIsFriendByQuery",e.t0),e.abrupt("return",!1);case 22:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(t){return e.apply(this,arguments)}}(),B=t.deleteContactLogic=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a,o,u,c;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,k.deleteContactService)(t,r);case 3:if(n=e.sent){e.next=28;break}return e.next=7,coreDb.deleteContactMemberGroup({contact_id:t,group_id:r});case 7:return e.next=9,$(t);case 9:if(a=e.sent){e.next=28;break}return e.next=13,coreDb.queryContact({contact_id:t});case 13:return o=e.sent,u=o.account,o.contact_id="0",e.next=18,(0,N.deleteContactFromDB)(o);case 18:return e.next=20,coreIm.getLocalRecent({owner:u});case 20:if(c=e.sent,!c.id){e.next=28;break}return c.contact.contact_id="0",e.next=25,coreDb.saveRecent(c);case 25:return c=e.sent,e.next=28,$dispatch(coreUi.updateRecent(c));case 28:L.info("删除单个分组里联系人逻辑"),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),L.error("deleteContactLogic",e.t0);case 34:case"end":return e.stop()}},e,void 0,[[0,31]])}));return function(t,r){return e.apply(this,arguments)}}(),q=(t.deleteContact=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(t,r);case 3:return e.next=5,F();case 5:n=$getState(),a=n.contactGroups.contactInfo.contact_id,t===a&&($dispatch(coreUi.updateSelectedItemKey(-1)),$dispatch(coreUi.updateContactGroupDetailShow("noContent"))),L.info("删除单个分组里联系人"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),L.error("deleteContact",e.t0);case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t,r){return e.apply(this,arguments)}}(),t.deleteContactFromAll=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s,d,p;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=$getState(),n=r.contactGroups.contactMemberGroup,a=[].concat((0,C.default)(n)),o=1,u=null,c=0;case 7:if(!(c<a.length)){e.next=22;break}if(t!==a[c].contact_id){e.next=19;break}return u=a[c].group_id,e.next=12,(0,k.deleteContactService)(t,u);case 12:if(!(o=e.sent)){e.next=17;break}return e.abrupt("break",22);case 17:return e.next=19,coreDb.deleteContactMemberGroup({contact_id:t,group_id:u});case 19:c++,e.next=7;break;case 22:if(o){e.next=43;break}return e.next=25,coreDb.queryContact({contact_id:t});case 25:return i=e.sent,s=i.account,i.contact_id="0",e.next=30,(0,N.deleteContactFromDB)(i);case 30:return e.next=32,coreIm.getLocalRecent({owner:s});case 32:if(d=e.sent,isNullOrEmpty(d)){e.next=40;break}return d.contact.contact_id="0",e.next=37,coreDb.saveRecent(d);case 37:return d=e.sent,e.next=40,$dispatch(coreUi.updateRecent(d));case 40:return e.next=42,F();case 42:window.CLIENTCONFIG.ISMOBILE?$dispatch(coreUi.updateMobileContactDetail(i,!1)):(p=r.contactGroups.contactInfo.contact_id,t===p&&($dispatch(coreUi.updateSelectedItemKey(-1)),$dispatch(coreUi.updateContactGroupDetailShow("noContent"))));case 43:L.info("将联系人从全部分组中删除"),e.next=49;break;case 46:e.prev=46,e.t0=e.catch(0),L.error("deleteContactFromAll",e.t0);case 49:case"end":return e.stop()}},e,void 0,[[0,46]])}));return function(t){return e.apply(this,arguments)}}(),t.deleteContactSubmenu=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r.length>0)){e.next=10;break}n=0;case 3:if(!(n<r.length)){e.next=10;break}return a=r[n].contact_id,e.next=7,B(a,t);case 7:n++,e.next=3;break;case 10:return e.next=12,(0,k.deleteContactGroupService)(t);case 12:return e.next=14,coreDb.deleteContactGroup({group_id:t});case 14:return e.next=16,F();case 16:L.info("deleteContactSubmenu"),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),L.error("deleteContactSubmenu",e.t0);case 22:case"end":return e.stop()}},e,void 0,[[0,19]])}));return function(t,r){return e.apply(this,arguments)}}(),t.queryContactMemerGroupByOpts=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=0;case 2:if(!(n<t.length)){e.next=9;break}if(a=t[n],a.contact_id!==r.contact_id||a.group_id!==r.group_id){e.next=6;break}return e.abrupt("return",a);case 6:n++,e.next=2;break;case 9:L.info("queryContactMemerGroupByOpts","success"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),L.error("queryContactMemerGroupByOpts",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}()),H=(t.moveToOtherGroup=function(){var e=(0,_.default)(x.default.mark(function e(t,r,n,a){var o,u,c,i,s,d,p,f;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={contact_id:t,old_group_id:r,new_group_id:n,type:a},e.next=4,(0,k.removeContactToGroupService)(o);case 4:if(u=e.sent,!(c=0===u.result)){e.next=28;break}if(0!==a){e.next=21;break}return i=$getState(),s=i.contactGroups.contactMemberGroup,e.next=12,q(s,{contact_id:t,group_id:r});case 12:return d=e.sent,d.group_id=n,p=(0,h.default)({},d),e.next=17,coreDb.deleteContactMemberGroup({contact_id:t,group_id:r});case 17:return e.next=19,coreDb.bulkPutContactMemberGroup([p]);case 19:e.next=25;break;case 21:if(1!==a){e.next=25;break}return f={contact_id:t,group_id:n,state:48},e.next=25,coreDb.bulkPutContactMemberGroup([f]);case 25:return e.next=27,F();case 27:return e.abrupt("return",c);case 28:L.info("移动/复制到分组"),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),L.error("moveToOtherGroup",e.t0);case 34:case"end":return e.stop()}},e,void 0,[[0,31]])}));return function(t,r,n,a){return e.apply(this,arguments)}}(),t.createContactGroup=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s,d;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=$getState(),n=r.common.inputValue,a=n.replace(/\s+/g,""),o=0===a.length?"New Group":n,u=H(o),e.next=8,(0,k.addContactGroupService)(u,t);case 8:if(c=e.sent,c.result){e.next=19;break}return i={group_id:c.param.id,index:-1,name:u,state:0},e.next=13,coreDb.bulkPutContactGroup([i]);case 13:return s=r.contactGroups.contactTypeOpen,d=[].concat((0,C.default)(s)),d.push({group:c.param.id,open:!0}),$dispatch(coreUi.updateContactTypeOpen(d)),e.next=19,F();case 19:return L.info("createContactGroup"),e.abrupt("return",c);case 23:e.prev=23,e.t0=e.catch(0),L.error("createContactGroup",e.t0);case 26:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t){return e.apply(this,arguments)}}(),t.createNewContactGroup=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s,d;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.contactGroups.addNewName,a=n.replace(/\s+/g,""),!window.CLIENTCONFIG.USE_IM||0!==a.length){e.next=6;break}return e.abrupt("return");case 6:return o=0===a.length?"New Group":n,u=H(o),e.next=10,(0,k.addContactGroupService)(u,t);case 10:if(c=e.sent,c.result){e.next=21;break}return i={group_id:c.param.id,index:-1,name:u,state:0},e.next=15,coreDb.bulkPutContactGroup([i]);case 15:return s=r.contactGroups.contactTypeOpen,d=[].concat((0,C.default)(s)),d.push({group:c.param.id,open:!0}),$dispatch(coreUi.updateContactTypeOpen(d)),e.next=21,F();case 21:return L.info("createNewContactGroup"),e.abrupt("return",c);case 25:e.prev=25,e.t0=e.catch(0),L.error("createNewContactGroup",e.t0);case 28:case"end":return e.stop()}},e,void 0,[[0,25]])}));return function(t){return e.apply(this,arguments)}}(),t.setAddNewContactValueLogic=function(e){try{$dispatch(coreUi.setAddNewContactValue(e))}catch(e){L.error("setAddNewContactValue",e)}},t.checkContactGroupName=function(e){try{L.info("checkContactGroupName");var t=u(e),r=[];$getState().contactGroups.contactGroup.map(function(e){r.push(e.name)});if(-1===r.findIndex(function(e){return e===t}))return t;var n=t.length,a=[];r.map(function(e){var r=e.length;if(r>n){var o=e.substr(0,n),u=e.substr(n+1,1),c=e.substr(r-1,1),i=parseInt(e.substr(n+2,r-n-3));o===t&&i&&"number"==typeof i&&"["===u&&"]"===c&&a.push(i)}});for(var o=0===a.length?0:Math.max.apply(Math,a),c=1;c<o+2;c++){var s=function(e){if(-1===a.findIndex(function(t){return t===e}))return{v:t+" ["+e+"]"}}(c);if("object"===(void 0===s?"undefined":(0,i.default)(s)))return s.v}}catch(e){L.error("checkContactGroupName",e)}}),j=(t.addContact=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s,d,p,f,l,v,m,h,g,C,b;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]),!((a=r.contactGroups.contactUserList?r.contactGroups.contactUserList.length:0)>=n)){e.next=7;break}return alert(language.ADD_TO_MAX),e.abrupt("return");case 7:if(o=t.account,u=t.groupId,c=t.displayName,i={account:o,group_id:u,display_name:void 0===c?"":c},s=void 0,window.CLIENTCONFIG.USE_IM||-3===u){e.next=14;break}s={result:0,param:{contact_id:parseInt((new Date).getTime().toString().substring(5))}},e.next=17;break;case 14:return e.next=16,(0,k.addContactService)(i);case 16:s=e.sent;case 17:if(d=s.param.contact_id,s.result){e.next=49;break}return e.next=21,D(o);case 21:return p=e.sent,p.contact_id=d,e.next=25,(0,S.deleteContactPreSave)(o);case 25:return e.next=27,coreContact.saveContactInfo(p);case 27:return p=e.sent,f={contact_id:d,group_id:u,state:48},e.next=31,coreDb.bulkPutContactMemberGroup([f]);case 31:return e.next=33,F();case 33:return e.next=35,coreIm.getLocalRecent({owner:o});case 35:if(l=e.sent,v=r.contactGroups,m=v.detailContent,h=v.contactInfo,g=v.sliderDetailShow,C=v.sliderContent,b=v.sliderContactInfo,!g||"Contact"!==C||b.account!==o){e.next=40;break}return e.next=40,$dispatch(coreUi.updateSliderContactDetail(p,!1));case 40:if("contact"!==m||h.account!==p.account&&h.contact_id!==p.contact_id||$dispatch(coreUi.updateContactDetail(p,!1)),window.CLIENTCONFIG.ISMOBILE&&$dispatch(coreUi.updateMobileContactDetail(p,!1)),!l.id){e.next=49;break}return l.contact.contact_id=d,e.next=46,coreDb.saveRecent(l);case 46:return l=e.sent,e.next=49,$dispatch(coreUi.updateRecent(l));case 49:return L.info("addContact"),e.abrupt("return",s.result);case 53:e.prev=53,e.t0=e.catch(0),L.error("addContact",e.t0);case 56:case"end":return e.stop()}},e,void 0,[[0,53]])}));return function(t){return e.apply(this,arguments)}}(),t.queryContactGroupByOpts=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=8;break}if(a=t[n],a.group_id!==r.group_id){e.next=5;break}return e.abrupt("return",a);case 5:n++,e.next=1;break;case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),W=t.changeContactGroupName=function(){var e=(0,_.default)(x.default.mark(function e(t,r,n){var a,o,u,c,i,s;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=H(r),e.next=4,(0,k.modifyContactGroupName)(t,a,n);case 4:if(o=e.sent,0!==(u=o.result)){e.next=19;break}return c=$getState(),i=c.contactGroups.contactGroup,e.next=11,j(i,{group_id:t});case 11:return s=e.sent,s.name=a,e.next=15,coreDb.deleteContactGroup({group_id:t});case 15:return e.next=17,coreDb.bulkPutContactGroup([s]);case 17:return e.next=19,F();case 19:L.info("changeContactGroupName"),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),L.error("changeContactGroupName",e.t0);case 25:case"end":return e.stop()}},e,void 0,[[0,22]])}));return function(t,r,n){return e.apply(this,arguments)}}(),K=(t.selectAddContactList=function(){var e=(0,_.default)(x.default.mark(function e(t){return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{L.info("selectAddContactList"),$dispatch(coreUi.updateSelectedContactGroupId(t))}catch(e){L.error("selectAddContactList",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.createConversationLogic=function(){if(window.isOffline)return void alert(language.UNABLE_CREATE_GROUP);var e=$getState(),t=e.recent.currentRecentInfo;return K(t.contact)},t.createConversation=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.isOffline){e.next=4;break}return alert(language.UNABLE_CREATE_GROUP),e.abrupt("return");case 4:if($dispatch(coreUi.setCreateLoading()),r=$getState(),n=void 0,n=r.selectBox.selectBox_tempSelectedList,a=r.myInfo,isNullOrEmpty(t)){e.next=23;break}if(1!==n.length){e.next=23;break}if(n[0].account!==t.account){e.next=18;break}return window.alert(language.CONTACT_ALREADY_EXISTS),e.next=15,$dispatch(coreUi.setCreateNotLoading());case 15:return e.abrupt("return");case 18:if(n[0].account!==a.account){e.next=23;break}return window.alert(language.CAN_NOT_ADD_OWN_ACCOUNT),e.next=22,$dispatch(coreUi.setCreateNotLoading());case 22:return e.abrupt("return");case 23:return o=n.findIndex(function(e){return e.account===a.account}),-1!==o&&n.splice(o,1),t&&t.account!==a.account&&n.unshift(t),e.next=28,J(V(n));case 28:return u=e.sent,e.next=31,$dispatch(coreUi.setCreateNotLoading());case 31:if(!1!==u){e.next=33;break}return e.abrupt("return");case 33:coreUi.hideModal(),L.info("createConversationLogic","success"),e.next=40;break;case 37:e.prev=37,e.t0=e.catch(0),L.error("createConversationLogic",e.t0);case 40:case"end":return e.stop()}},e,void 0,[[0,37]])}));return function(t){return e.apply(this,arguments)}}()),V=function(e){for(var t=[],r=0,n=e.length;r<n;r++){for(var a=r+1;a<n;a++)e[r].account===e[a].account&&(a=++r);t.push(e[r])}return t},J=t.createContactOrGroupConversation=function(){var e=(0,_.default)(x.default.mark(function e(t){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.isOffline){e.next=3;break}return alert(language.UNABLE_CREATE_GROUP),e.abrupt("return");case 3:if(0!==t.length){e.next=5;break}return e.abrupt("return");case 5:if(1!==t.length){e.next=9;break}return e.next=8,P(t[0]);case 8:return e.abrupt("return",e.sent);case 9:return e.next=11,coreGroup.createDiscussionGroup(t);case 11:if(r=e.sent){e.next=14;break}return e.abrupt("return",!1);case 14:if(!isNullOrEmpty(r)){e.next=21;break}return e.next=17,$dispatch(coreUi.setCreateNotLoading());case 17:coreUi.hideModal(),alert(language.CREAT_FAIL),e.next=23;break;case 21:return e.next=23,coreIm.openGroupConversation({group_id:r.group_id});case 23:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Y=(t.checkIsFriendByAccount=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L.info("checkIsFriendByAccount"),r=!1,e.next=5,coreDb.queryContact({account:t});case 5:return n=e.sent,n.contact_id&&(r=!0),e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),L.error("checkIsFriendByAccount",e.t0);case 13:case"end":return e.stop()}},e,void 0,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),t.dealUserInfoChange=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.param){e.next=24;break}if(r=$getState(),!(n=t.param.user_list)){e.next=24;break}a=0;case 6:if(!(a<n.length)){e.next=21;break}return o=n[a],u=o.account,e.next=11,coreDb.queryContact({account:u});case 11:return c=e.sent,i=(0,h.default)({},c,o),e.next=15,coreContact.saveContactInfo(i);case 15:return s=e.sent,e.next=18,Y(s,r);case 18:a++,e.next=6;break;case 21:return e.next=23,F();case 23:L.info("dealUserInfoChange","success");case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),L.error("dealUserInfoChange",e.t0);case 29:case"end":return e.stop()}},e,void 0,[[0,26]])}));return function(t){return e.apply(this,arguments)}}(),t.reLoadContactInfo=function(){var e=(0,_.default)(x.default.mark(function e(t,r){var n,a,o,u,c,i,s,d,p,f,l;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=!0,t.account&&(n=!1),a=r.contactGroups,o=a.detailContent,u=a.contactInfo,c=a.sliderDetailShow,i=a.sliderContent,s=a.sliderContactInfo,d=a.mContactDetailShow,p=a.mContactInfo,!c||"Contact"!==i||s.account!==t.account&&s.contact_id!==t.contact_id||$dispatch(coreUi.updateSliderContactDetail(t,n)),"contact"!==o||u.account!==t.account&&u.contact_id!==t.contact_id||$dispatch(coreUi.updateContactDetail(t,n)),window.CLIENTCONFIG.ISMOBILE&&(!d||p.contact_id!==t.contact_id&&p.account!==t.account||$dispatch(coreUi.updateMobileContactDetail(t,n))),n){e.next=20;break}return f=t.account,e.next=11,coreIm.getLocalRecent({owner:f});case 11:if(l=e.sent,!l.id){e.next=20;break}return l.contact=t,e.next=16,coreDb.saveRecent(l);case 16:if(l=e.sent,l.is_delete!==constant.IS_DELETE.NO){e.next=20;break}return e.next=20,$dispatch(coreUi.updateRecent(l));case 20:L.info("reLoadContactInfo","success"),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(0),L.error("reLoadContactInfo",e.t0);case 26:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t,r){return e.apply(this,arguments)}}());t.setContactGroupNameLogic=function(e){$dispatch(coreUi.setContactGroupName(e))},t.initContactGroupNameLogic=function(){$dispatch(coreUi.initContactGroupName())},t.testGroupName=function(e){try{L.info("testGroupName");var t=$getState(),r=t.contactGroups.contactGroupName.trim(),n=t.contactGroups.contactGroup,a=0;return n.map(function(t){t.name===r&&t.group_id!==e&&a++}),0===a}catch(e){L.error("testGroupName",e)}},t.changeGroupName=function(e,t,r){try{L.info("changeGroupName:"),W(e,t,r)}catch(e){L.error("changeGroupName:",e)}},t.autoCreateGroupName=function(e){var t=$getState().contactGroups.contactGroup,r=e.length,n=[];t.map(function(t){var a=t.name.length;if(a>r){var o=t.name.substr(0,r),u=t.name.substr(r+1,1),c=t.name.substr(a-1,1),i=parseInt(t.name.substr(r+2,a-r-3));o===e&&i&&"number"==typeof i&&"["===u&&"]"===c&&n.push(i)}});for(var a=0===n.length?0:Math.max.apply(Math,n),o=1;o<a+2;o++){var u=function(t){if(-1===n.findIndex(function(e){return e===t}))return{v:e+" ["+t+"]"}}(o);if("object"===(void 0===u?"undefined":(0,i.default)(u)))return u.v}},t.addContactToGroups=function(){var e=(0,_.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s,d,p,f,l,v,m,h,g,C,b,y,_,w,I;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=$getState(),n=void 0,a=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]),!((o=r.contactGroups.contactUserList?r.contactGroups.contactUserList.length:0)>=a)){e.next=7;break}return alert(language.ADD_TO_MAX),e.abrupt("return");case 7:u=t.account,c=t.groupList,i=!0,s=void 0,d=0;case 11:if(!(d<c.length)){e.next=37;break}return p=c[d],f=p.group_id,l={account:u,group_id:f,display_name:""},e.next=17,(0,k.addContactService)(l);case 17:if(v=e.sent,s=v.param.contact_id,v.result){e.next=32;break}return e.next=22,D(u);case 22:return n=e.sent,n.contact_id=s,e.next=26,coreContact.saveContactInfo(n);case 26:return n=e.sent,m={contact_id:s,group_id:f,state:48},e.next=30,coreDb.bulkPutContactMemberGroup([m]);case 30:e.next=34;break;case 32:return i=!1,e.abrupt("break",37);case 34:d++,e.next=11;break;case 37:if(!i){e.next=60;break}return e.next=40,F();case 40:return e.next=42,coreIm.getLocalRecent({owner:u});case 42:if(h=e.sent,g=r.contactGroups,C=g.detailContent,b=g.contactInfo,y=g.sliderDetailShow,_=g.sliderContent,w=g.sliderContactInfo,!y||"Contact"!==_||w.account!==u){e.next=47;break}return e.next=47,$dispatch(coreUi.updateSliderContactDetail(n,!1));case 47:if("contact"!==C||b.account!==n.account&&b.contact_id!==s||$dispatch(coreUi.updateContactDetail(n,!1)),!window.CLIENTCONFIG.ISMOBILE){e.next=53;break}return $dispatch(coreUi.updateMobileContactDetail(n,!1)),I={account:u,contact_id:s},e.next=53,(0,E.tapContact)(I);case 53:if(isNullOrEmpty(h)){e.next=60;break}return h.contact.contact_id=s,e.next=57,coreDb.saveRecent(h);case 57:return h=e.sent,e.next=60,$dispatch(coreUi.updateRecent(h));case 60:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},97:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwContactSdk=void 0;var o=r(120),u=a(o),c=r(4),i=a(c),s=r(1334),d=n(s),p=r(1213),f=n(p),l=r(1337),v=n(l),m=r(1336),h=n(m),g=r(1335),C=n(g),b=r(1338),x=n(b),y=r(890),_=n(y),w=r(1068),I=n(w),k=r(1753),S=n(k),E=r(1211),N=n(E),L=r(996),O=n(L),G=r(1754),T=n(G),M=r(1755),A=n(M),D=r(995),U=n(D),R=r(1756),P=n(R),F=r(1757),$=n(F),B=r(1758),q=r(1760),H=n(q);t.HwContactSdk=function e(){(0,i.default)(this,e),(0,u.default)(this,v),(0,u.default)(this,h),(0,u.default)(this,C),(0,u.default)(this,x),(0,u.default)(this,f),(0,u.default)(this,_),(0,u.default)(this,I),(0,u.default)(this,S),(0,u.default)(this,N),(0,u.default)(this,d),(0,u.default)(this,O),(0,u.default)(this,T),(0,u.default)(this,A),(0,u.default)(this,U),(0,u.default)(this,P),(0,u.default)(this,$),(0,u.default)(this,B.euaserver.getApiList()),(0,u.default)(this,H)}},995:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkageStatusLogic=t.setLinkageStatusLogic=t.getContactList=t.confirmPreservateLogic=t.modifyCustomContactService=t.addCustomContactService=t.addContactService=t.modifyContactGroupName=t.addContactGroupService=t.removeContactToGroupService=t.deleteContactGroupService=t.deleteContactService=void 0;var a=r(1),o=n(a),u=r(2),c=n(u),i=window.Logger("logic")("tupLogic"),s=(t.deleteContactService=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.USE_IM){e.next=9;break}return e.next=3,new coreTup.HWTupIM;case 3:return n=e.sent,e.next=6,n.delfriendorcontact({contact_id:t,group_id:r});case 6:return a=e.sent,u=a.result,e.abrupt("return",u);case 9:return e.abrupt("return",0);case 10:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.deleteContactGroupService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,!window.CLIENTCONFIG.USE_IM){e.next=9;break}return e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.delusergroup(t);case 7:a=e.sent,r=0===a.result;case 9:return e.next=11,coreDb.deleteContactGroup({group_id:t});case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.removeContactToGroupService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.contact_id,n=t.old_group_id,a=t.new_group_id,u=t.type,!window.CLIENTCONFIG.USE_IM){e.next=10;break}return e.next=4,new coreTup.HWTupIM;case 4:return c=e.sent,e.next=7,c.movecontactgroup(t);case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",{result:0});case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.addContactGroupService=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t,index:r},e.next=3,new coreTup.HWTupIM;case 3:return a=e.sent,e.next=6,a.addusergroup(n);case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.modifyContactGroupName=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.USE_IM){e.next=10;break}return e.next=3,new coreTup.HWTupIM;case 3:return a=e.sent,u={id:t,name:r,index:n},e.next=7,a.modusergroup(u);case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",{result:0});case 11:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),t.addContactService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.addfriend(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.addCustomContactService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isEserverOnline){e.next=3;break}return i.error("addCustomContactService eserver is offline!"),e.abrupt("return",{result:1,param:{}});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return r=e.sent,n={id:0,staff_id:0,name:d(t.name),nick_name:"",foreign_name:"",birthday:"",gender:2,corp_name:d(t.crop_name),
//! corp_name 和 crop_name 好坑啊!!!
dept_name:d(t.dept_name),title:d(t.title),mobile:d(t.mobile),office_phone:d(t.office_phone),home_phone:d(t.home_phone),other_phone:d(t.other_phone),fax:d(t.fax),email:d(t.email),website:d(t.website),im_no:d(t.im_no),address:d(t.address),desc:d(t.desc),postcode:d(t.postcode),state:0,other_phone2:d(t.other_phone2),other_mobiles:d(t.other_mobiles),group_id:s(t.group_id)},e.abrupt("return",r.addcontact(n));case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.modifyCustomContactService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isEserverOnline){e.next=3;break}return i.error("modifyCustomContactService eserver is offline!"),e.abrupt("return",{result:1,param:{}});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return r=e.sent,n={id:s(t.contact_id),staff_id:s(t.staff_id),name:d(t.name),nick_name:d(t.nick_name),foreign_name:d(t.foreign_name),birthday:d(t.birthday),gender:s(t.gender),corp_name:d(t.crop_name),
//! 设置是corp_name,下发的却是crop_name 好坑啊!!!
dept_name:d(t.dept_name),title:d(t.title),mobile:d(t.mobile),office_phone:d(t.office_phone),home_phone:d(t.home_phone),other_phone:d(t.other_phone),fax:d(t.fax),email:d(t.email),website:d(t.website),im_no:d(t.im_no),address:d(t.address),desc:d(t.desc),postcode:d(t.postcode),state:0,other_phone2:d(t.other_phone2),other_mobiles:d(t.other_mobiles)},e.abrupt("return",r.modcontact(n));case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(e){var t="number"===Object.type(e)?e:parseInt(e);return isNaN(t)?0:t}),d=function(e){return isNullOrEmpty(e)||"object"===Object.type(e)?"":e.toString()};t.confirmPreservateLogic=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return n=e.sent,a={id:t.contact_id,staff_id:t.staff_id,name:t.name,nick_name:r,foreign_name:"11"},e.next=7,n.modcontact(a);case 7:if(u=e.sent,0!==u.result){e.next=13;break}return e.next=11,coreContact.saveContactInfo(t);case 11:e.next=14;break;case 13:window.alert(language.SETTING_NICKNAME_FAILED);case 14:return e.abrupt("return",u);case 17:e.prev=17,e.t0=e.catch(0),i.error("error",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t,r){return e.apply(this,arguments)}}(),t.getContactList=function(){var e=(0,c.default)(o.default.mark(function e(){var t,r,n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.info("getContactList"),e.next=3,new coreTup.HWTupIM;case 3:return t=e.sent,e.next=6,coreDb.queryUserConfig({key:"increTimeStamp"});case 6:if(r=e.sent,n=r.value,a=void 0,!isNullOrEmpty(n)){e.next=15;break}return e.next=12,t.getcontactlist({is_sync_all:1,time_stamp:""});case 12:a=e.sent,e.next=18;break;case 15:return e.next=17,t.getcontactlist({is_sync_all:0,time_stamp:n});case 17:a=e.sent;case 18:return a&&a.result===constant.ERROR_CODE.Success&&(i.info("getContactList save time_stamp to localstorage"),coreDb.saveUserConfig({key:"increTimeStamp",value:a.param.time_stamp})),e.abrupt("return",a);case 20:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setLinkageStatusLogic=function(){var e=(0,c.default)(o.default.mark(function e(t){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("setLinkageStatusLogic"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.abrupt("return",r.setLinkageStatus(t));case 8:e.prev=8,e.t0=e.catch(0),i.error("setLinkageStatusLogic",e.t0.toString());case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),t.getLinkageStatusLogic=function(){var e=(0,c.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("getLinkageStatusLogic"),e.next=4,new coreTup.HWTupIM;case 4:return t=e.sent,e.abrupt("return",t.getLinkageStatus({}));case 8:e.prev=8,e.t0=e.catch(0),i.error("getLinkageStatusLogic",e.t0.toString());case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},996:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.sortMUserListSync=t.sortMUserList=t.tapContact=void 0;var a=r(130),o=n(a),u=r(120),c=n(u),i=r(1),s=n(i),d=r(2),p=n(d),f=r(890),l=(t.tapContact=function(){var e=(0,p.default)(s.default.mark(function e(t){var r,n,a,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=$getState(),n=r.myInfo.account,a=n===t.account,a?window.goRoute("myAccountInfo"):(window.goRoute("contactBasics"),setTimeout(function(){return l(t,o)},10));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,p.default)(s.default.mark(function e(t){var r,n,a,o,u,i,d,p,l,v,m;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&$dispatch(coreUi.updateMobileContactDetail(t,isNullOrEmpty(t.account))),!t.contact_id||!isNullOrEmpty(t.account)){e.next=3;break}return e.abrupt("return");case 3:return r=[],n="",e.next=7,(0,f.getContactDetailInfo)(t);case 7:return a=e.sent,o=a.userInfo,u=a.customContact,e.next=12,(0,f.updateSignatureFromEserver)(o,t.account);case 12:if(o=e.sent,isNullOrEmpty(o))o=t;else if(o.contact_id){for(i=$getState(),d=i.contactGroups.contactMemberGroup,p=i.contactGroups.contactGroup,l=0;l<d.length;l++)if(d[l].contact_id===o.contact_id)for(v=0;v<p.length;v++)p[v].group_id===d[l].group_id&&r.push(p[v].name);n=r.join(",")}if(m=$getState().contactGroups.contactUserList.query({account:t.account}),$getState().contactGroups.mContactInfo.account===o.account){e.next=17;break}return e.abrupt("return");case 17:$dispatch(coreUi.updateMContactDetailGroup(n)),$dispatch(coreUi.updateMobileContactDetail((0,c.default)({},m,o),u));case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),v=(t.sortMUserList=function(){var e=(0,p.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.sortMUserListSync=function(e){var t=e.sort(function(){return function(e,t){var r=window.pinyinUtil.getPinyin(e.name),n=window.pinyinUtil.getPinyin(t.name);return r.localeCompare(n)}}()),r=[],n=[],a=[],u=1,c=!1;t.forEach(function(e){var t=window.pinyinUtil.getPinyin(e.name.trim()),o=t.charAt(0).toUpperCase();if(/[a-zA-Z]/.test(o))r.includes(o)||(r.push(o),n.push({type:"charTitle",char:o,char_index:u++})),n.push({type:"charItem",item:e,itemKey:e.contact_id});else{if(c=!0,""===o){var i=getContactName(e);e.q_pin_yin=i}a.push({type:"charItem",item:e,itemKey:e.contact_id})}});var i=[];return c&&(r.push("#"),i=a.sort(function(){return function(e,t){var r=e.item.name,n=t.item.name;return r.localeCompare(n)}}()),i.unshift({type:"charTitle",char:"#",char_index:27})),n.push.apply(n,(0,o.default)(i)),{mList:n,enList:r}})}});